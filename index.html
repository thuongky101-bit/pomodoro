<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="A Pomodoro application for studying, featuring Gemini AI integration and a modern interface." />
    <title>Pomodoro Study App — Gemini AI Integration (New UI)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — FOCUSED UI VERSION (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Default) - Updated from file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Add RGB variable for panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: ADD NEW THEMES === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: ADD NEW THEMES === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Add border rules for light/pastel themes */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Modified: remove default border */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: UPDATE TOPIC MANAGEMENT UI === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Modified */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Raise the open menu block above others */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: UPDATE TOPIC MANAGEMENT UI === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Modified */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Keep background transparent on hover */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Color tweak */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Color tweak */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: SOFTER DIVIDER CUSTOMIZATION === */
    #view-timer .panel-bg hr {
        border: none; /* Remove default border */
        height: 1px;  /* Set divider height */
        background-color: var(--muted); /* Use theme's secondary color */
        opacity: 0.3; /* Make it subtle to blend with background */
        margin-top: 0; /* Adjust spacing */
    }
    /* === END: SOFTER DIVIDER CUSTOMIZATION === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Modified */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Modified */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Modified */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Raise z-index to sit above header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Modified */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Modified */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Modified */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Modified */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Modified */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Modified: switched to translucent white background */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Faint white border */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Fine-tune: closer to spec */
        border-color: var(--acc);
    }
    /* === START: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Use translucent black instead of white on light theme */
        border-color: rgba(0, 0, 0, 0.1); /* Faint black border on light themes */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Increase density on focus */
    }
    /* === END: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */

    /* Improve option background and text color per current theme */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Tweak */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Reduce/remove text shadow on light themes to avoid blur/glare */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Timer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Timer</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Topics">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Topics</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Stats">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Stats</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Knowledge Base">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Knowledge Base</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Settings">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Settings</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Guide</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">No Subtopic Selected</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard">📊 Dashboard </button>
          <a href="https://forms.gle/61hYjvwAkR328EaC9" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Send your feedback">💬 Feedback</a>
          <button class="btn ghost small" id="btnExport" title="Export JSON">⬇️ Export File</button>
          <label class="btn ghost small" for="importFile" title="Import JSON">⬆️ Import File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Show/Hide Interface">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Fullscreen">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Welcome to the Pomodoro Study App!</h3>
                <p>Get started by selecting a <strong>Subtopic</strong> or creating a new Topic/Subtopic.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Create New Topic</button>
            </div>
            <div class="presets" role="group" aria-label="Choose preset mode">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">STATUS</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Wind-down Checklist</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Save your current work (Save/Commit).</li>
                <li>Jot down the "Next step".</li>
                <li>Tidy up your workspace.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Start (Space)">▶️ Start</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="End focus session">🧘 Start Break</button>
              <button class="btn" id="btnPause" aria-label="Pause (Space)">⏸️ Pause</button>
              <button class="btn" id="btnResume" aria-label="Resume (Space)">⏵ Resume</button>
              <button class="btn warn" id="btnSkip" aria-label="Skip (N)">⏭️ Skip</button>
              <button class="btn danger" id="btnReset">↺ Reset</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Break Early</button>
            </div>
            <div class="tiny">Shortcuts: <strong>Space</strong> = Start/Pause/Resume, <strong>N</strong> = Next/Skip</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Tasks</button>
                <button class="tab-btn" data-tab="notes">Notes</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-dos for this subtopic:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Add a new task..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Add</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Add a new note..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Add Note</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini for: <span id="currentSubtopicNameChat">(none selected)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Clear History">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Explain the key concepts of this topic">Explain Concept</button>
                  <button class="btn small ghost" data-prompt="Create a detailed outline for this topic">Create Outline</button>
                  <button class="btn small ghost" data-prompt="List 5 important review questions for this topic">Create Review Questions</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Ask Gemini something..." />
                  <button id="btnSendMessage" class="btn acc">Send</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Topic Management</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Add Topic</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Click the arrow to expand/collapse the subtopic list.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Statistics & History — <span id="currentSubtopicName">(none selected)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Total Time</h4><div class="stat-value" id="statTotal">0 min</div></div>
              <div class="stat-card"><h4>Sessions</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Tasks Completed</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">History (FOCUS)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Knowledge Base per Subtopic</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Add Knowledge</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Click on an item to see details.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Discover the Pomodoro Study App</h3>
              <p>
                  Welcome to a study space designed for focus and efficiency. Explore the features that support your learning journey.
              </p>

              <h4>🚀 Quick Start in 4 Steps</h4>
              <p>To keep your journey organized, the app uses a <strong>Main Topic → Subtopic</strong> structure.</p>
              <ol>
                  <li>Open <strong>📚 Topics</strong> from the side navigation.</li>
                  <li>Click <strong>＋ Add Topic</strong> to create a main area (e.g., "Conversational English").</li>
                  <li>Next to the topic, click <strong>＋ Add</strong> to create a more specific subtopic (e.g., "Lesson 1: Practice IPA").</li>
                  <li>Select that subtopic. You’re now ready to start your first focus session!</li>
              </ol>

              <hr />
              <h4>✨ Notable Features</h4>

              <h4>Flexible Timer Modes ⏱️</h4>
              <p>The app offers more than Pomodoro. Pick what fits your work:</p>
              <ul>
                  <li><strong>Classic Pomodoro (Style A/B):</strong> Focus in fixed sessions (e.g., 25 min work, 5 min break) to build discipline and cadence.</li>
                  <li><strong>Flowtime Mode (Style 🌊 Flow):</strong> Ideal for deep work. The timer counts up; end when it feels right. Break time is suggested based on your focus time.</li>
                  <li><strong>Wind-down Buffer:</strong> A customizable buffer between focus and break to wrap up, jot the next step, and switch smoothly—without abrupt cutoffs.</li>
              </ul>

              <h4>Knowledge Base Per Subtopic 💡</h4>
              <p>
                  Each <strong>Subtopic</strong> now has its own dedicated Knowledge Base. This lets you build a focused library of methods and notes that only relate to what you’re studying in that subtopic.
              </p>
              <p>
                  For example, notes and methods for “Conversational English” will only appear when that subtopic is selected and won’t mix with formulas from a subtopic like “Calculus”.
              </p>
              <p>
                  The rich editor still lets you format headings, bold key points, create lists, and highlight important information for each subject.
              </p>

              <h4>Visual Topic Management</h4>
              <p>Easily organize your study goals. Use <strong>drag and drop</strong> to reorder Topics or move Subtopics across topics intuitively.</p>

              <h4>Integrated Tasks & Notes 📝</h4>
              <p>Right within the timer view, create to-dos for each subtopic and jot quick notes without breaking your flow.</p>

              <h4>Zen Mode 🧘</h4>
              <p>When you need absolute focus, click the eye icon (👁️). The interface hides, leaving only the background and timer. You can <strong>drag the timer</strong> anywhere for a clean workspace.</p>

              <h4>Statistics & Milestones 🏆</h4>
              <p>Track your journey through meaningful numbers. The app records and celebrates important focus-time milestones—turning effort into achievements.</p>

              <hr />
              <h4>⌨️ Smart Shortcuts</h4>
              <ul>
                  <li><kbd>Space</kbd>: Start / Pause / Resume the session.</li>
                  <li><kbd>N</kbd>: Skip the current focus or break session.</li>
                  <li><kbd>Esc</kbd>: Close open dialogs (e.g., Settings).</li>
              </ul>

              <hr />
              <h4>🛠️ Advanced Settings & Integrations</h4>

              <h4>Gemini AI Assistant 🧠</h4>
              <p>Turn the app into a smart study companion. Beyond Q&A, you can:</p>
              <ul>
                  <li><strong>Smart Auto-formatting:</strong> While writing under "Methods", let AI analyze and format your raw text—detect headings, bold key ideas, and lists.</li>
                  <li><strong>Setup:</strong> Visit Google AI Studio to create a free API Key and paste it into "Gemini API Key" in Settings.</li>
              </ul>

              <h4>Customize Interface & Sound 🎨</h4>
              <p>Make the workspace yours:</p>
              <ul>
                  <li><strong>Multiple Themes & Backgrounds:</strong> Choose from built-in themes (Light, Dark, Pastel...) or <strong>upload your own background</strong> for inspiration.</li>
                  <li><strong>Custom Alerts:</strong> <strong>Upload your own audio files (.mp3, .wav...)</strong> as alert sounds for focus and breaks.</li>
              </ul>

              <h4>YouTube Background Music 🎶</h4>
              <p>Create the perfect study ambiance by playing a YouTube video or playlist as background music. Paste the URL into the "YouTube Background Music" field in Settings.</p>

              <h4>Data Safety: Backup & Restore 🛡️</h4>
              <p>The app automatically backs up your progress daily. Customize how many days to keep and restore data from a previous day if needed. ⚠️ <strong>Warning:</strong> Restore will overwrite your current data.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Congratulations!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Continue the journey!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Settings</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Timer</button>
              <button class="tab-btn" data-tab="settings-ui">Interface & Sound</button>
              <button class="tab-btn" data-tab="settings-integrations">Integrations</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Style A </button>
                      <button class="btn ghost" data-preset-target="B"> Style B </button>
                      <button class="btn ghost" data-preset-target="C"> Style C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Pomodoro Durations</h4>
                      <div class="row">
                          <label>FOCUS (minutes)<input type="number" id="set_work" min="1" /></label>
                          <label>WIND-DOWN (minutes)<input type="number" id="set_winddown" min="0" /></label>
                          <label>SHORT BREAK (minutes)<input type="number" id="set_short" min="1" /></label>
                          <label>LONG BREAK (minutes)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Pomodoro Cycles<input type="number" id="set_cycles" min="1" /></label>
                          <label>Long Break Interval<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Break Ratio (Work / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Tip: Break time = total focus time / X. Default is 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Automatically start next session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Enable Wind-down after focus session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Prompt for note after each session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Interface</h4>
                      <div class="row">
                          <label>UI Theme
                                <select id="set_theme_color">
                                    <option value="default">Default (Dark Blue)</option>
                                    <option value="light">Light - Milk Tea</option>
                                    <option value="pastel">Pastel - Soft</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Background Display Mode
                              <select id="set_backgroundMode">
                                  <option value="cover">Cover (Default)</option>
                                  <option value="contain">Contain (Sharp)</option>
                                  <option value="auto">Original Size (Repeat)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Background Image
                              <label class="btn small ghost" for="uploadBg">Upload New Image</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Clear Background</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Panel Opacity</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Sound</h4>
                      <div class="row">
                          <label>Volume (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Alert Style
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Customize Alerts</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Alert at end of FOCUS</small>
                              <label title="Alert at end of FOCUS" class="btn small ghost" for="uploadSoundWork">FOCUS</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of SHORT BREAK</small>
                              <label title="Alert at end of SHORT BREAK" class="btn small ghost" for="uploadSoundBreak">SHORT BREAK</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of LONG BREAK</small>
                              <label title="Alert at end of LONG BREAK" class="btn small ghost" for="uploadSoundLong">LONG BREAK</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>AI Integration</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Paste your API Key here..." />
                      </label>
                      <div class="tiny">Required to use AI features. Get a free key at <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 YouTube Background Music</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Paste YouTube link here..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Use video thumbnail as background</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Stopping will not auto-play again until you press ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Volume</div>
                  </div>
                  <div>
                      <h4>🛡️ Backup Settings</h4>
                      <div class="row">
                          <label>Number of backup days to keep
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Restore Data</h4>
                      <p class="tiny">Restore from an automatic daily backup. This action will overwrite your current data.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Restore</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Defaults</button>
              <button class="btn acc" id="btnSaveSettings">Save</button>
              <button class="btn" id="btnCloseSettings">Close</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Note for the completed session</h3>
      <div class="row"><textarea id="noteText" placeholder="What did you learn? Any difficulties? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Summarize & Suggest</button>
        <button class="btn" id="btnSkipNote">Skip</button>
        <button class="btn acc" id="btnSaveNote">Save Note</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Title</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Cancel</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Dashboard</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Close</button>
        </div>
        <p class="tiny">Summary of time and sessions completed across all topics.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Edit Method</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Title<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Content</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Small heading">H</button>
          <button id="toolBold" class="btn small ghost" title="Bold">B</button>
          <button id="toolItalic" class="btn small ghost" title="Italic">I</button>
          <button id="toolList" class="btn small ghost" title="Numbered list">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Bulleted list">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Text color">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Default text color"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Accent color"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Positive color"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Warning color"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Danger color"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Purple"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="This feature requires a Gemini API Key">✨ Auto-format</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Cancel</button>
          <button class="btn acc" id="btnSaveMethod">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Press "Enable Sound" to allow background audio.</span>
    <button id="btnEnableSound" class="btn small acc">Enable Sound</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
    const _0x52ca82=_0x1305;(function(_0x476b7a,_0x195ecc){const _0x4da3a5=_0x1305,_0x489e48=_0x476b7a();while(!![]){try{const _0x2c4640=-parseInt(_0x4da3a5(0x4c5))/0x1+parseInt(_0x4da3a5(0x3d1))/0x2+-parseInt(_0x4da3a5(0x27b))/0x3*(-parseInt(_0x4da3a5(0x433))/0x4)+-parseInt(_0x4da3a5(0x463))/0x5+parseInt(_0x4da3a5(0x32a))/0x6*(-parseInt(_0x4da3a5(0x3b9))/0x7)+-parseInt(_0x4da3a5(0x35d))/0x8*(parseInt(_0x4da3a5(0x1fd))/0x9)+parseInt(_0x4da3a5(0x32d))/0xa*(parseInt(_0x4da3a5(0x2bc))/0xb);if(_0x2c4640===_0x195ecc)break;else _0x489e48['push'](_0x489e48['shift']());}catch(_0x3defe5){_0x489e48['push'](_0x489e48['shift']());}}}(_0x52c9,0xbdbe8),window['addEventListener'](_0x52ca82(0x330),()=>{try{updateFullscreenButton();}catch(_0x160792){}}));const IS_FILE_PROTOCOL=window[_0x52ca82(0x2f6)][_0x52ca82(0x3c3)]===_0x52ca82(0x2f9);function startYtApiWatchdog(){const _0x138125=_0x52ca82,_0x258114=document[_0x138125(0x49c)](_0x138125(0x2e9));if(!_0x258114)return;const _0x122564=setTimeout(()=>{const _0x5b924b=_0x138125;try{(!window['YT']||!window['YT']['Player'])&&(_0x258114['textContent']=_0x5b924b(0x1d3),_0x258114[_0x5b924b(0x2b8)]['color']=_0x5b924b(0x406));}catch(_0x57ca5c){}},0x5dc),_0x30eb80=setTimeout(()=>{const _0x39fc33=_0x138125;try{(!window['YT']||!window['YT'][_0x39fc33(0x1bf)])&&(_0x258114[_0x39fc33(0x4a4)]=_0x39fc33(0x3c1),_0x258114[_0x39fc33(0x2b8)][_0x39fc33(0x45c)]=_0x39fc33(0x2ee));}catch(_0x262b13){}},0x1b58);window[_0x138125(0x284)]={'cancel'(){clearTimeout(_0x122564),clearTimeout(_0x30eb80);}};}(function(){const _0x370f85=_0x52ca82,_0x4e0893={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x370f85(0x3f7)+current+'/'+target,'timer.selectSubtopicPrompt':_0x370f85(0x46c)};window['t']=function _0x5351e8(_0x492b1a,_0x15e3cf){const _0x989185=_0x370f85;try{const _0x355b66=_0x4e0893[_0x492b1a];if(typeof _0x355b66==='function')return _0x355b66(_0x15e3cf||{});if(typeof _0x355b66===_0x989185(0x268))return _0x355b66;}catch(_0x809cd1){}return _0x492b1a;},window[_0x370f85(0x456)]=function _0x353314(_0x31a19a){const _0x50fc31=_0x370f85;try{localStorage[_0x50fc31(0x4a5)](_0x50fc31(0x428),_0x31a19a||'en');}catch(_0x404bec){}return Promise[_0x50fc31(0x2f0)]();};}());function ensureYouTubeAPI(){const _0x36a191=_0x52ca82;if(IS_FILE_PROTOCOL)return Promise[_0x36a191(0x2f0)](![]);try{if(window['YT']&&window['YT'][_0x36a191(0x1bf)])return Promise['resolve'](!![]);}catch(_0x30d918){}if(window[_0x36a191(0x409)])return window[_0x36a191(0x409)];return startYtApiWatchdog(),window[_0x36a191(0x409)]=new Promise((_0x43cca2,_0x1c55ab)=>{const _0x88fa4c=_0x36a191;try{const _0x199daf=document[_0x88fa4c(0x410)](_0x88fa4c(0x202));_0x199daf[_0x88fa4c(0x34f)]=_0x88fa4c(0x413),_0x199daf[_0x88fa4c(0x426)]=!![],_0x199daf[_0x88fa4c(0x43d)]=!![],_0x199daf[_0x88fa4c(0x4c0)]=()=>_0x43cca2(!![]),_0x199daf[_0x88fa4c(0x315)]=()=>_0x1c55ab(new Error('Failed\x20to\x20load\x20YouTube\x20API')),document[_0x88fa4c(0x29a)][_0x88fa4c(0x3e9)](_0x199daf);}catch(_0x45d4d8){_0x1c55ab(_0x45d4d8);}}),window['__ytApiPromise'];}const storageManager={'DB_NAME':'PomodoroAppDB','DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x468c5a,_0x3a5b9d)=>{const _0xe93c87=_0x1305;if(this['db'])return _0x468c5a(this['db']);const _0x39546e=indexedDB[_0xe93c87(0x3f4)](this[_0xe93c87(0x22a)],this[_0xe93c87(0x43f)]);_0x39546e[_0xe93c87(0x364)]=_0x9ac03b=>{const _0x7a7d76=_0xe93c87,_0x5d7d54=_0x9ac03b[_0x7a7d76(0x1e2)][_0x7a7d76(0x444)];!_0x5d7d54[_0x7a7d76(0x386)][_0x7a7d76(0x4a0)](_0x7a7d76(0x4b9))&&_0x5d7d54[_0x7a7d76(0x401)](_0x7a7d76(0x4b9));!_0x5d7d54['objectStoreNames'][_0x7a7d76(0x4a0)](_0x7a7d76(0x269))&&_0x5d7d54[_0x7a7d76(0x401)](_0x7a7d76(0x269),{'keyPath':'id'});if(!_0x5d7d54[_0x7a7d76(0x386)][_0x7a7d76(0x4a0)]('subtopics')){const _0x3899b2=_0x5d7d54[_0x7a7d76(0x401)](_0x7a7d76(0x23c),{'keyPath':'id'});_0x3899b2[_0x7a7d76(0x296)](_0x7a7d76(0x28b),_0x7a7d76(0x304));}!_0x5d7d54[_0x7a7d76(0x386)][_0x7a7d76(0x4a0)](_0x7a7d76(0x368))&&_0x5d7d54[_0x7a7d76(0x401)](_0x7a7d76(0x368),{'keyPath':_0x7a7d76(0x3d6)});},_0x39546e[_0xe93c87(0x226)]=_0x160709=>{const _0x3d6c05=_0xe93c87;this['db']=_0x160709[_0x3d6c05(0x1e2)][_0x3d6c05(0x444)],console[_0x3d6c05(0x203)](_0x3d6c05(0x2d8)),_0x468c5a(this['db']);},_0x39546e[_0xe93c87(0x315)]=_0x4285e4=>{const _0x3b477e=_0xe93c87;console[_0x3b477e(0x2fb)](_0x3b477e(0x41a),_0x4285e4[_0x3b477e(0x1e2)][_0x3b477e(0x31e)]),_0x3a5b9d(_0x4285e4['target'][_0x3b477e(0x2fb)]);};});},async '_getStore'(_0x241d58,_0x169eef=_0x52ca82(0x341)){const _0x27b58b=_0x52ca82;await this['initDB']();const _0x55c937=this['db'][_0x27b58b(0x391)]([_0x241d58],_0x169eef);return _0x55c937['objectStore'](_0x241d58);},async 'getSettings'(){const _0x4614ba=_0x52ca82,_0x593eaf=await this[_0x4614ba(0x405)](_0x4614ba(0x4b9));return new Promise((_0x47987b,_0x25b29f)=>{const _0x2f4bca=_0x4614ba,_0xb34033=_0x593eaf[_0x2f4bca(0x4cb)](_0x2f4bca(0x273));_0xb34033[_0x2f4bca(0x226)]=()=>_0x47987b(_0xb34033[_0x2f4bca(0x444)]),_0xb34033[_0x2f4bca(0x315)]=()=>_0x25b29f(_0xb34033[_0x2f4bca(0x2fb)]);});},async 'updateSettings'(_0x1504b1){const _0x194c89=_0x52ca82,_0x2f7dc4=await this[_0x194c89(0x405)](_0x194c89(0x4b9),_0x194c89(0x482));return new Promise((_0x21654b,_0x6a1342)=>{const _0x4ee919=_0x194c89,_0x2a76cd=_0x2f7dc4['put'](_0x1504b1,'main_settings');_0x2a76cd[_0x4ee919(0x226)]=()=>_0x21654b(_0x2a76cd[_0x4ee919(0x444)]),_0x2a76cd[_0x4ee919(0x315)]=()=>_0x6a1342(_0x2a76cd['error']);});},async 'getAll'(_0x270f44){const _0x450dc3=await this['_getStore'](_0x270f44);return new Promise((_0x49d52f,_0x5701f7)=>{const _0x1af60e=_0x1305,_0x325788=_0x450dc3[_0x1af60e(0x382)]();_0x325788[_0x1af60e(0x226)]=()=>_0x49d52f(_0x325788[_0x1af60e(0x444)]),_0x325788[_0x1af60e(0x315)]=()=>_0x5701f7(_0x325788[_0x1af60e(0x2fb)]);});},async 'update'(_0x5c8d28,_0x12aa8c){const _0x1bce65=_0x52ca82,_0x53f709=await this['_getStore'](_0x5c8d28,_0x1bce65(0x482));return new Promise((_0x1f1820,_0x2f35e8)=>{const _0x13b7a1=_0x1bce65,_0x5f5b13=_0x53f709['put'](_0x12aa8c);_0x5f5b13['onsuccess']=()=>_0x1f1820(_0x5f5b13[_0x13b7a1(0x444)]),_0x5f5b13[_0x13b7a1(0x315)]=()=>_0x2f35e8(_0x5f5b13[_0x13b7a1(0x2fb)]);});},async 'add'(_0x3ca059,_0x34521b){const _0x3b907c=_0x52ca82,_0x11ba4d=await this[_0x3b907c(0x405)](_0x3ca059,_0x3b907c(0x482));return new Promise((_0x2eec09,_0x4bed40)=>{const _0x473f8f=_0x3b907c,_0x35e84b=_0x11ba4d['add'](_0x34521b);_0x35e84b['onsuccess']=()=>_0x2eec09(_0x35e84b['result']),_0x35e84b[_0x473f8f(0x315)]=()=>_0x4bed40(_0x35e84b[_0x473f8f(0x2fb)]);});},async 'delete'(_0x326b6d,_0x4e34fd){const _0x4cdbdc=_0x52ca82,_0x2ef0f2=await this[_0x4cdbdc(0x405)](_0x326b6d,_0x4cdbdc(0x482));return new Promise((_0x4c1dc4,_0x245d07)=>{const _0x379673=_0x4cdbdc,_0x4eb9b5=_0x2ef0f2['delete'](_0x4e34fd);_0x4eb9b5[_0x379673(0x226)]=()=>_0x4c1dc4(_0x4eb9b5['result']),_0x4eb9b5[_0x379673(0x315)]=()=>_0x245d07(_0x4eb9b5[_0x379673(0x2fb)]);});},async 'save'(_0x994b69){const _0x51b04d=_0x52ca82;return await this[_0x51b04d(0x1c5)](),new Promise((_0x6ddde4,_0x3d8514)=>{const _0x14f19e=_0x51b04d,_0x58933a=this['db'][_0x14f19e(0x391)]([_0x14f19e(0x4b9),_0x14f19e(0x269),_0x14f19e(0x23c)],_0x14f19e(0x482)),_0xd3519f=_0x58933a['objectStore']('settings'),_0x1080e6=_0x58933a[_0x14f19e(0x344)](_0x14f19e(0x269)),_0x5efd98=_0x58933a[_0x14f19e(0x344)](_0x14f19e(0x23c));_0xd3519f[_0x14f19e(0x232)](_0x994b69[_0x14f19e(0x4b9)],_0x14f19e(0x273)),_0x1080e6[_0x14f19e(0x465)](),_0x5efd98['clear'](),_0x994b69['topics'][_0x14f19e(0x26c)](_0x1f642d=>{const _0x4dad5a=_0x14f19e,{subtopics:_0x293144,..._0x4ba539}=_0x1f642d;_0x1080e6[_0x4dad5a(0x232)](_0x4ba539),(_0x293144||[])['forEach'](_0x422c80=>_0x5efd98[_0x4dad5a(0x232)](_0x422c80));}),_0x58933a[_0x14f19e(0x48c)]=()=>_0x6ddde4(),_0x58933a['onerror']=_0x3cb9ad=>_0x3d8514(_0x3cb9ad[_0x14f19e(0x1e2)][_0x14f19e(0x2fb)]);});},async 'autoBackup'(_0x250f45){const _0x71def7=_0x52ca82;await this[_0x71def7(0x1c5)]();const _0x13897e=new Date()['toISOString']()[_0x71def7(0x384)](0x0,0xa),_0x34cff6=localStorage[_0x71def7(0x342)](_0x71def7(0x4b5));if(_0x13897e!==_0x34cff6){console['log'](_0x71def7(0x39c)+_0x13897e+_0x71def7(0x458));const _0x3e692d={'date':_0x13897e,'data':JSON[_0x71def7(0x34d)](JSON[_0x71def7(0x2f8)](_0x250f45))},_0x414552=this['db'][_0x71def7(0x391)]([_0x71def7(0x368)],'readwrite'),_0x2e86d0=_0x414552[_0x71def7(0x344)]('backups'),_0x45dd38=_0x2e86d0['put'](_0x3e692d);_0x45dd38[_0x71def7(0x226)]=()=>{const _0x973f59=_0x71def7;localStorage[_0x973f59(0x4a5)](_0x973f59(0x4b5),_0x13897e),console['log'](_0x973f59(0x253)),this[_0x973f59(0x1f9)](_0x250f45?.[_0x973f59(0x4b9)]?.[_0x973f59(0x1e0)]||0x7);},_0x45dd38[_0x71def7(0x315)]=_0x5bd281=>{const _0x468357=_0x71def7;console['error'](_0x468357(0x4da),_0x5bd281[_0x468357(0x1e2)][_0x468357(0x2fb)]);};}},async 'cleanupOldBackups'(_0xb50653){const _0x5adbd9=_0x52ca82;await this['initDB']();const _0x445099=this['db'][_0x5adbd9(0x391)]([_0x5adbd9(0x368)],_0x5adbd9(0x482)),_0xfff229=_0x445099['objectStore'](_0x5adbd9(0x368)),_0x335150=_0xfff229[_0x5adbd9(0x1d8)]();_0x335150[_0x5adbd9(0x226)]=()=>{const _0x510991=_0x5adbd9,_0x4be3ab=_0x335150[_0x510991(0x444)]['sort']()['reverse']();if(_0x4be3ab[_0x510991(0x2ca)]>_0xb50653){const _0x40cd1b=_0x4be3ab[_0x510991(0x384)](_0xb50653);_0x40cd1b['forEach'](_0x980546=>{const _0x16c1bd=_0x510991;_0xfff229[_0x16c1bd(0x3cb)](_0x980546),console[_0x16c1bd(0x203)](_0x16c1bd(0x1c2)+_0x980546);});}};},async 'getBackupList'(){const _0x37187f=_0x52ca82;return await this[_0x37187f(0x1c5)](),new Promise((_0x4cdfd6,_0xb55e06)=>{const _0x1fc662=_0x37187f,_0xfd577e=this['db'][_0x1fc662(0x391)]([_0x1fc662(0x368)],_0x1fc662(0x341)),_0x216987=_0xfd577e['objectStore'](_0x1fc662(0x368)),_0x32099b=_0x216987['getAll']();_0x32099b[_0x1fc662(0x226)]=()=>_0x4cdfd6(_0x32099b[_0x1fc662(0x444)][_0x1fc662(0x3ac)]((_0x1b62b9,_0x5506e2)=>_0x5506e2[_0x1fc662(0x3d6)][_0x1fc662(0x4cc)](_0x1b62b9[_0x1fc662(0x3d6)]))),_0x32099b[_0x1fc662(0x315)]=_0x3c5e8d=>_0xb55e06(_0x3c5e8d[_0x1fc662(0x1e2)]['error']);});},async 'restoreBackup'(_0x58837e){return await this['initDB'](),new Promise((_0x43d237,_0x114fe4)=>{const _0x3bfc57=_0x1305,_0x33fb10=this['db'][_0x3bfc57(0x391)](['backups'],_0x3bfc57(0x341)),_0x5a9c17=_0x33fb10[_0x3bfc57(0x344)](_0x3bfc57(0x368)),_0x549508=_0x5a9c17[_0x3bfc57(0x4cb)](_0x58837e);_0x549508['onsuccess']=()=>{const _0xbe01e2=_0x3bfc57;_0x549508['result']&&_0x549508['result'][_0xbe01e2(0x28a)]?(localStorage[_0xbe01e2(0x4a5)](_0xbe01e2(0x37c),JSON['stringify'](_0x549508[_0xbe01e2(0x444)][_0xbe01e2(0x28a)])),_0x43d237(_0x549508[_0xbe01e2(0x444)][_0xbe01e2(0x28a)])):_0x114fe4(new Error(_0xbe01e2(0x1f0)));},_0x549508[_0x3bfc57(0x315)]=_0x28dd9a=>_0x114fe4(_0x28dd9a[_0x3bfc57(0x1e2)][_0x3bfc57(0x2fb)]);});},'exportData'(_0x572ca3){const _0x42e0df=_0x52ca82;let _0x2341ff={};try{_0x2341ff=JSON[_0x42e0df(0x34d)](JSON[_0x42e0df(0x2f8)](_0x572ca3||{}));}catch(_0x3bbd01){_0x2341ff=_0x572ca3;}try{if(_0x2341ff&&_0x2341ff[_0x42e0df(0x4b9)])_0x2341ff['settings'][_0x42e0df(0x4a6)]='';}catch(_0x207f16){}const _0x2667ee=new Blob([JSON['stringify'](_0x2341ff,null,0x2)],{'type':_0x42e0df(0x33a)}),_0x1a82e1=document[_0x42e0df(0x410)]('a'),_0x5884b1=new Date(),_0x441a91=_0x4bf42c=>(''+_0x4bf42c)[_0x42e0df(0x311)](0x2,'0');_0x1a82e1[_0x42e0df(0x42a)]=URL[_0x42e0df(0x23a)](_0x2667ee),_0x1a82e1[_0x42e0df(0x3d3)]=_0x42e0df(0x21f)+_0x5884b1['getFullYear']()+_0x441a91(_0x5884b1[_0x42e0df(0x4d4)]()+0x1)+_0x441a91(_0x5884b1['getDate']())+_0x42e0df(0x295),_0x1a82e1['click'](),URL['revokeObjectURL'](_0x1a82e1[_0x42e0df(0x42a)]);},async 'importData'(_0x7f5e3f){const _0x5b2cb8=_0x52ca82,_0x407f57=await _0x7f5e3f[_0x5b2cb8(0x469)](),_0xe72e58=JSON[_0x5b2cb8(0x34d)](_0x407f57);if(!_0xe72e58[_0x5b2cb8(0x24e)]||!_0xe72e58[_0x5b2cb8(0x4b9)]||!Array['isArray'](_0xe72e58[_0x5b2cb8(0x269)]))throw new Error(_0x5b2cb8(0x236));try{const _0x220b2b=window[_0x5b2cb8(0x28a)]&&window[_0x5b2cb8(0x28a)]['settings']&&window['data'][_0x5b2cb8(0x4b9)][_0x5b2cb8(0x4a6)]||'';(!(_0x5b2cb8(0x4a6)in _0xe72e58[_0x5b2cb8(0x4b9)])||_0xe72e58[_0x5b2cb8(0x4b9)][_0x5b2cb8(0x4a6)]==='')&&(_0xe72e58[_0x5b2cb8(0x4b9)][_0x5b2cb8(0x4a6)]=_0x220b2b);}catch(_0x590b8c){}return localStorage[_0x5b2cb8(0x4a5)](_0x5b2cb8(0x37c),JSON[_0x5b2cb8(0x2f8)](_0xe72e58)),_0xe72e58;}},$=(_0x41db94,_0x6574d3=document)=>_0x6574d3[_0x52ca82(0x4d1)](_0x41db94),breakSuggestions=['Stand\x20up\x20and\x20stretch.',_0x52ca82(0x25a),_0x52ca82(0x356),_0x52ca82(0x4bb),_0x52ca82(0x2af),_0x52ca82(0x357),_0x52ca82(0x2be),_0x52ca82(0x2dc),'Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.',_0x52ca82(0x44f),_0x52ca82(0x431),'Open\x20a\x20window\x20for\x20some\x20fresh\x20air.',_0x52ca82(0x495),'Look\x20at\x20something\x20cute\x20or\x20uplifting.','Count\x20down\x20slowly\x20from\x2020\x20to\x200.',_0x52ca82(0x38f),_0x52ca82(0x23d),_0x52ca82(0x3ba),'Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.','Notice\x20the\x20room’s\x20temperature\x20and\x20lighting.',_0x52ca82(0x282),_0x52ca82(0x287),_0x52ca82(0x473),'Have\x20a\x20sip\x20of\x20water.',_0x52ca82(0x36a),_0x52ca82(0x2a5),_0x52ca82(0x415),'Loosen\x20your\x20finger\x20joints\x20after\x20typing.',_0x52ca82(0x3aa),_0x52ca82(0x290),_0x52ca82(0x299),_0x52ca82(0x4e6)],$$=(_0x13f4dd,_0x5bcc15=document)=>Array[_0x52ca82(0x377)](_0x5bcc15[_0x52ca82(0x338)](_0x13f4dd));function on(_0x27e47a,_0x3a7bfa,_0x20bc30){const _0x703863=_0x52ca82;if(!_0x27e47a){console[_0x703863(0x42b)](_0x703863(0x46b),_0x3a7bfa);return;}_0x27e47a['addEventListener'](_0x3a7bfa,_0x20bc30);}const formatMMSS=_0x1c2887=>{const _0x37db8c=_0x52ca82,_0x44e288=Math[_0x37db8c(0x347)](_0x1c2887/0x3c)['toString']()[_0x37db8c(0x311)](0x2,'0'),_0x5c7c54=Math[_0x37db8c(0x347)](_0x1c2887%0x3c)['toString']()[_0x37db8c(0x311)](0x2,'0');return _0x44e288+':'+_0x5c7c54;},uid=(_0x40e9a7='id')=>_0x40e9a7+'_'+Date[_0x52ca82(0x40e)]()+'_'+Math[_0x52ca82(0x3a7)]()['toString'](0x24)[_0x52ca82(0x384)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x474cad){const _0x566e46=_0x52ca82;try{const _0x3cb47e=_0x474cad[_0x566e46(0x338)](_0x566e46(0x32b));if(!_0x3cb47e[_0x566e46(0x2ca)])return;const _0x5ed077=_0x3cb47e[0x0],_0x5220e3=_0x3cb47e[_0x3cb47e['length']-0x1],_0x2eef74=_0x571bf7=>{const _0x3c9a36=_0x566e46;if(_0x571bf7[_0x3c9a36(0x4b0)]==='Tab'){if(_0x571bf7['shiftKey']&&document[_0x3c9a36(0x37b)]===_0x5ed077)_0x571bf7['preventDefault'](),_0x5220e3[_0x3c9a36(0x2d6)]();else!_0x571bf7[_0x3c9a36(0x1e1)]&&document[_0x3c9a36(0x37b)]===_0x5220e3&&(_0x571bf7[_0x3c9a36(0x40f)](),_0x5ed077[_0x3c9a36(0x2d6)]());}};_0x474cad[_0x566e46(0x459)](_0x566e46(0x363),_0x2eef74),_0x5ed077['focus'](),__releaseFocusTrap=()=>{const _0x5f58d8=_0x566e46;try{_0x474cad['removeEventListener'](_0x5f58d8(0x363),_0x2eef74);}catch(_0x2a810e){}};}catch(_0x3bae2a){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x4694e7){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x52ca82(0x309)]();function toast(_0x1e725e,_0x58aa97=0xa28){const _0xfb93f1=_0x52ca82,_0x272fd4=$(_0xfb93f1(0x328)),_0x65e5e9=document['createElement'](_0xfb93f1(0x3d0));_0x65e5e9['className']=_0xfb93f1(0x47d),_0x65e5e9['textContent']=_0x1e725e,_0x272fd4[_0xfb93f1(0x3e9)](_0x65e5e9),setTimeout(()=>{const _0x2742c3=_0xfb93f1;_0x65e5e9[_0x2742c3(0x2b8)][_0x2742c3(0x499)]='0';},_0x58aa97-0x12c),setTimeout(()=>_0x272fd4['removeChild'](_0x65e5e9),_0x58aa97);}function escapeHTML(_0x313ba2){const _0x1ae77d=_0x52ca82;return _0x313ba2['replace'](/[&<>"']/g,_0x2a9741=>({'&':_0x1ae77d(0x212),'<':_0x1ae77d(0x3ff),'>':_0x1ae77d(0x1f4),'\x22':_0x1ae77d(0x354),'\x27':_0x1ae77d(0x4c4)}[_0x2a9741]));}function formatDaysHoursMinutes(_0x2ed9dd){const _0x4f6a76=_0x52ca82;if(!_0x2ed9dd||_0x2ed9dd<0x1)return _0x4f6a76(0x440);const _0x28e49f=Math['floor'](_0x2ed9dd/0x3c),_0x477d4c=_0x2ed9dd%0x3c,_0x4b2422=_0x477d4c['toString']()[_0x4f6a76(0x311)](0x2,'0');return _0x28e49f+'\x20hours\x20'+_0x4b2422+_0x4f6a76(0x205);}function formatGeminiResponse(_0x320b99){const _0x441717=_0x52ca82;return _0x320b99[_0x441717(0x383)](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x5e5a9d){const _0x36fdd7=_0x52ca82,_0x3b72f0=(_0x5e5a9d||'')[_0x36fdd7(0x449)]('\x0a');let _0x1edd45='',_0x4fbe57=null;const _0x3b0a96=()=>{const _0x49490f=_0x36fdd7;_0x4fbe57&&(_0x1edd45+=_0x4fbe57==='ol'?_0x49490f(0x3da):_0x49490f(0x486),_0x4fbe57=null);};for(let _0x19861b of _0x3b72f0){let _0x517b72=(_0x19861b||'')['trim']();if(!_0x517b72){_0x3b0a96();continue;}if(_0x517b72['startsWith'](_0x36fdd7(0x2b9)))_0x3b0a96(),_0x1edd45+='<h4>'+escapeHTML(_0x517b72[_0x36fdd7(0x20a)](0x5))+'</h4>';else{if(/^\d+\.\s/[_0x36fdd7(0x498)](_0x517b72)){_0x4fbe57!=='ol'&&(_0x3b0a96(),_0x1edd45+=_0x36fdd7(0x3b4),_0x4fbe57='ol');const _0x291125=_0x517b72[_0x36fdd7(0x20a)](_0x517b72['indexOf']('\x20')+0x1);_0x1edd45+=_0x36fdd7(0x324)+escapeHTML(_0x291125)+_0x36fdd7(0x3ee);}else _0x517b72['startsWith']('-\x20')?(_0x4fbe57!=='ul'&&(_0x3b0a96(),_0x1edd45+=_0x36fdd7(0x493),_0x4fbe57='ul'),_0x1edd45+=_0x36fdd7(0x324)+escapeHTML(_0x517b72['substring'](0x2))+_0x36fdd7(0x3ee)):(_0x3b0a96(),_0x517b72=escapeHTML(_0x517b72)['replace'](/\*\*(.*?)\*\*/g,_0x36fdd7(0x229))[_0x36fdd7(0x383)](/_(.*?)_/g,_0x36fdd7(0x3a3)),_0x1edd45+='<p>'+_0x517b72+_0x36fdd7(0x271));}}return _0x3b0a96(),_0x1edd45;}function wrapTextInMarkdown(_0xe20926,_0x537e56,_0x197897=''){const _0xabd36a=_0x52ca82;if(!_0xe20926)return;const _0x37c55a=_0xe20926['selectionStart']||0x0,_0x1f8fed=_0xe20926[_0xabd36a(0x30d)]||0x0,_0x5bc2d6=_0xe20926[_0xabd36a(0x1ff)][_0xabd36a(0x20a)](_0x37c55a,_0x1f8fed),_0x4efe14=_0x537e56+_0x5bc2d6+(_0x197897||_0x537e56);_0xe20926['setRangeText'](_0x4efe14,_0x37c55a,_0x1f8fed,_0xabd36a(0x310)),_0xe20926[_0xabd36a(0x2d6)]();}function updateEditorPreview(){const _0x2a2149=_0x52ca82,_0x282bbd=$(_0x2a2149(0x421)),_0x2880cf=$(_0x2a2149(0x231));if(!_0x282bbd||!_0x2880cf)return;const _0x10481d=_0x282bbd[_0x2a2149(0x1ff)]||'';_0x2880cf[_0x2a2149(0x468)]=parseSimpleMarkdown(_0x10481d);}function normalizeDataStructure(_0x2ad8aa){const _0x5e05b9=_0x52ca82;if(!_0x2ad8aa||typeof _0x2ad8aa!==_0x5e05b9(0x1cd))return;const _0x1b1d52=_0x2ad8aa[_0x5e05b9(0x4b9)]||{},_0x23147d={...defaults[_0x5e05b9(0x4b9)],..._0x1b1d52,'durations':{...defaults[_0x5e05b9(0x4b9)][_0x5e05b9(0x1d1)],..._0x1b1d52[_0x5e05b9(0x1d1)]||{}}};if(!Array['isArray'](_0x23147d['achievedMilestones']))_0x23147d[_0x5e05b9(0x3c2)]=[];_0x2ad8aa[_0x5e05b9(0x4b9)]=_0x23147d,_0x2ad8aa[_0x5e05b9(0x269)]=Array['isArray'](_0x2ad8aa['topics'])?_0x2ad8aa[_0x5e05b9(0x269)]:[],_0x2ad8aa[_0x5e05b9(0x269)][_0x5e05b9(0x26c)](_0x3568e8=>{const _0x3c08bb=_0x5e05b9;_0x3568e8[_0x3c08bb(0x23c)]=Array[_0x3c08bb(0x39b)](_0x3568e8[_0x3c08bb(0x23c)])?_0x3568e8[_0x3c08bb(0x23c)]:[],_0x3568e8[_0x3c08bb(0x23c)][_0x3c08bb(0x26c)](_0x3594a0=>{const _0x1f5bd8=_0x3c08bb;_0x3594a0['tasks']=_0x3594a0['tasks']||[],_0x3594a0[_0x1f5bd8(0x3a8)]=_0x3594a0[_0x1f5bd8(0x3a8)]||[],_0x3594a0[_0x1f5bd8(0x313)]=_0x3594a0[_0x1f5bd8(0x313)]||[],_0x3594a0['chatHistory']=_0x3594a0[_0x1f5bd8(0x4df)]||[],_0x3594a0[_0x1f5bd8(0x1dd)]=Array['isArray'](_0x3594a0[_0x1f5bd8(0x1dd)])?_0x3594a0['methods']:[],_0x3594a0[_0x1f5bd8(0x2a6)]=_0x3594a0[_0x1f5bd8(0x2a6)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x3594a0[_0x1f5bd8(0x307)]=_0x3594a0[_0x1f5bd8(0x307)]||[],_0x3594a0[_0x1f5bd8(0x1f2)]=_0x3594a0['timerState']||{'state':_0x1f5bd8(0x446),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x402d88){const _0x3720fa=_0x52ca82;if(!_0x402d88)return null;const _0xf324d4=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x1d2740=_0x402d88[_0x3720fa(0x2ba)](_0xf324d4);return _0x1d2740?_0x1d2740[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x44a971=_0x52ca82;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x2bb600=document[_0x44a971(0x49c)](_0x44a971(0x2b4)),_0x15dd9a=(_0x2bb600&&_0x2bb600[_0x44a971(0x1ff)]?_0x2bb600['value']:'')[_0x44a971(0x251)]();return _0x15dd9a;}catch(_0x4bb722){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}async function migrateSharedMethodsToCurrentSubtopic(){const _0x24842d=_0x52ca82;try{const _0xa4a845=data?.[_0x24842d(0x4b9)]?.[_0x24842d(0x1dd)]||[];if(!Array[_0x24842d(0x39b)](_0xa4a845)||_0xa4a845[_0x24842d(0x2ca)]===0x0)return;const _0x11c67e=getCurrentSubtopic();if(!_0x11c67e)return;(!Array['isArray'](_0x11c67e[_0x24842d(0x1dd)])||_0x11c67e[_0x24842d(0x1dd)]['length']===0x0)&&(_0x11c67e[_0x24842d(0x1dd)]=_0xa4a845,data[_0x24842d(0x4b9)][_0x24842d(0x1dd)]=[],await saveData());}catch(_0x2b1d20){}}function handleYoutubeUrlInput(){const _0x3b4146=_0x52ca82,_0x3e2462=$(_0x3b4146(0x420)),_0x17669f=$(_0x3b4146(0x1bd)),_0x23c317=$(_0x3b4146(0x2a4)),_0x447555=_0x3e2462[_0x3b4146(0x1ff)][_0x3b4146(0x251)](),_0x11bb9e=extractYouTubeID(_0x447555);if(_0x11bb9e){_0x17669f[_0x3b4146(0x4a4)]=_0x3b4146(0x49a),_0x17669f[_0x3b4146(0x2b8)]['color']=_0x3b4146(0x392),_0x23c317[_0x3b4146(0x329)]=![],sessionYoutubeUrl=_0x447555;try{ytUserPaused=![];}catch(_0x5fd736){}try{const _0x350f2d='https://img.youtube.com/vi/'+_0x11bb9e+_0x3b4146(0x235),_0x4cd745=new Image();_0x4cd745[_0x3b4146(0x4c0)]=async()=>{const _0x18206d=_0x3b4146;data['settings'][_0x18206d(0x206)]=_0x350f2d;try{await saveData();}catch(_0x513e7e){}applyCustomBg();},_0x4cd745[_0x3b4146(0x315)]=async()=>{const _0x2c6c08=_0x3b4146,_0xd38bc0=_0x2c6c08(0x372)+_0x11bb9e+_0x2c6c08(0x367);data['settings'][_0x2c6c08(0x206)]=_0xd38bc0;try{await saveData();}catch(_0x47776d){}applyCustomBg();},_0x4cd745[_0x3b4146(0x34f)]=_0x350f2d;}catch(_0x526858){}try{if(IS_FILE_PROTOCOL){const _0x14beb5=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x11bb9e,{'autoplay':0x1,'mute':_0x14beb5});try{setTimeout(()=>{const _0xec25bc=_0x3b4146;try{fallbackPostMessage(_0xec25bc(0x30a));}catch(_0x2725a5){}},0xfa);}catch(_0x14e4eb){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x52c033=_0x3b4146,_0x5f26a4=document[_0x52c033(0x49c)](_0x52c033(0x2e9));if(_0x5f26a4)_0x5f26a4[_0x52c033(0x4a4)]=_0x52c033(0x30e);},0x1f4);}catch(_0x48739c){}}else ensureYouTubeAPI()[_0x3b4146(0x340)](()=>{const _0x21a6b4=_0x3b4146;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x21a6b4(0x483)]&&ytPlayer[_0x21a6b4(0x30a)]&&(ytPlayer['mute'](),ytPlayer['playVideo'](),_ytPrimed=!![],showSoundPermission());}catch(_0x1479e3){}})[_0x3b4146(0x485)](()=>{});}catch(_0x3036d0){}}else{if(_0x447555===''){_0x17669f[_0x3b4146(0x4a4)]='',_0x23c317[_0x3b4146(0x329)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x7fa4eb){}else ytPlayer&&ytPlayer[_0x3b4146(0x3ca)]&&ytPlayer['stopVideo']();}else _0x17669f['textContent']=_0x3b4146(0x2ff),_0x17669f[_0x3b4146(0x2b8)]['color']='var(--danger)',_0x23c317[_0x3b4146(0x329)]=!![];}}function applyTheme(_0x43da6d){const _0x110f69=_0x52ca82,_0x486c9d=_0x43da6d||data[_0x110f69(0x4b9)][_0x110f69(0x233)]||_0x110f69(0x31d);document[_0x110f69(0x3ea)][_0x110f69(0x445)][_0x110f69(0x233)]=_0x486c9d;const _0x20e57b=[_0x110f69(0x215),'space']['includes'](_0x486c9d),_0x1fb8d5=_0x486c9d==='light'||_0x486c9d===_0x110f69(0x323),_0x422f43=data['settings'][_0x110f69(0x206)],_0x1444fc=()=>{const _0x508627=_0x110f69;try{document[_0x508627(0x3ea)][_0x508627(0x2b8)]['backgroundImage']='';}catch(_0x4d7ff7){}};if(_0x422f43&&!data[_0x110f69(0x4b9)][_0x110f69(0x38b)])document[_0x110f69(0x3ea)][_0x110f69(0x2b8)]['setProperty'](_0x110f69(0x370),_0x110f69(0x4a3)+_0x422f43+')'),_0x1444fc();else{if(_0x422f43&&data[_0x110f69(0x4b9)][_0x110f69(0x38b)])document[_0x110f69(0x3ea)][_0x110f69(0x2b8)][_0x110f69(0x376)](_0x110f69(0x370),_0x110f69(0x4a3)+_0x422f43+')'),_0x1444fc();else{if(_0x20e57b)document[_0x110f69(0x3ea)][_0x110f69(0x2b8)][_0x110f69(0x254)](_0x110f69(0x370)),_0x1444fc();else _0x1fb8d5?(document['body'][_0x110f69(0x2b8)][_0x110f69(0x376)](_0x110f69(0x370),_0x110f69(0x1f6)),_0x1444fc()):(document['body'][_0x110f69(0x2b8)][_0x110f69(0x376)](_0x110f69(0x370),''),document[_0x110f69(0x3ea)][_0x110f69(0x2b8)][_0x110f69(0x35f)]=_0x110f69(0x4b1));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x52ca82(0x23b),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':_0x52ca82(0x25c),'theme':_0x52ca82(0x31d),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':_0x52ca82(0x448),'backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x52ca82(0x2cd),'content':_0x52ca82(0x44c)},{'id':uid('m'),'title':_0x52ca82(0x39d),'content':'<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively—rather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later—once\x20you’ve\x20forgotten\x20the\x20original\x20style—use\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn’t\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses—turning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don’t\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>'},{'id':uid('m'),'title':'The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','content':_0x52ca82(0x26b)},{'id':uid('m'),'title':_0x52ca82(0x4bc),'content':_0x52ca82(0x349)},{'id':uid('m'),'title':_0x52ca82(0x21a),'content':_0x52ca82(0x25b)}]},'topics':[]};function _0x1305(_0x47bc0b,_0x3ea16e){const _0x52c9e0=_0x52c9();return _0x1305=function(_0x1305a1,_0x6cd502){_0x1305a1=_0x1305a1-0x1ba;let _0x17b230=_0x52c9e0[_0x1305a1];return _0x17b230;},_0x1305(_0x47bc0b,_0x3ea16e);}let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x59b864=_0x52ca82;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x59b864(0x47b))]||window[(_0x59b864(0x204))])();}function tone(_0x55b657=0x370,_0x10205e=0xc8,_0x462520=0.2,_0x387e9f='sine',_0x1689d3=0x0){const _0x1c7f23=_0x52ca82;ensureAudio();const _0x3dde3b=AUDIO_CTX,_0x240d0d=_0x3dde3b['createOscillator'](),_0x2ed0f9=_0x3dde3b[_0x1c7f23(0x3c7)]();_0x240d0d[_0x1c7f23(0x4db)]=_0x387e9f,_0x240d0d[_0x1c7f23(0x374)][_0x1c7f23(0x1ff)]=_0x55b657,_0x240d0d['connect'](_0x2ed0f9),_0x2ed0f9[_0x1c7f23(0x1d6)](_0x3dde3b[_0x1c7f23(0x2db)]);const _0x26a1d1=_0x3dde3b[_0x1c7f23(0x41d)]+_0x1689d3;_0x2ed0f9[_0x1c7f23(0x38e)]['setValueAtTime'](0x0,_0x26a1d1),_0x2ed0f9['gain'][_0x1c7f23(0x1c0)](_0x462520,_0x26a1d1+0.01),_0x2ed0f9[_0x1c7f23(0x38e)][_0x1c7f23(0x2e3)](0.0001,_0x26a1d1+_0x10205e/0x3e8),_0x240d0d[_0x1c7f23(0x35b)](_0x26a1d1),_0x240d0d[_0x1c7f23(0x3f1)](_0x26a1d1+_0x10205e/0x3e8+0.05);}function playSound(_0x39140c){const _0x29588c=_0x52ca82;if(!data[_0x29588c(0x4b9)]['soundOn'])return;const _0x2c5b7d=Math[_0x29588c(0x425)](0x0,Math[_0x29588c(0x31f)](0x1,data['settings'][_0x29588c(0x4b2)]??0.8)),_0xe2de91=data[_0x29588c(0x4b9)][_0x29588c(0x1e8)]?.[_0x39140c];let _0x59bbfb;if(_0x39140c===_0x29588c(0x402))_0x59bbfb=$(_0x29588c(0x1c1));else{if(_0x39140c==='break_end')_0x59bbfb=$(_0x29588c(0x3cd));else{if(_0x39140c==='long_end')_0x59bbfb=$('#audioLongEnd');}}if(_0xe2de91&&_0x59bbfb){_0xe2de91[_0x29588c(0x467)](_0x29588c(0x2b3))||_0xe2de91[_0x29588c(0x467)](_0x29588c(0x1ec))||_0xe2de91['startsWith'](_0x29588c(0x345))?(_0x59bbfb['src']=_0xe2de91,_0x59bbfb[_0x29588c(0x4b2)]=_0x2c5b7d,_0x59bbfb[_0x29588c(0x4af)]()[_0x29588c(0x485)](_0x3e0406=>console['error']('Audio\x20playback\x20error:',_0x3e0406))):getStoredFileUrl(_0xe2de91)[_0x29588c(0x340)](_0xbac91=>{const _0x2e60ab=_0x29588c;_0xbac91&&(_0x59bbfb[_0x2e60ab(0x34f)]=_0xbac91,_0x59bbfb[_0x2e60ab(0x4b2)]=_0x2c5b7d,_0x59bbfb[_0x2e60ab(0x4af)]()[_0x2e60ab(0x485)](_0x281608=>console['error'](_0x2e60ab(0x4bf),_0x281608)));});return;}const _0x19915a=data[_0x29588c(0x4b9)][_0x29588c(0x3bc)]||_0x29588c(0x25c);if(_0x19915a===_0x29588c(0x25c)){if(_0x39140c===_0x29588c(0x402))tone(0x370,0xfa,_0x2c5b7d),tone(0x294,0xb4,_0x2c5b7d*0.8,'sine',0.22);else{if(_0x39140c===_0x29588c(0x4dc))tone(0x294,0xdc,_0x2c5b7d*0.9);else _0x39140c==='long_end'&&(tone(0x208,0xc8,_0x2c5b7d),tone(0x30c,0xc8,_0x2c5b7d,_0x29588c(0x47f),0.22),tone(0x410,0xdc,_0x2c5b7d,_0x29588c(0x47f),0.44));}}else{if(_0x39140c===_0x29588c(0x402))tone(0x4b0,0xa0,_0x2c5b7d*0.9,_0x29588c(0x42f)),tone(0x384,0xdc,_0x2c5b7d*0.8,_0x29588c(0x42f),0.18);else{if(_0x39140c==='break_end')tone(0x370,0xf0,_0x2c5b7d*0.8,_0x29588c(0x42f));else _0x39140c===_0x29588c(0x3c0)&&(tone(0x258,0xdc,_0x2c5b7d*0.9,_0x29588c(0x42f)),tone(0x3b6,0xf0,_0x2c5b7d*0.9,_0x29588c(0x42f),0.22),tone(0x4b0,0xf0,_0x2c5b7d,_0x29588c(0x42f),0.44));}}}async function saveData(){const _0x4ec741=_0x52ca82;try{await storageManager[_0x4ec741(0x33d)](data);}catch(_0x75e279){console[_0x4ec741(0x2fb)]('Failed\x20to\x20save\x20data:',_0x75e279),toast(_0x4ec741(0x1fa)+_0x75e279[_0x4ec741(0x3f9)]);}}async function ensureValidSelection(){const _0x24d4e6=_0x52ca82,_0xc960a4=data[_0x24d4e6(0x4b9)];if(!data[_0x24d4e6(0x269)]||data[_0x24d4e6(0x269)][_0x24d4e6(0x2ca)]===0x0){_0xc960a4[_0x24d4e6(0x4cf)]='',_0xc960a4['selectedSubtopicId']='',await saveData();return;}const _0x5b0910=data[_0x24d4e6(0x269)][_0x24d4e6(0x298)](_0x580bc3=>_0x580bc3['id']===_0xc960a4[_0x24d4e6(0x4cf)]),_0x2c2202=_0x5b0910?.[_0x24d4e6(0x23c)][_0x24d4e6(0x298)](_0x20bfd0=>_0x20bfd0['id']===_0xc960a4[_0x24d4e6(0x2f4)]);if(!_0x5b0910||!_0x2c2202){const _0x184f17=data[_0x24d4e6(0x269)][0x0],_0x11b85a=_0x184f17?.[_0x24d4e6(0x23c)]?.[0x0];_0xc960a4[_0x24d4e6(0x4cf)]=_0x184f17?.['id']||'',_0xc960a4[_0x24d4e6(0x2f4)]=_0x11b85a?.['id']||'',await saveData();}}function showInputModal(_0x5105dc,_0x42aa33,_0x30c257=''){const _0x58b98e=_0x52ca82;$(_0x58b98e(0x4b4))['textContent']=_0x5105dc,$(_0x58b98e(0x316))[_0x58b98e(0x262)][_0x58b98e(0x2c0)](_0x58b98e(0x2eb));const _0x323e62=$(_0x58b98e(0x4c3));_0x323e62[_0x58b98e(0x1ff)]=_0x30c257,_0x323e62[_0x58b98e(0x262)][_0x58b98e(0x28d)](_0x58b98e(0x2eb)),$('#modalGeneric')[_0x58b98e(0x262)][_0x58b98e(0x2c0)](_0x58b98e(0x227));try{trapFocus($(_0x58b98e(0x4a8)));}catch(_0x704709){}_0x323e62['focus'](),_0x323e62[_0x58b98e(0x2cc)]();const _0x179a21=()=>{_0x42aa33(_0x323e62['value']),_0x3223bb();},_0x2ce058=()=>_0x3223bb(),_0x25177d=_0x1e4217=>{const _0x4e2c7f=_0x58b98e;if(_0x1e4217[_0x4e2c7f(0x4b0)]===_0x4e2c7f(0x216))_0x179a21();if(_0x1e4217[_0x4e2c7f(0x4b0)]==='Escape')_0x2ce058();};$(_0x58b98e(0x1db))[_0x58b98e(0x2d2)]=_0x179a21,$('#btnGenericCancel')[_0x58b98e(0x2d2)]=_0x2ce058,_0x323e62[_0x58b98e(0x21c)]=_0x25177d;function _0x3223bb(){const _0x1c8ce3=_0x58b98e;$(_0x1c8ce3(0x4a8))['classList'][_0x1c8ce3(0x28d)]('show'),$('#btnGenericOk')[_0x1c8ce3(0x2d2)]=null,$(_0x1c8ce3(0x2c7))[_0x1c8ce3(0x2d2)]=null,_0x323e62['onkeydown']=null;try{releaseFocus();}catch(_0x208c5b){}}}function showConfirmModal(_0x4509ea,_0x3c174d,_0x5abf3a){const _0x595a9c=_0x52ca82;$('#genericTitle')[_0x595a9c(0x4a4)]=_0x4509ea;const _0x3992f7=$(_0x595a9c(0x316));_0x3992f7[_0x595a9c(0x4a4)]=_0x3c174d,_0x3992f7[_0x595a9c(0x262)][_0x595a9c(0x28d)]('hidden'),$(_0x595a9c(0x4c3))['classList'][_0x595a9c(0x2c0)]('hidden'),$(_0x595a9c(0x4a8))['classList']['add'](_0x595a9c(0x227));try{trapFocus($(_0x595a9c(0x4a8)));}catch(_0x29e054){}const _0x541907=()=>{_0x5abf3a(!![]),_0x1a50a0();},_0x235908=()=>{_0x5abf3a(![]),_0x1a50a0();};$(_0x595a9c(0x1db))['onclick']=_0x541907,$('#btnGenericCancel')[_0x595a9c(0x2d2)]=_0x235908;function _0x1a50a0(){const _0x467a0c=_0x595a9c;$(_0x467a0c(0x4a8))[_0x467a0c(0x262)][_0x467a0c(0x28d)](_0x467a0c(0x227)),$(_0x467a0c(0x1db))[_0x467a0c(0x2d2)]=null,$(_0x467a0c(0x2c7))[_0x467a0c(0x2d2)]=null;try{releaseFocus();}catch(_0x131dc9){}}}let pendingNoteSessionId=null;function openNoteModal(_0x561af5){const _0x2a0b7b=_0x52ca82;pendingNoteSessionId=_0x561af5||null;const _0x150af7=$(_0x2a0b7b(0x286));if(!_0x150af7)return;const _0x4d607f=$(_0x2a0b7b(0x350));if(_0x4d607f)try{_0x4d607f['value']='';}catch(_0x420cff){}_0x150af7[_0x2a0b7b(0x262)][_0x2a0b7b(0x2c0)](_0x2a0b7b(0x227));try{trapFocus(_0x150af7);}catch(_0x42155d){}}function closeNoteModal(){const _0xf4702c=_0x52ca82,_0x592b4e=$(_0xf4702c(0x286));if(!_0x592b4e)return;_0x592b4e['classList']['remove'](_0xf4702c(0x227)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x231674){}}async function switchView(_0x1df6a5){const _0x359610=_0x52ca82;$$('.view')['forEach'](_0x10d997=>_0x10d997[_0x359610(0x262)][_0x359610(0x28d)]('active')),$(_0x359610(0x243)+_0x1df6a5)[_0x359610(0x262)][_0x359610(0x2c0)]('active'),$$('.nav-btn')[_0x359610(0x26c)](_0x2143ac=>_0x2143ac[_0x359610(0x262)]['remove'](_0x359610(0x2b5)));const _0x1bbbb5=$(_0x359610(0x388)+_0x1df6a5+'\x22]');if(_0x1bbbb5)_0x1bbbb5[_0x359610(0x262)][_0x359610(0x2c0)](_0x359610(0x2b5));data[_0x359610(0x4b9)]['currentView']=_0x1df6a5,await saveData(),_0x1df6a5===_0x359610(0x2a6)&&renderDashboard();}function closeAllMenus(){const _0x3adcbc=_0x52ca82;$$(_0x3adcbc(0x2e7))[_0x3adcbc(0x26c)](_0x677466=>_0x677466[_0x3adcbc(0x262)][_0x3adcbc(0x28d)](_0x3adcbc(0x227))),$$(_0x3adcbc(0x3bb))[_0x3adcbc(0x26c)](_0x414296=>_0x414296[_0x3adcbc(0x262)][_0x3adcbc(0x28d)](_0x3adcbc(0x3dd)));}function renderTopics(){const _0x259fb9=_0x52ca82,_0x39bdee=$(_0x259fb9(0x239));if(!_0x39bdee)return;_0x39bdee['innerHTML']='';const _0x40fe91=data['settings'][_0x259fb9(0x1e7)]||{};data[_0x259fb9(0x269)]['forEach'](_0x5e4aef=>{const _0x1b2a45=_0x259fb9,_0x3510e8=document['createElement'](_0x1b2a45(0x3d0));_0x3510e8[_0x1b2a45(0x265)]=_0x1b2a45(0x436),_0x3510e8[_0x1b2a45(0x445)][_0x1b2a45(0x2ef)]=_0x5e4aef['id'];const _0x427dfc=document[_0x1b2a45(0x410)](_0x1b2a45(0x3d0));_0x427dfc[_0x1b2a45(0x265)]=_0x1b2a45(0x2d1);const _0x43b18c=!!_0x40fe91[_0x5e4aef['id']],_0x1c965a=document[_0x1b2a45(0x410)]('button');_0x1c965a[_0x1b2a45(0x265)]=_0x1b2a45(0x22c),_0x1c965a[_0x1b2a45(0x3a6)](_0x1b2a45(0x26a),String(!_0x43b18c)),_0x1c965a[_0x1b2a45(0x468)]='<span\x20class=\x22ico\x22>▾</span>';const _0x594b8a=document[_0x1b2a45(0x410)](_0x1b2a45(0x3d0));_0x594b8a[_0x1b2a45(0x265)]='topic-title',_0x594b8a[_0x1b2a45(0x4a4)]=_0x5e4aef[_0x1b2a45(0x33e)];const _0xd76d1=document[_0x1b2a45(0x410)](_0x1b2a45(0x3d0));_0xd76d1[_0x1b2a45(0x265)]='topic-actions';const _0x18958c=document[_0x1b2a45(0x410)]('button');_0x18958c[_0x1b2a45(0x265)]=_0x1b2a45(0x4cd),_0x18958c[_0x1b2a45(0x468)]=_0x1b2a45(0x1f8),_0x18958c[_0x1b2a45(0x47a)]='Add\x20subtopic';const _0x6332bf=document['createElement'](_0x1b2a45(0x3d0));_0x6332bf[_0x1b2a45(0x2b8)][_0x1b2a45(0x2c4)]=_0x1b2a45(0x378);const _0x69f14b=document['createElement'](_0x1b2a45(0x476));_0x69f14b[_0x1b2a45(0x265)]='btn\x20small\x20ghost\x20actions-menu-btn',_0x69f14b[_0x1b2a45(0x468)]=_0x1b2a45(0x458),_0x69f14b[_0x1b2a45(0x47a)]=_0x1b2a45(0x4d2);const _0xd19290=document[_0x1b2a45(0x410)](_0x1b2a45(0x3d0));_0xd19290[_0x1b2a45(0x265)]='actions-menu';const _0x3f6190=document[_0x1b2a45(0x410)](_0x1b2a45(0x476));_0x3f6190[_0x1b2a45(0x265)]=_0x1b2a45(0x248),_0x3f6190[_0x1b2a45(0x468)]='Rename\x20Topic';const _0x394ea9=document['createElement'](_0x1b2a45(0x476));_0x394ea9[_0x1b2a45(0x265)]='menu-item\x20danger',_0x394ea9['innerHTML']=_0x1b2a45(0x47e),_0xd19290[_0x1b2a45(0x288)](_0x3f6190,_0x394ea9),_0x6332bf[_0x1b2a45(0x288)](_0x69f14b,_0xd19290),_0xd76d1[_0x1b2a45(0x288)](_0x18958c,_0x6332bf),_0x427dfc[_0x1b2a45(0x288)](_0x1c965a,_0x594b8a,_0xd76d1),_0x1c965a[_0x1b2a45(0x459)](_0x1b2a45(0x422),async _0x3d2791=>{const _0x3e758d=_0x1b2a45;_0x3d2791[_0x3e758d(0x41f)]();const _0x2dd756=!!_0x40fe91[_0x5e4aef['id']];_0x2dd756?delete _0x40fe91[_0x5e4aef['id']]:_0x40fe91[_0x5e4aef['id']]=!![],data[_0x3e758d(0x4b9)]['collapsedTopics']=_0x40fe91,await storageManager[_0x3e758d(0x1fe)](data[_0x3e758d(0x4b9)]),renderTopics();});const _0x298abf=async()=>{const _0x4d01d2=_0x1b2a45,_0x2cc396=!!_0x40fe91[_0x5e4aef['id']];_0x2cc396?delete _0x40fe91[_0x5e4aef['id']]:_0x40fe91[_0x5e4aef['id']]=!![],data[_0x4d01d2(0x4b9)]['collapsedTopics']=_0x40fe91,await storageManager['updateSettings'](data[_0x4d01d2(0x4b9)]),renderTopics();};_0x427dfc[_0x1b2a45(0x459)](_0x1b2a45(0x422),async _0x4e6abd=>{const _0x395a8e=_0x1b2a45,_0x3e0e6d=_0x4e6abd[_0x395a8e(0x1e2)];if(_0x3e0e6d&&_0x3e0e6d[_0x395a8e(0x442)]){if(_0x3e0e6d[_0x395a8e(0x442)](_0x395a8e(0x389))||_0x3e0e6d[_0x395a8e(0x442)](_0x395a8e(0x4e7))||_0x3e0e6d[_0x395a8e(0x442)]('button')||_0x3e0e6d['closest'](_0x395a8e(0x407)))return;}_0x4e6abd[_0x395a8e(0x41f)](),await _0x298abf();}),_0x594b8a[_0x1b2a45(0x459)](_0x1b2a45(0x422),async _0x1cd35f=>{const _0x5e6237=_0x1b2a45;_0x1cd35f[_0x5e6237(0x41f)](),await _0x298abf();}),_0x3510e8['addEventListener'](_0x1b2a45(0x422),async _0x3c5ccf=>{const _0x3fe5c6=_0x1b2a45,_0x238d83=_0x3c5ccf['target'];if(_0x238d83&&_0x238d83[_0x3fe5c6(0x442)]){if(_0x238d83[_0x3fe5c6(0x442)]('.subtopics'))return;if(_0x238d83[_0x3fe5c6(0x442)]('.actions-menu')||_0x238d83[_0x3fe5c6(0x442)]('.actions-menu-btn')||_0x238d83[_0x3fe5c6(0x442)](_0x3fe5c6(0x476))||_0x238d83[_0x3fe5c6(0x442)](_0x3fe5c6(0x407)))return;}await _0x298abf();});const _0x1d19bb=document[_0x1b2a45(0x410)](_0x1b2a45(0x3d0));_0x1d19bb[_0x1b2a45(0x265)]=_0x1b2a45(0x23c)+(_0x43b18c?_0x1b2a45(0x2d3):''),_0x1d19bb[_0x1b2a45(0x445)][_0x1b2a45(0x2ef)]=_0x5e4aef['id'],_0x5e4aef['subtopics'][_0x1b2a45(0x26c)](_0x24a496=>{const _0x1362a8=_0x1b2a45,_0x105809=document[_0x1362a8(0x410)](_0x1362a8(0x3d0));_0x105809['className']='sub-row',_0x105809[_0x1362a8(0x445)][_0x1362a8(0x4c9)]=_0x24a496['id'];const _0x17fd5a=document[_0x1362a8(0x410)](_0x1362a8(0x476));_0x17fd5a[_0x1362a8(0x265)]=_0x1362a8(0x4c1),_0x17fd5a['textContent']='•\x20'+_0x24a496[_0x1362a8(0x33e)],_0x17fd5a[_0x1362a8(0x445)][_0x1362a8(0x4c9)]=_0x24a496['id'],_0x17fd5a[_0x1362a8(0x445)][_0x1362a8(0x2ef)]=_0x5e4aef['id'];if(data[_0x1362a8(0x4b9)][_0x1362a8(0x2f4)]===_0x24a496['id'])_0x17fd5a[_0x1362a8(0x262)][_0x1362a8(0x2c0)](_0x1362a8(0x2b5));const _0x30f7e8=document['createElement']('div');_0x30f7e8['className']=_0x1362a8(0x49b);const _0x5e4135=document[_0x1362a8(0x410)]('div');_0x5e4135[_0x1362a8(0x2b8)][_0x1362a8(0x2c4)]='relative';const _0x43903b=document[_0x1362a8(0x410)](_0x1362a8(0x476));_0x43903b[_0x1362a8(0x265)]=_0x1362a8(0x2ac),_0x43903b[_0x1362a8(0x468)]='...',_0x43903b[_0x1362a8(0x47a)]=_0x1362a8(0x4d2);const _0x537fa7=document['createElement']('div');_0x537fa7[_0x1362a8(0x265)]=_0x1362a8(0x274);const _0x40e3c6=document['createElement'](_0x1362a8(0x476));_0x40e3c6[_0x1362a8(0x265)]=_0x1362a8(0x248),_0x40e3c6[_0x1362a8(0x468)]=_0x1362a8(0x4b7);const _0xcda2af=document[_0x1362a8(0x410)]('button');_0xcda2af[_0x1362a8(0x265)]=_0x1362a8(0x29b),_0xcda2af['innerHTML']=_0x1362a8(0x3be),_0x537fa7[_0x1362a8(0x288)](_0x40e3c6,_0xcda2af),_0x5e4135[_0x1362a8(0x288)](_0x43903b,_0x537fa7),_0x30f7e8[_0x1362a8(0x288)](_0x5e4135),_0x105809[_0x1362a8(0x288)](_0x17fd5a,_0x30f7e8),_0x1d19bb['appendChild'](_0x105809),_0x17fd5a[_0x1362a8(0x459)](_0x1362a8(0x422),()=>selectSubtopic(_0x5e4aef['id'],_0x24a496['id'])),_0x43903b[_0x1362a8(0x459)](_0x1362a8(0x422),_0x4e3081=>{const _0xdfe6a5=_0x1362a8;_0x4e3081[_0xdfe6a5(0x41f)]();const _0x52955b=_0x537fa7['classList'][_0xdfe6a5(0x4a0)](_0xdfe6a5(0x227));closeAllMenus(),_0x52955b?_0x3510e8[_0xdfe6a5(0x262)][_0xdfe6a5(0x28d)](_0xdfe6a5(0x3dd)):(_0x537fa7[_0xdfe6a5(0x262)]['add'](_0xdfe6a5(0x227)),_0x3510e8[_0xdfe6a5(0x262)][_0xdfe6a5(0x2c0)](_0xdfe6a5(0x3dd)));}),_0x40e3c6[_0x1362a8(0x459)]('click',()=>showInputModal(_0x1362a8(0x4b7),async _0x15e550=>{const _0x45b85f=_0x1362a8;if(!_0x15e550)return;_0x24a496[_0x45b85f(0x33e)]=_0x15e550,await storageManager[_0x45b85f(0x321)](_0x45b85f(0x23c),_0x24a496),renderAll();},_0x24a496['name'])),_0xcda2af[_0x1362a8(0x459)](_0x1362a8(0x422),()=>showConfirmModal('Confirm\x20Deletion',_0x1362a8(0x49d)+_0x24a496[_0x1362a8(0x33e)]+_0x1362a8(0x403),async _0x14f71c=>{const _0xcea1ca=_0x1362a8;if(!_0x14f71c)return;_0x5e4aef['subtopics']=_0x5e4aef['subtopics'][_0xcea1ca(0x32c)](_0x392538=>_0x392538['id']!==_0x24a496['id']);const _0x3c1a0b=data[_0xcea1ca(0x4b9)];_0x3c1a0b['selectedSubtopicId']===_0x24a496['id']&&(_0x3c1a0b[_0xcea1ca(0x2f4)]='',_0x3c1a0b[_0xcea1ca(0x4cf)]='',ensureValidSelection()),await storageManager[_0xcea1ca(0x3cb)]('subtopics',_0x24a496['id']),renderAll();}));}),_0x69f14b['addEventListener'](_0x1b2a45(0x422),_0x52bdd0=>{const _0x11a1d5=_0x1b2a45;_0x52bdd0[_0x11a1d5(0x41f)]();const _0x30e4b2=_0xd19290[_0x11a1d5(0x262)][_0x11a1d5(0x4a0)](_0x11a1d5(0x227));closeAllMenus(),_0x30e4b2?_0x3510e8[_0x11a1d5(0x262)]['remove'](_0x11a1d5(0x3dd)):(_0xd19290['classList'][_0x11a1d5(0x2c0)]('show'),_0x3510e8[_0x11a1d5(0x262)][_0x11a1d5(0x2c0)](_0x11a1d5(0x3dd)));}),_0x18958c[_0x1b2a45(0x459)](_0x1b2a45(0x422),()=>showInputModal(_0x1b2a45(0x3c6),async _0x173a51=>{const _0x37c585=_0x1b2a45;if(!_0x173a51)return;const _0xcb076e={'id':uid('s'),'topicId':_0x5e4aef['id'],'name':_0x173a51,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x37c585(0x446),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};try{const _0x25910b=data?.['settings']?.[_0x37c585(0x1dd)]||[];Array[_0x37c585(0x39b)](_0x25910b)&&_0x25910b[_0x37c585(0x2ca)]>0x0&&(_0xcb076e['methods']=_0x25910b,data[_0x37c585(0x4b9)][_0x37c585(0x1dd)]=[],await storageManager[_0x37c585(0x1fe)](data[_0x37c585(0x4b9)]));}catch(_0x40778a){}_0x5e4aef[_0x37c585(0x23c)][_0x37c585(0x31c)](_0xcb076e),await storageManager[_0x37c585(0x2c0)](_0x37c585(0x23c),_0xcb076e),renderTopics();})),_0x3f6190['addEventListener']('click',()=>showInputModal('Rename\x20Topic',async _0xfe8ff=>{const _0x9b844c=_0x1b2a45;if(!_0xfe8ff)return;_0x5e4aef['name']=_0xfe8ff,await storageManager[_0x9b844c(0x321)](_0x9b844c(0x269),_0x5e4aef),renderTopics();},_0x5e4aef[_0x1b2a45(0x33e)])),_0x394ea9['addEventListener'](_0x1b2a45(0x422),()=>showConfirmModal(_0x1b2a45(0x3bd),_0x1b2a45(0x336)+_0x5e4aef['name']+_0x1b2a45(0x451),async _0x19c90f=>{const _0x1f93ef=_0x1b2a45;if(!_0x19c90f)return;data['topics']=data['topics']['filter'](_0x338cd3=>_0x338cd3['id']!==_0x5e4aef['id']),delete _0x40fe91[_0x5e4aef['id']];data[_0x1f93ef(0x4b9)]['selectedTopicId']===_0x5e4aef['id']&&(data[_0x1f93ef(0x4b9)]['selectedTopicId']='',data['settings'][_0x1f93ef(0x2f4)]='',ensureValidSelection());await storageManager[_0x1f93ef(0x3cb)](_0x1f93ef(0x269),_0x5e4aef['id']);for(const _0x44ef8c of _0x5e4aef['subtopics']){await storageManager['delete'](_0x1f93ef(0x23c),_0x44ef8c['id']);}renderAll();})),_0x18958c[_0x1b2a45(0x459)](_0x1b2a45(0x422),_0x3e9ad0=>_0x3e9ad0[_0x1b2a45(0x41f)]()),_0x3f6190[_0x1b2a45(0x459)](_0x1b2a45(0x422),_0x1de827=>_0x1de827[_0x1b2a45(0x41f)]()),_0x394ea9[_0x1b2a45(0x459)](_0x1b2a45(0x422),_0x1c9f36=>_0x1c9f36[_0x1b2a45(0x41f)]()),_0x3510e8[_0x1b2a45(0x288)](_0x427dfc,_0x1d19bb),_0x39bdee['appendChild'](_0x3510e8);});if(window[_0x259fb9(0x3e5)]){const _0x414d7d=document['getElementById']('topicsList');if(_0x414d7d){if(_0x414d7d[_0x259fb9(0x4aa)])try{_0x414d7d[_0x259fb9(0x4aa)]['destroy']();}catch(_0x405f81){}_0x414d7d['_sortable']=new Sortable(_0x414d7d,{'animation':0x96,'draggable':_0x259fb9(0x3e1),'onEnd':async function(_0xef4587){const _0x532a38=_0x259fb9;if(_0xef4587[_0x532a38(0x247)]===_0xef4587[_0x532a38(0x275)])return;const _0x4382f1=data['topics']['splice'](_0xef4587[_0x532a38(0x247)],0x1)[0x0];data[_0x532a38(0x269)]['splice'](_0xef4587['newIndex'],0x0,_0x4382f1),await saveData(),renderTopics();}}),_0x414d7d['querySelectorAll'](_0x259fb9(0x4d8))['forEach'](_0x55b987=>{const _0x479f25=_0x259fb9;new Sortable(_0x55b987,{'group':_0x479f25(0x435),'animation':0x96,'draggable':_0x479f25(0x36f),'onEnd':async function(_0x1578de){const _0x2c7c2d=_0x479f25,_0x395135=_0x1578de[_0x2c7c2d(0x377)]?.['dataset']?.[_0x2c7c2d(0x2ef)]||_0x1578de[_0x2c7c2d(0x377)]?.[_0x2c7c2d(0x442)](_0x2c7c2d(0x3e1))?.[_0x2c7c2d(0x445)]?.[_0x2c7c2d(0x2ef)],_0x120d05=_0x1578de['to']?.[_0x2c7c2d(0x445)]?.[_0x2c7c2d(0x2ef)]||_0x1578de['to']?.[_0x2c7c2d(0x442)]('.topic-item')?.[_0x2c7c2d(0x445)]?.[_0x2c7c2d(0x2ef)],_0x4df500=data['topics']['find'](_0x409d4d=>_0x409d4d['id']===_0x395135),_0x357271=data[_0x2c7c2d(0x269)][_0x2c7c2d(0x298)](_0x5f329b=>_0x5f329b['id']===_0x120d05);if(!_0x4df500||!_0x357271)return;let _0x236a06=null;const _0x5d75be=_0x1578de[_0x2c7c2d(0x249)]?.['dataset']?.[_0x2c7c2d(0x4c9)]||_0x1578de[_0x2c7c2d(0x249)]?.[_0x2c7c2d(0x4d1)](_0x2c7c2d(0x3c9))?.['dataset']?.[_0x2c7c2d(0x4c9)];if(_0x5d75be){const _0x25cc49=_0x4df500['subtopics']['findIndex'](_0x519f99=>_0x519f99['id']===_0x5d75be);if(_0x25cc49>=0x0)_0x236a06=_0x4df500[_0x2c7c2d(0x23c)][_0x2c7c2d(0x337)](_0x25cc49,0x1)[0x0];}!_0x236a06&&(_0x236a06=_0x4df500[_0x2c7c2d(0x23c)][_0x2c7c2d(0x337)](_0x1578de[_0x2c7c2d(0x247)],0x1)[0x0]);if(!_0x236a06)return;_0x236a06[_0x2c7c2d(0x304)]=_0x357271['id'],_0x357271[_0x2c7c2d(0x23c)]['splice'](_0x1578de[_0x2c7c2d(0x275)],0x0,_0x236a06),data[_0x2c7c2d(0x4b9)][_0x2c7c2d(0x2f4)]===_0x236a06['id']&&(data[_0x2c7c2d(0x4b9)]['selectedTopicId']=_0x357271['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x43ded0,_0xeac193){const _0x5f571d=_0x52ca82,_0x1a6e80=$('.app-content'),_0xc31657=getCurrentSubtopic();_0xc31657&&timer[_0x5f571d(0x41c)]!==_0x5f571d(0x446)&&(_0xc31657[_0x5f571d(0x1f2)]={'state':timer[_0x5f571d(0x41c)],'prevState':timer[_0x5f571d(0x22e)],'remaining':timer[_0x5f571d(0x41e)],'segmentTotal':timer[_0x5f571d(0x496)],'cycleIndex':timer[_0x5f571d(0x2d4)]}),_0x1a6e80[_0x5f571d(0x262)][_0x5f571d(0x2c0)](_0x5f571d(0x240)),setTimeout(async()=>{const _0x388811=_0x5f571d;data[_0x388811(0x4b9)]['selectedTopicId']=_0x43ded0,data[_0x388811(0x4b9)]['selectedSubtopicId']=_0xeac193;const _0x409b59=getCurrentSubtopic();_0x409b59[_0x388811(0x1f2)]?(timer[_0x388811(0x41c)]=_0x409b59['timerState']['state'],timer['prevState']=_0x409b59['timerState'][_0x388811(0x22e)]||null,timer['remaining']=_0x409b59['timerState'][_0x388811(0x41e)],timer[_0x388811(0x496)]=_0x409b59[_0x388811(0x1f2)][_0x388811(0x496)],timer[_0x388811(0x2d4)]=_0x409b59[_0x388811(0x1f2)][_0x388811(0x2d4)]):timer['reset'](),await saveData(),timer['updateUI'](),renderAll(),switchView(_0x388811(0x23b)),_0x1a6e80[_0x388811(0x262)][_0x388811(0x28d)](_0x388811(0x240));},0xc8);}function getCurrentSubtopic(){const _0x8fb3a3=_0x52ca82,_0x39069b=data[_0x8fb3a3(0x4b9)][_0x8fb3a3(0x4cf)],_0x108852=data[_0x8fb3a3(0x4b9)]['selectedSubtopicId'];if(!_0x39069b||!_0x108852)return null;const _0x504211=data[_0x8fb3a3(0x269)]['find'](_0x4ee5bb=>_0x4ee5bb['id']===_0x39069b);if(!_0x504211)return null;return _0x504211[_0x8fb3a3(0x23c)]['find'](_0x49ec57=>_0x49ec57['id']===_0x108852)||null;}function renderContextBadge(){const _0x21e61a=_0x52ca82,_0x4fecad=getCurrentSubtopic(),_0x15905d=_0x4fecad?_0x4fecad[_0x21e61a(0x33e)]:'(none\x20selected)',_0x3b7fd4=$(_0x21e61a(0x3c5)),_0x294e0f=$('#currentSubtopicName'),_0x4f98e9=$(_0x21e61a(0x454));if(_0x3b7fd4)_0x3b7fd4[_0x21e61a(0x4a4)]=_0x4fecad?_0x21e61a(0x429)+_0x4fecad[_0x21e61a(0x33e)]:_0x21e61a(0x369);if(_0x294e0f)_0x294e0f[_0x21e61a(0x4a4)]=_0x15905d;if(_0x4f98e9)_0x4f98e9[_0x21e61a(0x4a4)]=_0x15905d;}function renderSubtopicTasks(){const _0x1e77d1=_0x52ca82,_0x535a98=getCurrentSubtopic(),_0x12bbbd=$(_0x1e77d1(0x439)),_0x3f8097=$('#newSubtopicTaskInput');if(!_0x12bbbd||!_0x3f8097)return;const _0x55ee0d=_0x3f8097[_0x1e77d1(0x3ce)];if(!_0x535a98){_0x12bbbd[_0x1e77d1(0x468)]=_0x1e77d1(0x3e3),_0x55ee0d[_0x1e77d1(0x262)]['add'](_0x1e77d1(0x2eb));return;}_0x55ee0d['classList'][_0x1e77d1(0x28d)]('hidden'),_0x12bbbd[_0x1e77d1(0x468)]='';const _0x5c5000=_0x535a98[_0x1e77d1(0x4d9)]?_0x535a98[_0x1e77d1(0x4d9)][_0x1e77d1(0x32c)](_0xfbe53b=>!_0xfbe53b[_0x1e77d1(0x400)]):[];_0x5c5000['length']===0x0&&(_0x12bbbd[_0x1e77d1(0x468)]='<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>'),_0x5c5000[_0x1e77d1(0x26c)](_0x3bf624=>{const _0x1dfb92=_0x1e77d1,_0x2c4e39=document[_0x1dfb92(0x410)]('li');_0x2c4e39['innerHTML']=_0x1dfb92(0x291)+_0x3bf624['id']+_0x1dfb92(0x38d)+_0x3bf624['id']+'\x22>'+escapeHTML(_0x3bf624[_0x1dfb92(0x469)])+_0x1dfb92(0x1dc),_0x2c4e39[_0x1dfb92(0x4d1)]('input')[_0x1dfb92(0x459)](_0x1dfb92(0x3e7),_0x4f337f=>toggleSubtopicTask(_0x4f337f[_0x1dfb92(0x1e2)]['id'],_0x2c4e39)),_0x12bbbd[_0x1dfb92(0x3e9)](_0x2c4e39);});}async function addSubtopicTask(){const _0x2cf19f=_0x52ca82,_0xd768ed=getCurrentSubtopic();if(!_0xd768ed){toast(t(_0x2cf19f(0x1de)));return;}const _0x3a40a9=$(_0x2cf19f(0x1df)),_0x29f3fb=_0x3a40a9[_0x2cf19f(0x1ff)][_0x2cf19f(0x251)]();if(_0x29f3fb){if(!_0xd768ed[_0x2cf19f(0x4d9)])_0xd768ed[_0x2cf19f(0x4d9)]=[];_0xd768ed['tasks'][_0x2cf19f(0x31c)]({'id':uid(_0x2cf19f(0x1ea)),'text':_0x29f3fb,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x3a40a9['value']='';}_0x3a40a9[_0x2cf19f(0x2d6)]();}async function toggleSubtopicTask(_0x380c12,_0x5a64cc){const _0xb99ee1=_0x52ca82,_0x229c8f=getCurrentSubtopic();if(!_0x229c8f||!_0x229c8f['tasks'])return;const _0x5b7e73=_0x229c8f[_0xb99ee1(0x4d9)][_0xb99ee1(0x298)](_0x27c5ff=>_0x27c5ff['id']===_0x380c12);_0x5b7e73&&(_0x5b7e73[_0xb99ee1(0x400)]=!![],_0x229c8f[_0xb99ee1(0x2a6)][_0xb99ee1(0x3b6)]=(_0x229c8f[_0xb99ee1(0x2a6)]['tasksCompleted']||0x0)+0x1,await saveData(),_0x5a64cc[_0xb99ee1(0x262)][_0xb99ee1(0x2c0)]('removing'),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':'idle','prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x3ebfdd,{silent:silent=![]}={}){const _0x179d21=_0x52ca82,_0x2f7240=data[_0x179d21(0x4b9)];this[_0x179d21(0x3d8)]=_0x3ebfdd,this[_0x179d21(0x20d)]=_0x3ebfdd==='A'?_0x2f7240['cyclesA']:_0x3ebfdd==='B'?_0x2f7240['cyclesB']:0x0,_0x2f7240['preset']=_0x3ebfdd,await saveData(),this[_0x179d21(0x41c)]===_0x179d21(0x446)&&this[_0x179d21(0x35c)]();},'currentDurations'(){const _0x12375a=_0x52ca82,_0x14b158=data[_0x12375a(0x4b9)][_0x12375a(0x1d1)];if(this['mode']==='A')return{'work':_0x14b158['A_work'],'short':_0x14b158[_0x12375a(0x2d0)],'long':_0x14b158[_0x12375a(0x21e)],'winddown':_0x14b158[_0x12375a(0x2c2)]??0x0};if(this[_0x12375a(0x3d8)]==='B')return{'work':_0x14b158[_0x12375a(0x1c3)],'short':_0x14b158[_0x12375a(0x1ed)],'long':_0x14b158[_0x12375a(0x264)],'winddown':_0x14b158[_0x12375a(0x4e5)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x569c0b=_0x52ca82,_0x579adb=data[_0x569c0b(0x4b9)];if(this[_0x569c0b(0x3d8)]==='A')return{'cycles':_0x579adb['cyclesA'],'interval':_0x579adb['longBreakIntervalA']};if(this[_0x569c0b(0x3d8)]==='B')return{'cycles':_0x579adb[_0x569c0b(0x455)],'interval':_0x579adb[_0x569c0b(0x213)]};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x120b64=_0x52ca82,_0x19168=$(_0x120b64(0x4ca)),_0xc0f079=$('.timer-circle-progress'),_0x3acc2d=$('.timer-circle-container');if(!_0x19168||!_0xc0f079||!_0x3acc2d)return;const _0x5e1bd0=this['mode']==='C';$(_0x120b64(0x214))['classList'][_0x120b64(0x237)](_0x120b64(0x2eb),this[_0x120b64(0x41c)]!==_0x120b64(0x446)||_0x5e1bd0&&this[_0x120b64(0x41c)]===_0x120b64(0x381)),$(_0x120b64(0x26f))['classList'][_0x120b64(0x237)]('hidden',!(_0x5e1bd0&&this[_0x120b64(0x41c)]===_0x120b64(0x381))),$(_0x120b64(0x353))[_0x120b64(0x262)][_0x120b64(0x237)]('hidden',![_0x120b64(0x381),_0x120b64(0x1ce),_0x120b64(0x224)]['includes'](this[_0x120b64(0x41c)])),$(_0x120b64(0x302))['classList'][_0x120b64(0x237)](_0x120b64(0x2eb),this[_0x120b64(0x41c)]!==_0x120b64(0x209));let _0x20c423=_0x120b64(0x222);if(this[_0x120b64(0x41c)]===_0x120b64(0x381))_0x19168[_0x120b64(0x4a4)]=_0x5e1bd0?_0x120b64(0x2a1):_0x120b64(0x1ee),_0x19168[_0x120b64(0x265)]='badge\x20state\x20work',_0x20c423=_0x120b64(0x1d2);else{if(this[_0x120b64(0x41c)]===_0x120b64(0x1ce))_0x19168['textContent']=_0x120b64(0x2e1),_0x19168[_0x120b64(0x265)]=_0x120b64(0x2e5),_0x20c423='var(--warn)';else{if(this[_0x120b64(0x41c)]===_0x120b64(0x224))_0x19168['textContent']=_0x120b64(0x2ea),_0x19168[_0x120b64(0x265)]=_0x120b64(0x3ab),_0x20c423='var(--danger)';else{if(this[_0x120b64(0x41c)]===_0x120b64(0x453)){_0x19168['textContent']=_0x120b64(0x430),_0x19168[_0x120b64(0x265)]=_0x120b64(0x2a3),_0x20c423=_0x120b64(0x392);try{$(_0x120b64(0x2e6))[_0x120b64(0x262)][_0x120b64(0x28d)](_0x120b64(0x2eb)),$('#btnBreakEarly')[_0x120b64(0x262)][_0x120b64(0x28d)]('hidden');}catch(_0x327c67){}}else this[_0x120b64(0x41c)]===_0x120b64(0x209)?(_0x19168['textContent']='PAUSED',_0x19168[_0x120b64(0x265)]=_0x120b64(0x4b3)):(_0x19168['textContent']=_0x120b64(0x3ec),_0x19168[_0x120b64(0x265)]=_0x120b64(0x4b3));}}}[_0x120b64(0x381),'break',_0x120b64(0x224),_0x120b64(0x453)][_0x120b64(0x417)](this[_0x120b64(0x41c)])?_0x3acc2d[_0x120b64(0x262)]['add'](_0x120b64(0x393)):_0x3acc2d[_0x120b64(0x262)][_0x120b64(0x28d)](_0x120b64(0x393));_0xc0f079[_0x120b64(0x2b8)][_0x120b64(0x3ae)]=_0x20c423,_0x3acc2d[_0x120b64(0x262)][_0x120b64(0x28d)](_0x120b64(0x303));const _0x356211=$(_0x120b64(0x23e));if(_0x356211)_0x356211[_0x120b64(0x4a4)]=formatMMSS(this[_0x120b64(0x41e)]);const _0x572004=_0xc0f079['r']['baseVal']['value'],_0x35a051=0x2*Math['PI']*_0x572004,_0x1c3f5e=this[_0x120b64(0x496)]>0x0?_0x35a051-this['remaining']/this[_0x120b64(0x496)]*_0x35a051:_0x35a051;_0xc0f079[_0x120b64(0x2b8)]['strokeDasharray']=_0x35a051,_0xc0f079[_0x120b64(0x2b8)][_0x120b64(0x1d7)]=isNaN(_0x1c3f5e)?_0x35a051:_0x1c3f5e;const _0x477c49=$(_0x120b64(0x22d));if(_0x477c49){const _0x53e17f=this[_0x120b64(0x3d2)]();_0x477c49['textContent']=t(_0x120b64(0x4ae),{'current':this[_0x120b64(0x2d4)],'target':_0x53e17f[_0x120b64(0x437)]}),_0x477c49[_0x120b64(0x262)]['toggle'](_0x120b64(0x2eb),_0x5e1bd0);}const _0x224917=$(_0x120b64(0x452));_0x224917&&_0x224917[_0x120b64(0x262)][_0x120b64(0x237)](_0x120b64(0x2eb),_0x5e1bd0&&this[_0x120b64(0x41c)]==='work');const _0x4b5c7e=$('#draggableTimer');if(_0x4b5c7e)_0x4b5c7e['textContent']=formatMMSS(this['remaining']);if(this[_0x120b64(0x41c)]!==_0x120b64(0x453))try{$('#windDownChecklist')[_0x120b64(0x262)]['add']('hidden'),$('#btnBreakEarly')[_0x120b64(0x262)][_0x120b64(0x2c0)]('hidden');}catch(_0xdfe132){}},'persistTimerState'(_0x3162e9=![]){const _0x11f440=_0x52ca82;try{const _0x9cbe3e=getCurrentSubtopic();if(!_0x9cbe3e)return;const _0x56c1e6={'state':this[_0x11f440(0x41c)],'prevState':this['prevState'],'remaining':this[_0x11f440(0x41e)],'segmentTotal':this['segmentTotal'],'cycleIndex':this['cycleIndex']};_0x9cbe3e[_0x11f440(0x1f2)]=_0x56c1e6;try{localStorage[_0x11f440(0x4a5)](_0x11f440(0x36d)+_0x9cbe3e['id'],JSON['stringify'](_0x56c1e6));}catch(_0x481f9a){}this[_0x11f440(0x34a)]=Date[_0x11f440(0x40e)]();}catch(_0xfb0c95){}},'_startTick'(){const _0x22ce18=_0x52ca82;if(this[_0x22ce18(0x25d)])clearInterval(this[_0x22ce18(0x25d)]);if(this[_0x22ce18(0x3d8)]==='C'&&this['state']==='work'){this[_0x22ce18(0x25d)]=setInterval(()=>{const _0x122256=_0x22ce18;this[_0x122256(0x41e)]+=0x1,this[_0x122256(0x3cf)](),this[_0x122256(0x223)]();},0x3e8);return;}this[_0x22ce18(0x25d)]=setInterval(()=>{const _0x39943a=_0x22ce18;this['remaining']>0x0&&(this[_0x39943a(0x41e)]-=0x1,this[_0x39943a(0x3cf)](),this[_0x39943a(0x223)]()),this[_0x39943a(0x41e)]<=0x0&&(clearInterval(this[_0x39943a(0x25d)]),this[_0x39943a(0x25d)]=null,this[_0x39943a(0x250)]());},0x3e8);},'_onFinishSegment'(){const _0x3ee29d=_0x52ca82;if(this[_0x3ee29d(0x41c)]==='work'){const _0x5aade3=getCurrentSubtopic();if(_0x5aade3){const _0x17b424=this['currentDurations']()['work'];_0x5aade3[_0x3ee29d(0x2a6)][_0x3ee29d(0x3d4)]=(_0x5aade3[_0x3ee29d(0x2a6)][_0x3ee29d(0x3d4)]||0x0)+_0x17b424,_0x5aade3[_0x3ee29d(0x2a6)]['sessionsCompleted']=(_0x5aade3[_0x3ee29d(0x2a6)][_0x3ee29d(0x37e)]||0x0)+0x1;const _0x474f3d={'id':uid(_0x3ee29d(0x35e)),'dateISO':todayISO(),'durationMinutes':_0x17b424,'mode':this[_0x3ee29d(0x3d8)],'note':''};if(!_0x5aade3[_0x3ee29d(0x307)])_0x5aade3[_0x3ee29d(0x307)]=[];_0x5aade3['sessions'][_0x3ee29d(0x22b)](_0x474f3d);if(data?.['settings']?.[_0x3ee29d(0x447)])try{openNoteModal(_0x474f3d['id']);}catch(_0x479379){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0x3ee29d(0x2d4)]++;}if(typeof data!==_0x3ee29d(0x1e9)&&data&&data['settings']&&data[_0x3ee29d(0x4b9)][_0x3ee29d(0x1da)]===![]&&this[_0x3ee29d(0x41c)]===_0x3ee29d(0x381))playSound(_0x3ee29d(0x402));else(this[_0x3ee29d(0x41c)]===_0x3ee29d(0x453)||this['state']===_0x3ee29d(0x1ce)||this[_0x3ee29d(0x41c)]===_0x3ee29d(0x224))&&playSound(_0x3ee29d(0x4dc));const _0x4460ba=$(_0x3ee29d(0x4c7));if(_0x4460ba)_0x4460ba[_0x3ee29d(0x262)][_0x3ee29d(0x2c0)](_0x3ee29d(0x303));if(data[_0x3ee29d(0x4b9)]['autoStartNext']){if(this[_0x3ee29d(0x41c)]===_0x3ee29d(0x381))data[_0x3ee29d(0x4b9)][_0x3ee29d(0x1da)]===![]?this[_0x3ee29d(0x255)]():this[_0x3ee29d(0x2a7)]();else this[_0x3ee29d(0x41c)]===_0x3ee29d(0x453)?this[_0x3ee29d(0x255)]():this[_0x3ee29d(0x2c6)]();}else this['tickHandle']&&(clearInterval(this[_0x3ee29d(0x25d)]),this['tickHandle']=null),this[_0x3ee29d(0x41c)]='idle',this['prevState']=null,this['updateUI'](),toast(_0x3ee29d(0x3af));},'beginWindDown'(){const _0x5a7f96=_0x52ca82;if(data?.[_0x5a7f96(0x4b9)]?.[_0x5a7f96(0x1da)]===![]){this[_0x5a7f96(0x255)]();return;}this[_0x5a7f96(0x22e)]=this['state'],this[_0x5a7f96(0x41c)]=_0x5a7f96(0x453);const _0x5acccd=(this['currentDurations']()[_0x5a7f96(0x32e)]||0x0)*0x3c;if(_0x5acccd<=0x0){this[_0x5a7f96(0x255)]();return;}this[_0x5a7f96(0x496)]=_0x5acccd,this[_0x5a7f96(0x41e)]=_0x5acccd;try{playSound('break_end');}catch(_0x2eeaff){}try{toast(_0x5a7f96(0x3cc));}catch(_0x3ca59c){}this['_startTick'](),this[_0x5a7f96(0x3cf)]();},'beginWork'(){const _0x5c2501=_0x52ca82;this['prevState']=this[_0x5c2501(0x41c)],this[_0x5c2501(0x41c)]=_0x5c2501(0x381);if(this[_0x5c2501(0x3d8)]==='C'){this[_0x5c2501(0x496)]=0x0;if(this['prevState']!==_0x5c2501(0x209))this[_0x5c2501(0x41e)]=0x0;}else{const _0x5ea1ad=this[_0x5c2501(0x219)]()[_0x5c2501(0x381)]*0x3c;this['segmentTotal']=_0x5ea1ad;if(this[_0x5c2501(0x22e)]!==_0x5c2501(0x209))this[_0x5c2501(0x41e)]=_0x5ea1ad;}const _0x5c0a19=$(_0x5c2501(0x452));_0x5c0a19&&(_0x5c0a19[_0x5c2501(0x4a4)]=''),this[_0x5c2501(0x2b1)](),this[_0x5c2501(0x3cf)]();},'finishFlowSession'(){const _0x2e779c=_0x52ca82;if(this[_0x2e779c(0x3d8)]!=='C'||this[_0x2e779c(0x41c)]!==_0x2e779c(0x381))return;this[_0x2e779c(0x25d)]&&(clearInterval(this[_0x2e779c(0x25d)]),this[_0x2e779c(0x25d)]=null);const _0x15518e=Math[_0x2e779c(0x425)](0x1,parseInt(data['settings'][_0x2e779c(0x3f8)]??0x5,0xa)),_0x5a80c6=Math['max'](0x0,this[_0x2e779c(0x41e)]|0x0),_0x3003b9=Math[_0x2e779c(0x425)](0x3c,Math[_0x2e779c(0x347)](_0x5a80c6/_0x15518e));try{const _0x35857a=getCurrentSubtopic();if(_0x35857a){const _0xebfe02=Math[_0x2e779c(0x425)](0x1,Math[_0x2e779c(0x4a1)](_0x5a80c6/0x3c));_0x35857a[_0x2e779c(0x2a6)][_0x2e779c(0x3d4)]=(_0x35857a[_0x2e779c(0x2a6)]['totalMinutes']||0x0)+_0xebfe02,_0x35857a[_0x2e779c(0x2a6)]['sessionsCompleted']=(_0x35857a[_0x2e779c(0x2a6)][_0x2e779c(0x37e)]||0x0)+0x1;const _0x430842={'id':uid('sess'),'dateISO':todayISO(),'durationMinutes':_0xebfe02,'mode':this['mode'],'note':''};if(!_0x35857a['sessions'])_0x35857a['sessions']=[];_0x35857a[_0x2e779c(0x307)][_0x2e779c(0x22b)](_0x430842),saveData(),renderStatsHistory(),data?.[_0x2e779c(0x4b9)]?.[_0x2e779c(0x447)]&&openNoteModal(_0x430842['id']);}}catch(_0x33ac21){}this['state']=_0x2e779c(0x1ce),this[_0x2e779c(0x496)]=_0x3003b9,this[_0x2e779c(0x41e)]=_0x3003b9,this['_startTick'](),this[_0x2e779c(0x3cf)](),this[_0x2e779c(0x223)](!![]);try{toast(_0x2e779c(0x27e)+Math[_0x2e779c(0x4a1)](_0x3003b9/0x3c)+_0x2e779c(0x2a0)+_0x15518e+').');}catch(_0x220aa4){}},'beginBreak'(){const _0x231dd6=_0x52ca82;this[_0x231dd6(0x22e)]=this[_0x231dd6(0x41c)];const _0x123607=this[_0x231dd6(0x3d2)](),_0xdb90a0=this['currentDurations']();if(this['cycleIndex']>0x0&&this['cycleIndex']%_0x123607[_0x231dd6(0x2a2)]===0x0){this[_0x231dd6(0x41c)]=_0x231dd6(0x224);const _0xf680d=_0xdb90a0['long']*0x3c;this[_0x231dd6(0x496)]=_0xf680d;if(this[_0x231dd6(0x22e)]!==_0x231dd6(0x209))this[_0x231dd6(0x41e)]=_0xf680d;toast(_0x231dd6(0x37a));}else{this[_0x231dd6(0x41c)]=_0x231dd6(0x1ce);const _0x158c8a=_0xdb90a0[_0x231dd6(0x3e2)]*0x3c;this[_0x231dd6(0x496)]=_0x158c8a;if(this[_0x231dd6(0x22e)]!==_0x231dd6(0x209))this[_0x231dd6(0x41e)]=_0x158c8a;}const _0x2c6b94=$(_0x231dd6(0x452));if(_0x2c6b94){const _0x54e437=Math[_0x231dd6(0x347)](Math[_0x231dd6(0x3a7)]()*breakSuggestions[_0x231dd6(0x2ca)]);_0x2c6b94[_0x231dd6(0x4a4)]='💡\x20Suggestion:\x20'+breakSuggestions[_0x54e437];}this[_0x231dd6(0x2b1)](),this[_0x231dd6(0x3cf)]();},async 'start'(){const _0x5ae5f2=_0x52ca82;if(!getCurrentSubtopic()){toast(_0x5ae5f2(0x352));return;}ensureAudio();if(this['mode']==='C'&&this[_0x5ae5f2(0x41c)]===_0x5ae5f2(0x446))this[_0x5ae5f2(0x41c)]=_0x5ae5f2(0x381),this[_0x5ae5f2(0x41e)]=0x0,this[_0x5ae5f2(0x496)]=0x0,this[_0x5ae5f2(0x2d4)]=0x0,this[_0x5ae5f2(0x2b1)](),this[_0x5ae5f2(0x3cf)]();else{if(this['state']===_0x5ae5f2(0x446))this[_0x5ae5f2(0x2d4)]=this[_0x5ae5f2(0x2d4)]||0x0,this[_0x5ae5f2(0x2c6)]();else this[_0x5ae5f2(0x41c)]===_0x5ae5f2(0x209)&&this[_0x5ae5f2(0x2a8)]();}await this[_0x5ae5f2(0x223)](!![]);},async 'pause'(){const _0x1073f5=_0x52ca82;this[_0x1073f5(0x25d)]&&(clearInterval(this[_0x1073f5(0x25d)]),this['tickHandle']=null),this[_0x1073f5(0x22e)]=this[_0x1073f5(0x41c)],this[_0x1073f5(0x41c)]=_0x1073f5(0x209),this[_0x1073f5(0x3cf)](),await this[_0x1073f5(0x223)](!![]);},async 'resume'(){const _0x4547d1=_0x52ca82;if(this[_0x4547d1(0x41c)]!==_0x4547d1(0x209))return;this['state']=this[_0x4547d1(0x22e)]||_0x4547d1(0x381),this[_0x4547d1(0x2b1)](),this['updateUI'](),await this['persistTimerState'](!![]);},async 'skip'(){const _0x1d8ad2=_0x52ca82;if(this['mode']==='C'&&this[_0x1d8ad2(0x41c)]===_0x1d8ad2(0x381)){this[_0x1d8ad2(0x24a)](),await this[_0x1d8ad2(0x223)](!![]);return;}this[_0x1d8ad2(0x41c)]==='work'?(this[_0x1d8ad2(0x25d)]&&(clearInterval(this['tickHandle']),this['tickHandle']=null),this[_0x1d8ad2(0x41e)]=0x0,this[_0x1d8ad2(0x250)]()):(this[_0x1d8ad2(0x41e)]=0x0,this[_0x1d8ad2(0x25d)]&&(clearInterval(this['tickHandle']),this['tickHandle']=null),this[_0x1d8ad2(0x250)]()),await this[_0x1d8ad2(0x223)](!![]);},async 'reset'(){const _0xfde515=_0x52ca82;this[_0xfde515(0x25d)]&&(clearInterval(this[_0xfde515(0x25d)]),this['tickHandle']=null);this[_0xfde515(0x41c)]='idle',this[_0xfde515(0x22e)]=null,this['remaining']=0x0,this[_0xfde515(0x496)]=0x0,this[_0xfde515(0x2d4)]=0x0;const _0x5bbfd6=$(_0xfde515(0x452));_0x5bbfd6&&(_0x5bbfd6[_0xfde515(0x4a4)]=''),this['updateUI'](),await this[_0xfde515(0x223)](!![]);}};async function deleteSummary(_0x1ddd38){showConfirmModal('Confirm\x20Deletion','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?',async _0x2dcbae=>{const _0x3bda94=_0x1305;if(!_0x2dcbae)return;const _0x124c15=getCurrentSubtopic();if(!_0x124c15||!_0x124c15[_0x3bda94(0x313)])return;const _0x1f54d9=[..._0x124c15[_0x3bda94(0x313)]];_0x124c15[_0x3bda94(0x313)]=_0x124c15['summaries'][_0x3bda94(0x32c)](_0x3d0f56=>_0x3d0f56['id']!==_0x1ddd38);try{await storageManager['update'](_0x3bda94(0x23c),_0x124c15),renderSummaries(),toast(_0x3bda94(0x4a7));}catch(_0x3c88db){console[_0x3bda94(0x2fb)](_0x3bda94(0x2f7),_0x3c88db),_0x124c15['summaries']=_0x1f54d9,toast(_0x3bda94(0x331));}});}function exportSummary(_0x59c14b){const _0x4540e9=_0x52ca82,_0x5289ce=new Blob([_0x59c14b[_0x4540e9(0x3f3)]],{'type':'text/plain'}),_0x52c644=document[_0x4540e9(0x410)]('a'),_0x2957ab=new Date(_0x59c14b[_0x4540e9(0x23f)]),_0x303721=_0xbad893=>(''+_0xbad893)['padStart'](0x2,'0');_0x52c644[_0x4540e9(0x42a)]=URL[_0x4540e9(0x23a)](_0x5289ce),_0x52c644[_0x4540e9(0x3d3)]='summary_'+_0x2957ab[_0x4540e9(0x1cc)]()+_0x303721(_0x2957ab[_0x4540e9(0x4d4)]()+0x1)+_0x303721(_0x2957ab[_0x4540e9(0x29e)]())+_0x4540e9(0x2c8),_0x52c644['click'](),URL[_0x4540e9(0x477)](_0x52c644[_0x4540e9(0x42a)]);}function renderStatsHistory(){const _0x596f06=_0x52ca82,_0x4ef158=getCurrentSubtopic(),_0x130cf5=$(_0x596f06(0x484)),_0x2451fb=$(_0x596f06(0x1c6)),_0x39d40b=$('#statTasks'),_0x55f01c=$('#historyList');if(!_0x130cf5||!_0x2451fb||!_0x39d40b||!_0x55f01c)return;if(!_0x4ef158){_0x130cf5[_0x596f06(0x4a4)]='0\x20min',_0x2451fb[_0x596f06(0x4a4)]='0',_0x39d40b[_0x596f06(0x4a4)]='0',_0x55f01c[_0x596f06(0x468)]=_0x596f06(0x474);return;}const _0x4f0a16=_0x4ef158[_0x596f06(0x2a6)]&&_0x4ef158[_0x596f06(0x2a6)][_0x596f06(0x3d4)]?_0x4ef158[_0x596f06(0x2a6)][_0x596f06(0x3d4)]:0x0,_0x6d96ba=_0x4ef158[_0x596f06(0x2a6)]&&_0x4ef158[_0x596f06(0x2a6)][_0x596f06(0x37e)]?_0x4ef158[_0x596f06(0x2a6)]['sessionsCompleted']:0x0,_0x19a285=_0x4ef158[_0x596f06(0x4d9)]?_0x4ef158[_0x596f06(0x4d9)][_0x596f06(0x32c)](_0x2bd809=>_0x2bd809[_0x596f06(0x400)])[_0x596f06(0x2ca)]:0x0;_0x130cf5[_0x596f06(0x4a4)]=formatDaysHoursMinutes(_0x4f0a16),_0x2451fb[_0x596f06(0x4a4)]=String(_0x6d96ba),_0x39d40b[_0x596f06(0x4a4)]=String(_0x19a285),_0x55f01c[_0x596f06(0x468)]='';const _0x5a3f76=Array[_0x596f06(0x39b)](_0x4ef158[_0x596f06(0x307)])?_0x4ef158[_0x596f06(0x307)]:[];if(_0x5a3f76[_0x596f06(0x2ca)]===0x0){_0x55f01c['innerHTML']=_0x596f06(0x289);return;}_0x5a3f76[_0x596f06(0x26c)](_0x30dab7=>{const _0x4654e6=_0x596f06,_0x5178ad=document['createElement'](_0x4654e6(0x3d0));_0x5178ad[_0x4654e6(0x265)]=_0x4654e6(0x1ca);const _0x164570=document[_0x4654e6(0x410)](_0x4654e6(0x3d0)),_0x2e9d58=_0x30dab7[_0x4654e6(0x34b)]?new Date(_0x30dab7[_0x4654e6(0x34b)]):new Date(),_0x40869c=_0x30dab7[_0x4654e6(0x33f)]!=null?_0x30dab7[_0x4654e6(0x33f)]:_0x30dab7[_0x4654e6(0x29d)]||0x0,_0x245081='<div\x20class=\x22hist-meta\x22>'+_0x2e9d58['toLocaleString']()+_0x4654e6(0x301)+_0x40869c+_0x4654e6(0x42e)+(_0x30dab7[_0x4654e6(0x3d8)]||'')+_0x4654e6(0x1f1);let _0x17b531='';if(_0x30dab7[_0x4654e6(0x4ab)])_0x17b531='<div>'+escapeHTML(_0x30dab7[_0x4654e6(0x4ab)])+_0x4654e6(0x1f1);else data?.[_0x4654e6(0x4b9)]?.[_0x4654e6(0x447)]&&(_0x17b531='<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>');_0x164570[_0x4654e6(0x468)]=_0x245081+_0x17b531,_0x5178ad['appendChild'](_0x164570),_0x55f01c['appendChild'](_0x5178ad);});}function renderGeneralNotes(){const _0x23c3a1=_0x52ca82,_0x53737b=$(_0x23c3a1(0x490));if(!_0x53737b)return;const _0x22617f=getCurrentSubtopic();if(!_0x22617f){_0x53737b[_0x23c3a1(0x468)]='<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>';return;}_0x22617f[_0x23c3a1(0x3a8)]=_0x22617f[_0x23c3a1(0x3a8)]||[];if(_0x22617f[_0x23c3a1(0x3a8)]['length']===0x0){_0x53737b[_0x23c3a1(0x468)]=_0x23c3a1(0x42c);return;}_0x53737b['innerHTML']='',_0x22617f[_0x23c3a1(0x3a8)][_0x23c3a1(0x26c)](_0x7f8cda=>{const _0x4a0583=_0x23c3a1,_0x450bbd=document[_0x4a0583(0x410)](_0x4a0583(0x3d0));_0x450bbd[_0x4a0583(0x265)]='note-item';const _0x1bb4b9=document[_0x4a0583(0x410)](_0x4a0583(0x3d0));_0x1bb4b9[_0x4a0583(0x265)]=_0x4a0583(0x305),_0x1bb4b9[_0x4a0583(0x4a4)]=typeof _0x7f8cda==='string'?_0x7f8cda:_0x7f8cda[_0x4a0583(0x469)]||'';const _0x64691c=document[_0x4a0583(0x410)](_0x4a0583(0x3d0));_0x64691c[_0x4a0583(0x265)]=_0x4a0583(0x3e4),_0x64691c[_0x4a0583(0x4a4)]=_0x7f8cda['createdAt']?new Date(_0x7f8cda[_0x4a0583(0x23f)])[_0x4a0583(0x21d)]():'';const _0x46aea5=document[_0x4a0583(0x410)](_0x4a0583(0x3d0)),_0x408a08=document[_0x4a0583(0x410)](_0x4a0583(0x476));_0x408a08['className']='btn\x20small\x20danger',_0x408a08[_0x4a0583(0x4a4)]=_0x4a0583(0x2c3),_0x408a08[_0x4a0583(0x2d2)]=async _0x22434f=>{const _0x4ea4cd=_0x4a0583;_0x22434f[_0x4ea4cd(0x41f)]();const _0x3fa68e=getCurrentSubtopic();if(!_0x3fa68e)return;_0x3fa68e[_0x4ea4cd(0x3a8)]=(_0x3fa68e[_0x4ea4cd(0x3a8)]||[])[_0x4ea4cd(0x32c)](_0xc65e65=>(_0xc65e65['id']||_0xc65e65)!==(_0x7f8cda['id']||_0x7f8cda)),await saveData(),renderGeneralNotes();},_0x46aea5[_0x4a0583(0x3e9)](_0x408a08);const _0x4c432d=document[_0x4a0583(0x410)](_0x4a0583(0x3d0));_0x4c432d[_0x4a0583(0x265)]=_0x4a0583(0x1c4),_0x4c432d[_0x4a0583(0x288)](_0x1bb4b9,_0x64691c),_0x450bbd[_0x4a0583(0x288)](_0x4c432d,_0x46aea5),_0x53737b[_0x4a0583(0x3e9)](_0x450bbd);});}function renderMethods(){const _0xa8370a=_0x52ca82,_0x275d60=document['querySelector'](_0xa8370a(0x41b));if(!_0x275d60)return;_0x275d60[_0xa8370a(0x468)]='';const _0x225a71=getCurrentSubtopic();if(!_0x225a71){_0x275d60[_0xa8370a(0x468)]='<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20its\x20Knowledge\x20Base.</p>';return;}const _0x12de29=Array['isArray'](_0x225a71[_0xa8370a(0x1dd)])?_0x225a71['methods']:[];if(_0x12de29[_0xa8370a(0x2ca)]===0x0){_0x275d60['innerHTML']='<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>';return;}_0x12de29[_0xa8370a(0x26c)](_0x3784cc=>{const _0x1eb1a0=_0xa8370a,_0x2f199f=document[_0x1eb1a0(0x410)](_0x1eb1a0(0x1f3));_0x2f199f[_0x1eb1a0(0x265)]=_0x1eb1a0(0x4b6),_0x2f199f[_0x1eb1a0(0x445)][_0x1eb1a0(0x2c5)]=_0x3784cc['id'];const _0xff8c6a=document[_0x1eb1a0(0x410)]('summary'),_0x8a63f1=document[_0x1eb1a0(0x410)](_0x1eb1a0(0x3b2));_0x8a63f1[_0x1eb1a0(0x265)]=_0x1eb1a0(0x326),_0x8a63f1[_0x1eb1a0(0x4a4)]=_0x3784cc[_0x1eb1a0(0x47a)]||_0x1eb1a0(0x45d),_0x8a63f1[_0x1eb1a0(0x459)]('click',_0xf43f0e=>{const _0x4c755a=_0x1eb1a0;_0xf43f0e['preventDefault'](),_0xf43f0e[_0x4c755a(0x41f)](),_0x2f199f[_0x4c755a(0x3f4)]=!_0x2f199f[_0x4c755a(0x3f4)];});const _0x547fa3=document[_0x1eb1a0(0x410)](_0x1eb1a0(0x3d0));_0x547fa3[_0x1eb1a0(0x265)]=_0x1eb1a0(0x1d0);const _0x491b5c=document[_0x1eb1a0(0x410)](_0x1eb1a0(0x476));_0x491b5c[_0x1eb1a0(0x265)]=_0x1eb1a0(0x35a),_0x491b5c[_0x1eb1a0(0x4a4)]=_0x1eb1a0(0x2b7),_0x491b5c[_0x1eb1a0(0x445)]['id']=_0x3784cc['id'];const _0x4c2454=document[_0x1eb1a0(0x410)](_0x1eb1a0(0x476));_0x4c2454[_0x1eb1a0(0x265)]=_0x1eb1a0(0x339),_0x4c2454[_0x1eb1a0(0x4a4)]='Delete',_0x4c2454[_0x1eb1a0(0x445)]['id']=_0x3784cc['id'],_0x547fa3[_0x1eb1a0(0x288)](_0x491b5c,_0x4c2454),_0xff8c6a['append'](_0x8a63f1,_0x547fa3);const _0x187018=document[_0x1eb1a0(0x410)](_0x1eb1a0(0x3d0));_0x187018[_0x1eb1a0(0x265)]='method-content',_0x187018[_0x1eb1a0(0x468)]=_0x3784cc[_0x1eb1a0(0x3f3)]||'',_0x2f199f['append'](_0xff8c6a,_0x187018),_0x275d60[_0x1eb1a0(0x3e9)](_0x2f199f),_0x2f199f[_0x1eb1a0(0x459)](_0x1eb1a0(0x422),_0x4db0e1=>{const _0x3f7ff1=_0x1eb1a0,_0x16df19=_0x4db0e1[_0x3f7ff1(0x1e2)];if(!_0x16df19)return;if(_0x16df19[_0x3f7ff1(0x442)]('button')||_0x16df19[_0x3f7ff1(0x442)]('a')||_0x16df19[_0x3f7ff1(0x442)](_0x3f7ff1(0x27c))||_0x16df19[_0x3f7ff1(0x442)](_0x3f7ff1(0x312)))return;if(!_0x2f199f[_0x3f7ff1(0x3f4)])_0x2f199f[_0x3f7ff1(0x3f4)]=!![];});});const _0x4389e7=_0x275d60[_0xa8370a(0x338)](_0xa8370a(0x2f1));_0x4389e7['forEach'](_0x4acc00=>{const _0x48ceb3=_0xa8370a;_0x4acc00[_0x48ceb3(0x459)](_0x48ceb3(0x237),()=>{const _0x55cd16=_0x48ceb3;_0x4acc00[_0x55cd16(0x3f4)]&&_0x4389e7[_0x55cd16(0x26c)](_0x4af23d=>{if(_0x4af23d!==_0x4acc00)_0x4af23d['open']=![];});});});}function addGeneralNote(){showInputModal('Add\x20note',async _0xb08862=>{const _0x5475fc=_0x1305;if(!_0xb08862)return;const _0x194234=getCurrentSubtopic();if(!_0x194234){toast(_0x5475fc(0x2e0));return;}_0x194234[_0x5475fc(0x3a8)]=_0x194234[_0x5475fc(0x3a8)]||[],_0x194234[_0x5475fc(0x3a8)][_0x5475fc(0x22b)]({'id':uid('gn'),'text':_0xb08862,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x427bfb=_0x52ca82,_0xd7cd82=getCurrentSubtopic();if(!_0xd7cd82){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x4f3690=(_0xd7cd82['generalNotes']||[])[_0x427bfb(0x242)](_0xb2e0d5=>typeof _0xb2e0d5===_0x427bfb(0x268)?_0xb2e0d5:_0xb2e0d5[_0x427bfb(0x469)]||'')[_0x427bfb(0x32c)](Boolean);if(_0x4f3690[_0x427bfb(0x2ca)]===0x0){toast(_0x427bfb(0x343));return;}const _0x185b4d=$(_0x427bfb(0x2d9));_0x185b4d&&(_0x185b4d[_0x427bfb(0x329)]=!![],_0x185b4d[_0x427bfb(0x468)]=_0x427bfb(0x419));try{const _0xa39156=_0x427bfb(0x408)+_0x4f3690['join'](_0x427bfb(0x38a)),_0x463a35=await callGeminiAPI(_0xa39156);if(!_0xd7cd82[_0x427bfb(0x313)])_0xd7cd82[_0x427bfb(0x313)]=[];_0xd7cd82[_0x427bfb(0x313)][_0x427bfb(0x22b)]({'id':uid(_0x427bfb(0x258)),'content':_0x463a35||_0x427bfb(0x2aa),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x1801d6){console[_0x427bfb(0x2fb)](_0x1801d6),toast(_0x427bfb(0x489));}finally{_0x185b4d&&(_0x185b4d[_0x427bfb(0x329)]=![],_0x185b4d[_0x427bfb(0x4a4)]='Summarize');}}function renderSummaries(){const _0x1ae44d=_0x52ca82,_0x6cf675=$('#summariesList');if(!_0x6cf675)return;const _0x5a21ac=getCurrentSubtopic();if(!_0x5a21ac){_0x6cf675['innerHTML']='<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>';return;}_0x6cf675[_0x1ae44d(0x468)]='';if(!_0x5a21ac['summaries']||_0x5a21ac[_0x1ae44d(0x313)][_0x1ae44d(0x2ca)]===0x0){_0x6cf675[_0x1ae44d(0x468)]=_0x1ae44d(0x292);return;}_0x5a21ac['summaries'][_0x1ae44d(0x26c)](_0x5110ec=>{const _0x3dc246=_0x1ae44d,_0x1961d=document[_0x3dc246(0x410)](_0x3dc246(0x3d0));_0x1961d[_0x3dc246(0x265)]=_0x3dc246(0x1bb);const _0xd06ba3=document[_0x3dc246(0x410)](_0x3dc246(0x3d0));_0xd06ba3[_0x3dc246(0x265)]=_0x3dc246(0x1c4);const _0x76e946=document[_0x3dc246(0x410)](_0x3dc246(0x3d0));_0x76e946[_0x3dc246(0x265)]='note-content',_0x76e946[_0x3dc246(0x4a4)]=_0x5110ec[_0x3dc246(0x3f3)];const _0x56b1a0=document[_0x3dc246(0x410)]('div');_0x56b1a0[_0x3dc246(0x265)]=_0x3dc246(0x3e4),_0x56b1a0[_0x3dc246(0x4a4)]=new Date(_0x5110ec[_0x3dc246(0x23f)])[_0x3dc246(0x21d)](),_0xd06ba3[_0x3dc246(0x288)](_0x76e946,_0x56b1a0);const _0x5df07a=document['createElement'](_0x3dc246(0x3d0)),_0x1c6b24=document[_0x3dc246(0x410)]('button');_0x1c6b24[_0x3dc246(0x265)]=_0x3dc246(0x4cd),_0x1c6b24[_0x3dc246(0x4a4)]=_0x3dc246(0x28e),_0x1c6b24['onclick']=_0x5d590d=>{const _0x4e9108=_0x3dc246;_0x5d590d[_0x4e9108(0x41f)](),exportSummary(_0x5110ec);};const _0xa4b5a2=document[_0x3dc246(0x410)]('button');_0xa4b5a2['className']=_0x3dc246(0x397),_0xa4b5a2[_0x3dc246(0x4a4)]=_0x3dc246(0x2c3),_0xa4b5a2[_0x3dc246(0x2d2)]=_0x25f532=>{const _0x302792=_0x3dc246;_0x25f532[_0x302792(0x41f)](),deleteSummary(_0x5110ec['id']);},_0x5df07a['append'](_0x1c6b24,_0xa4b5a2),_0x1961d[_0x3dc246(0x288)](_0xd06ba3,_0x5df07a),_0x1961d[_0x3dc246(0x459)](_0x3dc246(0x422),()=>_0x76e946[_0x3dc246(0x262)][_0x3dc246(0x237)]('expanded')),_0x6cf675[_0x3dc246(0x3e9)](_0x1961d);});}function loadEditingPresetFields(){const _0x122975=_0x52ca82,_0x12ccad=data[_0x122975(0x4b9)],_0xe6c77e=_0x12ccad[_0x122975(0x1d1)],_0x3045aa=$('#settings-pomodoro'),_0x47c809=$(_0x122975(0x373));if(_0x3045aa&&_0x47c809){const _0x117f36=editingPreset==='C';_0x3045aa['classList'][_0x122975(0x237)](_0x122975(0x2eb),_0x117f36),_0x47c809[_0x122975(0x262)][_0x122975(0x237)](_0x122975(0x2eb),!_0x117f36);}if(editingPreset==='A'){$(_0x122975(0x4d5))[_0x122975(0x1ff)]=_0xe6c77e['A_work'];if($(_0x122975(0x424)))$(_0x122975(0x424))[_0x122975(0x1ff)]=_0xe6c77e[_0x122975(0x2c2)]??0x0;$(_0x122975(0x300))['value']=_0xe6c77e['A_short'],$(_0x122975(0x1cf))[_0x122975(0x1ff)]=_0xe6c77e[_0x122975(0x21e)],$(_0x122975(0x276))[_0x122975(0x1ff)]=_0x12ccad[_0x122975(0x3b7)],$('#set_interval')['value']=_0x12ccad['longBreakIntervalA'];}else{if(editingPreset==='B'){$(_0x122975(0x4d5))[_0x122975(0x1ff)]=_0xe6c77e[_0x122975(0x1c3)];if($('#set_winddown'))$(_0x122975(0x424))[_0x122975(0x1ff)]=_0xe6c77e[_0x122975(0x4e5)]??0x0;$(_0x122975(0x300))[_0x122975(0x1ff)]=_0xe6c77e['B_short'],$('#set_long')[_0x122975(0x1ff)]=_0xe6c77e[_0x122975(0x264)],$(_0x122975(0x276))[_0x122975(0x1ff)]=_0x12ccad[_0x122975(0x455)],$(_0x122975(0x4e3))[_0x122975(0x1ff)]=_0x12ccad[_0x122975(0x213)];}else{if(editingPreset==='C'){const _0x1069ba=$(_0x122975(0x297));if(_0x1069ba)_0x1069ba['value']=_0x12ccad[_0x122975(0x3f8)]??0x5;}}}}function highlightPresetSelector(){const _0x6ff74d=_0x52ca82;$$(_0x6ff74d(0x1e3))[_0x6ff74d(0x26c)](_0x405422=>{const _0x3ebbd3=_0x6ff74d,_0x1124ae=_0x405422[_0x3ebbd3(0x445)]['presetTarget']===editingPreset;_0x405422[_0x3ebbd3(0x262)][_0x3ebbd3(0x237)]('acc',_0x1124ae),_0x405422[_0x3ebbd3(0x262)]['toggle'](_0x3ebbd3(0x24b),!_0x1124ae);});}function openSettings(){const _0x46ca08=_0x52ca82,_0x571079=data[_0x46ca08(0x4b9)];editingPreset=_0x571079['preset'],$('#set_apiKey')[_0x46ca08(0x1ff)]=_0x571079[_0x46ca08(0x4a6)]||'',loadEditingPresetFields(),highlightPresetSelector(),$('#set_volume')[_0x46ca08(0x1ff)]=_0x571079[_0x46ca08(0x4b2)]??0.8,$(_0x46ca08(0x40d))[_0x46ca08(0x1ff)]=_0x571079[_0x46ca08(0x3bc)]||_0x46ca08(0x25c),$(_0x46ca08(0x2ec))['value']=_0x571079[_0x46ca08(0x233)]||'default';const _0x3236c5=getActiveYoutubeUrl();$(_0x46ca08(0x420))[_0x46ca08(0x1ff)]=_0x3236c5||'';const _0x1f7a56=extractYouTubeID(_0x3236c5);$(_0x46ca08(0x2a4))[_0x46ca08(0x329)]=!_0x1f7a56;$('#ytUrlFeedback')&&($(_0x46ca08(0x1bd))[_0x46ca08(0x4a4)]='');$(_0x46ca08(0x306))[_0x46ca08(0x1ff)]=_0x571079['youtubeVolume']||0x50,$(_0x46ca08(0x470))[_0x46ca08(0x4be)]=!!_0x571079['useYtThumbnailAsBg'],$(_0x46ca08(0x3b1))['value']=_0x571079['panelOpacity']||0.85;$('#set_backgroundMode')&&($(_0x46ca08(0x4a9))[_0x46ca08(0x1ff)]=_0x571079['backgroundMode']||_0x46ca08(0x448));$(_0x46ca08(0x3f5))&&($(_0x46ca08(0x3f5))[_0x46ca08(0x4be)]=!!_0x571079['autoStartNext']);$(_0x46ca08(0x450))&&($('#set_enableWinddown')[_0x46ca08(0x4be)]=_0x571079[_0x46ca08(0x1da)]!==![]);$(_0x46ca08(0x3fc))&&($(_0x46ca08(0x3fc))[_0x46ca08(0x4be)]=!!_0x571079['enableSessionNotes']);$('#set_backupDays')&&($(_0x46ca08(0x2d7))[_0x46ca08(0x1ff)]=_0x571079['backupDaysToKeep']||0x7);const _0x5ba5d1=$(_0x46ca08(0x461));_0x5ba5d1&&storageManager['getBackupList']()[_0x46ca08(0x340)](_0x3731c9=>{const _0x92a590=_0x46ca08;_0x5ba5d1[_0x92a590(0x468)]=_0x92a590(0x1bc),_0x3731c9&&_0x3731c9[_0x92a590(0x2ca)]>0x0?_0x3731c9[_0x92a590(0x26c)](_0x34f6bd=>{const _0x5b88f6=_0x92a590,_0x12c9bf=document[_0x5b88f6(0x410)](_0x5b88f6(0x280));_0x12c9bf[_0x5b88f6(0x1ff)]=_0x34f6bd[_0x5b88f6(0x3d6)],_0x12c9bf['textContent']=_0x5b88f6(0x334)+new Date(_0x34f6bd[_0x5b88f6(0x3d6)])[_0x5b88f6(0x395)](_0x5b88f6(0x38c)),_0x5ba5d1['appendChild'](_0x12c9bf);}):_0x5ba5d1[_0x92a590(0x468)]=_0x92a590(0x36b);});$(_0x46ca08(0x4d3))[_0x46ca08(0x262)][_0x46ca08(0x2c0)](_0x46ca08(0x227));try{trapFocus($('#modalSettings'));}catch(_0xd0008b){}}function closeSettings(){const _0x4c4ef9=_0x52ca82;$(_0x4c4ef9(0x4d3))['classList'][_0x4c4ef9(0x28d)](_0x4c4ef9(0x227));try{releaseFocus();}catch(_0x316fe0){}}async function setDefaults(){const _0xf10202=_0x52ca82;data['settings'][_0xf10202(0x1d1)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0xf10202(0x4b9)][_0xf10202(0x3b7)]=0x4,data[_0xf10202(0x4b9)][_0xf10202(0x443)]=0x4,data[_0xf10202(0x4b9)]['cyclesB']=0x4,data['settings'][_0xf10202(0x213)]=0x4,data[_0xf10202(0x4b9)][_0xf10202(0x3f8)]=0x5,data[_0xf10202(0x4b9)][_0xf10202(0x2fc)]='A',data[_0xf10202(0x4b9)][_0xf10202(0x4b2)]=0.8,data[_0xf10202(0x4b9)][_0xf10202(0x3bc)]=_0xf10202(0x25c),await saveData(),openSettings(),toast(_0xf10202(0x325));}async function saveSettings(){const _0x25b0e2=_0x52ca82,_0x36a9c7=data[_0x25b0e2(0x4b9)];_0x36a9c7['apiKey']=$(_0x25b0e2(0x2fe))[_0x25b0e2(0x1ff)][_0x25b0e2(0x251)]();const _0x4e1085=_0x36a9c7[_0x25b0e2(0x1d1)];if(editingPreset==='A')_0x4e1085['A_work']=clampInt($(_0x25b0e2(0x4d5))[_0x25b0e2(0x1ff)],0x1,0x3e7),_0x4e1085[_0x25b0e2(0x2c2)]=clampInt($('#set_winddown')[_0x25b0e2(0x1ff)],0x0,0x3e7),_0x4e1085[_0x25b0e2(0x2d0)]=clampInt($(_0x25b0e2(0x300))[_0x25b0e2(0x1ff)],0x1,0x3e7),_0x4e1085[_0x25b0e2(0x21e)]=clampInt($(_0x25b0e2(0x1cf))[_0x25b0e2(0x1ff)],0x1,0x3e7),_0x36a9c7[_0x25b0e2(0x3b7)]=clampInt($(_0x25b0e2(0x276))['value'],0x1,0xc),_0x36a9c7['longBreakIntervalA']=clampInt($('#set_interval')[_0x25b0e2(0x1ff)],0x2,0xc);else{if(editingPreset==='B')_0x4e1085['B_work']=clampInt($(_0x25b0e2(0x4d5))[_0x25b0e2(0x1ff)],0x1,0x3e7),_0x4e1085[_0x25b0e2(0x4e5)]=clampInt($(_0x25b0e2(0x424))[_0x25b0e2(0x1ff)],0x0,0x3e7),_0x4e1085['B_short']=clampInt($(_0x25b0e2(0x300))[_0x25b0e2(0x1ff)],0x1,0x3e7),_0x4e1085[_0x25b0e2(0x264)]=clampInt($(_0x25b0e2(0x1cf))[_0x25b0e2(0x1ff)],0x1,0x3e7),_0x36a9c7['cyclesB']=clampInt($(_0x25b0e2(0x276))[_0x25b0e2(0x1ff)],0x1,0xc),_0x36a9c7[_0x25b0e2(0x213)]=clampInt($(_0x25b0e2(0x4e3))[_0x25b0e2(0x1ff)],0x2,0xc);else{if(editingPreset==='C'){const _0x5b08cd=$(_0x25b0e2(0x297));if(_0x5b08cd)_0x36a9c7['flowtimeBreakRatio']=clampInt(_0x5b08cd['value'],0x1,0x14);}}}_0x36a9c7['volume']=clampFloat($(_0x25b0e2(0x1ba))[_0x25b0e2(0x1ff)],0x0,0x1,0.8),_0x36a9c7[_0x25b0e2(0x3bc)]=$('#set_theme')[_0x25b0e2(0x1ff)]==='chime'?_0x25b0e2(0x200):'beep',_0x36a9c7[_0x25b0e2(0x233)]=$(_0x25b0e2(0x2ec))[_0x25b0e2(0x1ff)],_0x36a9c7[_0x25b0e2(0x46f)]=parseFloat($(_0x25b0e2(0x3b1))[_0x25b0e2(0x1ff)])||0.85;$('#set_backgroundMode')&&(_0x36a9c7[_0x25b0e2(0x2ce)]=$('#set_backgroundMode')['value']);_0x36a9c7[_0x25b0e2(0x335)]=!!($('#set_autoStartNext')&&$(_0x25b0e2(0x3f5))[_0x25b0e2(0x4be)]),_0x36a9c7[_0x25b0e2(0x1da)]=!!($('#set_enableWinddown')&&$(_0x25b0e2(0x450))[_0x25b0e2(0x4be)]),_0x36a9c7[_0x25b0e2(0x447)]=!!($(_0x25b0e2(0x3fc))&&$(_0x25b0e2(0x3fc))[_0x25b0e2(0x4be)]);$('#set_backupDays')&&(_0x36a9c7[_0x25b0e2(0x1e0)]=clampInt($(_0x25b0e2(0x2d7))[_0x25b0e2(0x1ff)],0x1,0x1e));_0x36a9c7['theme']===_0x25b0e2(0x412)||_0x36a9c7[_0x25b0e2(0x233)]==='pastel'?(_0x36a9c7[_0x25b0e2(0x38b)]=![],typeof _0x36a9c7['customBg']===_0x25b0e2(0x268)&&_0x36a9c7['customBg'][_0x25b0e2(0x417)](_0x25b0e2(0x1e5))&&(_0x36a9c7['customBg']='')):_0x36a9c7[_0x25b0e2(0x38b)]=!![];const _0x3b8813=$('#set_youtubeUrl')[_0x25b0e2(0x1ff)]['trim']();_0x36a9c7[_0x25b0e2(0x38b)]=$(_0x25b0e2(0x470))[_0x25b0e2(0x4be)],_0x36a9c7[_0x25b0e2(0x2df)]=parseInt($(_0x25b0e2(0x306))[_0x25b0e2(0x1ff)],0xa),sessionYoutubeUrl=_0x3b8813;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer[_0x25b0e2(0x46a)])ytPlayer[_0x25b0e2(0x46a)](_0x36a9c7[_0x25b0e2(0x2df)]);}else try{fallbackPostMessage(_0x25b0e2(0x46a),[_0x36a9c7[_0x25b0e2(0x2df)]]);}catch(_0x5132dd){}}catch(_0x59c7cb){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer['setPreset'](_0x36a9c7['preset'],{'silent':!![]}),closeSettings(),toast(_0x25b0e2(0x488));}function clampInt(_0x5eb821,_0x428ecf,_0x23f0c6){const _0x59af18=_0x52ca82;_0x5eb821=parseInt(_0x5eb821||0x0,0xa);if(isNaN(_0x5eb821))_0x5eb821=_0x428ecf;return Math['max'](_0x428ecf,Math[_0x59af18(0x31f)](_0x23f0c6,_0x5eb821));}function clampFloat(_0x18dbea,_0x492752,_0x308e07,_0x2fa461){const _0x3e3a74=_0x52ca82;_0x18dbea=parseFloat(_0x18dbea);if(Number[_0x3e3a74(0x3a1)](_0x18dbea))_0x18dbea=_0x2fa461;return Math[_0x3e3a74(0x425)](_0x492752,Math['min'](_0x308e07,_0x18dbea));}const dbPromise=new Promise((_0x1f677b,_0x4f143d)=>{const _0x3fb60e=_0x52ca82,_0x5e1f48=indexedDB[_0x3fb60e(0x3f4)](_0x3fb60e(0x27f),0x1);_0x5e1f48[_0x3fb60e(0x364)]=_0x447fd0=>_0x447fd0[_0x3fb60e(0x1e2)]['result'][_0x3fb60e(0x401)]('files'),_0x5e1f48[_0x3fb60e(0x226)]=_0x8d4e7d=>_0x1f677b(_0x8d4e7d['target'][_0x3fb60e(0x444)]),_0x5e1f48[_0x3fb60e(0x315)]=_0x116989=>_0x4f143d(_0x116989);}),fileCache={};function handleFileUpload(_0xe90674,_0x378745){const _0x49c549=_0x52ca82;if(!_0xe90674)return;dbPromise[_0x49c549(0x340)](_0x45c7bf=>{const _0x214e72=_0x49c549,_0x4f73ef=uid(_0x214e72(0x2bf)),_0x264102=_0x45c7bf[_0x214e72(0x391)](_0x214e72(0x1cb),'readwrite');_0x264102[_0x214e72(0x344)](_0x214e72(0x1cb))['put'](_0xe90674,_0x4f73ef),_0x264102[_0x214e72(0x48c)]=()=>_0x378745(_0x4f73ef),_0x264102[_0x214e72(0x315)]=()=>toast(_0x214e72(0x348));});}function getStoredFileUrl(_0x563f7c){const _0x253b06=_0x52ca82;if(!_0x563f7c)return Promise[_0x253b06(0x2f0)]('');if(fileCache[_0x563f7c])return Promise[_0x253b06(0x2f0)](fileCache[_0x563f7c]);return dbPromise[_0x253b06(0x340)](_0x1e92ac=>new Promise(_0xbbcc66=>{const _0xd1666=_0x253b06,_0x56cc5b=_0x1e92ac['transaction'](_0xd1666(0x1cb),_0xd1666(0x341)),_0x5b39d4=_0x56cc5b[_0xd1666(0x344)](_0xd1666(0x1cb))[_0xd1666(0x4cb)](_0x563f7c);_0x5b39d4['onsuccess']=_0x26205e=>{const _0x9d6378=_0xd1666,_0x1896e8=_0x26205e[_0x9d6378(0x1e2)][_0x9d6378(0x444)];if(_0x1896e8){const _0x3f3b31=URL[_0x9d6378(0x23a)](_0x1896e8);fileCache[_0x563f7c]=_0x3f3b31,_0xbbcc66(_0x3f3b31);}else _0xbbcc66('');},_0x5b39d4['onerror']=()=>_0xbbcc66('');}));}function applyCustomBg(){const _0x43a874=_0x52ca82,_0x5ca2f3=data[_0x43a874(0x4b9)],_0x410922=_0x5ca2f3[_0x43a874(0x206)],_0x304226=_0x5ca2f3[_0x43a874(0x233)],_0x35db46=[_0x43a874(0x215),'space'][_0x43a874(0x417)](_0x304226),_0x4eb342=_0x304226===_0x43a874(0x412)||_0x304226==='pastel',_0x2325fe=_0x5ca2f3[_0x43a874(0x2ce)]||_0x43a874(0x448);document[_0x43a874(0x3ea)][_0x43a874(0x2b8)][_0x43a874(0x457)]=_0x2325fe,document[_0x43a874(0x3ea)][_0x43a874(0x2b8)]['backgroundRepeat']=_0x2325fe==='auto'?'repeat':_0x43a874(0x322);const _0x143cf6=()=>{const _0x472b96=_0x43a874;try{document[_0x472b96(0x3ea)][_0x472b96(0x2b8)][_0x472b96(0x35f)]='';}catch(_0x228d41){}};if(_0x410922){const _0x4204c8=_0x410922['startsWith'](_0x43a874(0x2b3))||_0x410922[_0x43a874(0x467)](_0x43a874(0x1ec))||_0x410922[_0x43a874(0x467)](_0x43a874(0x345))?Promise['resolve'](_0x410922):getStoredFileUrl(_0x410922);_0x4204c8[_0x43a874(0x340)](_0x312a8f=>{const _0x296679=_0x43a874;_0x312a8f?document[_0x296679(0x3ea)]['style'][_0x296679(0x376)](_0x296679(0x370),_0x296679(0x4a3)+_0x312a8f+')'):document['body'][_0x296679(0x2b8)][_0x296679(0x376)](_0x296679(0x370),_0x4eb342?_0x296679(0x1f6):''),_0x143cf6();});}else!_0x35db46?_0x4eb342?(document['body'][_0x43a874(0x2b8)][_0x43a874(0x376)]('--bg-image',_0x43a874(0x1f6)),_0x143cf6()):document['body']['style'][_0x43a874(0x376)](_0x43a874(0x370),_0x43a874(0x4b1)):(document[_0x43a874(0x3ea)]['style'][_0x43a874(0x254)](_0x43a874(0x370)),_0x143cf6());}function applyPanelOpacity(){const _0x13f577=_0x52ca82;document[_0x13f577(0x2dd)][_0x13f577(0x2b8)][_0x13f577(0x376)]('--panel-opacity',data[_0x13f577(0x4b9)][_0x13f577(0x46f)]);}function renderDashboard(){const _0x2744b4=_0x52ca82,_0x49001a=data['topics']['flatMap'](_0x128f12=>_0x128f12[_0x2744b4(0x23c)][_0x2744b4(0x242)](_0x76e6f2=>({'topic':_0x128f12[_0x2744b4(0x33e)],'subtopic':_0x76e6f2['name'],'m':_0x76e6f2['stats'][_0x2744b4(0x3d4)]||0x0,'c':_0x76e6f2[_0x2744b4(0x2a6)]['sessionsCompleted']||0x0,'t':_0x76e6f2[_0x2744b4(0x2a6)][_0x2744b4(0x3b6)]||0x0}))),_0x513b00=_0x49001a[_0x2744b4(0x245)]((_0xd4b9b9,_0x44d6b4)=>_0xd4b9b9+_0x44d6b4['m'],0x0),_0x41b292=_0x49001a[_0x2744b4(0x245)]((_0x4ca281,_0x4ac898)=>_0x4ca281+_0x4ac898['c'],0x0),_0x29b676=_0x49001a[_0x2744b4(0x245)]((_0xd9293d,_0x2aa0b1)=>_0xd9293d+_0x2aa0b1['t'],0x0);let _0x155006=_0x2744b4(0x404)+formatDaysHoursMinutes(_0x513b00)+_0x2744b4(0x3b3)+_0x41b292+_0x2744b4(0x24d)+_0x29b676+_0x2744b4(0x33b);_0x49001a[_0x2744b4(0x26c)](_0x4e3dbd=>{const _0x33213c=_0x2744b4;_0x155006+=_0x33213c(0x3bf)+escapeHTML(_0x4e3dbd['topic'])+'</td><td>'+escapeHTML(_0x4e3dbd[_0x33213c(0x34e)])+'</td><td>'+formatDaysHoursMinutes(_0x4e3dbd['m'])+_0x33213c(0x479)+_0x4e3dbd['c']+_0x33213c(0x479)+_0x4e3dbd['t']+'</td></tr>';}),_0x155006+=_0x2744b4(0x34c);const _0x23db7f=$('#dashboardContent');if(_0x23db7f)_0x23db7f['innerHTML']=_0x155006;}function getMilestones(){const _0x4e7909=_0x52ca82;return[{'hours':0x5,'title':_0x4e7909(0x3ad),'message':_0x4e7909(0x333)},{'hours':0x14,'title':_0x4e7909(0x1f5),'message':_0x4e7909(0x285)},{'hours':0x32,'title':_0x4e7909(0x3ed),'message':'50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You’re\x20on\x20the\x20right\x20path—keep\x20going.'},{'hours':0x64,'title':_0x4e7909(0x24f),'message':_0x4e7909(0x359)},{'hours':0xfa,'title':_0x4e7909(0x3eb),'message':_0x4e7909(0x362)},{'hours':0x1f4,'title':_0x4e7909(0x1be),'message':_0x4e7909(0x365)},{'hours':0x3e8,'title':_0x4e7909(0x37d),'message':_0x4e7909(0x4e1)},{'hours':0x1388,'title':_0x4e7909(0x27a),'message':'5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‘How\x20do\x20I\x20focus?’\x20to\x20‘What\x20value\x20will\x20this\x20focus\x20create?’.\x20You’re\x20not\x20just\x20working—you’re\x20building\x20a\x20legacy.'}]['sort']((_0x17d372,_0x1d4fe7)=>_0x1d4fe7[_0x4e7909(0x2c1)]-_0x17d372[_0x4e7909(0x2c1)]);}async function checkAndShowMilestones(){const _0x3e7bcd=_0x52ca82;if(!data||!data[_0x3e7bcd(0x4b9)])return;if(!Array[_0x3e7bcd(0x39b)](data[_0x3e7bcd(0x4b9)][_0x3e7bcd(0x3c2)]))data[_0x3e7bcd(0x4b9)][_0x3e7bcd(0x3c2)]=[];const _0x3c534c=data[_0x3e7bcd(0x269)][_0x3e7bcd(0x245)]((_0x4fbd2f,_0x27ab7a)=>{const _0x45fe9f=_0x3e7bcd;return _0x4fbd2f+_0x27ab7a[_0x45fe9f(0x23c)]['reduce']((_0x5b916a,_0x1224c4)=>{return _0x5b916a+(_0x1224c4['stats']['totalMinutes']||0x0);},0x0);},0x0),_0x354245=_0x3c534c/0x3c,_0x37f7fe=getMilestones(),_0x4d302a=Array[_0x3e7bcd(0x39b)](data[_0x3e7bcd(0x4b9)][_0x3e7bcd(0x3c2)])?data[_0x3e7bcd(0x4b9)]['achievedMilestones']:[],_0x590c6a=_0x37f7fe[_0x3e7bcd(0x32c)](_0x3f33ba=>_0x354245>=_0x3f33ba[_0x3e7bcd(0x2c1)]&&!_0x4d302a[_0x3e7bcd(0x417)](_0x3f33ba[_0x3e7bcd(0x2c1)]));if(_0x590c6a[_0x3e7bcd(0x2ca)]===0x0)return![];const _0x214979=_0x590c6a[_0x3e7bcd(0x245)]((_0x55ebc2,_0x163d38)=>_0x55ebc2&&_0x55ebc2[_0x3e7bcd(0x2c1)]>_0x163d38[_0x3e7bcd(0x2c1)]?_0x55ebc2:_0x163d38,null);if(!_0x214979)return![];$(_0x3e7bcd(0x2ad))['textContent']=_0x214979['title'],$(_0x3e7bcd(0x260))['textContent']=_0x214979[_0x3e7bcd(0x3f9)],$(_0x3e7bcd(0x1eb))[_0x3e7bcd(0x262)][_0x3e7bcd(0x2c0)](_0x3e7bcd(0x227));try{trapFocus($('#modalMilestone'));}catch(_0x444d13){}return data[_0x3e7bcd(0x4b9)]['achievedMilestones'][_0x3e7bcd(0x31c)](_0x214979['hours']),await saveData(),!![];}async function seedAchievedMilestones(){const _0x56e61b=_0x52ca82;if(!data||!data[_0x56e61b(0x4b9)])return;!Array[_0x56e61b(0x39b)](data[_0x56e61b(0x4b9)][_0x56e61b(0x3c2)])&&(data['settings']['achievedMilestones']=[],await saveData());}async function handleSendMessage(){const _0x27fdcf=_0x52ca82,_0x55ccf0=$('#btnSendMessage'),_0x98b695=$(_0x27fdcf(0x492)),_0x13fe24=_0x98b695['value'][_0x27fdcf(0x251)](),_0x3e5baf=getCurrentSubtopic();if(!_0x13fe24)return;if(!_0x3e5baf){toast(t(_0x27fdcf(0x1de)));return;}_0x98b695['value']='',_0x55ccf0['disabled']=!![],_0x55ccf0[_0x27fdcf(0x468)]=_0x27fdcf(0x419),_0x3e5baf[_0x27fdcf(0x4df)][_0x27fdcf(0x31c)]({'role':_0x27fdcf(0x2ab),'text':_0x13fe24}),renderChat();const _0x4c2e04=await callGeminiAPI(_0x13fe24);_0x4c2e04&&(_0x3e5baf[_0x27fdcf(0x4df)][_0x27fdcf(0x31c)]({'role':_0x27fdcf(0x27d),'text':_0x4c2e04}),await saveData(),renderChat()),_0x55ccf0[_0x27fdcf(0x329)]=![],_0x55ccf0[_0x27fdcf(0x468)]=_0x27fdcf(0x327);}function renderChat(){const _0x3d50c1=_0x52ca82,_0x24984b=getCurrentSubtopic(),_0x32cc21=$('#chatMessages'),_0x537f0e=$(_0x3d50c1(0x492)),_0x1a33dd=$(_0x3d50c1(0x279));if(!_0x32cc21||!_0x537f0e||!_0x1a33dd)return;if(!_0x24984b){_0x32cc21['innerHTML']='<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>',_0x537f0e['disabled']=!![],_0x1a33dd[_0x3d50c1(0x329)]=!![];return;}_0x537f0e[_0x3d50c1(0x329)]=![],_0x1a33dd['disabled']=![],_0x32cc21[_0x3d50c1(0x468)]='';if(!_0x24984b['chatHistory']||_0x24984b[_0x3d50c1(0x4df)][_0x3d50c1(0x2ca)]===0x0){_0x32cc21[_0x3d50c1(0x468)]=_0x3d50c1(0x380);return;}_0x24984b[_0x3d50c1(0x4df)][_0x3d50c1(0x26c)](_0x470b09=>{const _0x2d0d3f=_0x3d50c1,_0x30abc4=document['createElement'](_0x2d0d3f(0x3d0));_0x30abc4[_0x2d0d3f(0x265)]=_0x2d0d3f(0x1f7)+_0x470b09[_0x2d0d3f(0x471)],_0x30abc4[_0x2d0d3f(0x4a4)]=_0x470b09[_0x2d0d3f(0x469)],_0x32cc21[_0x2d0d3f(0x3e9)](_0x30abc4);}),_0x32cc21[_0x3d50c1(0x320)]=_0x32cc21[_0x3d50c1(0x3d9)];}async function handleSummarizeNote(){const _0x36d07e=_0x52ca82,_0x1309f7=$('#btnSummarizeNote'),_0x2d927f=$('#noteText'),_0x4a9626=_0x2d927f[_0x36d07e(0x1ff)]['trim'](),_0x5f2a16=getCurrentSubtopic();if(!_0x4a9626){toast('Please\x20enter\x20a\x20note\x20before\x20summarizing.');return;}const _0x55603c=_0x1309f7[_0x36d07e(0x468)];_0x1309f7[_0x36d07e(0x468)]=_0x36d07e(0x419),_0x1309f7['disabled']=!![];const _0x45f5ca='Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22'+(_0x5f2a16?.[_0x36d07e(0x33e)]||'unknown')+_0x36d07e(0x318)+_0x4a9626+_0x36d07e(0x2e8),_0x1c687d=await callGeminiAPI(_0x45f5ca);_0x1c687d&&(_0x2d927f[_0x36d07e(0x1ff)]+='\x0a\x0a'+_0x1c687d),_0x1309f7['innerHTML']=_0x55603c,_0x1309f7[_0x36d07e(0x329)]=![];}function clearChat(){const _0x18c466=_0x52ca82,_0x322a0d=getCurrentSubtopic();if(!_0x322a0d){toast(t('timer.selectSubtopicPrompt'));return;}showConfirmModal(_0x18c466(0x3bd),'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?',async _0x3d1ed0=>{const _0x11638a=_0x18c466;_0x3d1ed0&&(_0x322a0d['chatHistory']=[],await saveData(),renderChat(),toast(_0x11638a(0x45b)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x14d6b8,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x1f72b5=_0x52ca82,_0x2b63f7=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x14d6b8,'enablejsapi':'1','origin':_0x1f72b5(0x4ba)})[_0x1f72b5(0x3f2)]();return _0x1f72b5(0x438)+_0x14d6b8+'?'+_0x2b63f7;}function ensureFallbackFrame(){const _0x283091=_0x52ca82,_0x292331=document['getElementById']('youtube-player-container');if(!_0x292331)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x283091(0x217)])return ytFallbackFrame;const _0x156e42=document[_0x283091(0x410)]('iframe');return _0x156e42['id']=_0x283091(0x48f),_0x156e42[_0x283091(0x2fa)]='1',_0x156e42[_0x283091(0x332)]='1',_0x156e42[_0x283091(0x2b8)][_0x283091(0x2c4)]=_0x283091(0x319),_0x156e42[_0x283091(0x2b8)]['top']='-9999px',_0x156e42[_0x283091(0x2b8)][_0x283091(0x48b)]='-9999px',_0x156e42[_0x283091(0x3f6)]=_0x283091(0x416),_0x292331['innerHTML']='',_0x292331[_0x283091(0x3e9)](_0x156e42),ytFallbackFrame=_0x156e42,_0x156e42;}function fallbackLoadVideo(_0x1d3beb,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x40b179=_0x52ca82,_0x5b2502=document[_0x40b179(0x49c)](_0x40b179(0x3a5));if(!_0x5b2502)return;_0x5b2502[_0x40b179(0x468)]='';const _0x19d9bf=document['createElement'](_0x40b179(0x29f));_0x19d9bf['id']=_0x40b179(0x48f),_0x19d9bf[_0x40b179(0x2fa)]='1',_0x19d9bf[_0x40b179(0x332)]='1',_0x19d9bf[_0x40b179(0x2b8)][_0x40b179(0x2c4)]=_0x40b179(0x319),_0x19d9bf[_0x40b179(0x2b8)]['top']=_0x40b179(0x3c4),_0x19d9bf[_0x40b179(0x2b8)][_0x40b179(0x48b)]=_0x40b179(0x3c4),_0x19d9bf[_0x40b179(0x3f6)]=_0x40b179(0x416),_0x19d9bf[_0x40b179(0x34f)]=buildFallbackSrc(_0x1d3beb,{'autoplay':autoplay,'mute':mute}),_0x5b2502['appendChild'](_0x19d9bf),ytFallbackFrame=_0x19d9bf,ytFallbackIsPlaying=!!autoplay;try{const _0x38dcd4=document[_0x40b179(0x49c)](_0x40b179(0x1c8));if(_0x38dcd4)_0x38dcd4['textContent']=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x3b0649){}}function fallbackPostMessage(_0x54b1e8,_0x524757=[]){const _0x3113a4=_0x52ca82;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x3113a4(0x379)])return;ytFallbackFrame[_0x3113a4(0x379)][_0x3113a4(0x24c)](JSON['stringify']({'event':_0x3113a4(0x230),'func':_0x54b1e8,'args':_0x524757}),_0x3113a4(0x4ba));}catch(_0x434cb4){}}function _0x52c9(){const _0x5e9c31=['https://www.youtube.com/iframe_api','importData','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','autoplay;\x20encrypted-media;\x20picture-in-picture','includes','.method-delete','<div\x20class=\x22spinner\x22></div>','IndexedDB\x20error:','#view-methods\x20.methods-container','state','currentTime','remaining','stopPropagation','#set_youtubeUrl','#methodEditorContentInput','click','reload','#set_winddown','max','async','function','lang','Subtopic:\x20','href','warn','<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>','HTTP\x20error:\x20','\x27\x20·\x20Mode\x20','triangle','WIND-DOWN','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.','BUFFERING','31148HAtHSa','Space','subtopics-group','topic-item','cycles','https://www.youtube.com/embed/','#subtopicTasksList','#btnCloseDashboard','#btnAddMethod','ArrowRight','defer','Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20','DB_VERSION','0\x20min','#methodEditorTitle','closest','longBreakIntervalA','result','dataset','idle','enableSessionNotes','cover','split','Error\x20calling\x20Gemini\x20API:','currentView','<p>The\x20core\x20idea:\x20\x22If\x20you\x20can’t\x20explain\x20a\x20topic\x20simply,\x20you\x20don’t\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can’t\x20explain\x20smoothly,\x20you’ve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it’s\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool—pinpointing\x20exactly\x20where\x20you’re\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>','#btnReset','setPreset','Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.','#set_enableWinddown','\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.','#breakSuggestionDisplay','wind_down','#currentSubtopicNameChat','cyclesB','loadLanguage','backgroundSize','...','addEventListener','Note\x20saved','Chat\x20history\x20cleared.','color','Untitled','Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20','all','.nav-btn[data-view]','#backupList','altKey','6929315arDSgg','.tab-btn','clear','pauseVideo','startsWith','innerHTML','text','setVolume','Missing\x20element','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','bold','#uploadBg','panelOpacity','#set_ytThumbAsBg','role','getPlayerState','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.','<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>','🌊\x20Flow','button','revokeObjectURL','abs','</td><td>','title','AudioContext','Saved\x20alert\x20for\x20LONG\x20BREAK.','toast','Delete\x20Topic','sine','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','getIframe','readwrite','mute','#statTotal','catch','</ul>','Exit\x20fullscreen','Settings\x20saved','Summary\x20failed.','offsetHeight','left','oncomplete','#btnSkip','Show\x20interface','yt-fallback','#generalNotesList','Delete\x20knowledge\x20\x22','#chatInput','<ul>','.presets\x20button','Gently\x20massage\x20your\x20temples.','segmentTotal','origin','test','opacity','OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...','actions','getElementById','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22','display','#btnSaveSettings','contains','round','#btnAutoFormat','url(','textContent','setItem','apiKey','Summary\x20deleted.','#modalGeneric','#set_backgroundMode','_sortable','note','execCommand','#toolBullet','timer.cycleInfo','play','key','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','volume','badge','#genericTitle','lastBackupDate','method-item','Rename\x20Subtopic','#draggableTimer','settings','https://www.youtube.com','Take\x20a\x20short\x20walk\x20around\x20the\x20room.','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','#btnAddGeneralNote','checked','Audio\x20playback\x20error:','onload','btn\x20subtopic-btn','#btnPresetC','#genericInput','&#39;','732524izZMpz','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','.timer-circle-container','top','sid','#stateBadge','get','localeCompare','btn\x20small','#btnCloseSettings','selectedTopicId','getSettings','querySelector','More\x20options','#modalSettings','getMonth','#set_work','#uploadSoundWork','Background\x20updated.','.subtopics','tasks','Backup\x20failed:','type','break_end','Initialization\x20error:','formatBlock','chatHistory','#toolColor','Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time—it\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‘superpower’\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.','#btnCancelMethodEditor','#set_interval','findIndex','B_winddown','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','.actions-menu-btn','#set_volume','note-item','<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>','#ytUrlFeedback','To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','Player','linearRampToValueAtTime','#audioWorkEnd','Deleted\x20old\x20backup:\x20','B_work','note-content-wrapper','initDB','#statSessions','scroll','btnToggleYtSound','PlayerState','hist-item','files','getFullYear','object','break','#set_long','topic-actions','durations','var(--acc)','Loading\x20YouTube\x20API...','#btnMilestoneClose','unMute','connect','strokeDashoffset','getAllKeys','Edit\x20Knowledge','enableWinddown','#btnGenericOk','</label>','methods','timer.selectSubtopicPrompt','#newSubtopicTaskInput','backupDaysToKeep','shiftKey','target','#timerPresetSelector\x20button','#btnPresetA','img.youtube.com/vi/','offsetWidth','collapsedTopics','customSounds','undefined','task','#modalMilestone','http','B_short','FOCUS','No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.','Backup\x20not\x20found.','</div>','timerState','details','&gt;','To\x20You,\x2020\x20Hours\x20(Foundation)','none','chat-msg\x20','＋\x20Add','cleanupOldBackups','Error\x20saving\x20data:\x20','insertOrderedList','exportData','9xUnYIu','updateSettings','value','chime','soundPermissionBar','script','log','webkitAudioContext','\x20min','customBg','#btnExport','Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.','paused','substring','textarea','sound_unlocked','cyclesTarget','Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.','?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.','bottom','styleWithCSS','&amp;','longBreakIntervalB','#btnStart','lofi','Enter','isConnected','innerHeight','currentDurations','Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','fullscreenchange','onkeydown','toLocaleString','A_long','pomodoro_backup_','.method-edit','#methodEditorId','var(--muted)','persistTimerState','long_break','Use\x20AI\x20to\x20auto-format\x20text','onsuccess','show','status','<strong>$1</strong>','DB_NAME','unshift','chev\x20btn\x20small\x20ghost','#cycleInfo','prevState','#btnBreakEarly','command','#editorPreview','put','theme','right','/maxresdefault.jpg','Invalid\x20file\x20format','toggle','bg-view-mode','#topicsList','createObjectURL','timer','subtopics','Check\x20and\x20correct\x20your\x20sitting\x20posture.','#timeDisplay','createdAt','reloading','#btnClearChat','map','#view-','code','reduce','mousemove','oldIndex','menu-item','item','finishFlowSession','ghost','postMessage','\x20|\x20<strong>Total\x20tasks:</strong>\x20','version','To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','_onFinishSegment','trim','AI\x20finished\x20formatting!','Daily\x20backup\x20successful.','removeProperty','beginBreak','#btnHelpCreateTopic','#btnEnableSound','sum','?\x20Current\x20data\x20will\x20be\x20overwritten.','Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.','<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20🧠</h4><p>Based\x20on\x20the\x20“Forgetting\x20Curve,”\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you’re\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you’ll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20📱</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20❌</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>—creating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010–20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory’s\x20“sweet\x20spot.”\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>','beep','tickHandle','#btnClearBg','http:','#milestoneMessage','beforeunload','classList','italic','B_long','className','#btnRestoreBackup','innerWidth','string','topics','aria-expanded','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203–5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20“Force\x20Multiplier”:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','forEach','Initialization\x20error:\x20','Gemini\x20error:\x20','#btnFinishFlow','#btnAddSubtopicTask','</p>','Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.','main_settings','actions-menu','newIndex','#set_cycles','.aux-panel,\x20.modal-card','view','#btnSendMessage','To\x20You,\x205,000+\x20Hours\x20(Legacy)','183tmcGQv','.color-picker-wrapper','model','Break\x20','pomodoro_files','option','about:blank','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','Gemini\x20API\x20Error:','__ytApiWatchdog','Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren’t\x20just\x20time—they’re\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You’re\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.','#modalNote','Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.','append','<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>','data','by_topic','AI\x20cannot\x20format\x20at\x20the\x20moment.','remove','Export','removeEventListener','Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','<input\x20type=\x22checkbox\x22\x20id=\x22','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','cueVideoById','#btnToggleCustomSounds','.json','createIndex','#set_flowRatio','find','Check\x20your\x20breathing—if\x20rushed,\x20slow\x20it\x20down.','head','menu-item\x20danger','prompt','workMinutes','getDate','iframe','\x20min\x20via\x20Flowtime\x20(','FOCUS\x20(FLOW)','interval','badge\x20state\x20work','#btnToggleYtSound','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','stats','beginWindDown','resume','#btnSaveNote','(Could\x20not\x20generate\x20summary)','user','btn\x20small\x20ghost\x20actions-menu-btn','#milestoneTitle','#btnSaveMethod','Do\x20a\x20few\x20deep-breathing\x20cycles.','fullscreenElement','_startTick','#welcomePanel','data:','set_youtubeUrl','active','Error:\x20','Edit','style','####\x20','match','API\x20response\x20structure\x20is\x20unexpected:','5478dBvbft','AutoBackup\x20error:','Play\x20a\x20favorite\x20song\x20briefly.','file','add','hours','A_winddown','Delete','position','methodId','beginWork','#btnGenericCancel','.txt','getBoundingClientRect','length','auto','select','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','backgroundMode','insertUnorderedList','A_short','topic-header','onclick','\x20hidden','cycleIndex','\x20(B)','focus','#set_backupDays','IndexedDB\x20initialized\x20successfully.','#btnSummarize','Background\x20music\x20stopped.','destination','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','documentElement','mousedown','youtubeVolume','Please\x20select\x20a\x20subtopic\x20first.','SHORT\x20BREAK','Switched\x20to\x20Style\x20','exponentialRampToValueAtTime','Saved\x20alert\x20for\x20SHORT\x20BREAK.','badge\x20state\x20break','#windDownChecklist','.actions-menu.show','\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**✨\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**🚀\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]','ytUrlFeedback','LONG\x20BREAK','hidden','#set_theme_color','#importFile','var(--danger)','tid','resolve','.method-item','requestFullscreen','flex','selectedSubtopicId','values','location','Failed\x20to\x20delete\x20summary:','stringify','file:','width','error','preset','POST','#set_apiKey','❌\x20Invalid\x20or\x20unsupported\x20link.','#set_short','\x20·\x20','#btnResume','finished','topicId','note-content','#ytSoundVolume','sessions','#modalMethodEditor','toISOString','playVideo','blockReason','#toolH4','selectionEnd','Playing','Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.','end','padStart','.color-palette','summaries','restoreBackup','onerror','#genericMessage','fixed','\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22','absolute','getVolume','Content\x20blocked\x20for:\x20','push','default','errorCode','min','scrollTop','update','no-repeat','pastel','<li>','Defaults\x20restored','method-title','Send','#toasts','disabled','15234zzeOYS','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','filter','65990gYJlWI','winddown','<h4>','load','Unable\x20to\x20save\x20changes.','height','Five\x20focused\x20hours!\x20You’ve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','Backup\x20from:\x20','autoStartNext','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22','splice','querySelectorAll','btn\x20small\x20danger\x20method-delete','application/json','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','Confirm\x20Switch','save','name','durationMinutes','then','readonly','getItem','No\x20notes\x20to\x20summarize.','objectStore','blob:','Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22','floor','File\x20save\x20error.','<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you’re\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don’t\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>','lastPersist','dateISO','</tbody></table>','parse','subtopic','src','#noteText','block','Please\x20select\x20a\x20Subtopic\x20first','#btnPause','&quot;','pointerdown','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.','Tidy\x20or\x20rearrange\x20your\x20workspace.','.modal','100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment—it’s\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.','btn\x20small\x20ghost\x20method-edit','start','reset','9485584znorSO','sess','backgroundImage','#welcomePanel\x20p','Playing\x20background\x20music...','250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You’ve\x20met\x20hard\x20days\x20and\x20distractions—and\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.','keydown','onupgradeneeded','Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You’ve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.','input','/hqdefault.jpg','backups','No\x20Subtopic\x20Selected','Stand\x20up\x20and\x20take\x20a\x20few\x20steps.','<option\x20value=\x22\x22>No\x20backups\x20available</option>','skip','timerState_','#btnDefaults','.sub-row','--bg-image','Switch\x20to\x20Style\x20','https://img.youtube.com/vi/','#settings-flowtime','frequency','#btnSummarizeNote','setProperty','from','relative','contentWindow','Great!\x20Time\x20for\x20a\x20long\x20break.','activeElement','pomodoroData_v11','To\x20You,\x201,000\x20Hours\x20(Transformation)','sessionsCompleted','Import\x20failed:\x20','<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>','work','getAll','replace','slice','#uploadSoundLong','objectStoreNames','transition','.nav-btn[data-view=\x22','.actions-menu','\x0a-\x20','useYtThumbnailAsBg','en-US','\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22','gain','Ask\x20yourself:\x20‘How\x20do\x20I\x20feel\x20right\x20now?’','#methodEditorTitleInput','transaction','var(--acc-2)','breathing','Data\x20imported\x20successfully!','toLocaleDateString','\x20(A)','btn\x20small\x20danger','#view-methods','foreColor','ENDED','isArray','Creating\x20backup\x20for\x20','Benjamin\x20Franklin’s\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','#btnFullscreen','mouseup','#btnSettings','isNaN','#toolList','<i>$1</i>','presetTarget','youtube-player-container','setAttribute','random','generalNotes','#uploadSoundBreak','Refuel\x20with\x20a\x20healthy\x20snack.','badge\x20state\x20long','sort','To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','stroke','Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.','toLowerCase','#set_panelOpacity','span','\x20|\x20<strong>Total\x20sessions:</strong>\x20','<ol>','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>','tasksCompleted','cyclesA','tab','2968SQnmFm','Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.','.topic-item.menu-active','soundTheme','Confirm\x20Deletion','Delete\x20Subtopic','<tr><td>','long_end','Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.','achievedMilestones','protocol','-9999px','#selectedContext','New\x20Subtopic\x20name?','createGain','pause','.subtopic-btn','stopVideo','delete','Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.','#audioBreakEnd','parentElement','updateUI','div','2793008XLBfMk','currentConfig','download','totalMinutes','no-subtopic-selected','date','getPropertyValue','mode','scrollHeight','</ol>','Fullscreen','#toolItalic','menu-active','#btnToggleBg','.tab-content','clientX','.topic-item','short','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>','note-meta','Sortable','#toolBold','change','parts','appendChild','body','To\x20You,\x20250\x20Hours\x20(Perseverance)','READY','To\x20You,\x2050\x20Hours\x20(Momentum)','</li>','Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.','#btnDashboard','stop','toString','content','open','#set_autoStartNext','allow','Cycle\x20','flowtimeBreakRatio','message','exitFullscreen','candidates','#set_enableSessionNotes','clientY','PLAYING','&lt;','isCompleted','createObjectStore','work_end','\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.','<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20','_getStore','var(--sub)','input,select,textarea','Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a','__ytApiPromise','statusText','promptFeedback','cancel','#set_theme','now','preventDefault','createElement','Sound\x20has\x20been\x20enabled!','light'];_0x52c9=function(){return _0x5e9c31;};return _0x52c9();}function fallbackPlay(){fallbackPostMessage('playVideo');}function fallbackStop(){const _0x111ff9=_0x52ca82;try{ytFallbackFrame&&(ytFallbackFrame[_0x111ff9(0x34f)]=_0x111ff9(0x281),ytFallbackIsPlaying=![]);}catch(_0x57c6af){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0x4d06de=_0x52ca82;fallbackPostMessage(_0x4d06de(0x1d5));}function fallbackMute(){fallbackPostMessage('mute');}window['onYouTubeIframeAPIReady']=function(){const _0xdcda25=_0x52ca82;if(IS_FILE_PROTOCOL){try{window['__ytApiWatchdog']&&window[_0xdcda25(0x284)]['cancel']();}catch(_0x245f82){}return;}const _0x5695e5={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':'https://www.youtube.com'};(window[_0xdcda25(0x2f6)][_0xdcda25(0x3c3)]===_0xdcda25(0x25f)||window['location']['protocol']==='https:')&&(_0x5695e5[_0xdcda25(0x497)]=window[_0xdcda25(0x2f6)][_0xdcda25(0x497)]);ytPlayer=new YT[(_0xdcda25(0x1bf))](_0xdcda25(0x3a5),_0x5695e5);try{window[_0xdcda25(0x284)]&&window[_0xdcda25(0x284)][_0xdcda25(0x40c)]();const _0x1d5e53=document[_0xdcda25(0x49c)](_0xdcda25(0x2e9));_0x1d5e53&&(_0x1d5e53[_0xdcda25(0x4a4)]='');}catch(_0x11b81d){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage['getItem'](_0x52ca82(0x20c))==='1';}catch(_0xcee61c){}function showSoundPermission(){const _0x2883ba=_0x52ca82,_0x1bb959=document['getElementById'](_0x2883ba(0x201));if(!_0x1bb959)return;if(_ytUnlocked){_0x1bb959[_0x2883ba(0x262)][_0x2883ba(0x28d)](_0x2883ba(0x227));return;}_0x1bb959['classList'][_0x2883ba(0x2c0)]('show');}function hideSoundPermission(){const _0x5bb55a=_0x52ca82,_0x2c5768=document[_0x5bb55a(0x49c)](_0x5bb55a(0x201));if(!_0x2c5768)return;_0x2c5768['classList']['remove']('show');}function unlockAudioChain(){const _0x1f173d=_0x52ca82;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x1f173d(0x2a8)]===_0x1f173d(0x427))AUDIO_CTX[_0x1f173d(0x2a8)]();}catch(_0x372fcb){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer['unMute']&&(ytPlayer[_0x1f173d(0x1d5)](),ytPlayer[_0x1f173d(0x30a)]());}catch(_0x5daff4){}_ytUnlocked=!![];try{localStorage[_0x1f173d(0x4a5)]('sound_unlocked','1');}catch(_0xc09a93){}hideSoundPermission(),toast(_0x1f173d(0x411));}function onPlayerReady(_0x17e030){const _0x96e3df=_0x52ca82;try{const _0x4e483f=ytPlayer&&ytPlayer[_0x96e3df(0x481)]?ytPlayer[_0x96e3df(0x481)]():null;_0x4e483f&&_0x4e483f['setAttribute'](_0x96e3df(0x3f6),'autoplay;\x20encrypted-media;\x20picture-in-picture');}catch(_0x3bdf35){}try{if(ytPlayer&&ytPlayer['setVolume'])ytPlayer['setVolume'](data&&data[_0x96e3df(0x4b9)]&&data[_0x96e3df(0x4b9)][_0x96e3df(0x2df)]||0x50);}catch(_0x37ac1c){}try{const _0x272e6c=getActiveVideoId&&getActiveVideoId();if(_0x272e6c&&ytPlayer&&ytPlayer['mute']&&ytPlayer[_0x96e3df(0x30a)]){ytPlayer[_0x96e3df(0x483)](),ytPlayer[_0x96e3df(0x30a)](),_ytPrimed=!![];const _0x5f0e8f=()=>{const _0x7b7f88=_0x96e3df;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x5b7143){}window[_0x7b7f88(0x28f)](_0x7b7f88(0x355),_0x5f0e8f,!![]),window[_0x7b7f88(0x28f)]('keydown',_0x5f0e8f,!![]);};window[_0x96e3df(0x459)](_0x96e3df(0x355),_0x5f0e8f,!![]),window['addEventListener'](_0x96e3df(0x363),_0x5f0e8f,!![]),showSoundPermission();}}catch(_0x3b1c48){}updateYouTubePlayer();}function onPlayerStateChange(_0x4f6e44){const _0xddce32=_0x52ca82,_0x11202e=$(_0xddce32(0x2a4));_0x4f6e44[_0xddce32(0x28a)]==YT[_0xddce32(0x1c9)][_0xddce32(0x3fe)]?(_0x11202e['textContent']='⏸️',hideSoundPermission()):_0x11202e[_0xddce32(0x4a4)]='▶';if(_0x4f6e44[_0xddce32(0x28a)]===YT[_0xddce32(0x1c9)][_0xddce32(0x39a)]){if(!ytUserPaused)ytPlayer[_0xddce32(0x30a)]();}}async function ytFadeTo(_0x22ea80,_0x15c297=0xfa){const _0x237b20=_0x52ca82;try{if(!ytPlayer||!ytPlayer[_0x237b20(0x31a)]||!ytPlayer[_0x237b20(0x46a)])return;ytPlayer['unMute']();const _0x20db90=ytPlayer['getVolume'](),_0x992dea=_0x22ea80-_0x20db90;if(Math[_0x237b20(0x478)](_0x992dea)<0x1||_0x15c297<=0x0){ytPlayer[_0x237b20(0x46a)](_0x22ea80);return;}const _0x493104=performance[_0x237b20(0x40e)]();await new Promise(_0x5cc46a=>{const _0x790b7a=_0x4c6b70=>{const _0x161029=_0x1305,_0x360764=Math['min'](0x1,(_0x4c6b70-_0x493104)/_0x15c297),_0x103f9e=Math[_0x161029(0x4a1)](_0x20db90+_0x992dea*_0x360764);ytPlayer['setVolume'](_0x103f9e);if(_0x360764<0x1)requestAnimationFrame(_0x790b7a);else _0x5cc46a();};requestAnimationFrame(_0x790b7a);});}catch(_0x494f60){}}async function ytFadeInPlay(_0x68e02c=0xdc){const _0x528207=_0x52ca82;try{const _0xb202a4=Math[_0x528207(0x425)](0x0,Math[_0x528207(0x31f)](0x64,data&&data['settings']&&data[_0x528207(0x4b9)][_0x528207(0x2df)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer['unMute'](),ytPlayer[_0x528207(0x30a)]();try{ytPlayer[_0x528207(0x46a)](0x0);}catch(_0x2f05d0){}await ytFadeTo(_0xb202a4,_0x68e02c);}else{const _0x2be99b=getActiveVideoId();_0x2be99b&&fallbackLoadVideo(_0x2be99b,{'autoplay':0x1,'mute':0x0});}}catch(_0x3105fd){}}async function ytFadeOutPause(_0x30ff81=0xb4){const _0x2a3f19=_0x52ca82;try{const _0x169702=Math['max'](0x0,Math[_0x2a3f19(0x31f)](0x64,data&&data[_0x2a3f19(0x4b9)]&&data[_0x2a3f19(0x4b9)][_0x2a3f19(0x2df)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x30ff81);try{ytPlayer['pauseVideo'](),ytPlayer['setVolume'](_0x169702);}catch(_0xda2bf9){}}else try{fallbackPause();}catch(_0x4e628f){}}catch(_0x524a74){}}async function updateYouTubePlayer(){const _0x563468=_0x52ca82,_0x5d66dc=getActiveVideoId();if(data[_0x563468(0x4b9)][_0x563468(0x38b)]&&_0x5d66dc){const _0x25b878=_0x563468(0x372)+_0x5d66dc+'/maxresdefault.jpg',_0xfc7688=new Image();_0xfc7688['onload']=async()=>{const _0x5b9995=_0x563468;data[_0x5b9995(0x4b9)][_0x5b9995(0x206)]=_0x25b878,await saveData(),applyCustomBg();},_0xfc7688['onerror']=async()=>{const _0x597540=_0x563468,_0x37e29c='https://img.youtube.com/vi/'+_0x5d66dc+_0x597540(0x367);data['settings'][_0x597540(0x206)]=_0x37e29c,await saveData(),applyCustomBg();},_0xfc7688[_0x563468(0x34f)]=_0x25b878;}else!_0x5d66dc&&(data[_0x563468(0x4b9)][_0x563468(0x206)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x5d66dc){fallbackStop(),hideSoundPermission();return;}const _0x4f9883=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x5d66dc,{'autoplay':0x1,'mute':_0x4f9883});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0x563468(0x293)]){try{ensureYouTubeAPI();}catch(_0x10b858){}return;}if(!_0x5d66dc){if(ytPlayer[_0x563468(0x3ca)])ytPlayer[_0x563468(0x3ca)]();hideSoundPermission();return;}ytPlayer[_0x563468(0x293)](_0x5d66dc),ytPlayer[_0x563468(0x46a)](data['settings']['youtubeVolume']);}function toggleYtSound(){const _0x1f3393=_0x52ca82;if(!_ytUnlocked){try{ensureAudio();}catch(_0x117b72){}try{unlockAudioChain();}catch(_0x19b266){}return;}if(IS_FILE_PROTOCOL){const _0x3a8882=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame['isConnected']){if(!_0x3a8882){toast(_0x1f3393(0x1ef));return;}fallbackLoadVideo(_0x3a8882,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x3ccea7=document[_0x1f3393(0x49c)]('btnToggleYtSound');if(_0x3ccea7)_0x3ccea7['textContent']='⏸️';}catch(_0x7034d7){}toast(_0x1f3393(0x361));return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0x1f3393(0x466)),ytFallbackIsPlaying=![],toast(_0x1f3393(0x2da));else{if(!_0x3a8882){toast(_0x1f3393(0x1ef));return;}fallbackPostMessage(_0x1f3393(0x30a)),ytFallbackIsPlaying=!![],toast(_0x1f3393(0x361));}try{const _0x122222=document[_0x1f3393(0x49c)](_0x1f3393(0x1c8));if(_0x122222)_0x122222['textContent']=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x23bf9e){}return;}if(!ytPlayer||typeof ytPlayer[_0x1f3393(0x472)]!=='function'){try{ensureYouTubeAPI();}catch(_0x4e8d7c){}return;}const _0x262e0e=ytPlayer[_0x1f3393(0x472)]();_0x262e0e===YT[_0x1f3393(0x1c9)][_0x1f3393(0x3fe)]||_0x262e0e===YT[_0x1f3393(0x1c9)][_0x1f3393(0x432)]?(ytFadeOutPause(),ytUserPaused=!![],toast(_0x1f3393(0x2da))):(ytFadeInPlay(),ytUserPaused=![],toast(_0x1f3393(0x361)));}function bindEvents(){const _0x45f7a4=_0x52ca82;try{const _0x4f8842=document[_0x45f7a4(0x4d1)](_0x45f7a4(0x360));_0x4f8842&&(_0x4f8842[_0x45f7a4(0x468)]=_0x45f7a4(0x208));}catch(_0x4eb022){}on($(_0x45f7a4(0x3de)),'click',toggleBackgroundView),on($(_0x45f7a4(0x1d4)),_0x45f7a4(0x422),()=>{const _0x10eda6=_0x45f7a4;$(_0x10eda6(0x1eb))[_0x10eda6(0x262)][_0x10eda6(0x28d)](_0x10eda6(0x227));try{releaseFocus();}catch(_0xa87e71){}}),on($('#btnAddTopic'),_0x45f7a4(0x422),()=>showInputModal('New\x20Topic\x20name?',async _0x190104=>{const _0x2bea51=_0x45f7a4;if(!_0x190104)return;data[_0x2bea51(0x269)][_0x2bea51(0x31c)]({'id':uid('t'),'name':_0x190104,'subtopics':[]}),await saveData(),renderTopics();})),on($(_0x45f7a4(0x207)),'click',()=>storageManager[_0x45f7a4(0x1fc)](data)),on($(_0x45f7a4(0x2ed)),_0x45f7a4(0x3e7),_0x3e5a7d=>{const _0x4ea811=_0x45f7a4,_0x40a770=_0x3e5a7d['target'][_0x4ea811(0x1cb)][0x0];if(!_0x40a770)return;storageManager[_0x4ea811(0x414)](_0x40a770)['then'](async _0x4ea4ee=>{const _0x24b78a=_0x4ea811;data=_0x4ea4ee,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x24b78a(0x394)),renderAll();})['catch'](_0x4ecc52=>toast(_0x4ea811(0x37f)+_0x4ecc52[_0x4ea811(0x3f9)])),_0x3e5a7d[_0x4ea811(0x1e2)][_0x4ea811(0x1ff)]=null;}),on($(_0x45f7a4(0x266)),_0x45f7a4(0x422),()=>{const _0x130fc2=_0x45f7a4,_0x20f5f5=$('#backupList'),_0x439a2c=_0x20f5f5?_0x20f5f5[_0x130fc2(0x1ff)]:'';if(!_0x439a2c){toast('Please\x20select\x20a\x20backup.');return;}showConfirmModal('Confirm\x20Restore',_0x130fc2(0x43e)+new Date(_0x439a2c)[_0x130fc2(0x395)]()+_0x130fc2(0x259),_0x4ca5e0=>{const _0x269347=_0x130fc2;_0x4ca5e0&&storageManager[_0x269347(0x314)](_0x439a2c)[_0x269347(0x340)](_0x403f7c=>{const _0x166275=_0x269347;data=_0x403f7c,toast('Data\x20restored\x20successfully!\x20Reloading...'),setTimeout(()=>window[_0x166275(0x2f6)][_0x166275(0x423)](),0x5dc);})[_0x269347(0x485)](_0x545e84=>{const _0x4277fb=_0x269347;toast(_0x4277fb(0x2b6)+_0x545e84[_0x4277fb(0x3f9)]);});});}),on($(_0x45f7a4(0x2ec)),'input',_0x2befe3=>{const _0x59521e=_0x45f7a4,_0x1b2eb0=_0x2befe3[_0x59521e(0x1e2)][_0x59521e(0x1ff)];applyTheme(_0x1b2eb0);if(_0x1b2eb0===_0x59521e(0x412)||_0x1b2eb0==='pastel'){const _0x43f281=$(_0x59521e(0x470));_0x43f281&&(_0x43f281['checked']=![],toast('Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.',0x7d0));try{document[_0x59521e(0x3ea)]['style'][_0x59521e(0x376)](_0x59521e(0x370),_0x59521e(0x1f6));}catch(_0x5565b2){}}else{const _0x401e65=$(_0x59521e(0x470));_0x401e65&&(_0x401e65['checked']=!![]);try{updateYouTubePlayer();}catch(_0x2a6747){}}}),on($(_0x45f7a4(0x3a0)),_0x45f7a4(0x422),openSettings),on($(_0x45f7a4(0x256)),_0x45f7a4(0x422),()=>{const _0x26d8e2=_0x45f7a4;switchView(_0x26d8e2(0x269)),$('#btnAddTopic')[_0x26d8e2(0x422)]();}),on($(_0x45f7a4(0x3f0)),_0x45f7a4(0x422),()=>{const _0x44881b=_0x45f7a4;renderDashboard(),$('#modalDashboard')[_0x44881b(0x262)][_0x44881b(0x2c0)](_0x44881b(0x227));}),on($(_0x45f7a4(0x43a)),_0x45f7a4(0x422),()=>{const _0x377806=_0x45f7a4;$('#modalDashboard')[_0x377806(0x262)][_0x377806(0x28d)]('show');}),on($(_0x45f7a4(0x4ce)),_0x45f7a4(0x422),closeSettings),on($(_0x45f7a4(0x49f)),_0x45f7a4(0x422),saveSettings),on($(_0x45f7a4(0x36e)),_0x45f7a4(0x422),setDefaults),on($('#btnTestSound'),_0x45f7a4(0x422),()=>{const _0x3e5268=_0x45f7a4;ensureAudio(),playSound(_0x3e5268(0x402));}),on($(_0x45f7a4(0x294)),_0x45f7a4(0x422),_0x2e60b3=>{const _0x231ab2=_0x45f7a4;_0x2e60b3[_0x231ab2(0x40f)]();const _0x46a88c=$('#customSoundsContainer');if(_0x46a88c)_0x46a88c[_0x231ab2(0x262)]['toggle'](_0x231ab2(0x2eb));}),on($(_0x45f7a4(0x2a9)),'click',async()=>{const _0x342782=_0x45f7a4,_0x49aec2=getCurrentSubtopic();if(!_0x49aec2)return;const _0x1cb2cc=pendingNoteSessionId,_0x37a4a1=_0x49aec2['sessions'][_0x342782(0x298)](_0xf239c=>_0xf239c['id']===_0x1cb2cc);_0x37a4a1&&(_0x37a4a1['note']=$('#noteText')['value'][_0x342782(0x251)](),await saveData(),renderStatsHistory(),toast(_0x342782(0x45a))),closeNoteModal();}),on($('#btnSkipNote'),'click',()=>closeNoteModal()),on($(_0x45f7a4(0x4bd)),_0x45f7a4(0x422),addGeneralNote),on($(_0x45f7a4(0x375)),'click',handleSummarizeNote),on($('#btnSendMessage'),_0x45f7a4(0x422),handleSendMessage),on($(_0x45f7a4(0x492)),_0x45f7a4(0x363),_0x15c4e4=>{const _0x2d88cb=_0x45f7a4;if(_0x15c4e4[_0x2d88cb(0x4b0)]==='Enter')handleSendMessage();}),$$('#aiPromptSuggestions\x20button')[_0x45f7a4(0x26c)](_0x38101f=>{on(_0x38101f,'click',()=>{const _0x8e4ea1=_0x1305,_0x4ac003=_0x38101f[_0x8e4ea1(0x445)][_0x8e4ea1(0x29c)];$(_0x8e4ea1(0x492))[_0x8e4ea1(0x1ff)]=_0x4ac003,$(_0x8e4ea1(0x492))['focus']();});}),on($(_0x45f7a4(0x241)),_0x45f7a4(0x422),clearChat),on($(_0x45f7a4(0x270)),_0x45f7a4(0x422),addSubtopicTask),on($('#newSubtopicTaskInput'),'keydown',_0x2a1b8d=>{if(_0x2a1b8d['key']==='Enter')addSubtopicTask();}),on($(_0x45f7a4(0x2a4)),_0x45f7a4(0x422),toggleYtSound),on($(_0x45f7a4(0x257)),_0x45f7a4(0x422),()=>{ensureAudio(),unlockAudioChain();}),on($(_0x45f7a4(0x306)),'input',_0x337b7d=>{const _0xbb0d72=_0x45f7a4,_0x44569b=parseInt(_0x337b7d[_0xbb0d72(0x1e2)][_0xbb0d72(0x1ff)],0xa);ytPlayer&&ytPlayer['setVolume']&&ytPlayer[_0xbb0d72(0x46a)](_0x44569b);}),on($(_0x45f7a4(0x420)),_0x45f7a4(0x366),handleYoutubeUrlInput),$$(_0x45f7a4(0x460))[_0x45f7a4(0x26c)](_0x398bf8=>{const _0x5b13f7=_0x45f7a4;_0x398bf8[_0x5b13f7(0x459)](_0x5b13f7(0x422),()=>{const _0x32e891=_0x5b13f7,_0x5dd2a5=_0x398bf8[_0x32e891(0x445)][_0x32e891(0x278)],_0x2e251b=data?.['settings']?.[_0x32e891(0x44b)]||_0x32e891(0x23b);if(_0x2e251b===_0x5dd2a5&&_0x5dd2a5!=='timer')switchView(_0x32e891(0x23b));else switchView(_0x5dd2a5);});}),$$(_0x45f7a4(0x464))['forEach'](_0x5be376=>{const _0xa3b06f=_0x45f7a4;_0x5be376[_0xa3b06f(0x459)](_0xa3b06f(0x422),()=>{const _0x2b79fa=_0xa3b06f,_0x5a7386=_0x5be376['dataset'][_0x2b79fa(0x3b8)],_0x567ac3=_0x5be376['closest'](_0x2b79fa(0x277));if(!_0x567ac3)return;_0x567ac3[_0x2b79fa(0x338)](_0x2b79fa(0x464))['forEach'](_0x43a4a5=>_0x43a4a5[_0x2b79fa(0x262)]['remove'](_0x2b79fa(0x2b5))),_0x5be376[_0x2b79fa(0x262)][_0x2b79fa(0x2c0)](_0x2b79fa(0x2b5)),_0x567ac3['querySelectorAll'](_0x2b79fa(0x3df))[_0x2b79fa(0x26c)](_0x5e2db8=>{const _0x365ad4=_0x2b79fa;_0x5e2db8[_0x365ad4(0x262)][_0x365ad4(0x28d)](_0x365ad4(0x2b5)),_0x5e2db8[_0x365ad4(0x2b8)][_0x365ad4(0x49e)]=_0x365ad4(0x1f6);});const _0xe9890b=_0x567ac3[_0x2b79fa(0x4d1)]('#'+_0x5a7386);_0xe9890b&&(_0xe9890b[_0x2b79fa(0x262)][_0x2b79fa(0x2c0)](_0x2b79fa(0x2b5)),_0xe9890b[_0x2b79fa(0x2b8)][_0x2b79fa(0x49e)]=_0x2b79fa(0x351),_0x567ac3['closest'](_0x2b79fa(0x4d3))&&(_0xe9890b[_0x2b79fa(0x2b8)][_0x2b79fa(0x49e)]=_0x2b79fa(0x2f3)));});});const _0x381646=$('#methodEditorContentInput');function _0x2c7376(_0x27cd71,_0x1cdbed=null){const _0x5edc44=_0x45f7a4;try{document['execCommand'](_0x5edc44(0x211),![],!![]);}catch(_0x2b2e56){}try{document[_0x5edc44(0x4ac)](_0x27cd71,![],_0x1cdbed);}catch(_0x952810){}if(_0x381646)_0x381646['focus']();}on($(_0x45f7a4(0x3e6)),_0x45f7a4(0x422),()=>_0x2c7376(_0x45f7a4(0x46d))),on($(_0x45f7a4(0x3dc)),_0x45f7a4(0x422),()=>_0x2c7376(_0x45f7a4(0x263))),on($(_0x45f7a4(0x30c)),'click',()=>_0x2c7376(_0x45f7a4(0x4de),_0x45f7a4(0x32f))),on($(_0x45f7a4(0x3a2)),_0x45f7a4(0x422),()=>_0x2c7376(_0x45f7a4(0x1fb))),on($(_0x45f7a4(0x4ad)),_0x45f7a4(0x422),()=>_0x2c7376(_0x45f7a4(0x2cf)));const _0x906c19=$(_0x45f7a4(0x27c)),_0x588930=$(_0x45f7a4(0x312));on($(_0x45f7a4(0x4e0)),'click',_0x52220c=>{const _0x434c9e=_0x45f7a4;if(!_0x588930)return;_0x52220c[_0x434c9e(0x41f)](),_0x588930[_0x434c9e(0x262)]['toggle'](_0x434c9e(0x2eb));}),$$('.color-swatch')[_0x45f7a4(0x26c)](_0x338928=>{const _0x562233=_0x45f7a4;on(_0x338928,_0x562233(0x422),_0x398be0=>{const _0x441ad3=_0x562233;_0x398be0[_0x441ad3(0x40f)]();const _0x265e49=_0x338928['dataset'][_0x441ad3(0x45c)]||'';let _0x2b813e=_0x265e49;try{const _0x1138f1=_0x265e49[_0x441ad3(0x2ba)](/--[a-zA-Z0-9_-]+/);if(_0x1138f1)_0x2b813e=getComputedStyle(document[_0x441ad3(0x3ea)])[_0x441ad3(0x3d7)](_0x1138f1[0x0])[_0x441ad3(0x251)]();}catch(_0x3a49ea){}_0x2c7376(_0x441ad3(0x399),_0x2b813e);if(_0x588930)_0x588930[_0x441ad3(0x262)]['add'](_0x441ad3(0x2eb));});}),on(document,_0x45f7a4(0x422),_0x3c215e=>{const _0x1c130a=_0x45f7a4;if(!_0x906c19||!_0x588930)return;!_0x906c19[_0x1c130a(0x4a0)](_0x3c215e['target'])&&!_0x588930['classList'][_0x1c130a(0x4a0)](_0x1c130a(0x2eb))&&_0x588930[_0x1c130a(0x262)][_0x1c130a(0x2c0)](_0x1c130a(0x2eb));});function _0x346fb9(_0x519209){const _0x5a9b98=_0x45f7a4,_0x1d6ae1=getCurrentSubtopic();if(!_0x1d6ae1){toast(_0x5a9b98(0x2e0));return;}const _0x5a6727=Array[_0x5a9b98(0x39b)](_0x1d6ae1[_0x5a9b98(0x1dd)])?_0x1d6ae1[_0x5a9b98(0x1dd)]:[],_0x11dc94=_0x519209?_0x5a6727[_0x5a9b98(0x298)](_0x38a2ea=>_0x38a2ea['id']===_0x519209):null;$(_0x5a9b98(0x221))['value']=_0x11dc94&&_0x11dc94['id']||'',$(_0x5a9b98(0x441))[_0x5a9b98(0x4a4)]=_0x11dc94?_0x5a9b98(0x1d9):'Add\x20New\x20Knowledge',$(_0x5a9b98(0x390))[_0x5a9b98(0x1ff)]=_0x11dc94&&_0x11dc94[_0x5a9b98(0x47a)]||'';const _0x356fc7=$(_0x5a9b98(0x421));if(_0x356fc7)_0x356fc7['innerHTML']=_0x11dc94&&_0x11dc94[_0x5a9b98(0x3f3)]||'';$(_0x5a9b98(0x308))['classList']['add']('show');try{trapFocus($(_0x5a9b98(0x308)));}catch(_0x27d5ea){}try{const _0x1a922d=$(_0x5a9b98(0x4a2));if(_0x1a922d){const _0x341364=!!(data?.[_0x5a9b98(0x4b9)]?.['apiKey']&&data[_0x5a9b98(0x4b9)][_0x5a9b98(0x4a6)]['trim']());_0x1a922d[_0x5a9b98(0x329)]=!_0x341364,_0x1a922d[_0x5a9b98(0x47a)]=_0x341364?_0x5a9b98(0x225):_0x5a9b98(0x272);}}catch(_0x105833){}}on($(_0x45f7a4(0x4e2)),_0x45f7a4(0x422),()=>{const _0xfd025=_0x45f7a4;$('#modalMethodEditor')[_0xfd025(0x262)][_0xfd025(0x28d)]('show');try{releaseFocus();}catch(_0x33ab71){}}),on($(_0x45f7a4(0x2ae)),_0x45f7a4(0x422),async()=>{const _0xec9390=_0x45f7a4,_0x2eeaae=$('#methodEditorId')[_0xec9390(0x1ff)]||uid('m'),_0x5a222b=($(_0xec9390(0x390))['value']||'')[_0xec9390(0x251)](),_0x23edf3=$('#methodEditorContentInput'),_0x56303b=_0x23edf3?_0x23edf3['innerHTML']||'':'',_0x19adec=getCurrentSubtopic();if(!_0x19adec){toast(_0xec9390(0x2e0));return;}if(!Array[_0xec9390(0x39b)](_0x19adec[_0xec9390(0x1dd)]))_0x19adec[_0xec9390(0x1dd)]=[];const _0x520048=_0x19adec[_0xec9390(0x1dd)][_0xec9390(0x4e4)](_0x18ce98=>_0x18ce98['id']===_0x2eeaae),_0x3e4b02={'id':_0x2eeaae,'title':_0x5a222b,'content':_0x56303b};if(_0x520048>=0x0)_0x19adec[_0xec9390(0x1dd)][_0x520048]=_0x3e4b02;else _0x19adec[_0xec9390(0x1dd)][_0xec9390(0x22b)](_0x3e4b02);await saveData(),renderMethods(),$(_0xec9390(0x308))[_0xec9390(0x262)][_0xec9390(0x28d)]('show');try{releaseFocus();}catch(_0x2870ba){}}),on($(_0x45f7a4(0x4a2)),_0x45f7a4(0x422),async()=>{const _0x4e7eeb=_0x45f7a4,_0x3f9db5=$(_0x4e7eeb(0x421));if(!_0x3f9db5)return;const _0x8b16b6=(_0x3f9db5['textContent']||'')[_0x4e7eeb(0x251)]();if(!_0x8b16b6||_0x8b16b6[_0x4e7eeb(0x2ca)]<0x14){toast('Content\x20required\x20for\x20AI\x20formatting.');return;}const _0x422bb3=$(_0x4e7eeb(0x4a2));_0x422bb3&&(_0x422bb3['disabled']=!![],_0x422bb3[_0x4e7eeb(0x468)]='<div\x20class=\x22spinner\x22></div>');const _0x4a265e=_0x4e7eeb(0x346)+_0x8b16b6+'\x22',_0x397a37=await callGeminiAPI(_0x4a265e);_0x397a37?(_0x3f9db5[_0x4e7eeb(0x468)]=_0x397a37,toast(_0x4e7eeb(0x252))):toast(_0x4e7eeb(0x28c)),_0x422bb3&&(_0x422bb3['disabled']=![],_0x422bb3[_0x4e7eeb(0x468)]='✨\x20Auto-format');}),on($(_0x45f7a4(0x43b)),_0x45f7a4(0x422),()=>_0x346fb9());const _0x597790=document[_0x45f7a4(0x4d1)](_0x45f7a4(0x398));_0x597790&&_0x597790[_0x45f7a4(0x459)](_0x45f7a4(0x422),_0x4e9dff=>{const _0x5d081e=_0x45f7a4,_0x1372b1=_0x4e9dff[_0x5d081e(0x1e2)][_0x5d081e(0x442)]&&_0x4e9dff[_0x5d081e(0x1e2)][_0x5d081e(0x442)](_0x5d081e(0x220)),_0x4c8ce5=!_0x1372b1&&_0x4e9dff['target'][_0x5d081e(0x442)]&&_0x4e9dff[_0x5d081e(0x1e2)][_0x5d081e(0x442)](_0x5d081e(0x418));if(_0x1372b1){_0x4e9dff[_0x5d081e(0x40f)](),_0x4e9dff[_0x5d081e(0x41f)]();const _0x1b8f1d=_0x1372b1[_0x5d081e(0x445)]['id'];if(_0x1b8f1d)_0x346fb9(_0x1b8f1d);return;}if(_0x4c8ce5){_0x4e9dff['preventDefault'](),_0x4e9dff['stopPropagation']();const _0x1123eb=_0x4c8ce5['dataset']['id'];if(!_0x1123eb)return;const _0x598297=getCurrentSubtopic();if(!_0x598297){toast(_0x5d081e(0x2e0));return;}const _0xe63cdf=Array['isArray'](_0x598297['methods'])?_0x598297[_0x5d081e(0x1dd)]:[],_0x5e878e=_0xe63cdf[_0x5d081e(0x298)](_0x3289e7=>_0x3289e7['id']===_0x1123eb);if(!_0x5e878e)return;showConfirmModal(_0x5d081e(0x3bd),_0x5d081e(0x491)+(_0x5e878e[_0x5d081e(0x47a)]||'')+'\x22?',async _0x371279=>{if(!_0x371279)return;_0x598297['methods']=_0xe63cdf['filter'](_0x53795e=>_0x53795e['id']!==_0x1123eb),await saveData(),renderMethods();});}});$$(_0x45f7a4(0x1e3))[_0x45f7a4(0x26c)](_0x444a6b=>{const _0x122d7a=_0x45f7a4;_0x444a6b[_0x122d7a(0x459)](_0x122d7a(0x422),()=>{const _0x29116b=_0x122d7a;editingPreset=_0x444a6b[_0x29116b(0x445)][_0x29116b(0x3a4)],highlightPresetSelector(),loadEditingPresetFields();});}),$$(_0x45f7a4(0x494))[_0x45f7a4(0x26c)](_0xd3a5e6=>{_0xd3a5e6['addEventListener']('click',_0x3decd4=>{const _0x311554=_0x1305,_0x5e71c6=_0x3decd4['target'][_0x311554(0x445)][_0x311554(0x2fc)],_0x11b51b=data[_0x311554(0x4b9)][_0x311554(0x2fc)];if(_0x5e71c6===_0x11b51b)return;timer[_0x311554(0x41c)]!=='idle'?showConfirmModal(_0x311554(0x33c),_0x311554(0x371)+_0x5e71c6+_0x311554(0x20f),_0x134b0c=>{const _0x251d5e=_0x311554;_0x134b0c&&(timer['reset'](),timer['setPreset'](_0x5e71c6),renderAll(),toast(_0x251d5e(0x2e2)+_0x5e71c6+'.'));}):(timer[_0x311554(0x44e)](_0x5e71c6),renderAll(),toast(_0x311554(0x2e2)+_0x5e71c6+'.'));});}),on($(_0x45f7a4(0x214)),_0x45f7a4(0x422),()=>timer[_0x45f7a4(0x35b)]()),on($(_0x45f7a4(0x26f)),_0x45f7a4(0x422),()=>timer[_0x45f7a4(0x24a)]()),on($('#btnPause'),'click',()=>timer[_0x45f7a4(0x3c8)]()),on($(_0x45f7a4(0x302)),_0x45f7a4(0x422),()=>timer[_0x45f7a4(0x2a8)]()),on($(_0x45f7a4(0x48d)),_0x45f7a4(0x422),()=>timer[_0x45f7a4(0x36c)]()),on($(_0x45f7a4(0x44d)),'click',()=>timer[_0x45f7a4(0x35c)]()),on($(_0x45f7a4(0x22f)),_0x45f7a4(0x422),()=>timer[_0x45f7a4(0x255)]()),on($(_0x45f7a4(0x46e)),'change',_0x1dffd3=>{const _0x99e05f=_0x45f7a4;handleFileUpload(_0x1dffd3[_0x99e05f(0x1e2)][_0x99e05f(0x1cb)][0x0],async _0x3ee0b0=>{const _0x1fbf01=_0x99e05f;data['settings'][_0x1fbf01(0x206)]=_0x3ee0b0,await saveData(),applyCustomBg(),toast(_0x1fbf01(0x4d7));}),_0x1dffd3[_0x99e05f(0x1e2)][_0x99e05f(0x1ff)]=null;}),on($(_0x45f7a4(0x25e)),_0x45f7a4(0x422),async()=>{const _0x17c8a9=_0x45f7a4;data['settings'][_0x17c8a9(0x206)]='',data[_0x17c8a9(0x4b9)][_0x17c8a9(0x38b)]=![],await saveData(),applyCustomBg(),toast('Custom\x20background\x20removed.'),$(_0x17c8a9(0x4d3))[_0x17c8a9(0x262)][_0x17c8a9(0x4a0)](_0x17c8a9(0x227))&&openSettings();}),on($(_0x45f7a4(0x4d6)),_0x45f7a4(0x3e7),_0x3aa2b5=>{const _0x396d8d=_0x45f7a4;handleFileUpload(_0x3aa2b5[_0x396d8d(0x1e2)][_0x396d8d(0x1cb)][0x0],async _0x3f8113=>{const _0x159d8e=_0x396d8d;data[_0x159d8e(0x4b9)][_0x159d8e(0x1e8)][_0x159d8e(0x402)]=_0x3f8113,await saveData(),toast('Saved\x20alert\x20for\x20FOCUS.');}),_0x3aa2b5[_0x396d8d(0x1e2)][_0x396d8d(0x1ff)]=null;}),on($(_0x45f7a4(0x3a9)),_0x45f7a4(0x3e7),_0x118adb=>{const _0x5351f5=_0x45f7a4;handleFileUpload(_0x118adb[_0x5351f5(0x1e2)][_0x5351f5(0x1cb)][0x0],async _0x1e40c8=>{const _0x2c15e7=_0x5351f5;data[_0x2c15e7(0x4b9)][_0x2c15e7(0x1e8)][_0x2c15e7(0x4dc)]=_0x1e40c8,await saveData(),toast(_0x2c15e7(0x2e4));}),_0x118adb[_0x5351f5(0x1e2)][_0x5351f5(0x1ff)]=null;}),on($(_0x45f7a4(0x385)),'change',_0x203283=>{const _0x16bf5f=_0x45f7a4;handleFileUpload(_0x203283['target'][_0x16bf5f(0x1cb)][0x0],async _0x59c7f7=>{const _0x571d24=_0x16bf5f;data['settings']['customSounds'][_0x571d24(0x3c0)]=_0x59c7f7,await saveData(),toast(_0x571d24(0x47c));}),_0x203283[_0x16bf5f(0x1e2)][_0x16bf5f(0x1ff)]=null;}),on($('#btnFullscreen'),_0x45f7a4(0x422),toggleFullScreen),document[_0x45f7a4(0x459)](_0x45f7a4(0x21b),updateFullscreenButton),window[_0x45f7a4(0x459)](_0x45f7a4(0x363),_0x50e3bd=>{const _0x1a0fac=_0x45f7a4,_0x3b7448=(_0x50e3bd[_0x1a0fac(0x1e2)]['tagName']||'')[_0x1a0fac(0x3b0)](),_0x46d84c=['input',_0x1a0fac(0x20b),_0x1a0fac(0x2cc)]['includes'](_0x3b7448);if(_0x50e3bd[_0x1a0fac(0x244)]===_0x1a0fac(0x434)&&!_0x46d84c){_0x50e3bd[_0x1a0fac(0x40f)]();if(timer[_0x1a0fac(0x41c)]==='idle'||timer[_0x1a0fac(0x41c)]===_0x1a0fac(0x209))timer[_0x1a0fac(0x35b)]();else timer[_0x1a0fac(0x3c8)]();}(_0x50e3bd[_0x1a0fac(0x4b0)]==='n'||_0x50e3bd[_0x1a0fac(0x4b0)]==='N')&&(!_0x46d84c&&(_0x50e3bd[_0x1a0fac(0x40f)](),timer['skip']()));if(_0x50e3bd['key']==='Escape'){$$(_0x1a0fac(0x358))[_0x1a0fac(0x26c)](_0x5087b0=>_0x5087b0['classList'][_0x1a0fac(0x28d)](_0x1a0fac(0x227)));try{releaseFocus();}catch(_0xe0fac){}}if(_0x50e3bd[_0x1a0fac(0x462)]&&!_0x46d84c){if(_0x50e3bd[_0x1a0fac(0x4b0)]==='ArrowUp')_0x50e3bd['preventDefault'](),_0x4d62d9(0x0,-0xa);else{if(_0x50e3bd[_0x1a0fac(0x4b0)]==='ArrowDown')_0x50e3bd[_0x1a0fac(0x40f)](),_0x4d62d9(0x0,0xa);else{if(_0x50e3bd[_0x1a0fac(0x4b0)]==='ArrowLeft')_0x50e3bd[_0x1a0fac(0x40f)](),_0x4d62d9(-0xa,0x0);else _0x50e3bd[_0x1a0fac(0x4b0)]===_0x1a0fac(0x43c)&&(_0x50e3bd['preventDefault'](),_0x4d62d9(0xa,0x0));}}}}),$$(_0x45f7a4(0x358))[_0x45f7a4(0x26c)](_0x3c16f8=>_0x3c16f8[_0x45f7a4(0x459)]('click',_0x43246b=>{const _0x2c222c=_0x45f7a4;if(_0x43246b&&_0x43246b[_0x2c222c(0x1e2)]&&_0x43246b[_0x2c222c(0x1e2)]['id']==='modalMethodEditor')return;if(_0x43246b[_0x2c222c(0x1e2)]===_0x3c16f8){_0x3c16f8[_0x2c222c(0x262)]['remove'](_0x2c222c(0x227));try{releaseFocus();}catch(_0x46ac91){}}})),window['addEventListener'](_0x45f7a4(0x422),_0x43676a=>{const _0x3973ad=_0x45f7a4;!_0x43676a[_0x3973ad(0x1e2)]['closest'](_0x3973ad(0x4e7))&&!_0x43676a['target'][_0x3973ad(0x442)](_0x3973ad(0x389))&&closeAllMenus();});try{const _0x540385=document[_0x45f7a4(0x4d1)]('.app-content');if(_0x540385)_0x540385[_0x45f7a4(0x459)](_0x45f7a4(0x1c7),closeAllMenus);}catch(_0x4daa1d){}try{window['addEventListener'](_0x45f7a4(0x1c7),closeAllMenus,!![]);}catch(_0x492caf){}window[_0x45f7a4(0x459)](_0x45f7a4(0x261),()=>timer['persistTimerState'](!![]));try{const _0x560cc5=Array[_0x45f7a4(0x377)](document[_0x45f7a4(0x338)]('#view-methods\x20.method-item'));_0x560cc5['length']&&_0x560cc5[_0x45f7a4(0x26c)](_0x2e9de5=>{const _0x3fa934=_0x45f7a4;_0x2e9de5[_0x3fa934(0x459)](_0x3fa934(0x237),()=>{_0x2e9de5['open']&&_0x560cc5['forEach'](_0x11f367=>{const _0x36e2a2=_0x1305;if(_0x11f367!==_0x2e9de5)_0x11f367[_0x36e2a2(0x3f4)]=![];});});});}catch(_0x45c155){}const _0x37c24c=$(_0x45f7a4(0x4b8));let _0x305983=![],_0x417933,_0x3e0b43;_0x37c24c&&(_0x37c24c[_0x45f7a4(0x459)](_0x45f7a4(0x2de),_0x208ad9=>{const _0x34c169=_0x45f7a4;_0x305983=!![];const _0xee5a57=_0x37c24c[_0x34c169(0x2c9)]();_0x417933=_0x208ad9[_0x34c169(0x3e0)]-_0xee5a57['left'],_0x3e0b43=_0x208ad9[_0x34c169(0x3fd)]-_0xee5a57[_0x34c169(0x4c8)],_0x37c24c['style'][_0x34c169(0x387)]=_0x34c169(0x1f6);}),document[_0x45f7a4(0x459)](_0x45f7a4(0x246),_0x234765=>{const _0x31730d=_0x45f7a4;if(!_0x305983)return;let _0x17376a=_0x234765[_0x31730d(0x3e0)]-_0x417933,_0x41f528=_0x234765[_0x31730d(0x3fd)]-_0x3e0b43;const _0x1b70fc=window[_0x31730d(0x267)]-_0x37c24c[_0x31730d(0x1e6)],_0x17469b=window[_0x31730d(0x218)]-_0x37c24c[_0x31730d(0x48a)];_0x17376a=Math[_0x31730d(0x425)](0x0,Math[_0x31730d(0x31f)](_0x17376a,_0x1b70fc)),_0x41f528=Math['max'](0x0,Math[_0x31730d(0x31f)](_0x41f528,_0x17469b)),_0x37c24c[_0x31730d(0x2b8)][_0x31730d(0x48b)]=_0x17376a+'px',_0x37c24c['style'][_0x31730d(0x4c8)]=_0x41f528+'px',_0x37c24c[_0x31730d(0x2b8)][_0x31730d(0x210)]=_0x31730d(0x2cb),_0x37c24c[_0x31730d(0x2b8)][_0x31730d(0x234)]=_0x31730d(0x2cb);}),document[_0x45f7a4(0x459)](_0x45f7a4(0x39f),()=>{const _0x1ae5f9=_0x45f7a4;if(!_0x305983)return;_0x305983=![],_0x37c24c[_0x1ae5f9(0x2b8)]['transition']='';}));function _0x121f64(_0x1440f0){const _0x238a83=_0x45f7a4,_0x24aad6=$('#draggableTimer');if(!_0x24aad6)return;_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x2c4)]=_0x238a83(0x317),_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x387)]='',_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x48b)]=_0x238a83(0x2cb),_0x24aad6['style'][_0x238a83(0x4c8)]=_0x238a83(0x2cb),_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x234)]=_0x238a83(0x2cb),_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x210)]='auto';const _0x2407cb=0x10;_0x1440f0==='tl'&&(_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x48b)]=_0x2407cb+'px',_0x24aad6[_0x238a83(0x2b8)]['top']=_0x2407cb+'px'),_0x1440f0==='tr'&&(_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x234)]=_0x2407cb+'px',_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x4c8)]=_0x2407cb+'px'),_0x1440f0==='bl'&&(_0x24aad6[_0x238a83(0x2b8)]['left']=_0x2407cb+'px',_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x210)]=_0x2407cb+'px'),_0x1440f0==='br'&&(_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x234)]=_0x2407cb+'px',_0x24aad6[_0x238a83(0x2b8)][_0x238a83(0x210)]=_0x2407cb+'px');}function _0x4d62d9(_0x51f088,_0x518d1f){const _0x194e59=_0x45f7a4,_0x4c35c6=$(_0x194e59(0x4b8));if(!_0x4c35c6)return;const _0x25184b=_0x4c35c6[_0x194e59(0x2c9)](),_0x12b9ea=Math[_0x194e59(0x425)](0x0,Math[_0x194e59(0x31f)](_0x25184b['left']+_0x51f088,window[_0x194e59(0x267)]-_0x4c35c6[_0x194e59(0x1e6)])),_0x2b2689=Math[_0x194e59(0x425)](0x0,Math[_0x194e59(0x31f)](_0x25184b[_0x194e59(0x4c8)]+_0x518d1f,window['innerHeight']-_0x4c35c6[_0x194e59(0x48a)]));_0x4c35c6['style'][_0x194e59(0x48b)]=_0x12b9ea+'px',_0x4c35c6[_0x194e59(0x2b8)][_0x194e59(0x4c8)]=_0x2b2689+'px',_0x4c35c6['style'][_0x194e59(0x234)]=_0x194e59(0x2cb),_0x4c35c6[_0x194e59(0x2b8)][_0x194e59(0x210)]=_0x194e59(0x2cb);}}function toggleBackgroundView(){const _0x41fd08=_0x52ca82,_0x26b1d5=document[_0x41fd08(0x3ea)];_0x26b1d5[_0x41fd08(0x262)][_0x41fd08(0x237)]('bg-view-mode');const _0x1d9074=_0x26b1d5['classList'][_0x41fd08(0x4a0)](_0x41fd08(0x238)),_0x167536=$(_0x41fd08(0x3de));if(!_0x167536)return;_0x1d9074?(_0x167536['title']=_0x41fd08(0x48e),_0x167536[_0x41fd08(0x468)]=_0x41fd08(0x3b5)):(_0x167536[_0x41fd08(0x47a)]='Hide\x20interface',_0x167536['innerHTML']='<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>');}function updateMainViewVisibility(){const _0x3c4179=_0x52ca82,_0x25000f=!!getCurrentSubtopic(),_0x36d37f=$('#view-timer'),_0x18af48=$(_0x3c4179(0x2b2));_0x18af48&&_0x18af48[_0x3c4179(0x262)][_0x3c4179(0x237)](_0x3c4179(0x2eb),_0x25000f),_0x36d37f&&(_0x25000f?_0x36d37f[_0x3c4179(0x262)][_0x3c4179(0x28d)](_0x3c4179(0x3d5)):_0x36d37f[_0x3c4179(0x262)][_0x3c4179(0x2c0)]('no-subtopic-selected'));}function updatePresetButtonsText(){const _0x1225ad=_0x52ca82,_0x413bbf=data[_0x1225ad(0x4b9)],_0x510751=_0x413bbf[_0x1225ad(0x3b7)],_0x104d0c=_0x413bbf[_0x1225ad(0x455)],_0x58f2f8=_0x413bbf['durations']['A_work'],_0xa90a89=_0x413bbf['durations'][_0x1225ad(0x1c3)],_0x743078=$(_0x1225ad(0x1e4)),_0x1ec94a=$('#btnPresetB'),_0x3fcdf5=$(_0x1225ad(0x4c2));_0x743078&&(_0x743078[_0x1225ad(0x4a4)]=_0x510751+'×'+_0x58f2f8+_0x1225ad(0x396)),_0x1ec94a&&(_0x1ec94a[_0x1225ad(0x4a4)]=_0x104d0c+'×'+_0xa90a89+_0x1225ad(0x2d5)),_0x3fcdf5&&(_0x3fcdf5[_0x1225ad(0x4a4)]=_0x1225ad(0x475));}function renderAll(){const _0x2fa243=_0x52ca82;updatePresetButtonsText();const _0x31e8fa=data[_0x2fa243(0x4b9)]['preset'];$$(_0x2fa243(0x494))[_0x2fa243(0x26c)](_0x393c5e=>{const _0x2b3fbd=_0x2fa243,_0x9fb786=_0x393c5e['dataset'][_0x2b3fbd(0x2fc)]===_0x31e8fa;_0x393c5e[_0x2b3fbd(0x262)]['toggle']('acc',_0x9fb786),_0x393c5e[_0x2b3fbd(0x262)]['toggle'](_0x2b3fbd(0x24b),!_0x9fb786),_0x393c5e[_0x2b3fbd(0x3a6)]('aria-pressed',_0x9fb786);}),updateMainViewVisibility(),timer['setPreset'](data[_0x2fa243(0x4b9)]['preset'],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x2fa243(0x4b9)][_0x2fa243(0x44b)]);}function toggleFullScreen(){const _0x587580=_0x52ca82;!document[_0x587580(0x2b0)]?document[_0x587580(0x2dd)][_0x587580(0x2f2)]()[_0x587580(0x485)](_0x219883=>{const _0x90f539=_0x587580;toast(_0x90f539(0x45e)+_0x219883[_0x90f539(0x3f9)]);}):document[_0x587580(0x3fa)]&&document[_0x587580(0x3fa)]();}function updateFullscreenButton(){const _0x446514=_0x52ca82,_0x432a7e=$(_0x446514(0x39e));document[_0x446514(0x2b0)]?(_0x432a7e['innerHTML']='↙',_0x432a7e['title']=_0x446514(0x487)):(_0x432a7e[_0x446514(0x468)]='↗',_0x432a7e[_0x446514(0x47a)]=_0x446514(0x3db));}async function initializeApp(){const _0x51d015=_0x52ca82;try{await storageManager[_0x51d015(0x1c5)]();const [_0x1f0323,_0x2cdf52,_0x5a5669]=await Promise[_0x51d015(0x45f)]([storageManager[_0x51d015(0x4d0)](),storageManager['getAll'](_0x51d015(0x269)),storageManager[_0x51d015(0x382)]('subtopics')]);let _0x30fdd8;if(!_0x1f0323){const _0x3610e4=JSON['parse'](JSON[_0x51d015(0x2f8)](defaults));await storageManager[_0x51d015(0x1fe)](_0x3610e4['settings']);for(const _0x4b8562 of _0x3610e4[_0x51d015(0x269)]){const {subtopics:_0xa9fcd6,..._0x14857d}=_0x4b8562;await storageManager[_0x51d015(0x2c0)](_0x51d015(0x269),_0x14857d);for(const _0x40d6f8 of _0xa9fcd6){await storageManager[_0x51d015(0x2c0)]('subtopics',{..._0x40d6f8,'topicId':_0x4b8562['id']});}}_0x30fdd8=_0x3610e4;}else{const _0x6fcd13={};for(const _0x51619e of _0x2cdf52)_0x6fcd13[_0x51619e['id']]={..._0x51619e,'subtopics':[]};for(const _0x194722 of _0x5a5669)_0x6fcd13[_0x194722[_0x51d015(0x304)]]?.['subtopics'][_0x51d015(0x31c)](_0x194722);_0x30fdd8={'version':defaults[_0x51d015(0x24e)],'settings':_0x1f0323,'topics':Object[_0x51d015(0x2f5)](_0x6fcd13)};}data=window[_0x51d015(0x28a)]=_0x30fdd8,normalizeDataStructure(data),await ensureValidSelection(),await migrateSharedMethodsToCurrentSubtopic(),await seedAchievedMilestones(),renderAll();try{storageManager['autoBackup'](data);}catch(_0x55630f){console[_0x51d015(0x42b)](_0x51d015(0x2bd),_0x55630f);}bindEvents(),applyTheme();}catch(_0x815c2f){console['error'](_0x51d015(0x4dd),_0x815c2f),toast(_0x51d015(0x26d)+_0x815c2f['message']);}}callGeminiAPI=async function(_0x23677e,_0x545a1c=0x3,_0x417e3e=0x3e8){const _0x4fe4ab=_0x52ca82,_0x14ca74=data?.[_0x4fe4ab(0x4b9)]?.[_0x4fe4ab(0x4a6)]||'';if(!_0x14ca74)return toast('Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.'),null;const _0x268a27=_0x4fe4ab(0x4c6)+_0x14ca74,_0x1eee84={'contents':[{'role':_0x4fe4ab(0x2ab),'parts':[{'text':_0x23677e}]}]};try{const _0x6abfc8=await fetch(_0x268a27,{'method':_0x4fe4ab(0x2fd),'headers':{'Content-Type':_0x4fe4ab(0x33a)},'body':JSON[_0x4fe4ab(0x2f8)](_0x1eee84)});if(!_0x6abfc8['ok']){if(_0x6abfc8[_0x4fe4ab(0x228)]===0x1ad&&_0x545a1c>0x0)return await new Promise(_0x17768d=>setTimeout(_0x17768d,_0x417e3e)),callGeminiAPI(_0x23677e,_0x545a1c-0x1,_0x417e3e*0x2);let _0x349f85=null;try{_0x349f85=await _0x6abfc8['json']();}catch(_0x987553){}let _0x4a4c35=_0x4fe4ab(0x42d)+_0x6abfc8[_0x4fe4ab(0x228)];if(_0x6abfc8['status']===0x190)_0x4a4c35=_0x4fe4ab(0x3ef);else{if(_0x6abfc8[_0x4fe4ab(0x228)]===0x1ad)_0x4a4c35=_0x4fe4ab(0x20e);else _0x349f85?.[_0x4fe4ab(0x2fb)]?.[_0x4fe4ab(0x3f9)]&&(_0x4a4c35=_0x4fe4ab(0x26e)+_0x349f85[_0x4fe4ab(0x2fb)][_0x4fe4ab(0x3f9)]);}return toast(_0x4a4c35,0xfa0),console[_0x4fe4ab(0x2fb)](_0x4fe4ab(0x283),_0x349f85||_0x6abfc8[_0x4fe4ab(0x40a)]),null;}const _0xde4a28=await _0x6abfc8['json']();if(_0xde4a28[_0x4fe4ab(0x3fb)]&&_0xde4a28[_0x4fe4ab(0x3fb)][0x0]?.[_0x4fe4ab(0x3f3)]?.['parts']?.[0x0]?.[_0x4fe4ab(0x469)])return formatGeminiResponse(_0xde4a28['candidates'][0x0][_0x4fe4ab(0x3f3)][_0x4fe4ab(0x3e8)][0x0][_0x4fe4ab(0x469)]);else{console[_0x4fe4ab(0x2fb)](_0x4fe4ab(0x2bb),_0xde4a28);if(_0xde4a28[_0x4fe4ab(0x40b)]?.[_0x4fe4ab(0x30b)])return _0x4fe4ab(0x31b)+_0xde4a28[_0x4fe4ab(0x40b)][_0x4fe4ab(0x30b)]+'.\x20Please\x20try\x20again\x20with\x20different\x20content.';return _0x4fe4ab(0x480);}}catch(_0x2ae62f){return console[_0x4fe4ab(0x2fb)](_0x4fe4ab(0x44a),_0x2ae62f),toast(_0x4fe4ab(0x30f),0xfa0),null;}},loadLanguage(localStorage[_0x52ca82(0x342)](_0x52ca82(0x428))||'en')[_0x52ca82(0x340)](initializeApp);
    </script>
</body>
</html>
