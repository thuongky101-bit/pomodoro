<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="A Pomodoro application for studying, featuring Gemini AI integration and a modern interface." />
    <title>Pomodoro Study App — Gemini AI Integration (New UI)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — FOCUSED UI VERSION (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Default) - Updated from file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Add RGB variable for panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: ADD NEW THEMES === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: ADD NEW THEMES === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Add border rules for light/pastel themes */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Modified: remove default border */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: UPDATE TOPIC MANAGEMENT UI === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Modified */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Raise the open menu block above others */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: UPDATE TOPIC MANAGEMENT UI === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Modified */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Keep background transparent on hover */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Color tweak */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Color tweak */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: SOFTER DIVIDER CUSTOMIZATION === */
    #view-timer .panel-bg hr {
        border: none; /* Remove default border */
        height: 1px;  /* Set divider height */
        background-color: var(--muted); /* Use theme's secondary color */
        opacity: 0.3; /* Make it subtle to blend with background */
        margin-top: 0; /* Adjust spacing */
    }
    /* === END: SOFTER DIVIDER CUSTOMIZATION === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Modified */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Modified */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Modified */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Raise z-index to sit above header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Modified */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Modified */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; flex-direction: column; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Modified */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
        /* Keep subheadings tidy */
        max-width: 80%;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Modified */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Modified */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Modified: switched to translucent white background */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Faint white border */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Fine-tune: closer to spec */
        border-color: var(--acc);
    }
    /* === START: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Use translucent black instead of white on light theme */
        border-color: rgba(0, 0, 0, 0.1); /* Faint black border on light themes */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Increase density on focus */
    }
    /* === END: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */

    /* Improve option background and text color per current theme */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Tweak */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Reduce/remove text shadow on light themes to avoid blur/glare */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
/* When content is expanded, draw a divider above the content */
.method-item > .method-content:not([hidden]) {
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    /* margin-top: 8px;  <-- removed to reduce extra spacing */
    padding-top: 8px; /* keep a bit of padding so text doesn’t stick to the divider */
}
    [data-theme='light'] .method-item > .method-content:not([hidden]),
    [data-theme='pastel'] .method-item > .method-content:not([hidden]) {
        border-top-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* ========================================================= */
    /* START: UPDATE KNOWLEDGE HEADER UI                         */
    /* ========================================================= */

    /* Use Flexbox to align title and action buttons on one row */
    .method-item > div:first-child {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        width: 100%;
    }

    /* Let the title flex and handle long text gracefully */
    .method-item .method-title {
        flex: 1;
        min-width: 0;
        word-break: break-word;
        overflow-wrap: break-word;
        cursor: pointer;
    }

    /* Add a small spacing before the action buttons */
    .method-item .topic-actions { margin-left: 8px; }

    .method-item:hover .topic-actions,
    .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    /* ========================================================= */
    /* END: UPDATE KNOWLEDGE HEADER UI                           */
    /* ========================================================= */

    /* ========================================================= */
    /* START: FIX FLEXBOX OVERFLOW WITH LONG TEXT (FLEXBOX FIX) */
    /* ========================================================= */
    .topic-title,
    .subtopic-btn,
    .note-content-wrapper,
    .subtopic-todo-list label,
    .method-title,
    .method-item > div:first-child {
        min-width: 0; /* Allow element to shrink below its content width */
    }

    .topic-title,
    .subtopic-btn,
    .note-content,
    .subtopic-todo-list label,
    .hist-item > div,
    .method-title {
        word-break: break-word;      /* Break long words automatically */
        overflow-wrap: break-word;   /* Ensure wrapping for long strings */
    }
    /* ========================================================= */
    /* END: FIX FLEXBOX OVERFLOW WITH LONG TEXT (FLEXBOX FIX) */
    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Timer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Timer</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Topics">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Topics</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Stats">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Stats</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Knowledge Base">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Knowledge Base</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Settings">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Settings</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Guide</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">No Subtopic Selected</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard">📊 Dashboard </button>
          <a href="https://forms.gle/61hYjvwAkR328EaC9" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Send your feedback">💬 Feedback</a>
          <button class="btn ghost small" id="btnExport" title="Export JSON">⬇️ Export File</button>
          <label class="btn ghost small" for="importFile" title="Import JSON">⬆️ Import File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Show/Hide Interface">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Fullscreen">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Welcome to the Pomodoro Study App!</h3>
                <p>Get started by selecting a <strong>Subtopic</strong> or creating a new Topic/Subtopic.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Create New Topic</button>
            </div>
            <div class="presets" role="group" aria-label="Choose preset mode">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">STATUS</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Wind-down Checklist</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Save your current work (Save/Commit).</li>
                <li>Jot down the "Next step".</li>
                <li>Tidy up your workspace.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Start (Space)">▶️ Start</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="End focus session">🧘 Start Break</button>
              <button class="btn" id="btnPause" aria-label="Pause (Space)">⏸️ Pause</button>
              <button class="btn" id="btnResume" aria-label="Resume (Space)">⏵ Resume</button>
              <button class="btn warn" id="btnSkip" aria-label="Skip (N)">⏭️ Skip</button>
              <button class="btn danger" id="btnReset">↺ Reset</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Break Early</button>
            </div>
            <div class="tiny">Shortcuts: <strong>Space</strong> = Start/Pause/Resume, <strong>N</strong> = Next/Skip</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Tasks</button>
                <button class="tab-btn" data-tab="notes">Notes</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-dos for this subtopic:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Add a new task..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Add</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Add a new note..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Add Note</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini for: <span id="currentSubtopicNameChat">(none selected)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Clear History">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Explain the key concepts of this topic">Explain Concept</button>
                  <button class="btn small ghost" data-prompt="Create a detailed outline for this topic">Create Outline</button>
                  <button class="btn small ghost" data-prompt="List 5 important review questions for this topic">Create Review Questions</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Ask Gemini something..." />
                  <button id="btnSendMessage" class="btn acc">Send</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Topic Management</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Add Topic</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Click the arrow to expand/collapse the subtopic list.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Statistics & History — <span id="currentSubtopicName">(none selected)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Total Time</h4><div class="stat-value" id="statTotal">0 min</div></div>
              <div class="stat-card"><h4>Sessions</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Tasks Completed</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">History (FOCUS)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Knowledge Base per Subtopic</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Add Knowledge</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Click on an item to see details.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Discover the Pomodoro Study App</h3>
              <p>
                  Welcome to a study space designed for focus and efficiency. Explore the features that support your learning journey.
              </p>

              <h4>🚀 Quick Start in 4 Steps</h4>
              <p>To keep your journey organized, the app uses a <strong>Main Topic → Subtopic</strong> structure.</p>
              <ol>
                  <li>Open <strong>📚 Topics</strong> from the side navigation.</li>
                  <li>Click <strong>＋ Add Topic</strong> to create a main area (e.g., "Conversational English").</li>
                  <li>Next to the topic, click <strong>＋ Add</strong> to create a more specific subtopic (e.g., "Lesson 1: Practice IPA").</li>
                  <li>Select that subtopic. You’re now ready to start your first focus session!</li>
              </ol>

              <hr />
              <h4>✨ Notable Features</h4>

              <h4>Flexible Timer Modes ⏱️</h4>
              <p>The app offers more than Pomodoro. Pick what fits your work:</p>
              <ul>
                  <li><strong>Classic Pomodoro (Style A/B):</strong> Focus in fixed sessions (e.g., 25 min work, 5 min break) to build discipline and cadence.</li>
                  <li><strong>Flowtime Mode (Style 🌊 Flow):</strong> Ideal for deep work. The timer counts up; end when it feels right. Break time is suggested based on your focus time.</li>
                  <li><strong>Wind-down Buffer:</strong> A customizable buffer between focus and break to wrap up, jot the next step, and switch smoothly—without abrupt cutoffs.</li>
              </ul>

              <h4>Knowledge Base Per Subtopic 💡</h4>
              <p>
                  Each <strong>Subtopic</strong> now has its own dedicated Knowledge Base. This lets you build a focused library of methods and notes that only relate to what you’re studying in that subtopic.
              </p>
              <p>
                  For example, notes and methods for “Conversational English” will only appear when that subtopic is selected and won’t mix with formulas from a subtopic like “Calculus”.
              </p>
              <p>
                  The rich editor still lets you format headings, bold key points, create lists, and highlight important information for each subject.
              </p>

              <h4>Visual Topic Management</h4>
              <p>Easily organize your study goals. Use <strong>drag and drop</strong> to reorder Topics or move Subtopics across topics intuitively.</p>

              <h4>Integrated Tasks & Notes 📝</h4>
              <p>Right within the timer view, create to-dos for each subtopic and jot quick notes without breaking your flow.</p>

              <h4>Zen Mode 🧘</h4>
              <p>When you need absolute focus, click the eye icon (👁️). The interface hides, leaving only the background and timer. You can <strong>drag the timer</strong> anywhere for a clean workspace.</p>

              <h4>Statistics & Milestones 🏆</h4>
              <p>Track your journey through meaningful numbers. The app records and celebrates important focus-time milestones—turning effort into achievements.</p>

              <hr />
              <h4>⌨️ Smart Shortcuts</h4>
              <ul>
                  <li><kbd>Space</kbd>: Start / Pause / Resume the session.</li>
                  <li><kbd>N</kbd>: Skip the current focus or break session.</li>
                  <li><kbd>Esc</kbd>: Close open dialogs (e.g., Settings).</li>
              </ul>

              <hr />
              <h4>🛠️ Advanced Settings & Integrations</h4>

              <h4>Gemini AI Assistant 🧠</h4>
              <p>Turn the app into a smart study companion. Beyond Q&A, you can:</p>
              <ul>
                  <li><strong>Smart Auto-formatting:</strong> While writing under "Methods", let AI analyze and format your raw text—detect headings, bold key ideas, and lists.</li>
                  <li><strong>Setup:</strong> Visit Google AI Studio to create a free API Key and paste it into "Gemini API Key" in Settings.</li>
              </ul>

              <h4>Customize Interface & Sound 🎨</h4>
              <p>Make the workspace yours:</p>
              <ul>
                  <li><strong>Multiple Themes & Backgrounds:</strong> Choose from built-in themes (Light, Dark, Pastel...) or <strong>upload your own background</strong> for inspiration.</li>
                  <li><strong>Custom Alerts:</strong> <strong>Upload your own audio files (.mp3, .wav...)</strong> as alert sounds for focus and breaks.</li>
              </ul>

              <h4>YouTube Background Music 🎶</h4>
              <p>Create the perfect study ambiance by playing a YouTube video or playlist as background music. Paste the URL into the "YouTube Background Music" field in Settings.</p>

              <h4>Data Safety: Backup & Restore 🛡️</h4>
              <p>The app automatically backs up your progress daily. Customize how many days to keep and restore data from a previous day if needed. ⚠️ <strong>Warning:</strong> Restore will overwrite your current data.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Congratulations!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Continue the journey!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Settings</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Timer</button>
              <button class="tab-btn" data-tab="settings-ui">Interface & Sound</button>
              <button class="tab-btn" data-tab="settings-integrations">Integrations</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Style A </button>
                      <button class="btn ghost" data-preset-target="B"> Style B </button>
                      <button class="btn ghost" data-preset-target="C"> Style C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Pomodoro Durations</h4>
                      <div class="row">
                          <label>FOCUS (minutes)<input type="number" id="set_work" min="1" /></label>
                          <label>WIND-DOWN (minutes)<input type="number" id="set_winddown" min="0" /></label>
                          <label>SHORT BREAK (minutes)<input type="number" id="set_short" min="1" /></label>
                          <label>LONG BREAK (minutes)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Pomodoro Cycles<input type="number" id="set_cycles" min="1" /></label>
                          <label>Long Break Interval<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Break Ratio (Work / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Tip: Break time = total focus time / X. Default is 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Automatically start next session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Enable Wind-down after focus session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Prompt for note after each session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Interface</h4>
                      <div class="row">
                          <label>UI Theme
                                <select id="set_theme_color">
                                    <option value="default">Default (Dark Blue)</option>
                                    <option value="light">Light - Milk Tea</option>
                                    <option value="pastel">Pastel - Soft</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Background Display Mode
                              <select id="set_backgroundMode">
                                  <option value="cover">Cover (Default)</option>
                                  <option value="contain">Contain (Sharp)</option>
                                  <option value="auto">Original Size (Repeat)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Background Image
                              <label class="btn small ghost" for="uploadBg">Upload New Image</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Clear Background</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Panel Opacity</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Sound</h4>
                      <div class="row">
                          <label>Volume (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Alert Style
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Customize Alerts</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Alert at end of FOCUS</small>
                              <label title="Alert at end of FOCUS" class="btn small ghost" for="uploadSoundWork">FOCUS</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of SHORT BREAK</small>
                              <label title="Alert at end of SHORT BREAK" class="btn small ghost" for="uploadSoundBreak">SHORT BREAK</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of LONG BREAK</small>
                              <label title="Alert at end of LONG BREAK" class="btn small ghost" for="uploadSoundLong">LONG BREAK</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>AI Integration</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Paste your API Key here..." />
                      </label>
                      <div class="tiny">Required to use AI features. Get a free key at <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 YouTube Background Music</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Paste YouTube link here..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Use video thumbnail as background</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Stopping will not auto-play again until you press ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Volume</div>
                  </div>
                  <div>
                      <h4>🛡️ Backup Settings</h4>
                      <div class="row">
                          <label>Number of backup days to keep
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Restore Data</h4>
                      <p class="tiny">Restore from an automatic daily backup. This action will overwrite your current data.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Restore</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Defaults</button>
              <button class="btn acc" id="btnSaveSettings">Save</button>
              <button class="btn" id="btnCloseSettings">Close</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Note for the completed session</h3>
      <div class="row"><textarea id="noteText" placeholder="What did you learn? Any difficulties? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Summarize & Suggest</button>
        <button class="btn" id="btnSkipNote">Skip</button>
        <button class="btn acc" id="btnSaveNote">Save Note</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Title</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Cancel</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Dashboard</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Close</button>
        </div>
        <p class="tiny">Summary of time and sessions completed across all topics.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Edit Method</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Title<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Content</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Small heading">H</button>
          <button id="toolBold" class="btn small ghost" title="Bold">B</button>
          <button id="toolItalic" class="btn small ghost" title="Italic">I</button>
          <button id="toolList" class="btn small ghost" title="Numbered list">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Bulleted list">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Text color">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Default text color"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Accent color"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Positive color"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Warning color"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Danger color"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Purple"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="This feature requires a Gemini API Key">✨ Auto-format</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Cancel</button>
          <button class="btn acc" id="btnSaveMethod">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Press "Enable Sound" to allow background audio.</span>
    <button id="btnEnableSound" class="btn small acc">Enable Sound</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
  const _0x272902=_0x4e4c;(function(_0x27a1f2,_0x207f0d){const _0x1fa45d=_0x4e4c,_0x25ddd2=_0x27a1f2();while(!![]){try{const _0x526506=-parseInt(_0x1fa45d(0x44c))/0x1+parseInt(_0x1fa45d(0x34e))/0x2*(parseInt(_0x1fa45d(0x4c2))/0x3)+-parseInt(_0x1fa45d(0x304))/0x4*(-parseInt(_0x1fa45d(0x3b2))/0x5)+parseInt(_0x1fa45d(0x452))/0x6+parseInt(_0x1fa45d(0x2fd))/0x7+parseInt(_0x1fa45d(0x45b))/0x8+-parseInt(_0x1fa45d(0x41f))/0x9;if(_0x526506===_0x207f0d)break;else _0x25ddd2['push'](_0x25ddd2['shift']());}catch(_0x455788){_0x25ddd2['push'](_0x25ddd2['shift']());}}}(_0x198c,0x3d358),window[_0x272902(0x3ea)](_0x272902(0x1d6),()=>{try{updateFullscreenButton();}catch(_0x546c59){}}));const IS_FILE_PROTOCOL=window['location']['protocol']===_0x272902(0x1b6);function startYtApiWatchdog(){const _0x1bd80c=_0x272902,_0x1e92a7=document[_0x1bd80c(0x298)]('ytUrlFeedback');if(!_0x1e92a7)return;const _0x5116f8=setTimeout(()=>{const _0x553368=_0x1bd80c;try{(!window['YT']||!window['YT']['Player'])&&(_0x1e92a7[_0x553368(0x1ab)]=_0x553368(0x46a),_0x1e92a7[_0x553368(0x497)][_0x553368(0x1bb)]=_0x553368(0x1cd));}catch(_0x55bf49){}},0x5dc),_0xd51b5e=setTimeout(()=>{const _0x10e5bb=_0x1bd80c;try{(!window['YT']||!window['YT'][_0x10e5bb(0x444)])&&(_0x1e92a7[_0x10e5bb(0x1ab)]=_0x10e5bb(0x486),_0x1e92a7['style'][_0x10e5bb(0x1bb)]=_0x10e5bb(0x3bd));}catch(_0x34f62d){}},0x1b58);window[_0x1bd80c(0x3eb)]={'cancel'(){clearTimeout(_0x5116f8),clearTimeout(_0xd51b5e);}};}(function(){const _0x335247=_0x272902,_0x5c4731={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x335247(0x1a8)+current+'/'+target,'timer.selectSubtopicPrompt':_0x335247(0x2c3)};window['t']=function _0x14543b(_0x59973c,_0x4ef5d8){const _0x20b740=_0x335247;try{const _0x5eb9e6=_0x5c4731[_0x59973c];if(typeof _0x5eb9e6===_0x20b740(0x1e4))return _0x5eb9e6(_0x4ef5d8||{});if(typeof _0x5eb9e6===_0x20b740(0x1d1))return _0x5eb9e6;}catch(_0x3d2b5a){}return _0x59973c;},window[_0x335247(0x39d)]=function _0x17e31d(_0x1f0b41){const _0x2f107a=_0x335247;try{localStorage['setItem'](_0x2f107a(0x417),_0x1f0b41||'en');}catch(_0x9a4ba6){}return Promise[_0x2f107a(0x370)]();};}());function ensureYouTubeAPI(){const _0x4f9115=_0x272902;if(IS_FILE_PROTOCOL)return Promise[_0x4f9115(0x370)](![]);try{if(window['YT']&&window['YT'][_0x4f9115(0x444)])return Promise['resolve'](!![]);}catch(_0x18e1bd){}if(window[_0x4f9115(0x2ff)])return window[_0x4f9115(0x2ff)];return startYtApiWatchdog(),window[_0x4f9115(0x2ff)]=new Promise((_0xc11785,_0x324abb)=>{const _0x5e696d=_0x4f9115;try{const _0x4c4b65=document['createElement'](_0x5e696d(0x1c6));_0x4c4b65[_0x5e696d(0x407)]='https://www.youtube.com/iframe_api',_0x4c4b65['async']=!![],_0x4c4b65[_0x5e696d(0x471)]=!![],_0x4c4b65['onload']=()=>_0xc11785(!![]),_0x4c4b65['onerror']=()=>_0x324abb(new Error(_0x5e696d(0x406))),document[_0x5e696d(0x2e8)]['appendChild'](_0x4c4b65);}catch(_0x279129){_0x324abb(_0x279129);}}),window[_0x4f9115(0x2ff)];}const storageManager={'DB_NAME':_0x272902(0x223),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x4fbf31,_0x585d80)=>{const _0x19d3d9=_0x4e4c;if(this['db'])return _0x4fbf31(this['db']);const _0x1a7522=indexedDB['open'](this[_0x19d3d9(0x396)],this[_0x19d3d9(0x368)]);_0x1a7522[_0x19d3d9(0x293)]=_0x11165b=>{const _0x4f869d=_0x19d3d9,_0x540c1f=_0x11165b[_0x4f869d(0x449)][_0x4f869d(0x22a)];!_0x540c1f['objectStoreNames'][_0x4f869d(0x214)](_0x4f869d(0x274))&&_0x540c1f[_0x4f869d(0x1da)](_0x4f869d(0x274));!_0x540c1f[_0x4f869d(0x4b6)]['contains']('topics')&&_0x540c1f[_0x4f869d(0x1da)]('topics',{'keyPath':'id'});if(!_0x540c1f[_0x4f869d(0x4b6)][_0x4f869d(0x214)](_0x4f869d(0x292))){const _0x5e9bd8=_0x540c1f[_0x4f869d(0x1da)](_0x4f869d(0x292),{'keyPath':'id'});_0x5e9bd8[_0x4f869d(0x2a4)](_0x4f869d(0x2f8),'topicId');}!_0x540c1f[_0x4f869d(0x4b6)][_0x4f869d(0x214)](_0x4f869d(0x44d))&&_0x540c1f['createObjectStore'](_0x4f869d(0x44d),{'keyPath':_0x4f869d(0x382)});},_0x1a7522[_0x19d3d9(0x373)]=_0x3f2a12=>{const _0x3bb142=_0x19d3d9;this['db']=_0x3f2a12[_0x3bb142(0x449)][_0x3bb142(0x22a)],console[_0x3bb142(0x32e)](_0x3bb142(0x45a)),_0x4fbf31(this['db']);},_0x1a7522['onerror']=_0x454d4d=>{const _0x51085e=_0x19d3d9;console[_0x51085e(0x1bc)]('IndexedDB\x20error:',_0x454d4d[_0x51085e(0x449)][_0x51085e(0x3b9)]),_0x585d80(_0x454d4d[_0x51085e(0x449)]['error']);};});},async '_getStore'(_0x3090cf,_0x1e4d35=_0x272902(0x420)){const _0x55ad0e=_0x272902;await this['initDB']();const _0xb77c4a=this['db']['transaction']([_0x3090cf],_0x1e4d35);return _0xb77c4a[_0x55ad0e(0x380)](_0x3090cf);},async 'getSettings'(){const _0x535b59=_0x272902,_0x5c094e=await this[_0x535b59(0x28a)]('settings');return new Promise((_0x1ca422,_0x586f87)=>{const _0x345475=_0x535b59,_0x33c94b=_0x5c094e['get'](_0x345475(0x320));_0x33c94b[_0x345475(0x373)]=()=>_0x1ca422(_0x33c94b[_0x345475(0x22a)]),_0x33c94b['onerror']=()=>_0x586f87(_0x33c94b[_0x345475(0x1bc)]);});},async 'updateSettings'(_0x320e50){const _0x56f755=_0x272902,_0x515462=await this[_0x56f755(0x28a)]('settings',_0x56f755(0x4ad));return new Promise((_0x394689,_0x4ba6fb)=>{const _0x186466=_0x56f755,_0x5bc919=_0x515462[_0x186466(0x213)](_0x320e50,_0x186466(0x320));_0x5bc919[_0x186466(0x373)]=()=>_0x394689(_0x5bc919[_0x186466(0x22a)]),_0x5bc919[_0x186466(0x216)]=()=>_0x4ba6fb(_0x5bc919[_0x186466(0x1bc)]);});},async 'getAll'(_0x1a3177){const _0x21b78c=await this['_getStore'](_0x1a3177);return new Promise((_0x32c17e,_0x2a77ac)=>{const _0x2441a3=_0x4e4c,_0x24b0d8=_0x21b78c[_0x2441a3(0x430)]();_0x24b0d8[_0x2441a3(0x373)]=()=>_0x32c17e(_0x24b0d8['result']),_0x24b0d8['onerror']=()=>_0x2a77ac(_0x24b0d8['error']);});},async 'update'(_0x37cbfd,_0x1963a4){const _0x4a56b5=_0x272902,_0x2fa4d4=await this[_0x4a56b5(0x28a)](_0x37cbfd,_0x4a56b5(0x4ad));return new Promise((_0xa1b0eb,_0x1cb1d9)=>{const _0x23d532=_0x4a56b5,_0x2d42a1=_0x2fa4d4['put'](_0x1963a4);_0x2d42a1[_0x23d532(0x373)]=()=>_0xa1b0eb(_0x2d42a1['result']),_0x2d42a1[_0x23d532(0x216)]=()=>_0x1cb1d9(_0x2d42a1[_0x23d532(0x1bc)]);});},async 'add'(_0x4282e5,_0x33e785){const _0x4721d5=_0x272902,_0x196ae6=await this[_0x4721d5(0x28a)](_0x4282e5,_0x4721d5(0x4ad));return new Promise((_0x4b32a8,_0x4d4512)=>{const _0x2505ed=_0x4721d5,_0x32c388=_0x196ae6[_0x2505ed(0x4b0)](_0x33e785);_0x32c388[_0x2505ed(0x373)]=()=>_0x4b32a8(_0x32c388[_0x2505ed(0x22a)]),_0x32c388['onerror']=()=>_0x4d4512(_0x32c388[_0x2505ed(0x1bc)]);});},async 'delete'(_0x167867,_0x28420a){const _0x2a3d00=_0x272902,_0x1fd5be=await this[_0x2a3d00(0x28a)](_0x167867,_0x2a3d00(0x4ad));return new Promise((_0x1537e0,_0x1e1802)=>{const _0xb55215=_0x2a3d00,_0x4edf0f=_0x1fd5be[_0xb55215(0x49f)](_0x28420a);_0x4edf0f['onsuccess']=()=>_0x1537e0(_0x4edf0f[_0xb55215(0x22a)]),_0x4edf0f['onerror']=()=>_0x1e1802(_0x4edf0f[_0xb55215(0x1bc)]);});},async 'save'(_0x37f905){const _0x4c0acf=_0x272902;return await this[_0x4c0acf(0x21b)](),new Promise((_0x15e6d9,_0xea7402)=>{const _0x39a466=_0x4c0acf,_0x3f4d1d=this['db'][_0x39a466(0x34b)]([_0x39a466(0x274),_0x39a466(0x2b0),_0x39a466(0x292)],_0x39a466(0x4ad)),_0xe879d3=_0x3f4d1d['objectStore'](_0x39a466(0x274)),_0x5d44a1=_0x3f4d1d[_0x39a466(0x380)]('topics'),_0x5d2e10=_0x3f4d1d[_0x39a466(0x380)]('subtopics');_0xe879d3['put'](_0x37f905[_0x39a466(0x274)],_0x39a466(0x320)),_0x5d44a1[_0x39a466(0x40a)](),_0x5d2e10[_0x39a466(0x40a)](),_0x37f905[_0x39a466(0x2b0)][_0x39a466(0x2b6)](_0x2bf00a=>{const _0x57e5ab=_0x39a466,{subtopics:_0x16377c,..._0x472d19}=_0x2bf00a;_0x5d44a1['put'](_0x472d19),(_0x16377c||[])[_0x57e5ab(0x2b6)](_0x178d41=>_0x5d2e10['put'](_0x178d41));}),_0x3f4d1d[_0x39a466(0x416)]=()=>_0x15e6d9(),_0x3f4d1d[_0x39a466(0x216)]=_0x453d79=>_0xea7402(_0x453d79[_0x39a466(0x449)][_0x39a466(0x1bc)]);});},async 'autoBackup'(_0x2f709b){const _0x1e97bf=_0x272902;await this[_0x1e97bf(0x21b)]();const _0x10df6d=new Date()[_0x1e97bf(0x2a6)]()[_0x1e97bf(0x38d)](0x0,0xa),_0x35adf0=localStorage['getItem'](_0x1e97bf(0x43f));if(_0x10df6d!==_0x35adf0){console[_0x1e97bf(0x32e)](_0x1e97bf(0x3a0)+_0x10df6d+_0x1e97bf(0x249));const _0x5b1266={'date':_0x10df6d,'data':JSON['parse'](JSON['stringify'](_0x2f709b))},_0x49b83b=this['db'][_0x1e97bf(0x34b)]([_0x1e97bf(0x44d)],_0x1e97bf(0x4ad)),_0x54c6a3=_0x49b83b[_0x1e97bf(0x380)](_0x1e97bf(0x44d)),_0x337ee2=_0x54c6a3[_0x1e97bf(0x213)](_0x5b1266);_0x337ee2[_0x1e97bf(0x373)]=()=>{const _0x73f097=_0x1e97bf;localStorage['setItem']('lastBackupDate',_0x10df6d),console['log'](_0x73f097(0x282)),this[_0x73f097(0x21f)](_0x2f709b?.[_0x73f097(0x274)]?.[_0x73f097(0x459)]||0x7);},_0x337ee2[_0x1e97bf(0x216)]=_0x4fd047=>{const _0x19f99b=_0x1e97bf;console[_0x19f99b(0x1bc)](_0x19f99b(0x40d),_0x4fd047[_0x19f99b(0x449)][_0x19f99b(0x1bc)]);};}},async 'cleanupOldBackups'(_0x505a54){const _0x1d32a6=_0x272902;await this['initDB']();const _0x2c5d0c=this['db']['transaction']([_0x1d32a6(0x44d)],_0x1d32a6(0x4ad)),_0x6fa9d4=_0x2c5d0c[_0x1d32a6(0x380)]('backups'),_0x4f56d3=_0x6fa9d4['getAllKeys']();_0x4f56d3['onsuccess']=()=>{const _0x14c9b7=_0x1d32a6,_0x4700b0=_0x4f56d3[_0x14c9b7(0x22a)][_0x14c9b7(0x2d0)]()[_0x14c9b7(0x408)]();if(_0x4700b0[_0x14c9b7(0x465)]>_0x505a54){const _0x25d27e=_0x4700b0[_0x14c9b7(0x38d)](_0x505a54);_0x25d27e[_0x14c9b7(0x2b6)](_0x1cc864=>{const _0x6efcfb=_0x14c9b7;_0x6fa9d4['delete'](_0x1cc864),console[_0x6efcfb(0x32e)](_0x6efcfb(0x3a8)+_0x1cc864);});}};},async 'getBackupList'(){const _0x198ab5=_0x272902;return await this[_0x198ab5(0x21b)](),new Promise((_0x18cb59,_0x31da6e)=>{const _0x109e1e=_0x198ab5,_0x5e3e8b=this['db'][_0x109e1e(0x34b)]([_0x109e1e(0x44d)],'readonly'),_0x1d94cf=_0x5e3e8b[_0x109e1e(0x380)]('backups'),_0x30959b=_0x1d94cf['getAll']();_0x30959b['onsuccess']=()=>_0x18cb59(_0x30959b[_0x109e1e(0x22a)]['sort']((_0x5a201f,_0x4d92e4)=>_0x4d92e4[_0x109e1e(0x382)][_0x109e1e(0x3a2)](_0x5a201f['date']))),_0x30959b[_0x109e1e(0x216)]=_0x50b55e=>_0x31da6e(_0x50b55e['target'][_0x109e1e(0x1bc)]);});},async 'restoreBackup'(_0x5be144){return await this['initDB'](),new Promise((_0xb1ccfd,_0x3b22f6)=>{const _0x27e39f=_0x4e4c,_0xdf5607=this['db']['transaction']([_0x27e39f(0x44d)],_0x27e39f(0x420)),_0x3a9298=_0xdf5607[_0x27e39f(0x380)]('backups'),_0x4a7f4e=_0x3a9298[_0x27e39f(0x424)](_0x5be144);_0x4a7f4e[_0x27e39f(0x373)]=()=>{const _0x1fb012=_0x27e39f;_0x4a7f4e[_0x1fb012(0x22a)]&&_0x4a7f4e[_0x1fb012(0x22a)][_0x1fb012(0x328)]?(localStorage[_0x1fb012(0x1b5)]('pomodoroData_v11',JSON[_0x1fb012(0x333)](_0x4a7f4e[_0x1fb012(0x22a)][_0x1fb012(0x328)])),_0xb1ccfd(_0x4a7f4e[_0x1fb012(0x22a)]['data'])):_0x3b22f6(new Error(_0x1fb012(0x284)));},_0x4a7f4e['onerror']=_0x363869=>_0x3b22f6(_0x363869[_0x27e39f(0x449)][_0x27e39f(0x1bc)]);});},'exportData'(_0x317430){const _0x24aa3c=_0x272902;let _0x31d1c5={};try{_0x31d1c5=JSON[_0x24aa3c(0x218)](JSON[_0x24aa3c(0x333)](_0x317430||{}));}catch(_0x12c0f5){_0x31d1c5=_0x317430;}try{if(_0x31d1c5&&_0x31d1c5[_0x24aa3c(0x274)])_0x31d1c5[_0x24aa3c(0x274)]['apiKey']='';}catch(_0x32c0e2){}const _0x593fa7=new Blob([JSON['stringify'](_0x31d1c5,null,0x2)],{'type':_0x24aa3c(0x3cd)}),_0x4c97fd=document[_0x24aa3c(0x2bd)]('a'),_0x59a59c=new Date(),_0xf9f3ea=_0x40d2e0=>(''+_0x40d2e0)[_0x24aa3c(0x401)](0x2,'0');_0x4c97fd[_0x24aa3c(0x4b3)]=URL[_0x24aa3c(0x21c)](_0x593fa7),_0x4c97fd[_0x24aa3c(0x399)]=_0x24aa3c(0x279)+_0x59a59c[_0x24aa3c(0x21a)]()+_0xf9f3ea(_0x59a59c[_0x24aa3c(0x239)]()+0x1)+_0xf9f3ea(_0x59a59c[_0x24aa3c(0x3b7)]())+'.json',_0x4c97fd[_0x24aa3c(0x477)](),URL[_0x24aa3c(0x29f)](_0x4c97fd[_0x24aa3c(0x4b3)]);},async 'importData'(_0x2aeaea){const _0x574c83=_0x272902,_0x12a873=await _0x2aeaea['text'](),_0x6b62ef=JSON[_0x574c83(0x218)](_0x12a873);if(!_0x6b62ef[_0x574c83(0x3ef)]||!_0x6b62ef[_0x574c83(0x274)]||!Array['isArray'](_0x6b62ef[_0x574c83(0x2b0)]))throw new Error(_0x574c83(0x476));try{const _0x3cfd65=window[_0x574c83(0x328)]&&window['data']['settings']&&window[_0x574c83(0x328)][_0x574c83(0x274)]['apiKey']||'';(!(_0x574c83(0x4ab)in _0x6b62ef['settings'])||_0x6b62ef[_0x574c83(0x274)][_0x574c83(0x4ab)]==='')&&(_0x6b62ef[_0x574c83(0x274)]['apiKey']=_0x3cfd65);}catch(_0x5742e4){}return localStorage[_0x574c83(0x1b5)](_0x574c83(0x1a6),JSON['stringify'](_0x6b62ef)),_0x6b62ef;}},$=(_0x256954,_0x30e12d=document)=>_0x30e12d['querySelector'](_0x256954),breakSuggestions=['Stand\x20up\x20and\x20stretch.',_0x272902(0x3d9),_0x272902(0x22d),_0x272902(0x276),'Do\x20a\x20few\x20deep-breathing\x20cycles.','Tidy\x20or\x20rearrange\x20your\x20workspace.','Play\x20a\x20favorite\x20song\x20briefly.',_0x272902(0x217),'Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.','Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.',_0x272902(0x23b),_0x272902(0x335),_0x272902(0x277),'Look\x20at\x20something\x20cute\x20or\x20uplifting.','Count\x20down\x20slowly\x20from\x2020\x20to\x200.',_0x272902(0x357),_0x272902(0x1b2),'Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.',_0x272902(0x2e4),_0x272902(0x4b9),_0x272902(0x226),'Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.',_0x272902(0x41c),_0x272902(0x3d7),_0x272902(0x1c9),_0x272902(0x1b1),_0x272902(0x257),_0x272902(0x480),'Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','Check\x20your\x20breathing—if\x20rushed,\x20slow\x20it\x20down.',_0x272902(0x26f)],$$=(_0x11f0bd,_0x583f43=document)=>Array['from'](_0x583f43['querySelectorAll'](_0x11f0bd));function on(_0x251bda,_0x30f0b0,_0x18e1ba){const _0x50c51f=_0x272902;if(!_0x251bda){console[_0x50c51f(0x1ee)]('Missing\x20element',_0x30f0b0);return;}_0x251bda[_0x50c51f(0x3ea)](_0x30f0b0,_0x18e1ba);}const formatMMSS=_0x7d627b=>{const _0x3c558a=_0x272902,_0x3de97c=Math[_0x3c558a(0x34f)](_0x7d627b/0x3c)[_0x3c558a(0x33e)]()[_0x3c558a(0x401)](0x2,'0'),_0x2edd6f=Math[_0x3c558a(0x34f)](_0x7d627b%0x3c)[_0x3c558a(0x33e)]()[_0x3c558a(0x401)](0x2,'0');return _0x3de97c+':'+_0x2edd6f;},uid=(_0x2e84b9='id')=>_0x2e84b9+'_'+Date[_0x272902(0x404)]()+'_'+Math['random']()[_0x272902(0x33e)](0x24)[_0x272902(0x38d)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x517cd4){const _0x2d5a97=_0x272902;try{const _0x5e977c=_0x517cd4[_0x2d5a97(0x310)](_0x2d5a97(0x339));if(!_0x5e977c[_0x2d5a97(0x465)])return;const _0x1bd0b9=_0x5e977c[0x0],_0x5b39e1=_0x5e977c[_0x5e977c[_0x2d5a97(0x465)]-0x1],_0x329864=_0x5e4513=>{const _0x119421=_0x2d5a97;if(_0x5e4513[_0x119421(0x358)]===_0x119421(0x1f2)){if(_0x5e4513[_0x119421(0x32f)]&&document[_0x119421(0x312)]===_0x1bd0b9)_0x5e4513[_0x119421(0x48b)](),_0x5b39e1['focus']();else!_0x5e4513['shiftKey']&&document[_0x119421(0x312)]===_0x5b39e1&&(_0x5e4513[_0x119421(0x48b)](),_0x1bd0b9[_0x119421(0x259)]());}};_0x517cd4[_0x2d5a97(0x3ea)](_0x2d5a97(0x467),_0x329864),_0x1bd0b9['focus'](),__releaseFocusTrap=()=>{const _0x7c7ab=_0x2d5a97;try{_0x517cd4[_0x7c7ab(0x394)](_0x7c7ab(0x467),_0x329864);}catch(_0x3c34f3){}};}catch(_0x567690){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x200001){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x272902(0x2a6)]();function toast(_0x37701d,_0x48b0a4=0xa28){const _0x99da8c=_0x272902,_0x24b6f3=$('#toasts'),_0x4d847e=document[_0x99da8c(0x2bd)]('div');_0x4d847e[_0x99da8c(0x28d)]=_0x99da8c(0x25d),_0x4d847e[_0x99da8c(0x1ab)]=_0x37701d,_0x24b6f3['appendChild'](_0x4d847e),setTimeout(()=>{const _0x4bd66f=_0x99da8c;_0x4d847e[_0x4bd66f(0x497)]['opacity']='0';},_0x48b0a4-0x12c),setTimeout(()=>_0x24b6f3['removeChild'](_0x4d847e),_0x48b0a4);}function escapeHTML(_0x2381de){const _0x485c17=_0x272902;return _0x2381de[_0x485c17(0x421)](/[&<>"']/g,_0x1e3dce=>({'&':'&amp;','<':_0x485c17(0x295),'>':_0x485c17(0x3ae),'\x22':_0x485c17(0x2ea),'\x27':_0x485c17(0x1fd)}[_0x1e3dce]));}function formatDaysHoursMinutes(_0x32bd69){const _0x1fd578=_0x272902;if(!_0x32bd69||_0x32bd69<0x1)return _0x1fd578(0x20a);const _0x46e2ce=Math[_0x1fd578(0x34f)](_0x32bd69/0x3c),_0x44f83a=_0x32bd69%0x3c,_0x11efbc=_0x44f83a['toString']()['padStart'](0x2,'0');return _0x46e2ce+'\x20hours\x20'+_0x11efbc+_0x1fd578(0x30f);}function formatGeminiResponse(_0x24df99){const _0x3a027e=_0x272902;return _0x24df99[_0x3a027e(0x421)](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x4a0df2){const _0x4ba11b=_0x272902,_0x1a13f3=(_0x4a0df2||'')[_0x4ba11b(0x262)]('\x0a');let _0x186f93='',_0x1b0f89=null;const _0x50a717=()=>{const _0x5dde52=_0x4ba11b;_0x1b0f89&&(_0x186f93+=_0x1b0f89==='ol'?_0x5dde52(0x314):_0x5dde52(0x1cb),_0x1b0f89=null);};for(let _0x29a077 of _0x1a13f3){let _0x1869d9=(_0x29a077||'')[_0x4ba11b(0x2eb)]();if(!_0x1869d9){_0x50a717();continue;}if(_0x1869d9[_0x4ba11b(0x473)](_0x4ba11b(0x39b)))_0x50a717(),_0x186f93+=_0x4ba11b(0x246)+escapeHTML(_0x1869d9[_0x4ba11b(0x4b4)](0x5))+_0x4ba11b(0x265);else{if(/^\d+\.\s/[_0x4ba11b(0x3d4)](_0x1869d9)){_0x1b0f89!=='ol'&&(_0x50a717(),_0x186f93+=_0x4ba11b(0x1b3),_0x1b0f89='ol');const _0x31294e=_0x1869d9[_0x4ba11b(0x4b4)](_0x1869d9[_0x4ba11b(0x405)]('\x20')+0x1);_0x186f93+='<li>'+escapeHTML(_0x31294e)+_0x4ba11b(0x3cb);}else _0x1869d9[_0x4ba11b(0x473)]('-\x20')?(_0x1b0f89!=='ul'&&(_0x50a717(),_0x186f93+='<ul>',_0x1b0f89='ul'),_0x186f93+=_0x4ba11b(0x35f)+escapeHTML(_0x1869d9[_0x4ba11b(0x4b4)](0x2))+_0x4ba11b(0x3cb)):(_0x50a717(),_0x1869d9=escapeHTML(_0x1869d9)['replace'](/\*\*(.*?)\*\*/g,_0x4ba11b(0x349))['replace'](/_(.*?)_/g,_0x4ba11b(0x45c)),_0x186f93+='<p>'+_0x1869d9+'</p>');}}return _0x50a717(),_0x186f93;}function wrapTextInMarkdown(_0x34adaa,_0x1bfd8f,_0x881e56=''){const _0x2238ed=_0x272902;if(!_0x34adaa)return;const _0x3fdaa1=_0x34adaa['selectionStart']||0x0,_0x4139ef=_0x34adaa[_0x2238ed(0x1dd)]||0x0,_0x1e6731=_0x34adaa[_0x2238ed(0x472)][_0x2238ed(0x4b4)](_0x3fdaa1,_0x4139ef),_0x42e399=_0x1bfd8f+_0x1e6731+(_0x881e56||_0x1bfd8f);_0x34adaa[_0x2238ed(0x445)](_0x42e399,_0x3fdaa1,_0x4139ef,_0x2238ed(0x2ef)),_0x34adaa[_0x2238ed(0x259)]();}function updateEditorPreview(){const _0x1769b0=_0x272902,_0xd40852=$(_0x1769b0(0x461)),_0x13b963=$(_0x1769b0(0x2e9));if(!_0xd40852||!_0x13b963)return;const _0x2739d3=_0xd40852[_0x1769b0(0x472)]||'';_0x13b963['innerHTML']=parseSimpleMarkdown(_0x2739d3);}function normalizeDataStructure(_0x12191c){const _0x32e681=_0x272902;if(!_0x12191c||typeof _0x12191c!==_0x32e681(0x344))return;const _0x44b523=_0x12191c[_0x32e681(0x274)]||{},_0xc8c96c={...defaults[_0x32e681(0x274)],..._0x44b523,'durations':{...defaults[_0x32e681(0x274)][_0x32e681(0x43d)],..._0x44b523['durations']||{}}};if(!Array[_0x32e681(0x425)](_0xc8c96c[_0x32e681(0x2db)]))_0xc8c96c['achievedMilestones']=[];_0x12191c['settings']=_0xc8c96c,_0x12191c[_0x32e681(0x2b0)]=Array[_0x32e681(0x425)](_0x12191c['topics'])?_0x12191c[_0x32e681(0x2b0)]:[],_0x12191c['topics'][_0x32e681(0x2b6)](_0x17249d=>{const _0x42805b=_0x32e681;_0x17249d['subtopics']=Array[_0x42805b(0x425)](_0x17249d[_0x42805b(0x292)])?_0x17249d['subtopics']:[],_0x17249d[_0x42805b(0x292)][_0x42805b(0x2b6)](_0x22f7ee=>{const _0x191cfb=_0x42805b;_0x22f7ee[_0x191cfb(0x45d)]=_0x22f7ee[_0x191cfb(0x45d)]||[],_0x22f7ee[_0x191cfb(0x390)]=_0x22f7ee['generalNotes']||[],_0x22f7ee[_0x191cfb(0x1a7)]=_0x22f7ee[_0x191cfb(0x1a7)]||[],_0x22f7ee[_0x191cfb(0x3c7)]=_0x22f7ee['chatHistory']||[],_0x22f7ee[_0x191cfb(0x297)]=Array[_0x191cfb(0x425)](_0x22f7ee[_0x191cfb(0x297)])?_0x22f7ee[_0x191cfb(0x297)]:[],_0x22f7ee[_0x191cfb(0x1ad)]=_0x22f7ee[_0x191cfb(0x1ad)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x22f7ee['sessions']=_0x22f7ee[_0x191cfb(0x327)]||[],_0x22f7ee[_0x191cfb(0x3df)]=_0x22f7ee['timerState']||{'state':_0x191cfb(0x2c4),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x51047c){if(!_0x51047c)return null;const _0x24b897=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0xa1c105=_0x51047c['match'](_0x24b897);return _0xa1c105?_0xa1c105[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x212c0b=_0x272902;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0xe2e170=document[_0x212c0b(0x298)](_0x212c0b(0x43b)),_0x1929c3=(_0xe2e170&&_0xe2e170[_0x212c0b(0x472)]?_0xe2e170['value']:'')[_0x212c0b(0x2eb)]();return _0x1929c3;}catch(_0x2ce68e){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}async function migrateSharedMethodsToCurrentSubtopic(){const _0x53b8b9=_0x272902;try{const _0x153e93=data?.[_0x53b8b9(0x274)]?.['methods']||[];if(!Array[_0x53b8b9(0x425)](_0x153e93)||_0x153e93[_0x53b8b9(0x465)]===0x0)return;const _0x3f93ca=getCurrentSubtopic();if(!_0x3f93ca)return;(!Array[_0x53b8b9(0x425)](_0x3f93ca['methods'])||_0x3f93ca[_0x53b8b9(0x297)][_0x53b8b9(0x465)]===0x0)&&(_0x3f93ca['methods']=_0x153e93,data[_0x53b8b9(0x274)][_0x53b8b9(0x297)]=[],await saveData());}catch(_0x1f167e){}}function handleYoutubeUrlInput(){const _0x4ebd99=_0x272902,_0x2a8ebd=$('#set_youtubeUrl'),_0x13fafa=$(_0x4ebd99(0x231)),_0x28622e=$(_0x4ebd99(0x232)),_0x36df9e=_0x2a8ebd[_0x4ebd99(0x472)][_0x4ebd99(0x2eb)](),_0x56633a=extractYouTubeID(_0x36df9e);if(_0x56633a){_0x13fafa[_0x4ebd99(0x1ab)]='OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...',_0x13fafa['style']['color']=_0x4ebd99(0x278),_0x28622e[_0x4ebd99(0x35b)]=![],sessionYoutubeUrl=_0x36df9e;try{ytUserPaused=![];}catch(_0x30c730){}try{const _0x589273=_0x4ebd99(0x464)+_0x56633a+_0x4ebd99(0x315),_0x4668bf=new Image();_0x4668bf[_0x4ebd99(0x234)]=async()=>{const _0x36d9c1=_0x4ebd99;data[_0x36d9c1(0x274)][_0x36d9c1(0x26a)]=_0x589273;try{await saveData();}catch(_0xbb195b){}applyCustomBg();},_0x4668bf[_0x4ebd99(0x216)]=async()=>{const _0x2bf518=_0x4ebd99,_0x85c7e3=_0x2bf518(0x464)+_0x56633a+'/hqdefault.jpg';data[_0x2bf518(0x274)][_0x2bf518(0x26a)]=_0x85c7e3;try{await saveData();}catch(_0x5b0fe1){}applyCustomBg();},_0x4668bf[_0x4ebd99(0x407)]=_0x589273;}catch(_0x30cdc4){}try{if(IS_FILE_PROTOCOL){const _0x2f832d=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x56633a,{'autoplay':0x1,'mute':_0x2f832d});try{setTimeout(()=>{const _0x6c0f25=_0x4ebd99;try{fallbackPostMessage(_0x6c0f25(0x1cf));}catch(_0x5e96fb){}},0xfa);}catch(_0x308c64){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x39cec0=_0x4ebd99,_0x338185=document['getElementById'](_0x39cec0(0x2e1));if(_0x338185)_0x338185[_0x39cec0(0x1ab)]=_0x39cec0(0x41b);},0x1f4);}catch(_0x5eea69){}}else ensureYouTubeAPI()[_0x4ebd99(0x3d1)](()=>{const _0x5c04ff=_0x4ebd99;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer['mute']&&ytPlayer[_0x5c04ff(0x1cf)]&&(ytPlayer[_0x5c04ff(0x436)](),ytPlayer[_0x5c04ff(0x1cf)](),_ytPrimed=!![],showSoundPermission());}catch(_0x329f80){}})['catch'](()=>{});}catch(_0x20505c){}}else{if(_0x36df9e===''){_0x13fafa[_0x4ebd99(0x1ab)]='',_0x28622e[_0x4ebd99(0x35b)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x3afb9d){}else ytPlayer&&ytPlayer[_0x4ebd99(0x30e)]&&ytPlayer[_0x4ebd99(0x30e)]();}else _0x13fafa[_0x4ebd99(0x1ab)]=_0x4ebd99(0x438),_0x13fafa[_0x4ebd99(0x497)][_0x4ebd99(0x1bb)]=_0x4ebd99(0x3bd),_0x28622e['disabled']=!![];}}function applyTheme(_0x5b1d3d){const _0x4b8279=_0x272902,_0x59db9b=_0x5b1d3d||data['settings'][_0x4b8279(0x288)]||_0x4b8279(0x2c8);document[_0x4b8279(0x42f)][_0x4b8279(0x372)][_0x4b8279(0x288)]=_0x59db9b;const _0x7db185=[_0x4b8279(0x27a),_0x4b8279(0x22b)][_0x4b8279(0x29e)](_0x59db9b),_0x454aad=_0x59db9b===_0x4b8279(0x338)||_0x59db9b===_0x4b8279(0x378),_0x43c03a=data['settings'][_0x4b8279(0x26a)],_0x14f4be=()=>{const _0x37be06=_0x4b8279;try{document[_0x37be06(0x42f)][_0x37be06(0x497)]['backgroundImage']='';}catch(_0x425039){}};if(_0x43c03a&&!data[_0x4b8279(0x274)]['useYtThumbnailAsBg'])document[_0x4b8279(0x42f)]['style']['setProperty']('--bg-image','url('+_0x43c03a+')'),_0x14f4be();else{if(_0x43c03a&&data['settings'][_0x4b8279(0x42c)])document['body']['style'][_0x4b8279(0x3c4)](_0x4b8279(0x1c8),'url('+_0x43c03a+')'),_0x14f4be();else{if(_0x7db185)document[_0x4b8279(0x42f)][_0x4b8279(0x497)][_0x4b8279(0x2ca)](_0x4b8279(0x1c8)),_0x14f4be();else _0x454aad?(document[_0x4b8279(0x42f)][_0x4b8279(0x497)]['setProperty']('--bg-image','none'),_0x14f4be()):(document[_0x4b8279(0x42f)][_0x4b8279(0x497)]['setProperty']('--bg-image',''),document[_0x4b8279(0x42f)][_0x4b8279(0x497)][_0x4b8279(0x453)]='radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)');}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x272902(0x260),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':_0x272902(0x36d),'theme':_0x272902(0x2c8),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':_0x272902(0x3f3),'backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x272902(0x36e),'content':_0x272902(0x4a9)},{'id':uid('m'),'title':_0x272902(0x3e4),'content':'<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively—rather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later—once\x20you’ve\x20forgotten\x20the\x20original\x20style—use\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn’t\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses—turning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don’t\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>'},{'id':uid('m'),'title':'The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','content':_0x272902(0x212)},{'id':uid('m'),'title':_0x272902(0x3bf),'content':_0x272902(0x207)},{'id':uid('m'),'title':'Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','content':'<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20🧠</h4><p>Based\x20on\x20the\x20“Forgetting\x20Curve,”\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you’re\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you’ll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20📱</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20❌</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>—creating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010–20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory’s\x20“sweet\x20spot.”\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>'}]},'topics':[]};try{delete defaults['settings'][_0x272902(0x297)];}catch(_0x3daad6){}let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x2a19f3=_0x272902;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x2a19f3(0x3a4))]||window[(_0x2a19f3(0x39e))])();}function tone(_0x1a7b9f=0x370,_0x240aff=0xc8,_0x51cea3=0.2,_0x4b8337=_0x272902(0x1e6),_0x54a7b1=0x0){const _0x577150=_0x272902;ensureAudio();const _0x5e723f=AUDIO_CTX,_0x580ec0=_0x5e723f[_0x577150(0x30b)](),_0x12baf1=_0x5e723f[_0x577150(0x346)]();_0x580ec0[_0x577150(0x375)]=_0x4b8337,_0x580ec0[_0x577150(0x2cf)][_0x577150(0x472)]=_0x1a7b9f,_0x580ec0[_0x577150(0x482)](_0x12baf1),_0x12baf1[_0x577150(0x482)](_0x5e723f[_0x577150(0x1f8)]);const _0x2c15f8=_0x5e723f[_0x577150(0x252)]+_0x54a7b1;_0x12baf1[_0x577150(0x244)][_0x577150(0x1e3)](0x0,_0x2c15f8),_0x12baf1[_0x577150(0x244)][_0x577150(0x3f7)](_0x51cea3,_0x2c15f8+0.01),_0x12baf1['gain'][_0x577150(0x3ee)](0.0001,_0x2c15f8+_0x240aff/0x3e8),_0x580ec0['start'](_0x2c15f8),_0x580ec0['stop'](_0x2c15f8+_0x240aff/0x3e8+0.05);}function playSound(_0x370c95){const _0x23c839=_0x272902;if(!data[_0x23c839(0x274)][_0x23c839(0x1d0)])return;const _0x5aa1a0=Math['max'](0x0,Math[_0x23c839(0x443)](0x1,data['settings']['volume']??0.8)),_0x3be25f=data[_0x23c839(0x274)][_0x23c839(0x2f3)]?.[_0x370c95];let _0x579269;if(_0x370c95===_0x23c839(0x428))_0x579269=$('#audioWorkEnd');else{if(_0x370c95===_0x23c839(0x1eb))_0x579269=$(_0x23c839(0x4af));else{if(_0x370c95===_0x23c839(0x229))_0x579269=$('#audioLongEnd');}}if(_0x3be25f&&_0x579269){_0x3be25f[_0x23c839(0x473)]('data:')||_0x3be25f[_0x23c839(0x473)](_0x23c839(0x4b2))||_0x3be25f[_0x23c839(0x473)](_0x23c839(0x3f0))?(_0x579269[_0x23c839(0x407)]=_0x3be25f,_0x579269[_0x23c839(0x44b)]=_0x5aa1a0,_0x579269[_0x23c839(0x332)]()['catch'](_0x57ec1e=>console[_0x23c839(0x1bc)](_0x23c839(0x331),_0x57ec1e))):getStoredFileUrl(_0x3be25f)[_0x23c839(0x3d1)](_0x5d3e01=>{const _0x17124d=_0x23c839;_0x5d3e01&&(_0x579269[_0x17124d(0x407)]=_0x5d3e01,_0x579269[_0x17124d(0x44b)]=_0x5aa1a0,_0x579269[_0x17124d(0x332)]()['catch'](_0x366dfd=>console[_0x17124d(0x1bc)]('Audio\x20playback\x20error:',_0x366dfd)));});return;}const _0x41375c=data[_0x23c839(0x274)][_0x23c839(0x3cf)]||_0x23c839(0x36d);if(_0x41375c===_0x23c839(0x36d)){if(_0x370c95===_0x23c839(0x428))tone(0x370,0xfa,_0x5aa1a0),tone(0x294,0xb4,_0x5aa1a0*0.8,_0x23c839(0x1e6),0.22);else{if(_0x370c95===_0x23c839(0x1eb))tone(0x294,0xdc,_0x5aa1a0*0.9);else _0x370c95===_0x23c839(0x229)&&(tone(0x208,0xc8,_0x5aa1a0),tone(0x30c,0xc8,_0x5aa1a0,_0x23c839(0x1e6),0.22),tone(0x410,0xdc,_0x5aa1a0,_0x23c839(0x1e6),0.44));}}else{if(_0x370c95==='work_end')tone(0x4b0,0xa0,_0x5aa1a0*0.9,_0x23c839(0x27f)),tone(0x384,0xdc,_0x5aa1a0*0.8,_0x23c839(0x27f),0.18);else{if(_0x370c95===_0x23c839(0x1eb))tone(0x370,0xf0,_0x5aa1a0*0.8,_0x23c839(0x27f));else _0x370c95===_0x23c839(0x229)&&(tone(0x258,0xdc,_0x5aa1a0*0.9,'triangle'),tone(0x3b6,0xf0,_0x5aa1a0*0.9,'triangle',0.22),tone(0x4b0,0xf0,_0x5aa1a0,'triangle',0.44));}}}async function saveData(){const _0x2d7b20=_0x272902;try{await storageManager[_0x2d7b20(0x36a)](data);}catch(_0x28282e){console[_0x2d7b20(0x1bc)]('Failed\x20to\x20save\x20data:',_0x28282e),toast(_0x2d7b20(0x20b)+_0x28282e['message']);}}async function ensureValidSelection(){const _0x99b1f1=_0x272902,_0x34d915=data['settings'];if(!data[_0x99b1f1(0x2b0)]||data[_0x99b1f1(0x2b0)][_0x99b1f1(0x465)]===0x0){_0x34d915[_0x99b1f1(0x47e)]='',_0x34d915[_0x99b1f1(0x1ec)]='',await saveData();return;}const _0x4aa388=data[_0x99b1f1(0x2b0)][_0x99b1f1(0x2ad)](_0x563458=>_0x563458['id']===_0x34d915[_0x99b1f1(0x47e)]),_0x49901b=_0x4aa388?.[_0x99b1f1(0x292)][_0x99b1f1(0x2ad)](_0x16c113=>_0x16c113['id']===_0x34d915[_0x99b1f1(0x1ec)]);if(!_0x4aa388||!_0x49901b){const _0x36df79=data['topics'][0x0],_0x5f0121=_0x36df79?.[_0x99b1f1(0x292)]?.[0x0];_0x34d915['selectedTopicId']=_0x36df79?.['id']||'',_0x34d915[_0x99b1f1(0x1ec)]=_0x5f0121?.['id']||'',await saveData();}}function showInputModal(_0x15a27b,_0x5a4547,_0x4d14e0=''){const _0x2e9fbf=_0x272902;$('#genericTitle')['textContent']=_0x15a27b,$(_0x2e9fbf(0x200))[_0x2e9fbf(0x21e)][_0x2e9fbf(0x4b0)](_0x2e9fbf(0x3e2));const _0x2d0453=$('#genericInput');_0x2d0453['value']=_0x4d14e0,_0x2d0453[_0x2e9fbf(0x21e)][_0x2e9fbf(0x348)](_0x2e9fbf(0x3e2)),$(_0x2e9fbf(0x356))[_0x2e9fbf(0x21e)]['add'](_0x2e9fbf(0x264));try{trapFocus($(_0x2e9fbf(0x356)));}catch(_0x58b650){}_0x2d0453[_0x2e9fbf(0x259)](),_0x2d0453[_0x2e9fbf(0x38b)]();const _0x52f3dc=()=>{const _0x13eca4=_0x2e9fbf;_0x5a4547(_0x2d0453[_0x13eca4(0x472)]),_0x42f81a();},_0x555f6b=()=>_0x42f81a(),_0x568988=_0x48e8db=>{const _0x2e5b4d=_0x2e9fbf;if(_0x48e8db['key']===_0x2e5b4d(0x39f))_0x52f3dc();if(_0x48e8db[_0x2e5b4d(0x358)]===_0x2e5b4d(0x3da))_0x555f6b();};$(_0x2e9fbf(0x2d1))[_0x2e9fbf(0x2a5)]=_0x52f3dc,$('#btnGenericCancel')[_0x2e9fbf(0x2a5)]=_0x555f6b,_0x2d0453[_0x2e9fbf(0x3fb)]=_0x568988;function _0x42f81a(){const _0x4437ba=_0x2e9fbf;$('#modalGeneric')[_0x4437ba(0x21e)]['remove'](_0x4437ba(0x264)),$(_0x4437ba(0x2d1))[_0x4437ba(0x2a5)]=null,$(_0x4437ba(0x432))[_0x4437ba(0x2a5)]=null,_0x2d0453['onkeydown']=null;try{releaseFocus();}catch(_0x32dd61){}}}function showConfirmModal(_0xbfddb,_0x3f6e1c,_0x287d85){const _0x38dc41=_0x272902;$(_0x38dc41(0x352))[_0x38dc41(0x1ab)]=_0xbfddb;const _0x5d926e=$(_0x38dc41(0x200));_0x5d926e[_0x38dc41(0x1ab)]=_0x3f6e1c,_0x5d926e[_0x38dc41(0x21e)][_0x38dc41(0x348)](_0x38dc41(0x3e2)),$(_0x38dc41(0x2f1))[_0x38dc41(0x21e)][_0x38dc41(0x4b0)](_0x38dc41(0x3e2)),$('#modalGeneric')[_0x38dc41(0x21e)][_0x38dc41(0x4b0)](_0x38dc41(0x264));try{trapFocus($(_0x38dc41(0x356)));}catch(_0x20454f){}const _0x33bd54=()=>{_0x287d85(!![]),_0x27b707();},_0x1a1334=()=>{_0x287d85(![]),_0x27b707();};$(_0x38dc41(0x2d1))[_0x38dc41(0x2a5)]=_0x33bd54,$(_0x38dc41(0x432))['onclick']=_0x1a1334;function _0x27b707(){const _0x383c00=_0x38dc41;$(_0x383c00(0x356))[_0x383c00(0x21e)]['remove'](_0x383c00(0x264)),$(_0x383c00(0x2d1))[_0x383c00(0x2a5)]=null,$(_0x383c00(0x432))[_0x383c00(0x2a5)]=null;try{releaseFocus();}catch(_0x337ba1){}}}let pendingNoteSessionId=null;function openNoteModal(_0x27e254){const _0x52e843=_0x272902;pendingNoteSessionId=_0x27e254||null;const _0xe79325=$(_0x52e843(0x3d8));if(!_0xe79325)return;const _0x51fdbd=$(_0x52e843(0x2d7));if(_0x51fdbd)try{_0x51fdbd['value']='';}catch(_0x3c3794){}_0xe79325['classList']['add'](_0x52e843(0x264));try{trapFocus(_0xe79325);}catch(_0x4a81f6){}}function closeNoteModal(){const _0x179577=_0x272902,_0x453a4d=$(_0x179577(0x3d8));if(!_0x453a4d)return;_0x453a4d[_0x179577(0x21e)][_0x179577(0x348)](_0x179577(0x264)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x1be395){}}async function switchView(_0x31b477){const _0x5d7b64=_0x272902;$$(_0x5d7b64(0x318))[_0x5d7b64(0x2b6)](_0x568039=>_0x568039['classList'][_0x5d7b64(0x348)]('active')),$(_0x5d7b64(0x3a5)+_0x31b477)[_0x5d7b64(0x21e)][_0x5d7b64(0x4b0)](_0x5d7b64(0x1c0)),$$('.nav-btn')[_0x5d7b64(0x2b6)](_0x5c73e0=>_0x5c73e0[_0x5d7b64(0x21e)][_0x5d7b64(0x348)](_0x5d7b64(0x1c0)));const _0x54a273=$(_0x5d7b64(0x365)+_0x31b477+'\x22]');if(_0x54a273)_0x54a273[_0x5d7b64(0x21e)]['add'](_0x5d7b64(0x1c0));data['settings'][_0x5d7b64(0x4bd)]=_0x31b477,await saveData(),_0x31b477===_0x5d7b64(0x1ad)&&renderDashboard();}function closeAllMenus(){const _0x239d74=_0x272902;$$('.actions-menu.show')['forEach'](_0x701e6=>_0x701e6['classList'][_0x239d74(0x348)]('show')),$$('.topic-item.menu-active')[_0x239d74(0x2b6)](_0x34dd0b=>_0x34dd0b[_0x239d74(0x21e)][_0x239d74(0x348)](_0x239d74(0x45f)));}function renderTopics(){const _0x3bd7d6=_0x272902,_0x33513d=$(_0x3bd7d6(0x3fd));if(!_0x33513d)return;_0x33513d['innerHTML']='';const _0x56feb6=data[_0x3bd7d6(0x274)][_0x3bd7d6(0x281)]||{};data[_0x3bd7d6(0x2b0)]['forEach'](_0x5ea414=>{const _0x101af6=_0x3bd7d6,_0x2aeec7=document[_0x101af6(0x2bd)](_0x101af6(0x256));_0x2aeec7[_0x101af6(0x28d)]=_0x101af6(0x25a),_0x2aeec7[_0x101af6(0x372)][_0x101af6(0x2c0)]=_0x5ea414['id'];const _0x35d75a=document[_0x101af6(0x2bd)]('div');_0x35d75a['className']=_0x101af6(0x479);const _0x177265=!!_0x56feb6[_0x5ea414['id']],_0x4ba1d8=document[_0x101af6(0x2bd)](_0x101af6(0x434));_0x4ba1d8[_0x101af6(0x28d)]=_0x101af6(0x484),_0x4ba1d8[_0x101af6(0x233)](_0x101af6(0x31c),String(!_0x177265)),_0x4ba1d8[_0x101af6(0x273)]=_0x101af6(0x3bb);const _0x188172=document[_0x101af6(0x2bd)](_0x101af6(0x256));_0x188172[_0x101af6(0x28d)]='topic-title',_0x188172[_0x101af6(0x1ab)]=_0x5ea414[_0x101af6(0x1f0)];const _0x6caff=document[_0x101af6(0x2bd)](_0x101af6(0x256));_0x6caff[_0x101af6(0x28d)]=_0x101af6(0x3bc);const _0x504d9f=document['createElement'](_0x101af6(0x434));_0x504d9f[_0x101af6(0x28d)]=_0x101af6(0x283),_0x504d9f['innerHTML']='＋\x20Add',_0x504d9f[_0x101af6(0x3fa)]=_0x101af6(0x24d);const _0x54f469=document['createElement'](_0x101af6(0x256));_0x54f469[_0x101af6(0x497)][_0x101af6(0x2c2)]=_0x101af6(0x40b);const _0x307a92=document[_0x101af6(0x2bd)](_0x101af6(0x434));_0x307a92[_0x101af6(0x28d)]=_0x101af6(0x49b),_0x307a92['innerHTML']='...',_0x307a92['title']=_0x101af6(0x3b4);const _0xf518fb=document[_0x101af6(0x2bd)](_0x101af6(0x256));_0xf518fb[_0x101af6(0x28d)]='actions-menu';const _0x16ba23=document[_0x101af6(0x2bd)](_0x101af6(0x434));_0x16ba23[_0x101af6(0x28d)]=_0x101af6(0x1d3),_0x16ba23[_0x101af6(0x273)]=_0x101af6(0x3b0);const _0xf6ddcf=document[_0x101af6(0x2bd)](_0x101af6(0x434));_0xf6ddcf[_0x101af6(0x28d)]=_0x101af6(0x47b),_0xf6ddcf[_0x101af6(0x273)]=_0x101af6(0x44a),_0xf518fb[_0x101af6(0x36c)](_0x16ba23,_0xf6ddcf),_0x54f469[_0x101af6(0x36c)](_0x307a92,_0xf518fb),_0x6caff[_0x101af6(0x36c)](_0x504d9f,_0x54f469),_0x35d75a[_0x101af6(0x36c)](_0x4ba1d8,_0x188172,_0x6caff),_0x4ba1d8[_0x101af6(0x3ea)](_0x101af6(0x477),async _0x231f2b=>{const _0x47f5b3=_0x101af6;_0x231f2b[_0x47f5b3(0x1bf)]();const _0x12cd5c=!!_0x56feb6[_0x5ea414['id']];_0x12cd5c?delete _0x56feb6[_0x5ea414['id']]:_0x56feb6[_0x5ea414['id']]=!![],data['settings'][_0x47f5b3(0x281)]=_0x56feb6,await storageManager['updateSettings'](data['settings']),renderTopics();});const _0x505c0d=async()=>{const _0xb89ff9=_0x101af6,_0xd636e4=!!_0x56feb6[_0x5ea414['id']];_0xd636e4?delete _0x56feb6[_0x5ea414['id']]:_0x56feb6[_0x5ea414['id']]=!![],data[_0xb89ff9(0x274)][_0xb89ff9(0x281)]=_0x56feb6,await storageManager[_0xb89ff9(0x468)](data[_0xb89ff9(0x274)]),renderTopics();};_0x35d75a[_0x101af6(0x3ea)](_0x101af6(0x477),async _0x41acf3=>{const _0xa9709=_0x101af6,_0x3fcd2c=_0x41acf3[_0xa9709(0x449)];if(_0x3fcd2c&&_0x3fcd2c[_0xa9709(0x418)]){if(_0x3fcd2c[_0xa9709(0x418)](_0xa9709(0x415))||_0x3fcd2c[_0xa9709(0x418)](_0xa9709(0x422))||_0x3fcd2c['closest'](_0xa9709(0x434))||_0x3fcd2c[_0xa9709(0x418)]('input,select,textarea'))return;}_0x41acf3['stopPropagation'](),await _0x505c0d();}),_0x188172['addEventListener'](_0x101af6(0x477),async _0x54c9a5=>{_0x54c9a5['stopPropagation'](),await _0x505c0d();}),_0x2aeec7[_0x101af6(0x3ea)](_0x101af6(0x477),async _0x49083d=>{const _0x4b35a8=_0x101af6,_0x3dc34f=_0x49083d[_0x4b35a8(0x449)];if(_0x3dc34f&&_0x3dc34f[_0x4b35a8(0x418)]){if(_0x3dc34f[_0x4b35a8(0x418)](_0x4b35a8(0x2b8)))return;if(_0x3dc34f[_0x4b35a8(0x418)](_0x4b35a8(0x415))||_0x3dc34f['closest']('.actions-menu-btn')||_0x3dc34f[_0x4b35a8(0x418)](_0x4b35a8(0x434))||_0x3dc34f['closest'](_0x4b35a8(0x280)))return;}await _0x505c0d();});const _0x582312=document[_0x101af6(0x2bd)](_0x101af6(0x256));_0x582312['className']=_0x101af6(0x292)+(_0x177265?_0x101af6(0x3e0):''),_0x582312[_0x101af6(0x372)]['tid']=_0x5ea414['id'],_0x5ea414['subtopics']['forEach'](_0x321f85=>{const _0x4a76da=_0x101af6,_0x2687aa=document['createElement'](_0x4a76da(0x256));_0x2687aa[_0x4a76da(0x28d)]=_0x4a76da(0x240),_0x2687aa[_0x4a76da(0x372)][_0x4a76da(0x410)]=_0x321f85['id'];const _0x2adfd5=document['createElement'](_0x4a76da(0x434));_0x2adfd5[_0x4a76da(0x28d)]=_0x4a76da(0x3f6),_0x2adfd5[_0x4a76da(0x1ab)]='•\x20'+_0x321f85[_0x4a76da(0x1f0)],_0x2adfd5[_0x4a76da(0x372)][_0x4a76da(0x410)]=_0x321f85['id'],_0x2adfd5[_0x4a76da(0x372)][_0x4a76da(0x2c0)]=_0x5ea414['id'];if(data[_0x4a76da(0x274)][_0x4a76da(0x1ec)]===_0x321f85['id'])_0x2adfd5['classList'][_0x4a76da(0x4b0)](_0x4a76da(0x1c0));const _0x4b1314=document['createElement'](_0x4a76da(0x256));_0x4b1314['className']=_0x4a76da(0x439);const _0x1fd604=document['createElement'](_0x4a76da(0x256));_0x1fd604[_0x4a76da(0x497)]['position']=_0x4a76da(0x40b);const _0x56b801=document[_0x4a76da(0x2bd)]('button');_0x56b801[_0x4a76da(0x28d)]=_0x4a76da(0x49b),_0x56b801[_0x4a76da(0x273)]=_0x4a76da(0x249),_0x56b801[_0x4a76da(0x3fa)]=_0x4a76da(0x3b4);const _0x4cff22=document['createElement']('div');_0x4cff22['className']=_0x4a76da(0x2ec);const _0x24db52=document[_0x4a76da(0x2bd)]('button');_0x24db52[_0x4a76da(0x28d)]='menu-item',_0x24db52[_0x4a76da(0x273)]=_0x4a76da(0x2b2);const _0x58ca0f=document['createElement'](_0x4a76da(0x434));_0x58ca0f[_0x4a76da(0x28d)]=_0x4a76da(0x47b),_0x58ca0f[_0x4a76da(0x273)]=_0x4a76da(0x20f),_0x4cff22[_0x4a76da(0x36c)](_0x24db52,_0x58ca0f),_0x1fd604['append'](_0x56b801,_0x4cff22),_0x4b1314['append'](_0x1fd604),_0x2687aa[_0x4a76da(0x36c)](_0x2adfd5,_0x4b1314),_0x582312[_0x4a76da(0x3af)](_0x2687aa),_0x2adfd5['addEventListener'](_0x4a76da(0x477),()=>selectSubtopic(_0x5ea414['id'],_0x321f85['id'])),_0x56b801[_0x4a76da(0x3ea)]('click',_0x581505=>{const _0x5659a9=_0x4a76da;_0x581505[_0x5659a9(0x1bf)]();const _0x6ae38e=_0x4cff22[_0x5659a9(0x21e)][_0x5659a9(0x214)](_0x5659a9(0x264));closeAllMenus(),_0x6ae38e?_0x2aeec7[_0x5659a9(0x21e)][_0x5659a9(0x348)](_0x5659a9(0x45f)):(_0x4cff22[_0x5659a9(0x21e)][_0x5659a9(0x4b0)](_0x5659a9(0x264)),_0x2aeec7[_0x5659a9(0x21e)][_0x5659a9(0x4b0)](_0x5659a9(0x45f)));}),_0x24db52[_0x4a76da(0x3ea)]('click',()=>showInputModal(_0x4a76da(0x2b2),async _0x313a37=>{const _0x30a03f=_0x4a76da;if(!_0x313a37)return;_0x321f85[_0x30a03f(0x1f0)]=_0x313a37,await storageManager[_0x30a03f(0x498)]('subtopics',_0x321f85),renderAll();},_0x321f85[_0x4a76da(0x1f0)])),_0x58ca0f[_0x4a76da(0x3ea)](_0x4a76da(0x477),()=>showConfirmModal(_0x4a76da(0x3ab),_0x4a76da(0x4a5)+_0x321f85['name']+_0x4a76da(0x343),async _0x16aa0f=>{const _0x4a489e=_0x4a76da;if(!_0x16aa0f)return;_0x5ea414['subtopics']=_0x5ea414[_0x4a489e(0x292)][_0x4a489e(0x1fb)](_0x2cff7c=>_0x2cff7c['id']!==_0x321f85['id']);const _0x4d2c1f=data[_0x4a489e(0x274)];_0x4d2c1f[_0x4a489e(0x1ec)]===_0x321f85['id']&&(_0x4d2c1f[_0x4a489e(0x1ec)]='',_0x4d2c1f[_0x4a489e(0x47e)]='',ensureValidSelection()),await storageManager[_0x4a489e(0x49f)](_0x4a489e(0x292),_0x321f85['id']),renderAll();}));}),_0x307a92[_0x101af6(0x3ea)](_0x101af6(0x477),_0x19d084=>{const _0x3ac302=_0x101af6;_0x19d084[_0x3ac302(0x1bf)]();const _0x3e8a31=_0xf518fb[_0x3ac302(0x21e)][_0x3ac302(0x214)](_0x3ac302(0x264));closeAllMenus(),_0x3e8a31?_0x2aeec7[_0x3ac302(0x21e)]['remove'](_0x3ac302(0x45f)):(_0xf518fb['classList'][_0x3ac302(0x4b0)](_0x3ac302(0x264)),_0x2aeec7['classList']['add'](_0x3ac302(0x45f)));}),_0x504d9f[_0x101af6(0x3ea)]('click',()=>showInputModal(_0x101af6(0x205),async _0x18476f=>{const _0x4c656f=_0x101af6;if(!_0x18476f)return;const _0x4e9898={'id':uid('s'),'topicId':_0x5ea414['id'],'name':_0x18476f,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':'idle','prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};try{const _0x57987a=data?.['settings']?.[_0x4c656f(0x297)]||[];Array[_0x4c656f(0x425)](_0x57987a)&&_0x57987a[_0x4c656f(0x465)]>0x0&&(_0x4e9898[_0x4c656f(0x297)]=_0x57987a,data[_0x4c656f(0x274)][_0x4c656f(0x297)]=[],await storageManager[_0x4c656f(0x468)](data['settings']));}catch(_0xede293){}_0x5ea414[_0x4c656f(0x292)][_0x4c656f(0x34a)](_0x4e9898),await storageManager['add'](_0x4c656f(0x292),_0x4e9898),renderTopics();})),_0x16ba23[_0x101af6(0x3ea)](_0x101af6(0x477),()=>showInputModal('Rename\x20Topic',async _0x43e770=>{const _0x190e59=_0x101af6;if(!_0x43e770)return;_0x5ea414[_0x190e59(0x1f0)]=_0x43e770,await storageManager[_0x190e59(0x498)](_0x190e59(0x2b0),_0x5ea414),renderTopics();},_0x5ea414[_0x101af6(0x1f0)])),_0xf6ddcf[_0x101af6(0x3ea)](_0x101af6(0x477),()=>showConfirmModal(_0x101af6(0x3ab),_0x101af6(0x350)+_0x5ea414['name']+_0x101af6(0x44e),async _0x2c8ff5=>{const _0x528cbd=_0x101af6;if(!_0x2c8ff5)return;data[_0x528cbd(0x2b0)]=data[_0x528cbd(0x2b0)][_0x528cbd(0x1fb)](_0x54aea0=>_0x54aea0['id']!==_0x5ea414['id']),delete _0x56feb6[_0x5ea414['id']];data[_0x528cbd(0x274)][_0x528cbd(0x47e)]===_0x5ea414['id']&&(data[_0x528cbd(0x274)][_0x528cbd(0x47e)]='',data['settings'][_0x528cbd(0x1ec)]='',ensureValidSelection());await storageManager['delete'](_0x528cbd(0x2b0),_0x5ea414['id']);for(const _0x18657e of _0x5ea414[_0x528cbd(0x292)]){await storageManager[_0x528cbd(0x49f)](_0x528cbd(0x292),_0x18657e['id']);}renderAll();})),_0x504d9f[_0x101af6(0x3ea)](_0x101af6(0x477),_0x4d1be4=>_0x4d1be4[_0x101af6(0x1bf)]()),_0x16ba23[_0x101af6(0x3ea)]('click',_0x4f0ffd=>_0x4f0ffd[_0x101af6(0x1bf)]()),_0xf6ddcf[_0x101af6(0x3ea)](_0x101af6(0x477),_0x10da7d=>_0x10da7d[_0x101af6(0x1bf)]()),_0x2aeec7[_0x101af6(0x36c)](_0x35d75a,_0x582312),_0x33513d[_0x101af6(0x3af)](_0x2aeec7);});if(window[_0x3bd7d6(0x241)]){const _0x28e04c=document['getElementById'](_0x3bd7d6(0x441));if(_0x28e04c){if(_0x28e04c['_sortable'])try{_0x28e04c[_0x3bd7d6(0x2aa)][_0x3bd7d6(0x3ff)]();}catch(_0x44efbc){}_0x28e04c[_0x3bd7d6(0x2aa)]=new Sortable(_0x28e04c,{'animation':0x96,'draggable':_0x3bd7d6(0x286),'onEnd':async function(_0x5be25b){const _0x360ee9=_0x3bd7d6;if(_0x5be25b[_0x360ee9(0x4b1)]===_0x5be25b[_0x360ee9(0x49c)])return;const _0x9bbd42=data[_0x360ee9(0x2b0)]['splice'](_0x5be25b[_0x360ee9(0x4b1)],0x1)[0x0];data[_0x360ee9(0x2b0)][_0x360ee9(0x485)](_0x5be25b[_0x360ee9(0x49c)],0x0,_0x9bbd42),await saveData(),renderTopics();}}),_0x28e04c['querySelectorAll'](_0x3bd7d6(0x2b8))[_0x3bd7d6(0x2b6)](_0x357569=>{const _0x3e21b1=_0x3bd7d6;new Sortable(_0x357569,{'group':_0x3e21b1(0x49e),'animation':0x96,'draggable':_0x3e21b1(0x1e1),'onEnd':async function(_0x79da2){const _0x5ddad2=_0x3e21b1,_0x26ee39=_0x79da2[_0x5ddad2(0x2f5)]?.[_0x5ddad2(0x372)]?.[_0x5ddad2(0x2c0)]||_0x79da2[_0x5ddad2(0x2f5)]?.[_0x5ddad2(0x418)]('.topic-item')?.[_0x5ddad2(0x372)]?.['tid'],_0x4dbc11=_0x79da2['to']?.[_0x5ddad2(0x372)]?.[_0x5ddad2(0x2c0)]||_0x79da2['to']?.[_0x5ddad2(0x418)](_0x5ddad2(0x286))?.[_0x5ddad2(0x372)]?.[_0x5ddad2(0x2c0)],_0x4b2ab1=data[_0x5ddad2(0x2b0)]['find'](_0x25560f=>_0x25560f['id']===_0x26ee39),_0x75fa29=data['topics'][_0x5ddad2(0x2ad)](_0x35dc61=>_0x35dc61['id']===_0x4dbc11);if(!_0x4b2ab1||!_0x75fa29)return;let _0x568a8b=null;const _0x419869=_0x79da2[_0x5ddad2(0x1ed)]?.[_0x5ddad2(0x372)]?.['sid']||_0x79da2['item']?.['querySelector'](_0x5ddad2(0x47f))?.[_0x5ddad2(0x372)]?.[_0x5ddad2(0x410)];if(_0x419869){const _0x114b3d=_0x4b2ab1['subtopics'][_0x5ddad2(0x400)](_0x9582d9=>_0x9582d9['id']===_0x419869);if(_0x114b3d>=0x0)_0x568a8b=_0x4b2ab1[_0x5ddad2(0x292)][_0x5ddad2(0x485)](_0x114b3d,0x1)[0x0];}!_0x568a8b&&(_0x568a8b=_0x4b2ab1['subtopics']['splice'](_0x79da2['oldIndex'],0x1)[0x0]);if(!_0x568a8b)return;_0x568a8b['topicId']=_0x75fa29['id'],_0x75fa29[_0x5ddad2(0x292)][_0x5ddad2(0x485)](_0x79da2[_0x5ddad2(0x49c)],0x0,_0x568a8b),data['settings'][_0x5ddad2(0x1ec)]===_0x568a8b['id']&&(data['settings'][_0x5ddad2(0x47e)]=_0x75fa29['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x1f3ca3,_0x43a7e2){const _0x165880=_0x272902,_0x523ea1=$(_0x165880(0x4ba)),_0x5ef299=getCurrentSubtopic();_0x5ef299&&timer['state']!==_0x165880(0x2c4)&&(_0x5ef299[_0x165880(0x3df)]={'state':timer['state'],'prevState':timer[_0x165880(0x4a2)],'remaining':timer['remaining'],'segmentTotal':timer['segmentTotal'],'cycleIndex':timer[_0x165880(0x1e0)]}),_0x523ea1['classList'][_0x165880(0x4b0)]('reloading'),setTimeout(async()=>{const _0x294d7d=_0x165880;data['settings'][_0x294d7d(0x47e)]=_0x1f3ca3,data[_0x294d7d(0x274)][_0x294d7d(0x1ec)]=_0x43a7e2;const _0x429226=getCurrentSubtopic();_0x429226['timerState']?(timer[_0x294d7d(0x470)]=_0x429226[_0x294d7d(0x3df)]['state'],timer[_0x294d7d(0x4a2)]=_0x429226['timerState'][_0x294d7d(0x4a2)]||null,timer[_0x294d7d(0x41a)]=_0x429226[_0x294d7d(0x3df)]['remaining'],timer['segmentTotal']=_0x429226[_0x294d7d(0x3df)][_0x294d7d(0x392)],timer[_0x294d7d(0x1e0)]=_0x429226[_0x294d7d(0x3df)][_0x294d7d(0x1e0)]):timer[_0x294d7d(0x46d)](),await saveData(),timer['updateUI'](),renderAll(),switchView(_0x294d7d(0x260)),_0x523ea1[_0x294d7d(0x21e)][_0x294d7d(0x348)](_0x294d7d(0x1d8));},0xc8);}function getCurrentSubtopic(){const _0x155c3f=_0x272902,_0x3578db=data['settings'][_0x155c3f(0x47e)],_0x582b99=data[_0x155c3f(0x274)][_0x155c3f(0x1ec)];if(!_0x3578db||!_0x582b99)return null;const _0x4ecb12=data[_0x155c3f(0x2b0)][_0x155c3f(0x2ad)](_0x40b902=>_0x40b902['id']===_0x3578db);if(!_0x4ecb12)return null;return _0x4ecb12[_0x155c3f(0x292)][_0x155c3f(0x2ad)](_0x4dd613=>_0x4dd613['id']===_0x582b99)||null;}function renderContextBadge(){const _0x3da80c=_0x272902,_0x4745ed=getCurrentSubtopic(),_0x530af1=_0x4745ed?_0x4745ed[_0x3da80c(0x1f0)]:'(none\x20selected)',_0x2394d0=$(_0x3da80c(0x25b)),_0x2588a2=$(_0x3da80c(0x411)),_0xe9083=$('#currentSubtopicNameChat');if(_0x2394d0)_0x2394d0[_0x3da80c(0x1ab)]=_0x4745ed?_0x3da80c(0x26d)+_0x4745ed[_0x3da80c(0x1f0)]:_0x3da80c(0x1be);if(_0x2588a2)_0x2588a2[_0x3da80c(0x1ab)]=_0x530af1;if(_0xe9083)_0xe9083[_0x3da80c(0x1ab)]=_0x530af1;}function renderSubtopicTasks(){const _0x4abb78=_0x272902,_0x49c425=getCurrentSubtopic(),_0x401d3b=$('#subtopicTasksList'),_0xad1087=$(_0x4abb78(0x454));if(!_0x401d3b||!_0xad1087)return;const _0x14ee40=_0xad1087['parentElement'];if(!_0x49c425){_0x401d3b[_0x4abb78(0x273)]=_0x4abb78(0x1af),_0x14ee40[_0x4abb78(0x21e)][_0x4abb78(0x4b0)](_0x4abb78(0x3e2));return;}_0x14ee40[_0x4abb78(0x21e)][_0x4abb78(0x348)](_0x4abb78(0x3e2)),_0x401d3b[_0x4abb78(0x273)]='';const _0x2dd955=_0x49c425[_0x4abb78(0x45d)]?_0x49c425[_0x4abb78(0x45d)][_0x4abb78(0x1fb)](_0x5b48bf=>!_0x5b48bf['isCompleted']):[];_0x2dd955['length']===0x0&&(_0x401d3b[_0x4abb78(0x273)]=_0x4abb78(0x336)),_0x2dd955[_0x4abb78(0x2b6)](_0x48291e=>{const _0x55d342=_0x4abb78,_0x5944c6=document['createElement']('li');_0x5944c6[_0x55d342(0x273)]=_0x55d342(0x324)+_0x48291e['id']+'\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22'+_0x48291e['id']+'\x22>'+escapeHTML(_0x48291e[_0x55d342(0x2c5)])+_0x55d342(0x38c),_0x5944c6[_0x55d342(0x23f)](_0x55d342(0x25c))[_0x55d342(0x3ea)](_0x55d342(0x3b3),_0x343512=>toggleSubtopicTask(_0x343512[_0x55d342(0x449)]['id'],_0x5944c6)),_0x401d3b[_0x55d342(0x3af)](_0x5944c6);});}async function addSubtopicTask(){const _0xc6b4ca=_0x272902,_0x34c754=getCurrentSubtopic();if(!_0x34c754){toast(t(_0xc6b4ca(0x224)));return;}const _0x501b8e=$(_0xc6b4ca(0x454)),_0x43084c=_0x501b8e[_0xc6b4ca(0x472)][_0xc6b4ca(0x2eb)]();if(_0x43084c){if(!_0x34c754[_0xc6b4ca(0x45d)])_0x34c754[_0xc6b4ca(0x45d)]=[];_0x34c754['tasks'][_0xc6b4ca(0x34a)]({'id':uid(_0xc6b4ca(0x413)),'text':_0x43084c,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x501b8e['value']='';}_0x501b8e[_0xc6b4ca(0x259)]();}async function toggleSubtopicTask(_0x712ff3,_0x3a7a99){const _0x39873c=_0x272902,_0x333065=getCurrentSubtopic();if(!_0x333065||!_0x333065['tasks'])return;const _0x4de922=_0x333065[_0x39873c(0x45d)][_0x39873c(0x2ad)](_0x1b3a51=>_0x1b3a51['id']===_0x712ff3);_0x4de922&&(_0x4de922['isCompleted']=!![],_0x333065['stats'][_0x39873c(0x2d3)]=(_0x333065[_0x39873c(0x1ad)][_0x39873c(0x2d3)]||0x0)+0x1,await saveData(),_0x3a7a99[_0x39873c(0x21e)][_0x39873c(0x4b0)](_0x39873c(0x2b3)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':_0x272902(0x2c4),'prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x4529dd,{silent:silent=![]}={}){const _0xf87789=_0x272902,_0x1f500e=data[_0xf87789(0x274)];this[_0xf87789(0x3fc)]=_0x4529dd,this[_0xf87789(0x1b8)]=_0x4529dd==='A'?_0x1f500e[_0xf87789(0x37c)]:_0x4529dd==='B'?_0x1f500e[_0xf87789(0x2b1)]:0x0,_0x1f500e[_0xf87789(0x247)]=_0x4529dd,await saveData(),this[_0xf87789(0x470)]===_0xf87789(0x2c4)&&this[_0xf87789(0x46d)]();},'currentDurations'(){const _0x1dbf67=_0x272902,_0x211172=data['settings'][_0x1dbf67(0x43d)];if(this[_0x1dbf67(0x3fc)]==='A')return{'work':_0x211172[_0x1dbf67(0x2dc)],'short':_0x211172['A_short'],'long':_0x211172[_0x1dbf67(0x48c)],'winddown':_0x211172[_0x1dbf67(0x475)]??0x0};if(this[_0x1dbf67(0x3fc)]==='B')return{'work':_0x211172[_0x1dbf67(0x46f)],'short':_0x211172[_0x1dbf67(0x303)],'long':_0x211172[_0x1dbf67(0x3ad)],'winddown':_0x211172[_0x1dbf67(0x28e)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x852cc3=_0x272902,_0x3283a1=data[_0x852cc3(0x274)];if(this[_0x852cc3(0x3fc)]==='A')return{'cycles':_0x3283a1['cyclesA'],'interval':_0x3283a1['longBreakIntervalA']};if(this[_0x852cc3(0x3fc)]==='B')return{'cycles':_0x3283a1['cyclesB'],'interval':_0x3283a1['longBreakIntervalB']};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x5f0bae=_0x272902,_0x48221a=$(_0x5f0bae(0x32a)),_0x432215=$(_0x5f0bae(0x1f1)),_0x5f45c2=$(_0x5f0bae(0x369));if(!_0x48221a||!_0x432215||!_0x5f45c2)return;const _0x367342=this[_0x5f0bae(0x3fc)]==='C';$(_0x5f0bae(0x2d8))[_0x5f0bae(0x21e)][_0x5f0bae(0x412)](_0x5f0bae(0x3e2),this['state']!=='idle'||_0x367342&&this[_0x5f0bae(0x470)]==='work'),$(_0x5f0bae(0x3dd))[_0x5f0bae(0x21e)][_0x5f0bae(0x412)](_0x5f0bae(0x3e2),!(_0x367342&&this[_0x5f0bae(0x470)]===_0x5f0bae(0x204))),$(_0x5f0bae(0x398))['classList'][_0x5f0bae(0x412)](_0x5f0bae(0x3e2),![_0x5f0bae(0x204),_0x5f0bae(0x34d),_0x5f0bae(0x360)][_0x5f0bae(0x29e)](this[_0x5f0bae(0x470)])),$(_0x5f0bae(0x4bc))[_0x5f0bae(0x21e)]['toggle']('hidden',this[_0x5f0bae(0x470)]!==_0x5f0bae(0x45e));let _0x4d341b=_0x5f0bae(0x38a);if(this['state']==='work')_0x48221a[_0x5f0bae(0x1ab)]=_0x367342?_0x5f0bae(0x3a3):_0x5f0bae(0x4aa),_0x48221a[_0x5f0bae(0x28d)]=_0x5f0bae(0x2da),_0x4d341b='var(--acc)';else{if(this[_0x5f0bae(0x470)]===_0x5f0bae(0x34d))_0x48221a['textContent']=_0x5f0bae(0x313),_0x48221a[_0x5f0bae(0x28d)]=_0x5f0bae(0x1de),_0x4d341b=_0x5f0bae(0x3e5);else{if(this[_0x5f0bae(0x470)]==='long_break')_0x48221a[_0x5f0bae(0x1ab)]=_0x5f0bae(0x30c),_0x48221a[_0x5f0bae(0x28d)]='badge\x20state\x20long',_0x4d341b='var(--danger)';else{if(this[_0x5f0bae(0x470)]===_0x5f0bae(0x35e)){_0x48221a['textContent']=_0x5f0bae(0x299),_0x48221a[_0x5f0bae(0x28d)]=_0x5f0bae(0x2da),_0x4d341b='var(--acc-2)';try{$(_0x5f0bae(0x1d7))[_0x5f0bae(0x21e)][_0x5f0bae(0x348)](_0x5f0bae(0x3e2)),$(_0x5f0bae(0x2a0))[_0x5f0bae(0x21e)][_0x5f0bae(0x348)](_0x5f0bae(0x3e2));}catch(_0x573afc){}}else this[_0x5f0bae(0x470)]==='paused'?(_0x48221a[_0x5f0bae(0x1ab)]='PAUSED',_0x48221a[_0x5f0bae(0x28d)]=_0x5f0bae(0x2e2)):(_0x48221a[_0x5f0bae(0x1ab)]=_0x5f0bae(0x469),_0x48221a['className']=_0x5f0bae(0x2e2));}}}[_0x5f0bae(0x204),_0x5f0bae(0x34d),'long_break','wind_down']['includes'](this[_0x5f0bae(0x470)])?_0x5f45c2[_0x5f0bae(0x21e)][_0x5f0bae(0x4b0)](_0x5f0bae(0x3b5)):_0x5f45c2[_0x5f0bae(0x21e)][_0x5f0bae(0x348)](_0x5f0bae(0x3b5));_0x432215[_0x5f0bae(0x497)]['stroke']=_0x4d341b,_0x5f45c2[_0x5f0bae(0x21e)][_0x5f0bae(0x348)]('finished');const _0x147fb4=$(_0x5f0bae(0x1ce));if(_0x147fb4)_0x147fb4[_0x5f0bae(0x1ab)]=formatMMSS(this[_0x5f0bae(0x41a)]);const _0x3aaac0=_0x432215['r']['baseVal'][_0x5f0bae(0x472)],_0x53c085=0x2*Math['PI']*_0x3aaac0,_0x1e831c=this['segmentTotal']>0x0?_0x53c085-this[_0x5f0bae(0x41a)]/this[_0x5f0bae(0x392)]*_0x53c085:_0x53c085;_0x432215['style']['strokeDasharray']=_0x53c085,_0x432215['style'][_0x5f0bae(0x3c5)]=isNaN(_0x1e831c)?_0x53c085:_0x1e831c;const _0x97c7e=$('#cycleInfo');if(_0x97c7e){const _0x500654=this[_0x5f0bae(0x4b7)]();_0x97c7e[_0x5f0bae(0x1ab)]=t(_0x5f0bae(0x2c1),{'current':this[_0x5f0bae(0x1e0)],'target':_0x500654[_0x5f0bae(0x353)]}),_0x97c7e[_0x5f0bae(0x21e)][_0x5f0bae(0x412)](_0x5f0bae(0x3e2),_0x367342);}const _0x4446dd=$(_0x5f0bae(0x31d));_0x4446dd&&_0x4446dd[_0x5f0bae(0x21e)][_0x5f0bae(0x412)](_0x5f0bae(0x3e2),_0x367342&&this[_0x5f0bae(0x470)]===_0x5f0bae(0x204));const _0x4efa72=$(_0x5f0bae(0x287));if(_0x4efa72)_0x4efa72[_0x5f0bae(0x1ab)]=formatMMSS(this[_0x5f0bae(0x41a)]);if(this[_0x5f0bae(0x470)]!==_0x5f0bae(0x35e))try{$(_0x5f0bae(0x1d7))[_0x5f0bae(0x21e)]['add'](_0x5f0bae(0x3e2)),$(_0x5f0bae(0x2a0))['classList'][_0x5f0bae(0x4b0)](_0x5f0bae(0x3e2));}catch(_0x2dddb1){}},'persistTimerState'(_0x53dada=![]){const _0x343c74=_0x272902;try{const _0x2e5142=getCurrentSubtopic();if(!_0x2e5142)return;const _0x255830={'state':this[_0x343c74(0x470)],'prevState':this[_0x343c74(0x4a2)],'remaining':this[_0x343c74(0x41a)],'segmentTotal':this['segmentTotal'],'cycleIndex':this[_0x343c74(0x1e0)]};_0x2e5142['timerState']=_0x255830;try{localStorage[_0x343c74(0x1b5)]('timerState_'+_0x2e5142['id'],JSON['stringify'](_0x255830));}catch(_0x16fb4c){}this[_0x343c74(0x2d2)]=Date[_0x343c74(0x404)]();}catch(_0x2e179c){}},'_startTick'(){const _0x2b18c8=_0x272902;if(this[_0x2b18c8(0x451)])clearInterval(this[_0x2b18c8(0x451)]);if(this[_0x2b18c8(0x3fc)]==='C'&&this[_0x2b18c8(0x470)]===_0x2b18c8(0x204)){this['tickHandle']=setInterval(()=>{const _0x23bf4c=_0x2b18c8;this[_0x23bf4c(0x41a)]+=0x1,this['updateUI'](),this[_0x23bf4c(0x1fa)]();},0x3e8);return;}this[_0x2b18c8(0x451)]=setInterval(()=>{const _0x388a1b=_0x2b18c8;this[_0x388a1b(0x41a)]>0x0&&(this['remaining']-=0x1,this[_0x388a1b(0x4b5)](),this[_0x388a1b(0x1fa)]()),this['remaining']<=0x0&&(clearInterval(this[_0x388a1b(0x451)]),this[_0x388a1b(0x451)]=null,this[_0x388a1b(0x20c)]());},0x3e8);},'_onFinishSegment'(){const _0x5590e4=_0x272902;if(this[_0x5590e4(0x470)]==='work'){const _0x16db9b=getCurrentSubtopic();if(_0x16db9b){const _0x5643b5=this[_0x5590e4(0x3be)]()['work'];_0x16db9b[_0x5590e4(0x1ad)]['totalMinutes']=(_0x16db9b[_0x5590e4(0x1ad)][_0x5590e4(0x35c)]||0x0)+_0x5643b5,_0x16db9b[_0x5590e4(0x1ad)]['sessionsCompleted']=(_0x16db9b[_0x5590e4(0x1ad)][_0x5590e4(0x437)]||0x0)+0x1;const _0x5b6386={'id':uid(_0x5590e4(0x3fe)),'dateISO':todayISO(),'durationMinutes':_0x5643b5,'mode':this[_0x5590e4(0x3fc)],'note':''};if(!_0x16db9b[_0x5590e4(0x327)])_0x16db9b[_0x5590e4(0x327)]=[];_0x16db9b[_0x5590e4(0x327)]['unshift'](_0x5b6386);if(data?.['settings']?.[_0x5590e4(0x2bf)])try{openNoteModal(_0x5b6386['id']);}catch(_0x285450){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0x5590e4(0x1e0)]++;}if(typeof data!==_0x5590e4(0x27d)&&data&&data[_0x5590e4(0x274)]&&data[_0x5590e4(0x274)][_0x5590e4(0x27e)]===![]&&this[_0x5590e4(0x470)]===_0x5590e4(0x204))playSound(_0x5590e4(0x428));else(this[_0x5590e4(0x470)]===_0x5590e4(0x35e)||this['state']==='break'||this[_0x5590e4(0x470)]===_0x5590e4(0x360))&&playSound(_0x5590e4(0x1eb));const _0x2a7a5e=$('.timer-circle-container');if(_0x2a7a5e)_0x2a7a5e[_0x5590e4(0x21e)][_0x5590e4(0x4b0)](_0x5590e4(0x27b));if(data['settings'][_0x5590e4(0x376)]){if(this[_0x5590e4(0x470)]===_0x5590e4(0x204))data[_0x5590e4(0x274)][_0x5590e4(0x27e)]===![]?this[_0x5590e4(0x340)]():this['beginWindDown']();else this[_0x5590e4(0x470)]==='wind_down'?this[_0x5590e4(0x340)]():this[_0x5590e4(0x433)]();}else this['tickHandle']&&(clearInterval(this['tickHandle']),this[_0x5590e4(0x451)]=null),this[_0x5590e4(0x470)]='idle',this[_0x5590e4(0x4a2)]=null,this[_0x5590e4(0x4b5)](),toast(_0x5590e4(0x3f8));},'beginWindDown'(){const _0x691ffa=_0x272902;if(data?.['settings']?.[_0x691ffa(0x27e)]===![]){this['beginBreak']();return;}this[_0x691ffa(0x4a2)]=this[_0x691ffa(0x470)],this[_0x691ffa(0x470)]=_0x691ffa(0x35e);const _0xedf29=(this[_0x691ffa(0x3be)]()[_0x691ffa(0x31e)]||0x0)*0x3c;if(_0xedf29<=0x0){this['beginBreak']();return;}this[_0x691ffa(0x392)]=_0xedf29,this[_0x691ffa(0x41a)]=_0xedf29;try{playSound('break_end');}catch(_0x16d576){}try{toast(_0x691ffa(0x3cc));}catch(_0x459100){}this[_0x691ffa(0x237)](),this['updateUI']();},'beginWork'(){const _0x5be9c8=_0x272902;this['prevState']=this[_0x5be9c8(0x470)],this[_0x5be9c8(0x470)]=_0x5be9c8(0x204);if(this[_0x5be9c8(0x3fc)]==='C'){this[_0x5be9c8(0x392)]=0x0;if(this[_0x5be9c8(0x4a2)]!==_0x5be9c8(0x45e))this[_0x5be9c8(0x41a)]=0x0;}else{const _0x5a3dc8=this[_0x5be9c8(0x3be)]()[_0x5be9c8(0x204)]*0x3c;this[_0x5be9c8(0x392)]=_0x5a3dc8;if(this['prevState']!=='paused')this[_0x5be9c8(0x41a)]=_0x5a3dc8;}const _0xc16fd4=$(_0x5be9c8(0x31d));_0xc16fd4&&(_0xc16fd4[_0x5be9c8(0x1ab)]=''),this['_startTick'](),this[_0x5be9c8(0x4b5)]();},'finishFlowSession'(){const _0x14be53=_0x272902;if(this[_0x14be53(0x3fc)]!=='C'||this[_0x14be53(0x470)]!=='work')return;this[_0x14be53(0x451)]&&(clearInterval(this['tickHandle']),this[_0x14be53(0x451)]=null);const _0x43042a=Math[_0x14be53(0x3ba)](0x1,parseInt(data[_0x14be53(0x274)]['flowtimeBreakRatio']??0x5,0xa)),_0x1607c1=Math[_0x14be53(0x3ba)](0x0,this[_0x14be53(0x41a)]|0x0),_0x4b4a47=Math[_0x14be53(0x3ba)](0x3c,Math[_0x14be53(0x34f)](_0x1607c1/_0x43042a));try{const _0xf9e543=getCurrentSubtopic();if(_0xf9e543){const _0x123b29=Math[_0x14be53(0x3ba)](0x1,Math[_0x14be53(0x1f3)](_0x1607c1/0x3c));_0xf9e543[_0x14be53(0x1ad)][_0x14be53(0x35c)]=(_0xf9e543['stats']['totalMinutes']||0x0)+_0x123b29,_0xf9e543[_0x14be53(0x1ad)]['sessionsCompleted']=(_0xf9e543[_0x14be53(0x1ad)]['sessionsCompleted']||0x0)+0x1;const _0x193716={'id':uid('sess'),'dateISO':todayISO(),'durationMinutes':_0x123b29,'mode':this['mode'],'note':''};if(!_0xf9e543[_0x14be53(0x327)])_0xf9e543[_0x14be53(0x327)]=[];_0xf9e543[_0x14be53(0x327)][_0x14be53(0x3e7)](_0x193716),saveData(),renderStatsHistory(),data?.[_0x14be53(0x274)]?.[_0x14be53(0x2bf)]&&openNoteModal(_0x193716['id']);}}catch(_0x1f2131){}this[_0x14be53(0x470)]=_0x14be53(0x34d),this[_0x14be53(0x392)]=_0x4b4a47,this[_0x14be53(0x41a)]=_0x4b4a47,this[_0x14be53(0x237)](),this['updateUI'](),this[_0x14be53(0x1fa)](!![]);try{toast('Break\x20'+Math[_0x14be53(0x1f3)](_0x4b4a47/0x3c)+_0x14be53(0x2a9)+_0x43042a+').');}catch(_0x1f6974){}},'beginBreak'(){const _0x282057=_0x272902;this[_0x282057(0x4a2)]=this[_0x282057(0x470)];const _0x209c5b=this[_0x282057(0x4b7)](),_0x5787a3=this[_0x282057(0x3be)]();if(this[_0x282057(0x1e0)]>0x0&&this['cycleIndex']%_0x209c5b[_0x282057(0x435)]===0x0){this['state']=_0x282057(0x360);const _0x38de21=_0x5787a3[_0x282057(0x3ce)]*0x3c;this[_0x282057(0x392)]=_0x38de21;if(this[_0x282057(0x4a2)]!=='paused')this[_0x282057(0x41a)]=_0x38de21;toast('Great!\x20Time\x20for\x20a\x20long\x20break.');}else{this['state']=_0x282057(0x34d);const _0x1606bf=_0x5787a3[_0x282057(0x3d5)]*0x3c;this[_0x282057(0x392)]=_0x1606bf;if(this['prevState']!==_0x282057(0x45e))this['remaining']=_0x1606bf;}const _0x457e36=$('#breakSuggestionDisplay');if(_0x457e36){const _0x3245a1=Math['floor'](Math['random']()*breakSuggestions[_0x282057(0x465)]);_0x457e36[_0x282057(0x1ab)]=_0x282057(0x4a7)+breakSuggestions[_0x3245a1];}this['_startTick'](),this[_0x282057(0x4b5)]();},async 'start'(){const _0x46a846=_0x272902;if(!getCurrentSubtopic()){toast(_0x46a846(0x20e));return;}ensureAudio();if(this[_0x46a846(0x3fc)]==='C'&&this['state']===_0x46a846(0x2c4))this[_0x46a846(0x470)]=_0x46a846(0x204),this[_0x46a846(0x41a)]=0x0,this[_0x46a846(0x392)]=0x0,this['cycleIndex']=0x0,this[_0x46a846(0x237)](),this[_0x46a846(0x4b5)]();else{if(this[_0x46a846(0x470)]===_0x46a846(0x2c4))this[_0x46a846(0x1e0)]=this[_0x46a846(0x1e0)]||0x0,this[_0x46a846(0x433)]();else this[_0x46a846(0x470)]===_0x46a846(0x45e)&&this[_0x46a846(0x487)]();}await this[_0x46a846(0x1fa)](!![]);},async 'pause'(){const _0x46073d=_0x272902;this[_0x46073d(0x451)]&&(clearInterval(this[_0x46073d(0x451)]),this[_0x46073d(0x451)]=null),this[_0x46073d(0x4a2)]=this[_0x46073d(0x470)],this[_0x46073d(0x470)]=_0x46073d(0x45e),this[_0x46073d(0x4b5)](),await this[_0x46073d(0x1fa)](!![]);},async 'resume'(){const _0x4fc5bd=_0x272902;if(this[_0x4fc5bd(0x470)]!==_0x4fc5bd(0x45e))return;this[_0x4fc5bd(0x470)]=this['prevState']||_0x4fc5bd(0x204),this[_0x4fc5bd(0x237)](),this['updateUI'](),await this['persistTimerState'](!![]);},async 'skip'(){const _0x22c741=_0x272902;if(this[_0x22c741(0x3fc)]==='C'&&this[_0x22c741(0x470)]==='work'){this[_0x22c741(0x2b9)](),await this[_0x22c741(0x1fa)](!![]);return;}this[_0x22c741(0x470)]===_0x22c741(0x204)?(this[_0x22c741(0x451)]&&(clearInterval(this[_0x22c741(0x451)]),this[_0x22c741(0x451)]=null),this[_0x22c741(0x41a)]=0x0,this['_onFinishSegment']()):(this[_0x22c741(0x41a)]=0x0,this[_0x22c741(0x451)]&&(clearInterval(this[_0x22c741(0x451)]),this[_0x22c741(0x451)]=null),this[_0x22c741(0x20c)]()),await this[_0x22c741(0x1fa)](!![]);},async 'reset'(){const _0x1aec5a=_0x272902;this[_0x1aec5a(0x451)]&&(clearInterval(this[_0x1aec5a(0x451)]),this[_0x1aec5a(0x451)]=null);this['state']=_0x1aec5a(0x2c4),this[_0x1aec5a(0x4a2)]=null,this['remaining']=0x0,this[_0x1aec5a(0x392)]=0x0,this[_0x1aec5a(0x1e0)]=0x0;const _0xa20047=$(_0x1aec5a(0x31d));_0xa20047&&(_0xa20047[_0x1aec5a(0x1ab)]=''),this[_0x1aec5a(0x4b5)](),await this[_0x1aec5a(0x1fa)](!![]);}};async function deleteSummary(_0x11b303){const _0x2db564=_0x272902;showConfirmModal(_0x2db564(0x3ab),_0x2db564(0x2a1),async _0x4eb380=>{const _0x1f61a9=_0x2db564;if(!_0x4eb380)return;const _0x1a9bb4=getCurrentSubtopic();if(!_0x1a9bb4||!_0x1a9bb4[_0x1f61a9(0x1a7)])return;const _0x51c88a=[..._0x1a9bb4[_0x1f61a9(0x1a7)]];_0x1a9bb4['summaries']=_0x1a9bb4[_0x1f61a9(0x1a7)]['filter'](_0x290f07=>_0x290f07['id']!==_0x11b303);try{await storageManager[_0x1f61a9(0x498)](_0x1f61a9(0x292),_0x1a9bb4),renderSummaries(),toast('Summary\x20deleted.');}catch(_0x1f3cf1){console[_0x1f61a9(0x1bc)](_0x1f61a9(0x2df),_0x1f3cf1),_0x1a9bb4[_0x1f61a9(0x1a7)]=_0x51c88a,toast(_0x1f61a9(0x2cb));}});}function exportSummary(_0x180ff0){const _0x37bec1=_0x272902,_0x1d23da=new Blob([_0x180ff0[_0x37bec1(0x238)]],{'type':'text/plain'}),_0x1ed3fb=document[_0x37bec1(0x2bd)]('a'),_0x67f7b9=new Date(_0x180ff0[_0x37bec1(0x1f9)]),_0x29507d=_0x42bcc9=>(''+_0x42bcc9)[_0x37bec1(0x401)](0x2,'0');_0x1ed3fb[_0x37bec1(0x4b3)]=URL[_0x37bec1(0x21c)](_0x1d23da),_0x1ed3fb['download']=_0x37bec1(0x48d)+_0x67f7b9[_0x37bec1(0x21a)]()+_0x29507d(_0x67f7b9[_0x37bec1(0x239)]()+0x1)+_0x29507d(_0x67f7b9[_0x37bec1(0x3b7)]())+_0x37bec1(0x255),_0x1ed3fb[_0x37bec1(0x477)](),URL[_0x37bec1(0x29f)](_0x1ed3fb[_0x37bec1(0x4b3)]);}function renderStatsHistory(){const _0x3cc595=_0x272902,_0x484ccf=getCurrentSubtopic(),_0x3219a0=$(_0x3cc595(0x2d5)),_0x451374=$(_0x3cc595(0x3d2)),_0x47d305=$(_0x3cc595(0x23a)),_0x17d018=$(_0x3cc595(0x1e7));if(!_0x3219a0||!_0x451374||!_0x47d305||!_0x17d018)return;if(!_0x484ccf){_0x3219a0[_0x3cc595(0x1ab)]=_0x3cc595(0x20a),_0x451374[_0x3cc595(0x1ab)]='0',_0x47d305[_0x3cc595(0x1ab)]='0',_0x17d018[_0x3cc595(0x273)]=_0x3cc595(0x2c6);return;}const _0x222e8f=_0x484ccf['stats']&&_0x484ccf[_0x3cc595(0x1ad)][_0x3cc595(0x35c)]?_0x484ccf[_0x3cc595(0x1ad)][_0x3cc595(0x35c)]:0x0,_0x1dd27d=_0x484ccf[_0x3cc595(0x1ad)]&&_0x484ccf[_0x3cc595(0x1ad)][_0x3cc595(0x437)]?_0x484ccf[_0x3cc595(0x1ad)][_0x3cc595(0x437)]:0x0,_0x20bba2=_0x484ccf[_0x3cc595(0x45d)]?_0x484ccf['tasks']['filter'](_0x11c6dc=>_0x11c6dc[_0x3cc595(0x386)])[_0x3cc595(0x465)]:0x0;_0x3219a0[_0x3cc595(0x1ab)]=formatDaysHoursMinutes(_0x222e8f),_0x451374[_0x3cc595(0x1ab)]=String(_0x1dd27d),_0x47d305['textContent']=String(_0x20bba2),_0x17d018[_0x3cc595(0x273)]='';const _0x284349=Array['isArray'](_0x484ccf['sessions'])?_0x484ccf[_0x3cc595(0x327)]:[];if(_0x284349[_0x3cc595(0x465)]===0x0){_0x17d018[_0x3cc595(0x273)]=_0x3cc595(0x23c);return;}_0x284349[_0x3cc595(0x2b6)](_0x3b5148=>{const _0x4cf53c=_0x3cc595,_0x48f1a3=document[_0x4cf53c(0x2bd)](_0x4cf53c(0x256));_0x48f1a3['className']=_0x4cf53c(0x387);const _0x11afed=document[_0x4cf53c(0x2bd)](_0x4cf53c(0x256)),_0x450761=_0x3b5148[_0x4cf53c(0x2ce)]?new Date(_0x3b5148[_0x4cf53c(0x2ce)]):new Date(),_0x3a9248=_0x3b5148['durationMinutes']!=null?_0x3b5148[_0x4cf53c(0x219)]:_0x3b5148[_0x4cf53c(0x22c)]||0x0,_0x5bd3ff='<div\x20class=\x22hist-meta\x22>'+_0x450761[_0x4cf53c(0x2ed)]()+_0x4cf53c(0x2e5)+_0x3a9248+'\x27\x20·\x20Mode\x20'+(_0x3b5148[_0x4cf53c(0x3fc)]||'')+_0x4cf53c(0x395);let _0x45c8f2='';if(_0x3b5148['note'])_0x45c8f2='<div>'+escapeHTML(_0x3b5148[_0x4cf53c(0x2c7)])+_0x4cf53c(0x395);else data?.[_0x4cf53c(0x274)]?.[_0x4cf53c(0x2bf)]&&(_0x45c8f2=_0x4cf53c(0x23e));_0x11afed[_0x4cf53c(0x273)]=_0x5bd3ff+_0x45c8f2,_0x48f1a3[_0x4cf53c(0x3af)](_0x11afed),_0x17d018[_0x4cf53c(0x3af)](_0x48f1a3);});}function renderGeneralNotes(){const _0x41c61f=_0x272902,_0x3d4939=$(_0x41c61f(0x228));if(!_0x3d4939)return;const _0x1972d=getCurrentSubtopic();if(!_0x1972d){_0x3d4939[_0x41c61f(0x273)]=_0x41c61f(0x47a);return;}_0x1972d[_0x41c61f(0x390)]=_0x1972d['generalNotes']||[];if(_0x1972d['generalNotes'][_0x41c61f(0x465)]===0x0){_0x3d4939[_0x41c61f(0x273)]=_0x41c61f(0x354);return;}_0x3d4939[_0x41c61f(0x273)]='',_0x1972d[_0x41c61f(0x390)][_0x41c61f(0x2b6)](_0x5aabcb=>{const _0x4da280=_0x41c61f,_0x214250=document['createElement'](_0x4da280(0x256));_0x214250[_0x4da280(0x28d)]='note-item';const _0x50b179=document[_0x4da280(0x2bd)]('div');_0x50b179['className']=_0x4da280(0x302),_0x50b179[_0x4da280(0x1ab)]=typeof _0x5aabcb===_0x4da280(0x1d1)?_0x5aabcb:_0x5aabcb[_0x4da280(0x2c5)]||'';const _0x5c1b2a=document[_0x4da280(0x2bd)](_0x4da280(0x256));_0x5c1b2a[_0x4da280(0x28d)]=_0x4da280(0x493),_0x5c1b2a['textContent']=_0x5aabcb['createdAt']?new Date(_0x5aabcb['createdAt'])['toLocaleString']():'';const _0x35c95d=document[_0x4da280(0x2bd)]('div'),_0xf9184b=document[_0x4da280(0x2bd)](_0x4da280(0x434));_0xf9184b[_0x4da280(0x28d)]=_0x4da280(0x3d0),_0xf9184b[_0x4da280(0x1ab)]=_0x4da280(0x37a),_0xf9184b[_0x4da280(0x2a5)]=async _0x3544bc=>{const _0x3cc30f=_0x4da280;_0x3544bc['stopPropagation']();const _0x3ed0fd=getCurrentSubtopic();if(!_0x3ed0fd)return;_0x3ed0fd['generalNotes']=(_0x3ed0fd[_0x3cc30f(0x390)]||[])['filter'](_0x107071=>(_0x107071['id']||_0x107071)!==(_0x5aabcb['id']||_0x5aabcb)),await saveData(),renderGeneralNotes();},_0x35c95d['appendChild'](_0xf9184b);const _0x4ec9eb=document[_0x4da280(0x2bd)](_0x4da280(0x256));_0x4ec9eb[_0x4da280(0x28d)]=_0x4da280(0x275),_0x4ec9eb['append'](_0x50b179,_0x5c1b2a),_0x214250[_0x4da280(0x36c)](_0x4ec9eb,_0x35c95d),_0x3d4939['appendChild'](_0x214250);});}function renderMethods(){const _0x5c9b5a=_0x272902,_0x279acc=document[_0x5c9b5a(0x23f)]('#view-methods\x20.methods-container');if(!_0x279acc)return;_0x279acc[_0x5c9b5a(0x273)]='';const _0xde1b92=getCurrentSubtopic();if(!_0xde1b92){_0x279acc[_0x5c9b5a(0x273)]=_0x5c9b5a(0x1ae);return;}const _0x33078c=Array[_0x5c9b5a(0x425)](_0xde1b92['methods'])?_0xde1b92['methods']:[];if(_0x33078c[_0x5c9b5a(0x465)]===0x0){_0x279acc[_0x5c9b5a(0x273)]=_0x5c9b5a(0x4bb);return;}_0x33078c[_0x5c9b5a(0x2b6)](_0x5a44a1=>{const _0x157872=_0x5c9b5a,_0x4f96c7=document[_0x157872(0x2bd)](_0x157872(0x256));_0x4f96c7[_0x157872(0x28d)]='method-item',_0x4f96c7['dataset'][_0x157872(0x2bb)]=_0x5a44a1['id'];const _0x415007=document[_0x157872(0x2bd)](_0x157872(0x256)),_0x41bd31=document['createElement']('span');_0x41bd31[_0x157872(0x28d)]=_0x157872(0x403),_0x41bd31[_0x157872(0x1ab)]=_0x5a44a1[_0x157872(0x3fa)]||_0x157872(0x4a3),_0x41bd31[_0x157872(0x3ea)](_0x157872(0x477),_0x38f74f=>{const _0x30711d=_0x157872;_0x38f74f[_0x30711d(0x48b)](),_0x38f74f[_0x30711d(0x1bf)]();const _0x159eb7=_0x4f96c7[_0x30711d(0x23f)](_0x30711d(0x32c));if(!_0x159eb7)return;const _0x4a9a78=_0x159eb7['hidden'];_0x279acc[_0x30711d(0x310)](_0x30711d(0x4ae))[_0x30711d(0x2b6)](_0x1b6cf4=>{_0x1b6cf4['hidden']=!![];}),_0x159eb7[_0x30711d(0x3e2)]=!_0x4a9a78;});const _0x8b2356=document['createElement'](_0x157872(0x256));_0x8b2356['className']=_0x157872(0x3bc);const _0x1ee296=document['createElement']('button');_0x1ee296[_0x157872(0x28d)]=_0x157872(0x3e9),_0x1ee296[_0x157872(0x1ab)]=_0x157872(0x43e),_0x1ee296[_0x157872(0x372)]['id']=_0x5a44a1['id'];const _0x25eaf9=document['createElement']('button');_0x25eaf9['className']=_0x157872(0x2c9),_0x25eaf9[_0x157872(0x1ab)]=_0x157872(0x37a),_0x25eaf9[_0x157872(0x372)]['id']=_0x5a44a1['id'],_0x8b2356[_0x157872(0x36c)](_0x1ee296,_0x25eaf9),_0x415007[_0x157872(0x36c)](_0x41bd31,_0x8b2356);const _0x534906=document[_0x157872(0x2bd)](_0x157872(0x256));_0x534906[_0x157872(0x28d)]=_0x157872(0x1ba),_0x534906['innerHTML']=_0x5a44a1['content']||'',_0x534906['hidden']=!![],_0x4f96c7['append'](_0x415007,_0x534906),_0x279acc[_0x157872(0x3af)](_0x4f96c7),_0x4f96c7[_0x157872(0x3ea)](_0x157872(0x477),_0x115aa2=>{const _0xf2dc93=_0x157872,_0x22c906=_0x115aa2['target'];if(!_0x22c906)return;if(_0x22c906[_0xf2dc93(0x418)]('button')||_0x22c906[_0xf2dc93(0x418)]('a')||_0x22c906['closest'](_0xf2dc93(0x391))||_0x22c906[_0xf2dc93(0x418)](_0xf2dc93(0x242)))return;const _0x4d84ec=_0x534906[_0xf2dc93(0x3e2)];_0x279acc[_0xf2dc93(0x310)](_0xf2dc93(0x4ae))['forEach'](_0x4cb43e=>{_0x4cb43e['hidden']=!![];}),_0x534906[_0xf2dc93(0x3e2)]=!_0x4d84ec;});});const _0xaf8275=_0x279acc['querySelectorAll'](_0x5c9b5a(0x22f));_0xaf8275[_0x5c9b5a(0x2b6)](_0x146357=>{const _0x31f1c3=_0x5c9b5a;_0x146357['addEventListener'](_0x31f1c3(0x412),()=>{const _0x4b16f6=_0x31f1c3;_0x146357[_0x4b16f6(0x209)]&&_0xaf8275[_0x4b16f6(0x2b6)](_0x27bf70=>{const _0x2f386c=_0x4b16f6;if(_0x27bf70!==_0x146357)_0x27bf70[_0x2f386c(0x209)]=![];});});}),window['Sortable']&&new Sortable(_0x279acc,{'animation':0x96,'draggable':_0x5c9b5a(0x22f),'onEnd':async function(_0x4f0ab2){const _0x5de176=_0x5c9b5a;if(_0x4f0ab2['oldIndex']===_0x4f0ab2[_0x5de176(0x49c)])return;const _0x1cd0fd=getCurrentSubtopic();if(!_0x1cd0fd||!Array[_0x5de176(0x425)](_0x1cd0fd[_0x5de176(0x297)]))return;const _0x1ea135=_0x1cd0fd['methods'][_0x5de176(0x485)](_0x4f0ab2[_0x5de176(0x4b1)],0x1)[0x0];_0x1cd0fd[_0x5de176(0x297)][_0x5de176(0x485)](_0x4f0ab2['newIndex'],0x0,_0x1ea135),await saveData();}});}function addGeneralNote(){showInputModal('Add\x20note',async _0x53865b=>{const _0x445b69=_0x4e4c;if(!_0x53865b)return;const _0xaac762=getCurrentSubtopic();if(!_0xaac762){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}_0xaac762['generalNotes']=_0xaac762['generalNotes']||[],_0xaac762[_0x445b69(0x390)]['unshift']({'id':uid('gn'),'text':_0x53865b,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x2e961c=_0x272902,_0xf6867d=getCurrentSubtopic();if(!_0xf6867d){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x39a95e=(_0xf6867d[_0x2e961c(0x390)]||[])[_0x2e961c(0x285)](_0x5bae26=>typeof _0x5bae26==='string'?_0x5bae26:_0x5bae26[_0x2e961c(0x2c5)]||'')['filter'](Boolean);if(_0x39a95e[_0x2e961c(0x465)]===0x0){toast('No\x20notes\x20to\x20summarize.');return;}const _0x243206=$(_0x2e961c(0x225));_0x243206&&(_0x243206[_0x2e961c(0x35b)]=!![],_0x243206['innerHTML']=_0x2e961c(0x33c));try{const _0x5b4de3=_0x2e961c(0x32b)+_0x39a95e['join']('\x0a-\x20'),_0x36c51d=await callGeminiAPI(_0x5b4de3);if(!_0xf6867d['summaries'])_0xf6867d[_0x2e961c(0x1a7)]=[];_0xf6867d[_0x2e961c(0x1a7)][_0x2e961c(0x3e7)]({'id':uid('sum'),'content':_0x36c51d||_0x2e961c(0x248),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x2d4e62){console[_0x2e961c(0x1bc)](_0x2d4e62),toast(_0x2e961c(0x2e3));}finally{_0x243206&&(_0x243206['disabled']=![],_0x243206[_0x2e961c(0x1ab)]=_0x2e961c(0x25f));}}function renderSummaries(){const _0x19629e=_0x272902,_0xd83c29=$(_0x19629e(0x393));if(!_0xd83c29)return;const _0x31d33e=getCurrentSubtopic();if(!_0x31d33e){_0xd83c29[_0x19629e(0x273)]=_0x19629e(0x2dd);return;}_0xd83c29[_0x19629e(0x273)]='';if(!_0x31d33e[_0x19629e(0x1a7)]||_0x31d33e[_0x19629e(0x1a7)]['length']===0x0){_0xd83c29['innerHTML']=_0x19629e(0x270);return;}_0x31d33e[_0x19629e(0x1a7)][_0x19629e(0x2b6)](_0x177f75=>{const _0xdca710=_0x19629e,_0x1566e8=document[_0xdca710(0x2bd)](_0xdca710(0x256));_0x1566e8[_0xdca710(0x28d)]=_0xdca710(0x263);const _0x4681c8=document[_0xdca710(0x2bd)](_0xdca710(0x256));_0x4681c8[_0xdca710(0x28d)]=_0xdca710(0x275);const _0x2135a8=document[_0xdca710(0x2bd)](_0xdca710(0x256));_0x2135a8[_0xdca710(0x28d)]=_0xdca710(0x302),_0x2135a8['textContent']=_0x177f75['content'];const _0x543f65=document[_0xdca710(0x2bd)](_0xdca710(0x256));_0x543f65[_0xdca710(0x28d)]=_0xdca710(0x493),_0x543f65[_0xdca710(0x1ab)]=new Date(_0x177f75[_0xdca710(0x1f9)])[_0xdca710(0x2ed)](),_0x4681c8[_0xdca710(0x36c)](_0x2135a8,_0x543f65);const _0x5f445b=document[_0xdca710(0x2bd)]('div'),_0x3eba3f=document[_0xdca710(0x2bd)](_0xdca710(0x434));_0x3eba3f[_0xdca710(0x28d)]='btn\x20small',_0x3eba3f[_0xdca710(0x1ab)]=_0xdca710(0x35a),_0x3eba3f[_0xdca710(0x2a5)]=_0x1d2a56=>{const _0x54588c=_0xdca710;_0x1d2a56[_0x54588c(0x1bf)](),exportSummary(_0x177f75);};const _0x2346e6=document[_0xdca710(0x2bd)]('button');_0x2346e6[_0xdca710(0x28d)]='btn\x20small\x20danger',_0x2346e6[_0xdca710(0x1ab)]='Delete',_0x2346e6['onclick']=_0x1a71d0=>{const _0x152476=_0xdca710;_0x1a71d0[_0x152476(0x1bf)](),deleteSummary(_0x177f75['id']);},_0x5f445b[_0xdca710(0x36c)](_0x3eba3f,_0x2346e6),_0x1566e8[_0xdca710(0x36c)](_0x4681c8,_0x5f445b),_0x1566e8[_0xdca710(0x3ea)](_0xdca710(0x477),()=>_0x2135a8['classList'][_0xdca710(0x412)]('expanded')),_0xd83c29[_0xdca710(0x3af)](_0x1566e8);});}function loadEditingPresetFields(){const _0x4c5d32=_0x272902,_0x572bd=data[_0x4c5d32(0x274)],_0x1b7fbc=_0x572bd['durations'],_0x8f162=$(_0x4c5d32(0x3c6)),_0x5a1e4c=$(_0x4c5d32(0x37f));if(_0x8f162&&_0x5a1e4c){const _0x3c766f=editingPreset==='C';_0x8f162[_0x4c5d32(0x21e)][_0x4c5d32(0x412)](_0x4c5d32(0x3e2),_0x3c766f),_0x5a1e4c[_0x4c5d32(0x21e)][_0x4c5d32(0x412)]('hidden',!_0x3c766f);}if(editingPreset==='A'){$(_0x4c5d32(0x402))['value']=_0x1b7fbc[_0x4c5d32(0x2dc)];if($('#set_winddown'))$(_0x4c5d32(0x1b9))[_0x4c5d32(0x472)]=_0x1b7fbc[_0x4c5d32(0x475)]??0x0;$(_0x4c5d32(0x20d))[_0x4c5d32(0x472)]=_0x1b7fbc['A_short'],$(_0x4c5d32(0x49a))[_0x4c5d32(0x472)]=_0x1b7fbc['A_long'],$(_0x4c5d32(0x1d2))['value']=_0x572bd[_0x4c5d32(0x37c)],$('#set_interval')[_0x4c5d32(0x472)]=_0x572bd['longBreakIntervalA'];}else{if(editingPreset==='B'){$(_0x4c5d32(0x402))['value']=_0x1b7fbc[_0x4c5d32(0x46f)];if($(_0x4c5d32(0x1b9)))$(_0x4c5d32(0x1b9))[_0x4c5d32(0x472)]=_0x1b7fbc[_0x4c5d32(0x28e)]??0x0;$(_0x4c5d32(0x20d))['value']=_0x1b7fbc[_0x4c5d32(0x303)],$('#set_long')[_0x4c5d32(0x472)]=_0x1b7fbc[_0x4c5d32(0x3ad)],$(_0x4c5d32(0x1d2))['value']=_0x572bd[_0x4c5d32(0x2b1)],$(_0x4c5d32(0x33a))[_0x4c5d32(0x472)]=_0x572bd['longBreakIntervalB'];}else{if(editingPreset==='C'){const _0x959431=$('#set_flowRatio');if(_0x959431)_0x959431[_0x4c5d32(0x472)]=_0x572bd[_0x4c5d32(0x383)]??0x5;}}}}function highlightPresetSelector(){const _0x3fb5e9=_0x272902;$$(_0x3fb5e9(0x474))[_0x3fb5e9(0x2b6)](_0x3a3ce8=>{const _0x1f7301=_0x3fb5e9,_0x1fb223=_0x3a3ce8[_0x1f7301(0x372)][_0x1f7301(0x311)]===editingPreset;_0x3a3ce8['classList'][_0x1f7301(0x412)](_0x1f7301(0x1e5),_0x1fb223),_0x3a3ce8[_0x1f7301(0x21e)][_0x1f7301(0x412)](_0x1f7301(0x24e),!_0x1fb223);});}function openSettings(){const _0x4afe86=_0x272902,_0x2212b1=data['settings'];editingPreset=_0x2212b1['preset'],$('#set_apiKey')[_0x4afe86(0x472)]=_0x2212b1[_0x4afe86(0x4ab)]||'',loadEditingPresetFields(),highlightPresetSelector(),$('#set_volume')[_0x4afe86(0x472)]=_0x2212b1[_0x4afe86(0x44b)]??0.8,$(_0x4afe86(0x202))[_0x4afe86(0x472)]=_0x2212b1[_0x4afe86(0x3cf)]||_0x4afe86(0x36d),$(_0x4afe86(0x364))[_0x4afe86(0x472)]=_0x2212b1[_0x4afe86(0x288)]||_0x4afe86(0x2c8);const _0x20c31d=getActiveYoutubeUrl();$(_0x4afe86(0x2fb))['value']=_0x20c31d||'';const _0x755acc=extractYouTubeID(_0x20c31d);$('#btnToggleYtSound')[_0x4afe86(0x35b)]=!_0x755acc;$('#ytUrlFeedback')&&($(_0x4afe86(0x231))[_0x4afe86(0x1ab)]='');$(_0x4afe86(0x1e9))[_0x4afe86(0x472)]=_0x2212b1[_0x4afe86(0x1e8)]||0x50,$(_0x4afe86(0x325))[_0x4afe86(0x254)]=!!_0x2212b1[_0x4afe86(0x42c)],$('#set_panelOpacity')['value']=_0x2212b1[_0x4afe86(0x419)]||0.85;$(_0x4afe86(0x2f4))&&($('#set_backgroundMode')[_0x4afe86(0x472)]=_0x2212b1[_0x4afe86(0x31b)]||_0x4afe86(0x3f3));$(_0x4afe86(0x1c4))&&($(_0x4afe86(0x1c4))['checked']=!!_0x2212b1['autoStartNext']);$(_0x4afe86(0x235))&&($(_0x4afe86(0x235))[_0x4afe86(0x254)]=_0x2212b1[_0x4afe86(0x27e)]!==![]);$('#set_enableSessionNotes')&&($('#set_enableSessionNotes')['checked']=!!_0x2212b1[_0x4afe86(0x2bf)]);$(_0x4afe86(0x24a))&&($(_0x4afe86(0x24a))[_0x4afe86(0x472)]=_0x2212b1['backupDaysToKeep']||0x7);const _0xb70c5e=$(_0x4afe86(0x2de));_0xb70c5e&&storageManager['getBackupList']()[_0x4afe86(0x3d1)](_0xfc8076=>{const _0x36ceb4=_0x4afe86;_0xb70c5e[_0x36ceb4(0x273)]='<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>',_0xfc8076&&_0xfc8076[_0x36ceb4(0x465)]>0x0?_0xfc8076[_0x36ceb4(0x2b6)](_0x59cb07=>{const _0xc14a0f=_0x36ceb4,_0x5c7873=document['createElement'](_0xc14a0f(0x39c));_0x5c7873[_0xc14a0f(0x472)]=_0x59cb07[_0xc14a0f(0x382)],_0x5c7873[_0xc14a0f(0x1ab)]='Backup\x20from:\x20'+new Date(_0x59cb07['date'])[_0xc14a0f(0x29d)]('en-US'),_0xb70c5e[_0xc14a0f(0x3af)](_0x5c7873);}):_0xb70c5e[_0x36ceb4(0x273)]='<option\x20value=\x22\x22>No\x20backups\x20available</option>';});$(_0x4afe86(0x3a7))[_0x4afe86(0x21e)][_0x4afe86(0x4b0)](_0x4afe86(0x264));try{trapFocus($(_0x4afe86(0x3a7)));}catch(_0x1b71d5){}}function closeSettings(){const _0xe4d3f3=_0x272902;$(_0xe4d3f3(0x3a7))[_0xe4d3f3(0x21e)][_0xe4d3f3(0x348)]('show');try{releaseFocus();}catch(_0x2e7746){}}async function setDefaults(){const _0x55f6af=_0x272902;data[_0x55f6af(0x274)][_0x55f6af(0x43d)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x55f6af(0x274)][_0x55f6af(0x37c)]=0x4,data[_0x55f6af(0x274)][_0x55f6af(0x3c0)]=0x4,data[_0x55f6af(0x274)][_0x55f6af(0x2b1)]=0x4,data[_0x55f6af(0x274)][_0x55f6af(0x41d)]=0x4,data[_0x55f6af(0x274)][_0x55f6af(0x383)]=0x5,data['settings'][_0x55f6af(0x247)]='A',data['settings'][_0x55f6af(0x44b)]=0.8,data['settings'][_0x55f6af(0x3cf)]=_0x55f6af(0x36d),await saveData(),openSettings(),toast(_0x55f6af(0x427));}async function saveSettings(){const _0x371d7c=_0x272902,_0x13abb6=data[_0x371d7c(0x274)];_0x13abb6[_0x371d7c(0x4ab)]=$('#set_apiKey')[_0x371d7c(0x472)][_0x371d7c(0x2eb)]();const _0x2137ef=_0x13abb6[_0x371d7c(0x43d)];if(editingPreset==='A')_0x2137ef[_0x371d7c(0x2dc)]=clampInt($('#set_work')[_0x371d7c(0x472)],0x1,0x3e7),_0x2137ef[_0x371d7c(0x475)]=clampInt($(_0x371d7c(0x1b9))[_0x371d7c(0x472)],0x0,0x3e7),_0x2137ef[_0x371d7c(0x2f9)]=clampInt($('#set_short')[_0x371d7c(0x472)],0x1,0x3e7),_0x2137ef[_0x371d7c(0x48c)]=clampInt($(_0x371d7c(0x49a))[_0x371d7c(0x472)],0x1,0x3e7),_0x13abb6[_0x371d7c(0x37c)]=clampInt($(_0x371d7c(0x1d2))['value'],0x1,0xc),_0x13abb6[_0x371d7c(0x3c0)]=clampInt($(_0x371d7c(0x33a))[_0x371d7c(0x472)],0x2,0xc);else{if(editingPreset==='B')_0x2137ef['B_work']=clampInt($('#set_work')[_0x371d7c(0x472)],0x1,0x3e7),_0x2137ef['B_winddown']=clampInt($(_0x371d7c(0x1b9))[_0x371d7c(0x472)],0x0,0x3e7),_0x2137ef[_0x371d7c(0x303)]=clampInt($(_0x371d7c(0x20d))[_0x371d7c(0x472)],0x1,0x3e7),_0x2137ef[_0x371d7c(0x3ad)]=clampInt($(_0x371d7c(0x49a))[_0x371d7c(0x472)],0x1,0x3e7),_0x13abb6[_0x371d7c(0x2b1)]=clampInt($(_0x371d7c(0x1d2))[_0x371d7c(0x472)],0x1,0xc),_0x13abb6[_0x371d7c(0x41d)]=clampInt($(_0x371d7c(0x33a))[_0x371d7c(0x472)],0x2,0xc);else{if(editingPreset==='C'){const _0x4ab4b2=$(_0x371d7c(0x496));if(_0x4ab4b2)_0x13abb6[_0x371d7c(0x383)]=clampInt(_0x4ab4b2[_0x371d7c(0x472)],0x1,0x14);}}}_0x13abb6['volume']=clampFloat($(_0x371d7c(0x371))['value'],0x0,0x1,0.8),_0x13abb6[_0x371d7c(0x3cf)]=$(_0x371d7c(0x202))[_0x371d7c(0x472)]===_0x371d7c(0x3ca)?'chime':'beep',_0x13abb6[_0x371d7c(0x288)]=$('#set_theme_color')[_0x371d7c(0x472)],_0x13abb6[_0x371d7c(0x419)]=parseFloat($(_0x371d7c(0x3aa))[_0x371d7c(0x472)])||0.85;$(_0x371d7c(0x2f4))&&(_0x13abb6[_0x371d7c(0x31b)]=$('#set_backgroundMode')[_0x371d7c(0x472)]);_0x13abb6['autoStartNext']=!!($(_0x371d7c(0x1c4))&&$(_0x371d7c(0x1c4))[_0x371d7c(0x254)]),_0x13abb6[_0x371d7c(0x27e)]=!!($('#set_enableWinddown')&&$(_0x371d7c(0x235))[_0x371d7c(0x254)]),_0x13abb6[_0x371d7c(0x2bf)]=!!($(_0x371d7c(0x3e3))&&$(_0x371d7c(0x3e3))['checked']);$(_0x371d7c(0x24a))&&(_0x13abb6[_0x371d7c(0x459)]=clampInt($(_0x371d7c(0x24a))['value'],0x1,0x1e));_0x13abb6[_0x371d7c(0x288)]===_0x371d7c(0x338)||_0x13abb6['theme']==='pastel'?(_0x13abb6['useYtThumbnailAsBg']=![],typeof _0x13abb6[_0x371d7c(0x26a)]===_0x371d7c(0x1d1)&&_0x13abb6['customBg'][_0x371d7c(0x29e)](_0x371d7c(0x494))&&(_0x13abb6[_0x371d7c(0x26a)]='')):_0x13abb6[_0x371d7c(0x42c)]=!![];const _0x569952=$('#set_youtubeUrl')[_0x371d7c(0x472)][_0x371d7c(0x2eb)]();_0x13abb6[_0x371d7c(0x42c)]=$(_0x371d7c(0x325))[_0x371d7c(0x254)],_0x13abb6[_0x371d7c(0x1e8)]=parseInt($(_0x371d7c(0x1e9))[_0x371d7c(0x472)],0xa),sessionYoutubeUrl=_0x569952;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer[_0x371d7c(0x243)])ytPlayer[_0x371d7c(0x243)](_0x13abb6['youtubeVolume']);}else try{fallbackPostMessage(_0x371d7c(0x243),[_0x13abb6[_0x371d7c(0x1e8)]]);}catch(_0x577373){}}catch(_0x28d7f7){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x371d7c(0x253)](_0x13abb6[_0x371d7c(0x247)],{'silent':!![]}),closeSettings(),toast(_0x371d7c(0x491));}function clampInt(_0x90333a,_0x3d8dbc,_0x4a37f6){const _0x5b2e41=_0x272902;_0x90333a=parseInt(_0x90333a||0x0,0xa);if(isNaN(_0x90333a))_0x90333a=_0x3d8dbc;return Math['max'](_0x3d8dbc,Math[_0x5b2e41(0x443)](_0x4a37f6,_0x90333a));}function clampFloat(_0x395bd5,_0xd13729,_0x994ff8,_0x21c0ac){const _0x4c881b=_0x272902;_0x395bd5=parseFloat(_0x395bd5);if(Number[_0x4c881b(0x3b6)](_0x395bd5))_0x395bd5=_0x21c0ac;return Math['max'](_0xd13729,Math[_0x4c881b(0x443)](_0x994ff8,_0x395bd5));}const dbPromise=new Promise((_0x5a280c,_0x53a811)=>{const _0x56ab1f=_0x272902,_0x43fae3=indexedDB['open'](_0x56ab1f(0x3b8),0x1);_0x43fae3['onupgradeneeded']=_0x791167=>_0x791167[_0x56ab1f(0x449)][_0x56ab1f(0x22a)][_0x56ab1f(0x1da)](_0x56ab1f(0x236)),_0x43fae3[_0x56ab1f(0x373)]=_0xce8ebc=>_0x5a280c(_0xce8ebc[_0x56ab1f(0x449)][_0x56ab1f(0x22a)]),_0x43fae3[_0x56ab1f(0x216)]=_0x4b5760=>_0x53a811(_0x4b5760);}),fileCache={};function handleFileUpload(_0x501775,_0x11e032){const _0x39f4f5=_0x272902;if(!_0x501775)return;dbPromise[_0x39f4f5(0x3d1)](_0x2c33af=>{const _0x6b3164=_0x39f4f5,_0x578aa1=uid(_0x6b3164(0x32d)),_0x5f1b01=_0x2c33af[_0x6b3164(0x34b)](_0x6b3164(0x236),_0x6b3164(0x4ad));_0x5f1b01['objectStore']('files')[_0x6b3164(0x213)](_0x501775,_0x578aa1),_0x5f1b01[_0x6b3164(0x416)]=()=>_0x11e032(_0x578aa1),_0x5f1b01[_0x6b3164(0x216)]=()=>toast(_0x6b3164(0x374));});}function getStoredFileUrl(_0x174e26){if(!_0x174e26)return Promise['resolve']('');if(fileCache[_0x174e26])return Promise['resolve'](fileCache[_0x174e26]);return dbPromise['then'](_0x147da0=>new Promise(_0x13f130=>{const _0x83096b=_0x4e4c,_0x53900d=_0x147da0[_0x83096b(0x34b)](_0x83096b(0x236),'readonly'),_0x554daf=_0x53900d['objectStore']('files')[_0x83096b(0x424)](_0x174e26);_0x554daf[_0x83096b(0x373)]=_0x39e081=>{const _0x4391b8=_0x83096b,_0x29b603=_0x39e081['target']['result'];if(_0x29b603){const _0x4ac577=URL[_0x4391b8(0x21c)](_0x29b603);fileCache[_0x174e26]=_0x4ac577,_0x13f130(_0x4ac577);}else _0x13f130('');},_0x554daf[_0x83096b(0x216)]=()=>_0x13f130('');}));}function applyCustomBg(){const _0x361381=_0x272902,_0xab7799=data[_0x361381(0x274)],_0x5874ae=_0xab7799[_0x361381(0x26a)],_0x260df8=_0xab7799[_0x361381(0x288)],_0x57ceda=[_0x361381(0x27a),_0x361381(0x22b)][_0x361381(0x29e)](_0x260df8),_0x52534d=_0x260df8===_0x361381(0x338)||_0x260df8===_0x361381(0x378),_0x5e9ad7=_0xab7799[_0x361381(0x31b)]||_0x361381(0x3f3);document[_0x361381(0x42f)][_0x361381(0x497)][_0x361381(0x1f5)]=_0x5e9ad7,document[_0x361381(0x42f)][_0x361381(0x497)][_0x361381(0x2ba)]=_0x5e9ad7===_0x361381(0x305)?'repeat':_0x361381(0x272);const _0x32624f=()=>{const _0x2e8f82=_0x361381;try{document[_0x2e8f82(0x42f)][_0x2e8f82(0x497)][_0x2e8f82(0x453)]='';}catch(_0x1e8a73){}};if(_0x5874ae){const _0xe81512=_0x5874ae[_0x361381(0x473)]('data:')||_0x5874ae[_0x361381(0x473)](_0x361381(0x4b2))||_0x5874ae['startsWith'](_0x361381(0x3f0))?Promise[_0x361381(0x370)](_0x5874ae):getStoredFileUrl(_0x5874ae);_0xe81512[_0x361381(0x3d1)](_0x5b932c=>{const _0xffe4a2=_0x361381;_0x5b932c?document[_0xffe4a2(0x42f)][_0xffe4a2(0x497)][_0xffe4a2(0x3c4)](_0xffe4a2(0x1c8),'url('+_0x5b932c+')'):document[_0xffe4a2(0x42f)]['style']['setProperty'](_0xffe4a2(0x1c8),_0x52534d?_0xffe4a2(0x1f7):''),_0x32624f();});}else!_0x57ceda?_0x52534d?(document[_0x361381(0x42f)]['style'][_0x361381(0x3c4)]('--bg-image','none'),_0x32624f()):document[_0x361381(0x42f)]['style'][_0x361381(0x3c4)](_0x361381(0x1c8),_0x361381(0x201)):(document[_0x361381(0x42f)]['style']['removeProperty'](_0x361381(0x1c8)),_0x32624f());}function applyPanelOpacity(){const _0x2f2a14=_0x272902;document[_0x2f2a14(0x2ac)][_0x2f2a14(0x497)][_0x2f2a14(0x3c4)](_0x2f2a14(0x26c),data[_0x2f2a14(0x274)][_0x2f2a14(0x419)]);}function renderDashboard(){const _0x5c6b01=_0x272902,_0x4406f5=data['topics'][_0x5c6b01(0x388)](_0xde54dd=>_0xde54dd[_0x5c6b01(0x292)][_0x5c6b01(0x285)](_0x3de11a=>({'topic':_0xde54dd['name'],'subtopic':_0x3de11a[_0x5c6b01(0x1f0)],'m':_0x3de11a[_0x5c6b01(0x1ad)]['totalMinutes']||0x0,'c':_0x3de11a[_0x5c6b01(0x1ad)][_0x5c6b01(0x437)]||0x0,'t':_0x3de11a[_0x5c6b01(0x1ad)][_0x5c6b01(0x2d3)]||0x0}))),_0x94914d=_0x4406f5[_0x5c6b01(0x48a)]((_0x1c4564,_0x4ee9ad)=>_0x1c4564+_0x4ee9ad['m'],0x0),_0x5d5fb6=_0x4406f5[_0x5c6b01(0x48a)]((_0x35b33d,_0x41432d)=>_0x35b33d+_0x41432d['c'],0x0),_0x2d5907=_0x4406f5['reduce']((_0x4248e6,_0x650045)=>_0x4248e6+_0x650045['t'],0x0);let _0x360601=_0x5c6b01(0x3e8)+formatDaysHoursMinutes(_0x94914d)+_0x5c6b01(0x341)+_0x5d5fb6+_0x5c6b01(0x440)+_0x2d5907+_0x5c6b01(0x21d);_0x4406f5[_0x5c6b01(0x2b6)](_0x3991b5=>{const _0x21474a=_0x5c6b01;_0x360601+=_0x21474a(0x457)+escapeHTML(_0x3991b5[_0x21474a(0x3f2)])+_0x21474a(0x1ac)+escapeHTML(_0x3991b5[_0x21474a(0x215)])+'</td><td>'+formatDaysHoursMinutes(_0x3991b5['m'])+'</td><td>'+_0x3991b5['c']+_0x21474a(0x1ac)+_0x3991b5['t']+_0x21474a(0x1c3);}),_0x360601+=_0x5c6b01(0x49d);const _0x757490=$(_0x5c6b01(0x31f));if(_0x757490)_0x757490[_0x5c6b01(0x273)]=_0x360601;}function getMilestones(){const _0x1ce027=_0x272902;return[{'hours':0x5,'title':_0x1ce027(0x1bd),'message':_0x1ce027(0x27c)},{'hours':0x14,'title':_0x1ce027(0x220),'message':_0x1ce027(0x1df)},{'hours':0x32,'title':_0x1ce027(0x1c7),'message':'50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You’re\x20on\x20the\x20right\x20path—keep\x20going.'},{'hours':0x64,'title':'To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','message':_0x1ce027(0x2b4)},{'hours':0xfa,'title':_0x1ce027(0x245),'message':_0x1ce027(0x48e)},{'hours':0x1f4,'title':_0x1ce027(0x423),'message':_0x1ce027(0x426)},{'hours':0x3e8,'title':_0x1ce027(0x478),'message':_0x1ce027(0x397)},{'hours':0x1388,'title':_0x1ce027(0x448),'message':_0x1ce027(0x379)}][_0x1ce027(0x2d0)]((_0x545993,_0x3e10f2)=>_0x3e10f2[_0x1ce027(0x2fc)]-_0x545993['hours']);}async function checkAndShowMilestones(){const _0x5dd33c=_0x272902;if(!data||!data[_0x5dd33c(0x274)])return;if(!Array['isArray'](data['settings'][_0x5dd33c(0x2db)]))data[_0x5dd33c(0x274)][_0x5dd33c(0x2db)]=[];const _0x4aa599=data[_0x5dd33c(0x2b0)][_0x5dd33c(0x48a)]((_0x400d01,_0x3678a2)=>{const _0x25850e=_0x5dd33c;return _0x400d01+_0x3678a2[_0x25850e(0x292)][_0x25850e(0x48a)]((_0x3564c4,_0x362d67)=>{const _0x5e4d5e=_0x25850e;return _0x3564c4+(_0x362d67[_0x5e4d5e(0x1ad)][_0x5e4d5e(0x35c)]||0x0);},0x0);},0x0),_0x498e76=_0x4aa599/0x3c,_0x16ad29=getMilestones(),_0x45c0a1=Array[_0x5dd33c(0x425)](data['settings'][_0x5dd33c(0x2db)])?data['settings']['achievedMilestones']:[],_0x589952=_0x16ad29[_0x5dd33c(0x1fb)](_0x225cbc=>_0x498e76>=_0x225cbc[_0x5dd33c(0x2fc)]&&!_0x45c0a1[_0x5dd33c(0x29e)](_0x225cbc[_0x5dd33c(0x2fc)]));if(_0x589952[_0x5dd33c(0x465)]===0x0)return![];const _0x23223d=_0x589952[_0x5dd33c(0x48a)]((_0x257fd5,_0x4c1c89)=>_0x257fd5&&_0x257fd5[_0x5dd33c(0x2fc)]>_0x4c1c89[_0x5dd33c(0x2fc)]?_0x257fd5:_0x4c1c89,null);if(!_0x23223d)return![];$(_0x5dd33c(0x2e6))[_0x5dd33c(0x1ab)]=_0x23223d[_0x5dd33c(0x3fa)],$(_0x5dd33c(0x261))[_0x5dd33c(0x1ab)]=_0x23223d[_0x5dd33c(0x1d9)],$(_0x5dd33c(0x1d5))['classList']['add'](_0x5dd33c(0x264));try{trapFocus($('#modalMilestone'));}catch(_0x3e6d15){}return data[_0x5dd33c(0x274)][_0x5dd33c(0x2db)][_0x5dd33c(0x34a)](_0x23223d[_0x5dd33c(0x2fc)]),await saveData(),!![];}async function seedAchievedMilestones(){const _0x15d39a=_0x272902;if(!data||!data[_0x15d39a(0x274)])return;!Array[_0x15d39a(0x425)](data[_0x15d39a(0x274)]['achievedMilestones'])&&(data[_0x15d39a(0x274)][_0x15d39a(0x2db)]=[],await saveData());}async function handleSendMessage(){const _0x440c62=_0x272902,_0x45f2ab=$(_0x440c62(0x290)),_0x7df8a1=$('#chatInput'),_0x30d5a3=_0x7df8a1[_0x440c62(0x472)][_0x440c62(0x2eb)](),_0x6b2032=getCurrentSubtopic();if(!_0x30d5a3)return;if(!_0x6b2032){toast(t(_0x440c62(0x224)));return;}_0x7df8a1['value']='',_0x45f2ab[_0x440c62(0x35b)]=!![],_0x45f2ab['innerHTML']='<div\x20class=\x22spinner\x22></div>',_0x6b2032[_0x440c62(0x3c7)][_0x440c62(0x34a)]({'role':_0x440c62(0x39a),'text':_0x30d5a3}),renderChat();const _0x1ac658=await callGeminiAPI(_0x30d5a3);_0x1ac658&&(_0x6b2032[_0x440c62(0x3c7)]['push']({'role':'model','text':_0x1ac658}),await saveData(),renderChat()),_0x45f2ab['disabled']=![],_0x45f2ab[_0x440c62(0x273)]=_0x440c62(0x37e);}function renderChat(){const _0x5b45bb=_0x272902,_0xb4dbcf=getCurrentSubtopic(),_0x4aaccd=$(_0x5b45bb(0x1ca)),_0x52a838=$(_0x5b45bb(0x347)),_0x14ba31=$('#btnSendMessage');if(!_0x4aaccd||!_0x52a838||!_0x14ba31)return;if(!_0xb4dbcf){_0x4aaccd[_0x5b45bb(0x273)]=_0x5b45bb(0x37d),_0x52a838[_0x5b45bb(0x35b)]=!![],_0x14ba31[_0x5b45bb(0x35b)]=!![];return;}_0x52a838[_0x5b45bb(0x35b)]=![],_0x14ba31['disabled']=![],_0x4aaccd[_0x5b45bb(0x273)]='';if(!_0xb4dbcf[_0x5b45bb(0x3c7)]||_0xb4dbcf['chatHistory'][_0x5b45bb(0x465)]===0x0){_0x4aaccd[_0x5b45bb(0x273)]=_0x5b45bb(0x409);return;}_0xb4dbcf[_0x5b45bb(0x3c7)][_0x5b45bb(0x2b6)](_0x3a5b1d=>{const _0xadd724=_0x5b45bb,_0x59996b=document[_0xadd724(0x2bd)](_0xadd724(0x256));_0x59996b[_0xadd724(0x28d)]='chat-msg\x20'+_0x3a5b1d[_0xadd724(0x326)],_0x59996b[_0xadd724(0x1ab)]=_0x3a5b1d[_0xadd724(0x2c5)],_0x4aaccd[_0xadd724(0x3af)](_0x59996b);}),_0x4aaccd['scrollTop']=_0x4aaccd[_0x5b45bb(0x4a8)];}async function handleSummarizeNote(){const _0x1f8d5a=_0x272902,_0x3b07df=$('#btnSummarizeNote'),_0x292437=$('#noteText'),_0x31b60a=_0x292437[_0x1f8d5a(0x472)][_0x1f8d5a(0x2eb)](),_0xd9002d=getCurrentSubtopic();if(!_0x31b60a){toast(_0x1f8d5a(0x359));return;}const _0x1da866=_0x3b07df[_0x1f8d5a(0x273)];_0x3b07df[_0x1f8d5a(0x273)]=_0x1f8d5a(0x33c),_0x3b07df[_0x1f8d5a(0x35b)]=!![];const _0x1fb9f6=_0x1f8d5a(0x3ec)+(_0xd9002d?.[_0x1f8d5a(0x1f0)]||_0x1f8d5a(0x40f))+_0x1f8d5a(0x294)+_0x31b60a+'\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**✨\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**🚀\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]',_0x153961=await callGeminiAPI(_0x1fb9f6);_0x153961&&(_0x292437['value']+='\x0a\x0a'+_0x153961),_0x3b07df[_0x1f8d5a(0x273)]=_0x1da866,_0x3b07df['disabled']=![];}function clearChat(){const _0x49e2a9=_0x272902,_0x2f1256=getCurrentSubtopic();if(!_0x2f1256){toast(t(_0x49e2a9(0x224)));return;}showConfirmModal('Confirm\x20Deletion','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?',async _0x5233cb=>{const _0x4d70ad=_0x49e2a9;_0x5233cb&&(_0x2f1256[_0x4d70ad(0x3c7)]=[],await saveData(),renderChat(),toast(_0x4d70ad(0x377)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x4c5d0c,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x40dd00=_0x272902,_0x2bf1cc=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x4c5d0c,'enablejsapi':'1','origin':_0x40dd00(0x28b)})['toString']();return'https://www.youtube.com/embed/'+_0x4c5d0c+'?'+_0x2bf1cc;}function ensureFallbackFrame(){const _0x47fe44=_0x272902,_0x168378=document[_0x47fe44(0x298)](_0x47fe44(0x33b));if(!_0x168378)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x47fe44(0x337)])return ytFallbackFrame;const _0xf20e6a=document['createElement'](_0x47fe44(0x322));return _0xf20e6a['id']=_0x47fe44(0x3f9),_0xf20e6a[_0x47fe44(0x1ef)]='1',_0xf20e6a['height']='1',_0xf20e6a[_0x47fe44(0x497)][_0x47fe44(0x2c2)]='absolute',_0xf20e6a[_0x47fe44(0x497)][_0x47fe44(0x208)]=_0x47fe44(0x250),_0xf20e6a[_0x47fe44(0x497)][_0x47fe44(0x1f6)]=_0x47fe44(0x250),_0xf20e6a[_0x47fe44(0x447)]=_0x47fe44(0x1e2),_0x168378['innerHTML']='',_0x168378[_0x47fe44(0x3af)](_0xf20e6a),ytFallbackFrame=_0xf20e6a,_0xf20e6a;}function fallbackLoadVideo(_0x279973,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x40c731=_0x272902,_0x43c913=document['getElementById']('youtube-player-container');if(!_0x43c913)return;_0x43c913['innerHTML']='';const _0x4dcf71=document[_0x40c731(0x2bd)](_0x40c731(0x322));_0x4dcf71['id']=_0x40c731(0x3f9),_0x4dcf71[_0x40c731(0x1ef)]='1',_0x4dcf71['height']='1',_0x4dcf71['style'][_0x40c731(0x2c2)]=_0x40c731(0x316),_0x4dcf71['style'][_0x40c731(0x208)]=_0x40c731(0x250),_0x4dcf71['style'][_0x40c731(0x1f6)]=_0x40c731(0x250),_0x4dcf71['allow']=_0x40c731(0x1e2),_0x4dcf71[_0x40c731(0x407)]=buildFallbackSrc(_0x279973,{'autoplay':autoplay,'mute':mute}),_0x43c913['appendChild'](_0x4dcf71),ytFallbackFrame=_0x4dcf71,ytFallbackIsPlaying=!!autoplay;try{const _0x8d7074=document[_0x40c731(0x298)](_0x40c731(0x2bc));if(_0x8d7074)_0x8d7074[_0x40c731(0x1ab)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x2ce16f){}}function fallbackPostMessage(_0x589a59,_0x143357=[]){const _0xbb54c6=_0x272902;try{if(!ytFallbackFrame||!ytFallbackFrame[_0xbb54c6(0x317)])return;ytFallbackFrame[_0xbb54c6(0x317)][_0xbb54c6(0x3e1)](JSON[_0xbb54c6(0x333)]({'event':_0xbb54c6(0x355),'func':_0x589a59,'args':_0x143357}),'https://www.youtube.com');}catch(_0x1d7883){}}function fallbackPlay(){const _0x368b21=_0x272902;fallbackPostMessage(_0x368b21(0x1cf));}function fallbackStop(){const _0x2c56a8=_0x272902;try{ytFallbackFrame&&(ytFallbackFrame[_0x2c56a8(0x407)]='about:blank',ytFallbackIsPlaying=![]);}catch(_0x1531b8){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0x250b52=_0x272902;fallbackPostMessage(_0x250b52(0x306));}function fallbackMute(){const _0x2eb932=_0x272902;fallbackPostMessage(_0x2eb932(0x436));}window['onYouTubeIframeAPIReady']=function(){const _0x4da97a=_0x272902;if(IS_FILE_PROTOCOL){try{window['__ytApiWatchdog']&&window['__ytApiWatchdog'][_0x4da97a(0x1db)]();}catch(_0x434068){}return;}const _0x524687={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x4da97a(0x28b)};(window['location'][_0x4da97a(0x26b)]===_0x4da97a(0x210)||window[_0x4da97a(0x414)][_0x4da97a(0x26b)]===_0x4da97a(0x466))&&(_0x524687['origin']=window[_0x4da97a(0x414)][_0x4da97a(0x211)]);ytPlayer=new YT[(_0x4da97a(0x444))](_0x4da97a(0x33b),_0x524687);try{window[_0x4da97a(0x3eb)]&&window['__ytApiWatchdog']['cancel']();const _0x5afa71=document[_0x4da97a(0x298)](_0x4da97a(0x2e1));_0x5afa71&&(_0x5afa71[_0x4da97a(0x1ab)]='');}catch(_0x4904f0){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage[_0x272902(0x329)](_0x272902(0x42b))==='1';}catch(_0x41b4d8){}function showSoundPermission(){const _0x41daec=_0x272902,_0x25d3e3=document['getElementById'](_0x41daec(0x1ff));if(!_0x25d3e3)return;if(_ytUnlocked){_0x25d3e3[_0x41daec(0x21e)][_0x41daec(0x348)](_0x41daec(0x264));return;}_0x25d3e3[_0x41daec(0x21e)][_0x41daec(0x4b0)](_0x41daec(0x264));}function hideSoundPermission(){const _0x2f70d2=_0x272902,_0x2df961=document[_0x2f70d2(0x298)](_0x2f70d2(0x1ff));if(!_0x2df961)return;_0x2df961['classList'][_0x2f70d2(0x348)](_0x2f70d2(0x264));}function unlockAudioChain(){const _0x53f11f=_0x272902;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x53f11f(0x487)]===_0x53f11f(0x1e4))AUDIO_CTX[_0x53f11f(0x487)]();}catch(_0xd5a5ca){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x53f11f(0x306)]&&(ytPlayer[_0x53f11f(0x306)](),ytPlayer[_0x53f11f(0x1cf)]());}catch(_0x201ef8){}_ytUnlocked=!![];try{localStorage[_0x53f11f(0x1b5)](_0x53f11f(0x42b),'1');}catch(_0x51e1d5){}hideSoundPermission(),toast(_0x53f11f(0x429));}function onPlayerReady(_0x50ecec){const _0x940746=_0x272902;try{const _0x57fd42=ytPlayer&&ytPlayer['getIframe']?ytPlayer[_0x940746(0x47c)]():null;_0x57fd42&&_0x57fd42[_0x940746(0x233)](_0x940746(0x447),'autoplay;\x20encrypted-media;\x20picture-in-picture');}catch(_0x182b26){}try{if(ytPlayer&&ytPlayer[_0x940746(0x243)])ytPlayer[_0x940746(0x243)](data&&data[_0x940746(0x274)]&&data[_0x940746(0x274)][_0x940746(0x1e8)]||0x50);}catch(_0x4c1a50){}try{const _0x4cf7ec=getActiveVideoId&&getActiveVideoId();if(_0x4cf7ec&&ytPlayer&&ytPlayer[_0x940746(0x436)]&&ytPlayer['playVideo']){ytPlayer[_0x940746(0x436)](),ytPlayer[_0x940746(0x1cf)](),_ytPrimed=!![];const _0x364c02=()=>{const _0x41aa96=_0x940746;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x629bbb){}window[_0x41aa96(0x394)](_0x41aa96(0x3d3),_0x364c02,!![]),window[_0x41aa96(0x394)](_0x41aa96(0x467),_0x364c02,!![]);};window[_0x940746(0x3ea)](_0x940746(0x3d3),_0x364c02,!![]),window['addEventListener']('keydown',_0x364c02,!![]),showSoundPermission();}}catch(_0xce9f7a){}updateYouTubePlayer();}function onPlayerStateChange(_0x5af0b6){const _0x510ed2=_0x272902,_0xd39b99=$('#btnToggleYtSound');_0x5af0b6['data']==YT[_0x510ed2(0x3c8)][_0x510ed2(0x3c3)]?(_0xd39b99[_0x510ed2(0x1ab)]='⏸️',hideSoundPermission()):_0xd39b99[_0x510ed2(0x1ab)]='▶';if(_0x5af0b6[_0x510ed2(0x328)]===YT[_0x510ed2(0x3c8)][_0x510ed2(0x33f)]){if(!ytUserPaused)ytPlayer['playVideo']();}}async function ytFadeTo(_0x255ed5,_0x1f728d=0xfa){const _0x12efc4=_0x272902;try{if(!ytPlayer||!ytPlayer[_0x12efc4(0x4a4)]||!ytPlayer['setVolume'])return;ytPlayer['unMute']();const _0x2a4a42=ytPlayer[_0x12efc4(0x4a4)](),_0x1e63cc=_0x255ed5-_0x2a4a42;if(Math['abs'](_0x1e63cc)<0x1||_0x1f728d<=0x0){ytPlayer[_0x12efc4(0x243)](_0x255ed5);return;}const _0x304dca=performance[_0x12efc4(0x404)]();await new Promise(_0x26e21c=>{const _0x1be6eb=_0x4660c2=>{const _0x1c2025=_0x4e4c,_0xa96ded=Math['min'](0x1,(_0x4660c2-_0x304dca)/_0x1f728d),_0x4578ff=Math[_0x1c2025(0x1f3)](_0x2a4a42+_0x1e63cc*_0xa96ded);ytPlayer[_0x1c2025(0x243)](_0x4578ff);if(_0xa96ded<0x1)requestAnimationFrame(_0x1be6eb);else _0x26e21c();};requestAnimationFrame(_0x1be6eb);});}catch(_0x10d011){}}async function ytFadeInPlay(_0x403a8e=0xdc){const _0x1c033a=_0x272902;try{const _0x49ba29=Math[_0x1c033a(0x3ba)](0x0,Math[_0x1c033a(0x443)](0x64,data&&data['settings']&&data['settings'][_0x1c033a(0x1e8)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer['unMute'](),ytPlayer['playVideo']();try{ytPlayer[_0x1c033a(0x243)](0x0);}catch(_0x340942){}await ytFadeTo(_0x49ba29,_0x403a8e);}else{const _0x544ca0=getActiveVideoId();_0x544ca0&&fallbackLoadVideo(_0x544ca0,{'autoplay':0x1,'mute':0x0});}}catch(_0x29af9c){}}async function ytFadeOutPause(_0x54154b=0xb4){const _0x671923=_0x272902;try{const _0x14af30=Math[_0x671923(0x3ba)](0x0,Math['min'](0x64,data&&data[_0x671923(0x274)]&&data[_0x671923(0x274)]['youtubeVolume']||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x54154b);try{ytPlayer['pauseVideo'](),ytPlayer[_0x671923(0x243)](_0x14af30);}catch(_0x58f20a){}}else try{fallbackPause();}catch(_0x38681a){}}catch(_0x1984b0){}}async function updateYouTubePlayer(){const _0x473fb6=_0x272902,_0x6d6e21=getActiveVideoId();if(data[_0x473fb6(0x274)][_0x473fb6(0x42c)]&&_0x6d6e21){const _0x1f741e=_0x473fb6(0x464)+_0x6d6e21+_0x473fb6(0x315),_0x1bffc7=new Image();_0x1bffc7[_0x473fb6(0x234)]=async()=>{const _0x146f79=_0x473fb6;data[_0x146f79(0x274)][_0x146f79(0x26a)]=_0x1f741e,await saveData(),applyCustomBg();},_0x1bffc7[_0x473fb6(0x216)]=async()=>{const _0x425a46=_0x473fb6,_0x8dc916=_0x425a46(0x464)+_0x6d6e21+_0x425a46(0x2a8);data['settings'][_0x425a46(0x26a)]=_0x8dc916,await saveData(),applyCustomBg();},_0x1bffc7[_0x473fb6(0x407)]=_0x1f741e;}else!_0x6d6e21&&(data[_0x473fb6(0x274)]['customBg']='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x6d6e21){fallbackStop(),hideSoundPermission();return;}const _0x1abb52=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x6d6e21,{'autoplay':0x1,'mute':_0x1abb52});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0x473fb6(0x2fa)]){try{ensureYouTubeAPI();}catch(_0x2572b1){}return;}if(!_0x6d6e21){if(ytPlayer[_0x473fb6(0x30e)])ytPlayer[_0x473fb6(0x30e)]();hideSoundPermission();return;}ytPlayer[_0x473fb6(0x2fa)](_0x6d6e21),ytPlayer[_0x473fb6(0x243)](data[_0x473fb6(0x274)][_0x473fb6(0x1e8)]);}function toggleYtSound(){const _0xfb1f37=_0x272902;if(!_ytUnlocked){try{ensureAudio();}catch(_0x54bc86){}try{unlockAudioChain();}catch(_0x58d486){}return;}if(IS_FILE_PROTOCOL){const _0x306828=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0xfb1f37(0x337)]){if(!_0x306828){toast(_0xfb1f37(0x24b));return;}fallbackLoadVideo(_0x306828,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x1b457e=document[_0xfb1f37(0x298)]('btnToggleYtSound');if(_0x1b457e)_0x1b457e[_0xfb1f37(0x1ab)]='⏸️';}catch(_0x3782ab){}toast('Playing\x20background\x20music...');return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0xfb1f37(0x3dc)),ytFallbackIsPlaying=![],toast('Background\x20music\x20stopped.');else{if(!_0x306828){toast(_0xfb1f37(0x24b));return;}fallbackPostMessage('playVideo'),ytFallbackIsPlaying=!![],toast(_0xfb1f37(0x40e));}try{const _0x425645=document[_0xfb1f37(0x298)](_0xfb1f37(0x2bc));if(_0x425645)_0x425645[_0xfb1f37(0x1ab)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x4d02e0){}return;}if(!ytPlayer||typeof ytPlayer['getPlayerState']!==_0xfb1f37(0x1e4)){try{ensureYouTubeAPI();}catch(_0x53d21d){}return;}const _0x3c6b0c=ytPlayer['getPlayerState']();_0x3c6b0c===YT[_0xfb1f37(0x3c8)]['PLAYING']||_0x3c6b0c===YT[_0xfb1f37(0x3c8)]['BUFFERING']?(ytFadeOutPause(),ytUserPaused=!![],toast(_0xfb1f37(0x309))):(ytFadeInPlay(),ytUserPaused=![],toast(_0xfb1f37(0x40e)));}function _0x198c(){const _0x536196=['&gt;','appendChild','Rename\x20Topic','#btnAddGeneralNote','655BCjSns','change','More\x20options','breathing','isNaN','getDate','pomodoro_files','errorCode','max','<span\x20class=\x22ico\x22>▾</span>','topic-actions','var(--danger)','currentDurations','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','longBreakIntervalA','transition','API\x20response\x20structure\x20is\x20unexpected:','PLAYING','setProperty','strokeDashoffset','#settings-pomodoro','chatHistory','PlayerState','offsetHeight','chime','</li>','Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.','application/json','long','soundTheme','btn\x20small\x20danger','then','#statSessions','pointerdown','test','short','#btnAddSubtopicTask','Stand\x20up\x20and\x20take\x20a\x20few\x20steps.','#modalNote','Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.','Escape','Data\x20restored\x20successfully!\x20Reloading...','pauseVideo','#btnFinishFlow','exportData','timerState','\x20hidden','postMessage','hidden','#set_enableSessionNotes','Benjamin\x20Franklin’s\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','var(--warn)','#view-methods\x20.method-item','unshift','<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20','btn\x20small\x20ghost\x20method-edit','addEventListener','__ytApiWatchdog','Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22','restoreBackup','exponentialRampToValueAtTime','version','blob:','Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.','topic','cover','textarea','#btnSettings','btn\x20subtopic-btn','linearRampToValueAtTime','Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.','yt-fallback','title','onkeydown','mode','#topicsList','sess','destroy','findIndex','padStart','#set_work','method-title','now','indexOf','Failed\x20to\x20load\x20YouTube\x20API','src','reverse','<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>','clear','relative','fullscreenchange','Backup\x20failed:','Playing\x20background\x20music...','unknown','sid','#currentSubtopicName','toggle','task','location','.actions-menu','oncomplete','lang','closest','panelOpacity','remaining','Playing','Have\x20a\x20sip\x20of\x20water.','longBreakIntervalB','#btnPresetA','12935052uDAGio','readonly','replace','.actions-menu-btn','To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','get','isArray','Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You’ve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.','Defaults\x20restored','work_end','Sound\x20has\x20been\x20enabled!','clientY','sound_unlocked','useYtThumbnailAsBg','catch','prompt','body','getAll','#btnHelpCreateTopic','#btnGenericCancel','beginWork','button','interval','mute','sessionsCompleted','❌\x20Invalid\x20or\x20unsupported\x20link.','actions','mousedown','set_youtubeUrl','isContentEditable','durations','Edit','lastBackupDate','\x20|\x20<strong>Total\x20tasks:</strong>\x20','topicsList','#uploadSoundBreak','min','Player','setRangeText','Saved\x20alert\x20for\x20SHORT\x20BREAK.','allow','To\x20You,\x205,000+\x20Hours\x20(Legacy)','target','Delete\x20Topic','volume','138490LlwaRu','backups','\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.','Gemini\x20error:\x20','AI\x20finished\x20formatting!','tickHandle','2753310sttEcg','backgroundImage','#newSubtopicTaskInput','formatBlock','#btnAddMethod','<tr><td>','tagName','backupDaysToKeep','IndexedDB\x20initialized\x20successfully.','2978760YvhtqZ','<i>$1</i>','tasks','paused','menu-active','.modal','#methodEditorContentInput','Note\x20saved','.\x20Please\x20try\x20again\x20with\x20different\x20content.','https://img.youtube.com/vi/','length','https:','keydown','updateSettings','READY','Loading\x20YouTube\x20API...','match','#methodEditorTitleInput','reset','candidates','B_work','state','defer','value','startsWith','#timerPresetSelector\x20button','A_winddown','Invalid\x20file\x20format','click','To\x20You,\x201,000\x20Hours\x20(Transformation)','topic-header','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>','menu-item\x20danger','getIframe','?\x20Current\x20data\x20will\x20be\x20overwritten.','selectedTopicId','.subtopic-btn','Refuel\x20with\x20a\x20healthy\x20snack.','.nav-btn[data-view]','connect','.method-delete','chev\x20btn\x20small\x20ghost','splice','Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.','resume','Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20','getPropertyValue','reduce','preventDefault','A_long','summary_','250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You’ve\x20met\x20hard\x20days\x20and\x20distractions—and\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.','execCommand','promptFeedback','Settings\x20saved','#toolList','note-meta','img.youtube.com/vi/','Import\x20failed:\x20','#set_flowRatio','style','update','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','#set_long','btn\x20small\x20ghost\x20actions-menu-btn','newIndex','</tbody></table>','subtopics-group','delete','#btnPresetC','#btnReset','prevState','Untitled','getVolume','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22','Error:\x20','💡\x20Suggestion:\x20','scrollHeight','<p>The\x20core\x20idea:\x20\x22If\x20you\x20can’t\x20explain\x20a\x20topic\x20simply,\x20you\x20don’t\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can’t\x20explain\x20smoothly,\x20you’ve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it’s\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool—pinpointing\x20exactly\x20where\x20you’re\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>','FOCUS','apiKey','#btnDashboard','readwrite','.method-item\x20.method-content','#audioBreakEnd','add','oldIndex','http','href','substring','updateUI','objectStoreNames','currentConfig','#uploadBg','Notice\x20the\x20room’s\x20temperature\x20and\x20lighting.','.app-content','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>','#btnResume','currentView','italic','toLowerCase','ArrowLeft','#welcomePanel','58161NfkhBJ','offsetWidth','pomodoroData_v11','summaries','Cycle\x20','#btnSaveNote','Saved\x20alert\x20for\x20FOCUS.','textContent','</td><td>','stats','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20its\x20Knowledge\x20Base.</p>','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>','ArrowRight','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','Check\x20and\x20correct\x20your\x20sitting\x20posture.','<ol>','topicId','setItem','file:','Edit\x20Knowledge','cyclesTarget','#set_winddown','method-content','color','error','To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','No\x20Subtopic\x20Selected','stopPropagation','active','#modalDashboard','Content\x20blocked\x20for:\x20','</td></tr>','#set_autoStartNext','Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.','script','To\x20You,\x2050\x20Hours\x20(Momentum)','--bg-image','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','#chatMessages','</ul>','#btnMilestoneClose','var(--sub)','#timeDisplay','playVideo','soundOn','string','#set_cycles','menu-item','parts','#modalMilestone','load','#windDownChecklist','reloading','message','createObjectStore','cancel','status','selectionEnd','badge\x20state\x20break','Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren’t\x20just\x20time—they’re\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You’re\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.','cycleIndex','.sub-row','autoplay;\x20encrypted-media;\x20picture-in-picture','setValueAtTime','function','acc','sine','#historyList','youtubeVolume','#ytSoundVolume','Delete\x20knowledge\x20\x22','break_end','selectedSubtopicId','item','warn','width','name','.timer-circle-progress','Tab','round','Switch\x20to\x20Style\x20','backgroundSize','left','none','destination','createdAt','persistTimerState','filter','Space','&#39;','#btnClearBg','soundPermissionBar','#genericMessage','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','#set_theme','display','work','New\x20Subtopic\x20name?','styleWithCSS','<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you’re\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don’t\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>','top','open','0\x20min','Error\x20saving\x20data:\x20','_onFinishSegment','#set_short','Please\x20select\x20a\x20Subtopic\x20first','Delete\x20Subtopic','http:','origin','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203–5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20“Force\x20Multiplier”:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','put','contains','subtopic','onerror','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','parse','durationMinutes','getFullYear','initDB','createObjectURL','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','classList','cleanupOldBackups','To\x20You,\x2020\x20Hours\x20(Foundation)','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','ArrowUp','PomodoroAppDB','timer.selectSubtopicPrompt','#btnSummarize','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','#btnPresetB','#generalNotesList','long_end','result','space','workMinutes','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.','#btnSkip','.method-item','#view-methods','#ytUrlFeedback','#btnToggleYtSound','setAttribute','onload','#set_enableWinddown','files','_startTick','content','getMonth','#statTasks','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.','<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>','#btnClearChat','<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>','querySelector','sub-row','Sortable','.color-palette','setVolume','gain','To\x20You,\x20250\x20Hours\x20(Perseverance)','<h4>','preset','(Could\x20not\x20generate\x20summary)','...','#set_backupDays','No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.','bold','Add\x20subtopic','ghost','#view-timer','-9999px','exitFullscreen','currentTime','setPreset','checked','.txt','div','Loosen\x20your\x20finger\x20joints\x20after\x20typing.','start','focus','topic-item','#selectedContext','input','toast','Gemini\x20API\x20Error:','Summarize','timer','#milestoneMessage','split','note-item','show','</h4>','#btnSaveSettings','Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.','POST','.tab-btn','customBg','protocol','--panel-opacity','Subtopic:\x20','Hide\x20interface','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','#btnTestSound','no-repeat','innerHTML','settings','note-content-wrapper','Take\x20a\x20short\x20walk\x20around\x20the\x20room.','Gently\x20massage\x20your\x20temples.','var(--acc-2)','pomodoro_backup_','lofi','finished','Five\x20focused\x20hours!\x20You’ve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','undefined','enableWinddown','triangle','input,select,textarea','collapsedTopics','Daily\x20backup\x20successful.','btn\x20small','Backup\x20not\x20found.','map','.topic-item','#draggableTimer','theme','#importFile','_getStore','https://www.youtube.com','#btnToggleBg','className','B_winddown','HTTP\x20error:\x20','#btnSendMessage','Switched\x20to\x20Style\x20','subtopics','onupgradeneeded','\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22','&lt;','fullscreenElement','methods','getElementById','WIND-DOWN','#methodEditorId','Initialization\x20error:\x20','#btnAutoFormat','toLocaleDateString','includes','revokeObjectURL','#btnBreakEarly','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?','block','Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.','createIndex','onclick','toISOString','Please\x20select\x20a\x20subtopic\x20first.','/hqdefault.jpg','\x20min\x20via\x20Flowtime\x20(','_sortable','#btnCloseSettings','documentElement','find','#btnAddTopic','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','topics','cyclesB','Rename\x20Subtopic','removing','100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment—it’s\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.','Content\x20required\x20for\x20AI\x20formatting.','forEach','bg-view-mode','.subtopics','finishFlowSession','backgroundRepeat','methodId','btnToggleYtSound','createElement','all','enableSessionNotes','tid','timer.cycleInfo','position','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','idle','text','<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>','note','default','btn\x20small\x20danger\x20method-delete','removeProperty','Unable\x20to\x20save\x20changes.','mousemove','foreColor','dateISO','frequency','sort','#btnGenericOk','lastPersist','tasksCompleted','\x20(A)','#statTotal','modalMethodEditor','#noteText','#btnStart','Confirm\x20Switch','badge\x20state\x20work','achievedMilestones','A_work','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>','#backupList','Failed\x20to\x20delete\x20summary:','#btnSummarizeNote','ytUrlFeedback','badge','Summary\x20failed.','Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.','\x20·\x20','#milestoneTitle','bottom','head','#editorPreview','&quot;','trim','actions-menu','toLocaleString','Custom\x20background\x20removed.','end','Confirm\x20Restore','#genericInput','altKey','customSounds','#set_backgroundMode','from','getSettings','AI\x20cannot\x20format\x20at\x20the\x20moment.','by_topic','A_short','cueVideoById','#set_youtubeUrl','hours','3446135QrBIhF','Initialization\x20error:','__ytApiPromise','.tab-content','.aux-panel,\x20.modal-card','note-content','B_short','7068mqmtXQ','auto','unMute','getBoundingClientRect','#uploadSoundLong','Background\x20music\x20stopped.','New\x20Topic\x20name?','createOscillator','LONG\x20BREAK','json','stopVideo','\x20min','querySelectorAll','presetTarget','activeElement','SHORT\x20BREAK','</ol>','/maxresdefault.jpg','absolute','contentWindow','.view','Please\x20select\x20a\x20backup.','#btnSaveMethod','backgroundMode','aria-expanded','#breakSuggestionDisplay','winddown','#dashboardContent','main_settings','Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.','iframe','innerHeight','<input\x20type=\x22checkbox\x22\x20id=\x22','#set_ytThumbAsBg','role','sessions','data','getItem','#stateBadge','Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a','.method-content','file','log','shiftKey','.presets\x20button','Audio\x20playback\x20error:','play','stringify','requestFullscreen','Open\x20a\x20window\x20for\x20some\x20fresh\x20air.','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>','isConnected','light','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','#set_interval','youtube-player-container','<div\x20class=\x22spinner\x22></div>','#customSoundsContainer','toString','ENDED','beginBreak','\x20|\x20<strong>Total\x20sessions:</strong>\x20','importData','\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.','object','reload','createGain','#chatInput','remove','<strong>$1</strong>','push','transaction','#btnFullscreen','break','28DkUZih','floor','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22','#toolBullet','#genericTitle','cycles','<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>','command','#modalGeneric','Ask\x20yourself:\x20‘How\x20do\x20I\x20feel\x20right\x20now?’','key','Please\x20enter\x20a\x20note\x20before\x20summarizing.','Export','disabled','totalMinutes','aria-pressed','wind_down','<li>','long_break','tab','blockReason','flex','#set_theme_color','.nav-btn[data-view=\x22','#toolItalic','right','DB_VERSION','.timer-circle-container','save','skip','append','beep','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','#btnDefaults','resolve','#set_volume','dataset','onsuccess','File\x20save\x20error.','type','autoStartNext','Chat\x20history\x20cleared.','pastel','5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‘How\x20do\x20I\x20focus?’\x20to\x20‘What\x20value\x20will\x20this\x20focus\x20create?’.\x20You’re\x20not\x20just\x20working—you’re\x20building\x20a\x20legacy.','Delete','values','cyclesA','<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>','Send','#settings-flowtime','objectStore','no-subtopic-selected','date','flowtimeBreakRatio','innerWidth','Data\x20imported\x20successfully!','isCompleted','hist-item','flatMap','pause','var(--muted)','select','</label>','slice','autoBackup','view','generalNotes','.color-picker-wrapper','segmentTotal','#summariesList','removeEventListener','</div>','DB_NAME','Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time—it\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‘superpower’\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.','#btnPause','download','user','####\x20','option','loadLanguage','webkitAudioContext','Enter','Creating\x20backup\x20for\x20','insertUnorderedList','localeCompare','FOCUS\x20(FLOW)','AudioContext','#view-','code','#modalSettings','Deleted\x20old\x20backup:\x20','#modalMethodEditor','#set_panelOpacity','Confirm\x20Deletion','#toolColor','B_long'];_0x198c=function(){return _0x536196;};return _0x198c();}function bindEvents(){const _0x53fe83=_0x272902;try{const _0x298627=document[_0x53fe83(0x23f)]('#welcomePanel\x20p');_0x298627&&(_0x298627[_0x53fe83(0x273)]='Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.');}catch(_0x527de7){}on($(_0x53fe83(0x28c)),_0x53fe83(0x477),toggleBackgroundView),on($(_0x53fe83(0x1cc)),_0x53fe83(0x477),()=>{const _0x455692=_0x53fe83;$(_0x455692(0x1d5))[_0x455692(0x21e)]['remove'](_0x455692(0x264));try{releaseFocus();}catch(_0x53fa79){}}),on($('#btnAddTopic'),_0x53fe83(0x477),()=>showInputModal(_0x53fe83(0x30a),async _0x217653=>{const _0x7d337e=_0x53fe83;if(!_0x217653)return;data[_0x7d337e(0x2b0)][_0x7d337e(0x34a)]({'id':uid('t'),'name':_0x217653,'subtopics':[]}),await saveData(),renderTopics();})),on($('#btnExport'),'click',()=>storageManager[_0x53fe83(0x3de)](data)),on($(_0x53fe83(0x289)),_0x53fe83(0x3b3),_0x37e58f=>{const _0x2d29c9=_0x53fe83,_0x36604f=_0x37e58f[_0x2d29c9(0x449)][_0x2d29c9(0x236)][0x0];if(!_0x36604f)return;storageManager[_0x2d29c9(0x342)](_0x36604f)['then'](async _0x544bc4=>{const _0x44d68b=_0x2d29c9;data=_0x544bc4,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x44d68b(0x385)),renderAll();})[_0x2d29c9(0x42d)](_0x191dfd=>toast(_0x2d29c9(0x495)+_0x191dfd[_0x2d29c9(0x1d9)])),_0x37e58f[_0x2d29c9(0x449)][_0x2d29c9(0x472)]=null;}),on($('#btnRestoreBackup'),_0x53fe83(0x477),()=>{const _0x471f57=_0x53fe83,_0x1ddb5c=$('#backupList'),_0x56160f=_0x1ddb5c?_0x1ddb5c[_0x471f57(0x472)]:'';if(!_0x56160f){toast(_0x471f57(0x319));return;}showConfirmModal(_0x471f57(0x2f0),_0x471f57(0x488)+new Date(_0x56160f)[_0x471f57(0x29d)]()+_0x471f57(0x47d),_0xde2c7a=>{const _0x1e3d18=_0x471f57;_0xde2c7a&&storageManager[_0x1e3d18(0x3ed)](_0x56160f)[_0x1e3d18(0x3d1)](_0x4a4cdb=>{const _0x56dcaa=_0x1e3d18;data=_0x4a4cdb,toast(_0x56dcaa(0x3db)),setTimeout(()=>window[_0x56dcaa(0x414)][_0x56dcaa(0x345)](),0x5dc);})[_0x1e3d18(0x42d)](_0x451de8=>{const _0x5a89db=_0x1e3d18;toast(_0x5a89db(0x4a6)+_0x451de8[_0x5a89db(0x1d9)]);});});}),on($(_0x53fe83(0x364)),'input',_0x5468ef=>{const _0x34f44d=_0x53fe83,_0x2f9d2c=_0x5468ef[_0x34f44d(0x449)][_0x34f44d(0x472)];applyTheme(_0x2f9d2c);if(_0x2f9d2c==='light'||_0x2f9d2c===_0x34f44d(0x378)){const _0x25d524=$(_0x34f44d(0x325));_0x25d524&&(_0x25d524[_0x34f44d(0x254)]=![],toast('Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.',0x7d0));try{document['body'][_0x34f44d(0x497)][_0x34f44d(0x3c4)](_0x34f44d(0x1c8),_0x34f44d(0x1f7));}catch(_0x43788f){}}else{const _0x51141a=$(_0x34f44d(0x325));_0x51141a&&(_0x51141a[_0x34f44d(0x254)]=!![]);try{updateYouTubePlayer();}catch(_0x3f6de0){}}}),on($(_0x53fe83(0x3f5)),_0x53fe83(0x477),openSettings),on($(_0x53fe83(0x431)),_0x53fe83(0x477),()=>{const _0x564f78=_0x53fe83;switchView(_0x564f78(0x2b0)),$(_0x564f78(0x2ae))[_0x564f78(0x477)]();}),on($(_0x53fe83(0x4ac)),_0x53fe83(0x477),()=>{const _0x1d96dd=_0x53fe83;renderDashboard(),$('#modalDashboard')['classList'][_0x1d96dd(0x4b0)](_0x1d96dd(0x264));}),on($('#btnCloseDashboard'),_0x53fe83(0x477),()=>{const _0x585a5e=_0x53fe83;$(_0x585a5e(0x1c1))[_0x585a5e(0x21e)][_0x585a5e(0x348)]('show');}),on($(_0x53fe83(0x2ab)),_0x53fe83(0x477),closeSettings),on($(_0x53fe83(0x266)),'click',saveSettings),on($(_0x53fe83(0x36f)),_0x53fe83(0x477),setDefaults),on($(_0x53fe83(0x271)),_0x53fe83(0x477),()=>{ensureAudio(),playSound('work_end');}),on($('#btnToggleCustomSounds'),_0x53fe83(0x477),_0x445497=>{const _0x461f82=_0x53fe83;_0x445497[_0x461f82(0x48b)]();const _0x5a0349=$(_0x461f82(0x33d));if(_0x5a0349)_0x5a0349['classList'][_0x461f82(0x412)](_0x461f82(0x3e2));}),on($(_0x53fe83(0x1a9)),_0x53fe83(0x477),async()=>{const _0x3f52e8=_0x53fe83,_0x185ca7=getCurrentSubtopic();if(!_0x185ca7)return;const _0x55ebb3=pendingNoteSessionId,_0x478072=_0x185ca7[_0x3f52e8(0x327)][_0x3f52e8(0x2ad)](_0x1f3312=>_0x1f3312['id']===_0x55ebb3);_0x478072&&(_0x478072['note']=$(_0x3f52e8(0x2d7))['value'][_0x3f52e8(0x2eb)](),await saveData(),renderStatsHistory(),toast(_0x3f52e8(0x462))),closeNoteModal();}),on($('#btnSkipNote'),_0x53fe83(0x477),()=>closeNoteModal()),on($(_0x53fe83(0x3b1)),_0x53fe83(0x477),addGeneralNote),on($(_0x53fe83(0x2e0)),_0x53fe83(0x477),handleSummarizeNote),on($('#btnSendMessage'),'click',handleSendMessage),on($(_0x53fe83(0x347)),_0x53fe83(0x467),_0x4b8a53=>{const _0x541ae2=_0x53fe83;if(_0x4b8a53[_0x541ae2(0x358)]===_0x541ae2(0x39f))handleSendMessage();}),$$('#aiPromptSuggestions\x20button')[_0x53fe83(0x2b6)](_0x585387=>{on(_0x585387,'click',()=>{const _0x3692a3=_0x4e4c,_0x2d11f6=_0x585387['dataset'][_0x3692a3(0x42e)];$('#chatInput')[_0x3692a3(0x472)]=_0x2d11f6,$('#chatInput')[_0x3692a3(0x259)]();});}),on($(_0x53fe83(0x23d)),_0x53fe83(0x477),clearChat),on($(_0x53fe83(0x3d6)),_0x53fe83(0x477),addSubtopicTask),on($(_0x53fe83(0x454)),_0x53fe83(0x467),_0xcd2a34=>{const _0x99916b=_0x53fe83;if(_0xcd2a34[_0x99916b(0x358)]==='Enter')addSubtopicTask();}),on($(_0x53fe83(0x232)),_0x53fe83(0x477),toggleYtSound),on($('#btnEnableSound'),'click',()=>{ensureAudio(),unlockAudioChain();}),on($(_0x53fe83(0x1e9)),'input',_0x13530c=>{const _0x4d598a=_0x53fe83,_0x2b1775=parseInt(_0x13530c[_0x4d598a(0x449)][_0x4d598a(0x472)],0xa);ytPlayer&&ytPlayer[_0x4d598a(0x243)]&&ytPlayer[_0x4d598a(0x243)](_0x2b1775);}),on($(_0x53fe83(0x2fb)),'input',handleYoutubeUrlInput),$$(_0x53fe83(0x481))[_0x53fe83(0x2b6)](_0x5cde37=>{const _0x56f2d1=_0x53fe83;_0x5cde37[_0x56f2d1(0x3ea)]('click',()=>{const _0x545605=_0x56f2d1,_0x2a91f7=_0x5cde37[_0x545605(0x372)][_0x545605(0x38f)],_0x3f21f6=data?.['settings']?.[_0x545605(0x4bd)]||_0x545605(0x260);if(_0x3f21f6===_0x2a91f7&&_0x2a91f7!==_0x545605(0x260))switchView(_0x545605(0x260));else switchView(_0x2a91f7);});}),$$(_0x53fe83(0x269))[_0x53fe83(0x2b6)](_0x456498=>{const _0x282c08=_0x53fe83;_0x456498[_0x282c08(0x3ea)](_0x282c08(0x477),()=>{const _0x5e57ac=_0x282c08,_0x2273cd=_0x456498[_0x5e57ac(0x372)][_0x5e57ac(0x361)],_0x2f8154=_0x456498[_0x5e57ac(0x418)](_0x5e57ac(0x301));if(!_0x2f8154)return;_0x2f8154[_0x5e57ac(0x310)](_0x5e57ac(0x269))['forEach'](_0x101d5d=>_0x101d5d[_0x5e57ac(0x21e)][_0x5e57ac(0x348)](_0x5e57ac(0x1c0))),_0x456498[_0x5e57ac(0x21e)][_0x5e57ac(0x4b0)](_0x5e57ac(0x1c0)),_0x2f8154[_0x5e57ac(0x310)](_0x5e57ac(0x300))['forEach'](_0x4b8d9b=>{const _0x54df6d=_0x5e57ac;_0x4b8d9b[_0x54df6d(0x21e)][_0x54df6d(0x348)](_0x54df6d(0x1c0)),_0x4b8d9b[_0x54df6d(0x497)][_0x54df6d(0x203)]=_0x54df6d(0x1f7);});const _0x14d7bf=_0x2f8154['querySelector']('#'+_0x2273cd);_0x14d7bf&&(_0x14d7bf[_0x5e57ac(0x21e)][_0x5e57ac(0x4b0)](_0x5e57ac(0x1c0)),_0x14d7bf[_0x5e57ac(0x497)][_0x5e57ac(0x203)]=_0x5e57ac(0x2a2),_0x2f8154[_0x5e57ac(0x418)](_0x5e57ac(0x3a7))&&(_0x14d7bf[_0x5e57ac(0x497)][_0x5e57ac(0x203)]=_0x5e57ac(0x363)));});});const _0x56d0bd=$('#methodEditorContentInput');function _0xd2b833(_0x26bb61,_0x376473=null){const _0x4cdd5f=_0x53fe83;try{document[_0x4cdd5f(0x48f)](_0x4cdd5f(0x206),![],!![]);}catch(_0x46863f){}try{document[_0x4cdd5f(0x48f)](_0x26bb61,![],_0x376473);}catch(_0x53bb41){}if(_0x56d0bd)_0x56d0bd[_0x4cdd5f(0x259)]();}on($('#toolBold'),'click',()=>_0xd2b833(_0x53fe83(0x24c))),on($(_0x53fe83(0x366)),_0x53fe83(0x477),()=>_0xd2b833(_0x53fe83(0x4be))),on($('#toolH4'),_0x53fe83(0x477),()=>_0xd2b833(_0x53fe83(0x455),_0x53fe83(0x246))),on($(_0x53fe83(0x492)),_0x53fe83(0x477),()=>_0xd2b833('insertOrderedList')),on($(_0x53fe83(0x351)),_0x53fe83(0x477),()=>_0xd2b833(_0x53fe83(0x3a1)));const _0x2b6e9d=$(_0x53fe83(0x391)),_0x2c5bb1=$(_0x53fe83(0x242));on($(_0x53fe83(0x3ac)),'click',_0x29c528=>{const _0x48d44b=_0x53fe83;if(!_0x2c5bb1)return;_0x29c528['stopPropagation'](),_0x2c5bb1[_0x48d44b(0x21e)]['toggle'](_0x48d44b(0x3e2));}),$$('.color-swatch')['forEach'](_0x526bb0=>{on(_0x526bb0,'click',_0x13aa7f=>{const _0x30b169=_0x4e4c;_0x13aa7f[_0x30b169(0x48b)]();const _0x4f0e6b=_0x526bb0[_0x30b169(0x372)][_0x30b169(0x1bb)]||'';let _0x15c23c=_0x4f0e6b;try{const _0xca8b50=_0x4f0e6b[_0x30b169(0x46b)](/--[a-zA-Z0-9_-]+/);if(_0xca8b50)_0x15c23c=getComputedStyle(document['body'])[_0x30b169(0x489)](_0xca8b50[0x0])[_0x30b169(0x2eb)]();}catch(_0x2f414f){}_0xd2b833(_0x30b169(0x2cd),_0x15c23c);if(_0x2c5bb1)_0x2c5bb1[_0x30b169(0x21e)]['add'](_0x30b169(0x3e2));});}),on(document,'click',_0x53cbfe=>{const _0x32a9ac=_0x53fe83;if(!_0x2b6e9d||!_0x2c5bb1)return;!_0x2b6e9d[_0x32a9ac(0x214)](_0x53cbfe[_0x32a9ac(0x449)])&&!_0x2c5bb1['classList'][_0x32a9ac(0x214)](_0x32a9ac(0x3e2))&&_0x2c5bb1[_0x32a9ac(0x21e)]['add'](_0x32a9ac(0x3e2));});function _0x1b9b2a(_0x81b613){const _0x4f2606=_0x53fe83,_0x1ccc92=getCurrentSubtopic();if(!_0x1ccc92){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x3e2467=Array['isArray'](_0x1ccc92[_0x4f2606(0x297)])?_0x1ccc92[_0x4f2606(0x297)]:[],_0x9fee12=_0x81b613?_0x3e2467['find'](_0x441ac9=>_0x441ac9['id']===_0x81b613):null;$('#methodEditorId')['value']=_0x9fee12&&_0x9fee12['id']||'',$('#methodEditorTitle')[_0x4f2606(0x1ab)]=_0x9fee12?_0x4f2606(0x1b7):'Add\x20New\x20Knowledge',$(_0x4f2606(0x46c))[_0x4f2606(0x472)]=_0x9fee12&&_0x9fee12['title']||'';const _0x1d1e95=$(_0x4f2606(0x461));if(_0x1d1e95)_0x1d1e95[_0x4f2606(0x273)]=_0x9fee12&&_0x9fee12[_0x4f2606(0x238)]||'';$('#modalMethodEditor')[_0x4f2606(0x21e)][_0x4f2606(0x4b0)](_0x4f2606(0x264));try{trapFocus($(_0x4f2606(0x3a9)));}catch(_0x41bd90){}try{const _0x482a15=$('#btnAutoFormat');if(_0x482a15){const _0x5c79=!!(data?.[_0x4f2606(0x274)]?.[_0x4f2606(0x4ab)]&&data[_0x4f2606(0x274)]['apiKey'][_0x4f2606(0x2eb)]());_0x482a15['disabled']=!_0x5c79,_0x482a15['title']=_0x5c79?'Use\x20AI\x20to\x20auto-format\x20text':_0x4f2606(0x2a3);}}catch(_0x3beb50){}}on($('#btnCancelMethodEditor'),_0x53fe83(0x477),()=>{const _0x26bdfb=_0x53fe83;$(_0x26bdfb(0x3a9))[_0x26bdfb(0x21e)][_0x26bdfb(0x348)](_0x26bdfb(0x264));try{releaseFocus();}catch(_0x20fb89){}}),on($(_0x53fe83(0x31a)),_0x53fe83(0x477),async()=>{const _0x484246=_0x53fe83,_0x2fb26a=$(_0x484246(0x29a))[_0x484246(0x472)]||uid('m'),_0x3ec92a=($(_0x484246(0x46c))[_0x484246(0x472)]||'')[_0x484246(0x2eb)](),_0x21a196=$(_0x484246(0x461)),_0x21af3d=_0x21a196?_0x21a196[_0x484246(0x273)]||'':'',_0x5f0cf1=getCurrentSubtopic();if(!_0x5f0cf1){toast(_0x484246(0x2a7));return;}if(!Array[_0x484246(0x425)](_0x5f0cf1[_0x484246(0x297)]))_0x5f0cf1[_0x484246(0x297)]=[];const _0x2aaa06=_0x5f0cf1[_0x484246(0x297)][_0x484246(0x400)](_0x3b887b=>_0x3b887b['id']===_0x2fb26a),_0x1daf7b={'id':_0x2fb26a,'title':_0x3ec92a,'content':_0x21af3d};if(_0x2aaa06>=0x0)_0x5f0cf1[_0x484246(0x297)][_0x2aaa06]=_0x1daf7b;else _0x5f0cf1['methods'][_0x484246(0x3e7)](_0x1daf7b);await saveData(),renderMethods(),$(_0x484246(0x3a9))[_0x484246(0x21e)][_0x484246(0x348)](_0x484246(0x264));try{releaseFocus();}catch(_0x56fa99){}}),on($(_0x53fe83(0x29c)),_0x53fe83(0x477),async()=>{const _0x3295c6=_0x53fe83,_0x5ba5c4=$(_0x3295c6(0x461));if(!_0x5ba5c4)return;const _0x164f52=(_0x5ba5c4['textContent']||'')[_0x3295c6(0x2eb)]();if(!_0x164f52||_0x164f52[_0x3295c6(0x465)]<0x14){toast(_0x3295c6(0x2b5));return;}const _0x32e3ac=$(_0x3295c6(0x29c));_0x32e3ac&&(_0x32e3ac[_0x3295c6(0x35b)]=!![],_0x32e3ac[_0x3295c6(0x273)]=_0x3295c6(0x33c));const _0x3cdb0b='Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22'+_0x164f52+'\x22',_0x4a39ae=await callGeminiAPI(_0x3cdb0b);_0x4a39ae?(_0x5ba5c4[_0x3295c6(0x273)]=_0x4a39ae,toast(_0x3295c6(0x450))):toast(_0x3295c6(0x2f7)),_0x32e3ac&&(_0x32e3ac[_0x3295c6(0x35b)]=![],_0x32e3ac[_0x3295c6(0x273)]='✨\x20Auto-format');}),on($(_0x53fe83(0x456)),_0x53fe83(0x477),()=>_0x1b9b2a());const _0x206674=document[_0x53fe83(0x23f)](_0x53fe83(0x230));_0x206674&&_0x206674[_0x53fe83(0x3ea)](_0x53fe83(0x477),_0x479365=>{const _0x5c96a6=_0x53fe83,_0x3ac3b9=_0x479365[_0x5c96a6(0x449)][_0x5c96a6(0x418)]&&_0x479365['target']['closest']('.method-edit'),_0xc19603=!_0x3ac3b9&&_0x479365['target'][_0x5c96a6(0x418)]&&_0x479365['target'][_0x5c96a6(0x418)](_0x5c96a6(0x483));if(_0x3ac3b9){_0x479365[_0x5c96a6(0x48b)](),_0x479365[_0x5c96a6(0x1bf)]();const _0x138d8e=_0x3ac3b9[_0x5c96a6(0x372)]['id'];if(_0x138d8e)_0x1b9b2a(_0x138d8e);return;}if(_0xc19603){_0x479365[_0x5c96a6(0x48b)](),_0x479365[_0x5c96a6(0x1bf)]();const _0x2a84a6=_0xc19603[_0x5c96a6(0x372)]['id'];if(!_0x2a84a6)return;const _0xabcc93=getCurrentSubtopic();if(!_0xabcc93){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x5368d3=Array[_0x5c96a6(0x425)](_0xabcc93[_0x5c96a6(0x297)])?_0xabcc93['methods']:[],_0x32d5f4=_0x5368d3[_0x5c96a6(0x2ad)](_0x3d4d48=>_0x3d4d48['id']===_0x2a84a6);if(!_0x32d5f4)return;showConfirmModal(_0x5c96a6(0x3ab),_0x5c96a6(0x1ea)+(_0x32d5f4[_0x5c96a6(0x3fa)]||'')+'\x22?',async _0x3eed70=>{const _0x30eb6a=_0x5c96a6;if(!_0x3eed70)return;_0xabcc93[_0x30eb6a(0x297)]=_0x5368d3[_0x30eb6a(0x1fb)](_0x1af1e5=>_0x1af1e5['id']!==_0x2a84a6),await saveData(),renderMethods();});}});$$(_0x53fe83(0x474))['forEach'](_0x588b05=>{const _0x31a026=_0x53fe83;_0x588b05[_0x31a026(0x3ea)](_0x31a026(0x477),()=>{const _0xbfbb20=_0x31a026;editingPreset=_0x588b05[_0xbfbb20(0x372)][_0xbfbb20(0x311)],highlightPresetSelector(),loadEditingPresetFields();});}),$$(_0x53fe83(0x330))['forEach'](_0x57b7a4=>{const _0x42f5bf=_0x53fe83;_0x57b7a4['addEventListener'](_0x42f5bf(0x477),_0x6acf4b=>{const _0x2c1960=_0x42f5bf,_0x18fade=_0x6acf4b[_0x2c1960(0x449)][_0x2c1960(0x372)][_0x2c1960(0x247)],_0x5c1cb7=data[_0x2c1960(0x274)]['preset'];if(_0x18fade===_0x5c1cb7)return;timer['state']!==_0x2c1960(0x2c4)?showConfirmModal(_0x2c1960(0x2d9),_0x2c1960(0x1f4)+_0x18fade+'?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.',_0x1174ea=>{const _0x395728=_0x2c1960;_0x1174ea&&(timer[_0x395728(0x46d)](),timer['setPreset'](_0x18fade),renderAll(),toast('Switched\x20to\x20Style\x20'+_0x18fade+'.'));}):(timer[_0x2c1960(0x253)](_0x18fade),renderAll(),toast(_0x2c1960(0x291)+_0x18fade+'.'));});}),on($(_0x53fe83(0x2d8)),_0x53fe83(0x477),()=>timer[_0x53fe83(0x258)]()),on($(_0x53fe83(0x3dd)),'click',()=>timer[_0x53fe83(0x2b9)]()),on($(_0x53fe83(0x398)),_0x53fe83(0x477),()=>timer[_0x53fe83(0x389)]()),on($(_0x53fe83(0x4bc)),'click',()=>timer[_0x53fe83(0x487)]()),on($(_0x53fe83(0x22e)),_0x53fe83(0x477),()=>timer['skip']()),on($(_0x53fe83(0x4a1)),_0x53fe83(0x477),()=>timer[_0x53fe83(0x46d)]()),on($('#btnBreakEarly'),_0x53fe83(0x477),()=>timer[_0x53fe83(0x340)]()),on($(_0x53fe83(0x4b8)),_0x53fe83(0x3b3),_0x384701=>{const _0x2e30e0=_0x53fe83;handleFileUpload(_0x384701[_0x2e30e0(0x449)][_0x2e30e0(0x236)][0x0],async _0x4cad7d=>{const _0x355abb=_0x2e30e0;data[_0x355abb(0x274)][_0x355abb(0x26a)]=_0x4cad7d,await saveData(),applyCustomBg(),toast('Background\x20updated.');}),_0x384701[_0x2e30e0(0x449)][_0x2e30e0(0x472)]=null;}),on($(_0x53fe83(0x1fe)),'click',async()=>{const _0x2c7646=_0x53fe83;data[_0x2c7646(0x274)]['customBg']='',data[_0x2c7646(0x274)][_0x2c7646(0x42c)]=![],await saveData(),applyCustomBg(),toast(_0x2c7646(0x2ee)),$('#modalSettings')[_0x2c7646(0x21e)]['contains'](_0x2c7646(0x264))&&openSettings();}),on($('#uploadSoundWork'),_0x53fe83(0x3b3),_0x396a1e=>{const _0x4b523d=_0x53fe83;handleFileUpload(_0x396a1e[_0x4b523d(0x449)][_0x4b523d(0x236)][0x0],async _0x477f85=>{const _0x204002=_0x4b523d;data[_0x204002(0x274)]['customSounds'][_0x204002(0x428)]=_0x477f85,await saveData(),toast(_0x204002(0x1aa));}),_0x396a1e['target'][_0x4b523d(0x472)]=null;}),on($(_0x53fe83(0x442)),_0x53fe83(0x3b3),_0x8e8e72=>{const _0x242fe2=_0x53fe83;handleFileUpload(_0x8e8e72[_0x242fe2(0x449)][_0x242fe2(0x236)][0x0],async _0x50e1cf=>{const _0x1cf403=_0x242fe2;data[_0x1cf403(0x274)][_0x1cf403(0x2f3)][_0x1cf403(0x1eb)]=_0x50e1cf,await saveData(),toast(_0x1cf403(0x446));}),_0x8e8e72[_0x242fe2(0x449)]['value']=null;}),on($(_0x53fe83(0x308)),'change',_0x457902=>{const _0x20b14f=_0x53fe83;handleFileUpload(_0x457902[_0x20b14f(0x449)][_0x20b14f(0x236)][0x0],async _0x5cbfa9=>{const _0x1eee7a=_0x20b14f;data[_0x1eee7a(0x274)][_0x1eee7a(0x2f3)][_0x1eee7a(0x229)]=_0x5cbfa9,await saveData(),toast('Saved\x20alert\x20for\x20LONG\x20BREAK.');}),_0x457902[_0x20b14f(0x449)][_0x20b14f(0x472)]=null;}),on($(_0x53fe83(0x34c)),_0x53fe83(0x477),toggleFullScreen),document[_0x53fe83(0x3ea)](_0x53fe83(0x40c),updateFullscreenButton),window[_0x53fe83(0x3ea)](_0x53fe83(0x467),_0x285c4e=>{const _0x1bb0f1=_0x53fe83,_0x3321df=_0x285c4e['target'],_0x183f72=(_0x3321df[_0x1bb0f1(0x458)]||'')[_0x1bb0f1(0x4bf)](),_0xa57af5=[_0x1bb0f1(0x25c),_0x1bb0f1(0x3f4),'select'][_0x1bb0f1(0x29e)](_0x183f72)||_0x3321df[_0x1bb0f1(0x43c)];if(_0x285c4e[_0x1bb0f1(0x3a6)]===_0x1bb0f1(0x1fc)&&!_0xa57af5){_0x285c4e['preventDefault']();if(timer['state']===_0x1bb0f1(0x2c4)||timer[_0x1bb0f1(0x470)]===_0x1bb0f1(0x45e))timer['start']();else timer[_0x1bb0f1(0x389)]();}(_0x285c4e[_0x1bb0f1(0x358)]==='n'||_0x285c4e[_0x1bb0f1(0x358)]==='N')&&(!_0xa57af5&&(_0x285c4e[_0x1bb0f1(0x48b)](),timer[_0x1bb0f1(0x36b)]()));if(_0x285c4e[_0x1bb0f1(0x358)]===_0x1bb0f1(0x3da)){$$(_0x1bb0f1(0x460))['forEach'](_0x487ba6=>_0x487ba6[_0x1bb0f1(0x21e)][_0x1bb0f1(0x348)](_0x1bb0f1(0x264)));try{releaseFocus();}catch(_0x568154){}}if(_0x285c4e[_0x1bb0f1(0x2f2)]&&!_0xa57af5){if(_0x285c4e[_0x1bb0f1(0x358)]===_0x1bb0f1(0x222))_0x285c4e[_0x1bb0f1(0x48b)](),_0x4b3503(0x0,-0xa);else{if(_0x285c4e[_0x1bb0f1(0x358)]==='ArrowDown')_0x285c4e['preventDefault'](),_0x4b3503(0x0,0xa);else{if(_0x285c4e[_0x1bb0f1(0x358)]===_0x1bb0f1(0x4c0))_0x285c4e[_0x1bb0f1(0x48b)](),_0x4b3503(-0xa,0x0);else _0x285c4e[_0x1bb0f1(0x358)]===_0x1bb0f1(0x1b0)&&(_0x285c4e[_0x1bb0f1(0x48b)](),_0x4b3503(0xa,0x0));}}}}),$$(_0x53fe83(0x460))['forEach'](_0x21c7aa=>_0x21c7aa[_0x53fe83(0x3ea)](_0x53fe83(0x477),_0x3b039e=>{const _0x560813=_0x53fe83;if(_0x3b039e&&_0x3b039e['target']&&_0x3b039e['target']['id']===_0x560813(0x2d6))return;if(_0x3b039e['target']===_0x21c7aa){_0x21c7aa[_0x560813(0x21e)][_0x560813(0x348)](_0x560813(0x264));try{releaseFocus();}catch(_0x5eb79e){}}})),window[_0x53fe83(0x3ea)](_0x53fe83(0x477),_0xd84411=>{const _0x2122d4=_0x53fe83;!_0xd84411[_0x2122d4(0x449)][_0x2122d4(0x418)]('.actions-menu-btn')&&!_0xd84411[_0x2122d4(0x449)][_0x2122d4(0x418)](_0x2122d4(0x415))&&closeAllMenus();});try{const _0x12bd0b=document['querySelector'](_0x53fe83(0x4ba));if(_0x12bd0b)_0x12bd0b[_0x53fe83(0x3ea)]('scroll',closeAllMenus);}catch(_0xd6baf0){}try{window[_0x53fe83(0x3ea)]('scroll',closeAllMenus,!![]);}catch(_0x5dd117){}window['addEventListener']('beforeunload',()=>timer[_0x53fe83(0x1fa)](!![]));try{const _0x64b4dc=Array[_0x53fe83(0x2f5)](document[_0x53fe83(0x310)](_0x53fe83(0x3e6)));_0x64b4dc[_0x53fe83(0x465)]&&_0x64b4dc[_0x53fe83(0x2b6)](_0x492323=>{_0x492323['addEventListener']('toggle',()=>{const _0x5f2074=_0x4e4c;_0x492323[_0x5f2074(0x209)]&&_0x64b4dc[_0x5f2074(0x2b6)](_0x30816d=>{const _0x39ff0f=_0x5f2074;if(_0x30816d!==_0x492323)_0x30816d[_0x39ff0f(0x209)]=![];});});});}catch(_0x5a65c9){}const _0x104139=$(_0x53fe83(0x287));let _0x359ed4=![],_0x97aa63,_0x53a343;_0x104139&&(_0x104139[_0x53fe83(0x3ea)](_0x53fe83(0x43a),_0x4492b1=>{const _0x562065=_0x53fe83;_0x359ed4=!![];const _0x1cf511=_0x104139['getBoundingClientRect']();_0x97aa63=_0x4492b1['clientX']-_0x1cf511[_0x562065(0x1f6)],_0x53a343=_0x4492b1['clientY']-_0x1cf511[_0x562065(0x208)],_0x104139[_0x562065(0x497)]['transition']=_0x562065(0x1f7);}),document['addEventListener'](_0x53fe83(0x2cc),_0xedb226=>{const _0x23c452=_0x53fe83;if(!_0x359ed4)return;let _0x3bee36=_0xedb226['clientX']-_0x97aa63,_0x8d833=_0xedb226[_0x23c452(0x42a)]-_0x53a343;const _0xf4ca66=window[_0x23c452(0x384)]-_0x104139[_0x23c452(0x4c3)],_0x3c3660=window[_0x23c452(0x323)]-_0x104139[_0x23c452(0x3c9)];_0x3bee36=Math[_0x23c452(0x3ba)](0x0,Math['min'](_0x3bee36,_0xf4ca66)),_0x8d833=Math[_0x23c452(0x3ba)](0x0,Math['min'](_0x8d833,_0x3c3660)),_0x104139[_0x23c452(0x497)]['left']=_0x3bee36+'px',_0x104139[_0x23c452(0x497)][_0x23c452(0x208)]=_0x8d833+'px',_0x104139[_0x23c452(0x497)][_0x23c452(0x2e7)]=_0x23c452(0x305),_0x104139[_0x23c452(0x497)][_0x23c452(0x367)]=_0x23c452(0x305);}),document[_0x53fe83(0x3ea)]('mouseup',()=>{const _0x39e80a=_0x53fe83;if(!_0x359ed4)return;_0x359ed4=![],_0x104139[_0x39e80a(0x497)][_0x39e80a(0x3c1)]='';}));function _0x48c0cb(_0x94e26b){const _0x1829c3=_0x53fe83,_0xe6c0df=$(_0x1829c3(0x287));if(!_0xe6c0df)return;_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x2c2)]='fixed',_0xe6c0df[_0x1829c3(0x497)]['transition']='',_0xe6c0df[_0x1829c3(0x497)]['left']=_0x1829c3(0x305),_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x208)]=_0x1829c3(0x305),_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x367)]='auto',_0xe6c0df['style'][_0x1829c3(0x2e7)]=_0x1829c3(0x305);const _0x4abc51=0x10;_0x94e26b==='tl'&&(_0xe6c0df[_0x1829c3(0x497)]['left']=_0x4abc51+'px',_0xe6c0df['style'][_0x1829c3(0x208)]=_0x4abc51+'px'),_0x94e26b==='tr'&&(_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x367)]=_0x4abc51+'px',_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x208)]=_0x4abc51+'px'),_0x94e26b==='bl'&&(_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x1f6)]=_0x4abc51+'px',_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x2e7)]=_0x4abc51+'px'),_0x94e26b==='br'&&(_0xe6c0df[_0x1829c3(0x497)][_0x1829c3(0x367)]=_0x4abc51+'px',_0xe6c0df['style'][_0x1829c3(0x2e7)]=_0x4abc51+'px');}function _0x4b3503(_0x24c429,_0x2efe50){const _0x1944a5=_0x53fe83,_0x8b5cfc=$(_0x1944a5(0x287));if(!_0x8b5cfc)return;const _0x336bc7=_0x8b5cfc[_0x1944a5(0x307)](),_0x1c80d9=Math[_0x1944a5(0x3ba)](0x0,Math[_0x1944a5(0x443)](_0x336bc7['left']+_0x24c429,window['innerWidth']-_0x8b5cfc['offsetWidth'])),_0x54f32f=Math['max'](0x0,Math[_0x1944a5(0x443)](_0x336bc7[_0x1944a5(0x208)]+_0x2efe50,window[_0x1944a5(0x323)]-_0x8b5cfc[_0x1944a5(0x3c9)]));_0x8b5cfc['style']['left']=_0x1c80d9+'px',_0x8b5cfc[_0x1944a5(0x497)][_0x1944a5(0x208)]=_0x54f32f+'px',_0x8b5cfc[_0x1944a5(0x497)][_0x1944a5(0x367)]=_0x1944a5(0x305),_0x8b5cfc['style']['bottom']=_0x1944a5(0x305);}}function toggleBackgroundView(){const _0x462dc1=_0x272902,_0xbf6b8d=document['body'];_0xbf6b8d[_0x462dc1(0x21e)][_0x462dc1(0x412)]('bg-view-mode');const _0x3bb25c=_0xbf6b8d[_0x462dc1(0x21e)][_0x462dc1(0x214)](_0x462dc1(0x2b7)),_0x107f93=$(_0x462dc1(0x28c));if(!_0x107f93)return;_0x3bb25c?(_0x107f93[_0x462dc1(0x3fa)]='Show\x20interface',_0x107f93[_0x462dc1(0x273)]='<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>'):(_0x107f93[_0x462dc1(0x3fa)]=_0x462dc1(0x26e),_0x107f93[_0x462dc1(0x273)]=_0x462dc1(0x2af));}function updateMainViewVisibility(){const _0x2aa1ec=_0x272902,_0x6b5530=!!getCurrentSubtopic(),_0x44e8d6=$(_0x2aa1ec(0x24f)),_0x2ba194=$(_0x2aa1ec(0x4c1));_0x2ba194&&_0x2ba194[_0x2aa1ec(0x21e)][_0x2aa1ec(0x412)]('hidden',_0x6b5530),_0x44e8d6&&(_0x6b5530?_0x44e8d6[_0x2aa1ec(0x21e)][_0x2aa1ec(0x348)](_0x2aa1ec(0x381)):_0x44e8d6[_0x2aa1ec(0x21e)][_0x2aa1ec(0x4b0)](_0x2aa1ec(0x381)));}function updatePresetButtonsText(){const _0x427b1d=_0x272902,_0x3bacbf=data[_0x427b1d(0x274)],_0x4c8997=_0x3bacbf[_0x427b1d(0x37c)],_0x16a74d=_0x3bacbf[_0x427b1d(0x2b1)],_0x2cab2d=_0x3bacbf[_0x427b1d(0x43d)]['A_work'],_0x4f2287=_0x3bacbf[_0x427b1d(0x43d)][_0x427b1d(0x46f)],_0xf00242=$(_0x427b1d(0x41e)),_0x20c13d=$(_0x427b1d(0x227)),_0x2dcf44=$(_0x427b1d(0x4a0));_0xf00242&&(_0xf00242[_0x427b1d(0x1ab)]=_0x4c8997+'×'+_0x2cab2d+_0x427b1d(0x2d4)),_0x20c13d&&(_0x20c13d[_0x427b1d(0x1ab)]=_0x16a74d+'×'+_0x4f2287+'\x20(B)'),_0x2dcf44&&(_0x2dcf44[_0x427b1d(0x1ab)]='🌊\x20Flow');}function renderAll(){const _0x56f348=_0x272902;updatePresetButtonsText();const _0x5a7ef3=data[_0x56f348(0x274)][_0x56f348(0x247)];$$('.presets\x20button')[_0x56f348(0x2b6)](_0x9bcdc7=>{const _0x3cec56=_0x56f348,_0x5b9b4f=_0x9bcdc7[_0x3cec56(0x372)]['preset']===_0x5a7ef3;_0x9bcdc7['classList'][_0x3cec56(0x412)](_0x3cec56(0x1e5),_0x5b9b4f),_0x9bcdc7[_0x3cec56(0x21e)][_0x3cec56(0x412)]('ghost',!_0x5b9b4f),_0x9bcdc7['setAttribute'](_0x3cec56(0x35d),_0x5b9b4f);}),updateMainViewVisibility(),timer[_0x56f348(0x253)](data[_0x56f348(0x274)]['preset'],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data['settings'][_0x56f348(0x4bd)]);}function toggleFullScreen(){const _0x5a53bf=_0x272902;!document[_0x5a53bf(0x296)]?document[_0x5a53bf(0x2ac)][_0x5a53bf(0x334)]()[_0x5a53bf(0x42d)](_0x2d1f33=>{const _0x469c51=_0x5a53bf;toast('Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20'+_0x2d1f33[_0x469c51(0x1d9)]);}):document[_0x5a53bf(0x251)]&&document['exitFullscreen']();}function updateFullscreenButton(){const _0x364466=_0x272902,_0x1ce14a=$(_0x364466(0x34c));document[_0x364466(0x296)]?(_0x1ce14a['innerHTML']='↙',_0x1ce14a[_0x364466(0x3fa)]='Exit\x20fullscreen'):(_0x1ce14a[_0x364466(0x273)]='↗',_0x1ce14a['title']='Fullscreen');}async function initializeApp(){const _0x5bf460=_0x272902;try{await storageManager['initDB']();const [_0x138281,_0x1ccdde,_0xef21d8]=await Promise[_0x5bf460(0x2be)]([storageManager[_0x5bf460(0x2f6)](),storageManager[_0x5bf460(0x430)](_0x5bf460(0x2b0)),storageManager[_0x5bf460(0x430)](_0x5bf460(0x292))]);let _0x5ac575;if(!_0x138281){const _0x1c63b2=JSON[_0x5bf460(0x218)](JSON[_0x5bf460(0x333)](defaults));await storageManager[_0x5bf460(0x468)](_0x1c63b2[_0x5bf460(0x274)]);for(const _0x266ca7 of _0x1c63b2['topics']){const {subtopics:_0x17b9b6,..._0x53ef4b}=_0x266ca7;await storageManager[_0x5bf460(0x4b0)](_0x5bf460(0x2b0),_0x53ef4b);for(const _0x4f8acc of _0x17b9b6){await storageManager[_0x5bf460(0x4b0)]('subtopics',{..._0x4f8acc,'topicId':_0x266ca7['id']});}}_0x5ac575=_0x1c63b2;}else{const _0x179114={};for(const _0x210cbd of _0x1ccdde)_0x179114[_0x210cbd['id']]={..._0x210cbd,'subtopics':[]};for(const _0x2ec377 of _0xef21d8)_0x179114[_0x2ec377[_0x5bf460(0x1b4)]]?.[_0x5bf460(0x292)][_0x5bf460(0x34a)](_0x2ec377);_0x5ac575={'version':defaults[_0x5bf460(0x3ef)],'settings':_0x138281,'topics':Object[_0x5bf460(0x37b)](_0x179114)};}data=window['data']=_0x5ac575,normalizeDataStructure(data),await ensureValidSelection(),await migrateSharedMethodsToCurrentSubtopic(),await seedAchievedMilestones(),renderAll();try{storageManager[_0x5bf460(0x38e)](data);}catch(_0x2bdcc3){console[_0x5bf460(0x1ee)]('AutoBackup\x20error:',_0x2bdcc3);}bindEvents(),applyTheme();}catch(_0x5f21f5){console[_0x5bf460(0x1bc)](_0x5bf460(0x2fe),_0x5f21f5),toast(_0x5bf460(0x29b)+_0x5f21f5[_0x5bf460(0x1d9)]);}}function _0x4e4c(_0x4a1a8d,_0x47ca97){const _0x198c2d=_0x198c();return _0x4e4c=function(_0x4e4c47,_0x1b23fe){_0x4e4c47=_0x4e4c47-0x1a6;let _0x1274e1=_0x198c2d[_0x4e4c47];return _0x1274e1;},_0x4e4c(_0x4a1a8d,_0x47ca97);}callGeminiAPI=async function(_0x3a7b1f,_0xce00fd=0x3,_0x14a025=0x3e8){const _0x2f5560=_0x272902,_0x5abe12=data?.['settings']?.['apiKey']||'';if(!_0x5abe12)return toast(_0x2f5560(0x3f1)),null;const _0x4c8d4d=_0x2f5560(0x221)+_0x5abe12,_0x2cf2ab={'contents':[{'role':'user','parts':[{'text':_0x3a7b1f}]}]};try{const _0x15e8d1=await fetch(_0x4c8d4d,{'method':_0x2f5560(0x268),'headers':{'Content-Type':_0x2f5560(0x3cd)},'body':JSON['stringify'](_0x2cf2ab)});if(!_0x15e8d1['ok']){if(_0x15e8d1[_0x2f5560(0x1dc)]===0x1ad&&_0xce00fd>0x0)return await new Promise(_0x2ce322=>setTimeout(_0x2ce322,_0x14a025)),callGeminiAPI(_0x3a7b1f,_0xce00fd-0x1,_0x14a025*0x2);let _0x2f96e2=null;try{_0x2f96e2=await _0x15e8d1['json']();}catch(_0x4a9852){}let _0x13dc79=_0x2f5560(0x28f)+_0x15e8d1[_0x2f5560(0x1dc)];if(_0x15e8d1[_0x2f5560(0x1dc)]===0x190)_0x13dc79=_0x2f5560(0x1c5);else{if(_0x15e8d1[_0x2f5560(0x1dc)]===0x1ad)_0x13dc79=_0x2f5560(0x267);else _0x2f96e2?.[_0x2f5560(0x1bc)]?.[_0x2f5560(0x1d9)]&&(_0x13dc79=_0x2f5560(0x44f)+_0x2f96e2[_0x2f5560(0x1bc)][_0x2f5560(0x1d9)]);}return toast(_0x13dc79,0xfa0),console[_0x2f5560(0x1bc)](_0x2f5560(0x25e),_0x2f96e2||_0x15e8d1['statusText']),null;}const _0x2a00a6=await _0x15e8d1[_0x2f5560(0x30d)]();if(_0x2a00a6[_0x2f5560(0x46e)]&&_0x2a00a6[_0x2f5560(0x46e)][0x0]?.[_0x2f5560(0x238)]?.[_0x2f5560(0x1d4)]?.[0x0]?.[_0x2f5560(0x2c5)])return formatGeminiResponse(_0x2a00a6[_0x2f5560(0x46e)][0x0][_0x2f5560(0x238)][_0x2f5560(0x1d4)][0x0][_0x2f5560(0x2c5)]);else{console['error'](_0x2f5560(0x3c2),_0x2a00a6);if(_0x2a00a6[_0x2f5560(0x490)]?.[_0x2f5560(0x362)])return _0x2f5560(0x1c2)+_0x2a00a6[_0x2f5560(0x490)][_0x2f5560(0x362)]+_0x2f5560(0x463);return _0x2f5560(0x499);}}catch(_0x3cf775){return console[_0x2f5560(0x1bc)]('Error\x20calling\x20Gemini\x20API:',_0x3cf775),toast(_0x2f5560(0x321),0xfa0),null;}},loadLanguage(localStorage[_0x272902(0x329)](_0x272902(0x417))||'en')[_0x272902(0x3d1)](initializeApp);
    </script>
</body>
</html>
