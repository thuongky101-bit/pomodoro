<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="A Pomodoro application for studying, featuring Gemini AI integration and a modern interface." />
    <title>Pomodoro Study App — Gemini AI Integration (New UI)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — FOCUSED UI VERSION (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Default) - Updated from file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Add RGB variable for panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: ADD NEW THEMES === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: ADD NEW THEMES === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Add border rules for light/pastel themes */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Modified: remove default border */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: UPDATE TOPIC MANAGEMENT UI === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Modified */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Raise the open menu block above others */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: UPDATE TOPIC MANAGEMENT UI === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Modified */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Keep background transparent on hover */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Color tweak */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Color tweak */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: SOFTER DIVIDER CUSTOMIZATION === */
    #view-timer .panel-bg hr {
        border: none; /* Remove default border */
        height: 1px;  /* Set divider height */
        background-color: var(--muted); /* Use theme's secondary color */
        opacity: 0.3; /* Make it subtle to blend with background */
        margin-top: 0; /* Adjust spacing */
    }
    /* === END: SOFTER DIVIDER CUSTOMIZATION === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Modified */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Modified */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Modified */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Raise z-index to sit above header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Modified */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Modified */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Modified */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Modified */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Modified */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Modified: switched to translucent white background */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Faint white border */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Fine-tune: closer to spec */
        border-color: var(--acc);
    }
    /* === START: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Use translucent black instead of white on light theme */
        border-color: rgba(0, 0, 0, 0.1); /* Faint black border on light themes */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Increase density on focus */
    }
    /* === END: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */

    /* Improve option background and text color per current theme */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Tweak */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Reduce/remove text shadow on light themes to avoid blur/glare */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Timer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Timer</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Topics">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Topics</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Stats">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Stats</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Knowledge Base">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Knowledge Base</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Settings">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Settings</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Guide</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">No Subtopic Selected</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard">📊 Dashboard </button>
          <a href="https://forms.gle/61hYjvwAkR328EaC9" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Send your feedback">💬 Feedback</a>
          <button class="btn ghost small" id="btnExport" title="Export JSON">⬇️ Export File</button>
          <label class="btn ghost small" for="importFile" title="Import JSON">⬆️ Import File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Show/Hide Interface">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Fullscreen">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Welcome to the Pomodoro Study App!</h3>
                <p>Get started by selecting a <strong>Subtopic</strong> or creating a new Topic/Subtopic.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Create New Topic</button>
            </div>
            <div class="presets" role="group" aria-label="Choose preset mode">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">STATUS</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Wind-down Checklist</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Save your current work (Save/Commit).</li>
                <li>Jot down the "Next step".</li>
                <li>Tidy up your workspace.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Start (Space)">▶️ Start</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="End focus session">🧘 Start Break</button>
              <button class="btn" id="btnPause" aria-label="Pause (Space)">⏸️ Pause</button>
              <button class="btn" id="btnResume" aria-label="Resume (Space)">⏵ Resume</button>
              <button class="btn warn" id="btnSkip" aria-label="Skip (N)">⏭️ Skip</button>
              <button class="btn danger" id="btnReset">↺ Reset</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Break Early</button>
            </div>
            <div class="tiny">Shortcuts: <strong>Space</strong> = Start/Pause/Resume, <strong>N</strong> = Next/Skip</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Tasks</button>
                <button class="tab-btn" data-tab="notes">Notes</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-dos for this subtopic:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Add a new task..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Add</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Add a new note..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Add Note</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini for: <span id="currentSubtopicNameChat">(none selected)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Clear History">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Explain the key concepts of this topic">Explain Concept</button>
                  <button class="btn small ghost" data-prompt="Create a detailed outline for this topic">Create Outline</button>
                  <button class="btn small ghost" data-prompt="List 5 important review questions for this topic">Create Review Questions</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Ask Gemini something..." />
                  <button id="btnSendMessage" class="btn acc">Send</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Topic Management</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Add Topic</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Click the arrow to expand/collapse the subtopic list.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Statistics & History — <span id="currentSubtopicName">(none selected)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Total Time</h4><div class="stat-value" id="statTotal">0 min</div></div>
              <div class="stat-card"><h4>Sessions</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Tasks Completed</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">History (FOCUS)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Knowledge Base per Subtopic</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Add Knowledge</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Click on an item to see details.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Discover the Pomodoro Study App</h3>
              <p>
                  Welcome to a study space designed for focus and efficiency. Explore the features that support your learning journey.
              </p>

              <h4>🚀 Quick Start in 4 Steps</h4>
              <p>To keep your journey organized, the app uses a <strong>Main Topic → Subtopic</strong> structure.</p>
              <ol>
                  <li>Open <strong>📚 Topics</strong> from the side navigation.</li>
                  <li>Click <strong>＋ Add Topic</strong> to create a main area (e.g., "Conversational English").</li>
                  <li>Next to the topic, click <strong>＋ Add</strong> to create a more specific subtopic (e.g., "Lesson 1: Practice IPA").</li>
                  <li>Select that subtopic. You’re now ready to start your first focus session!</li>
              </ol>

              <hr />
              <h4>✨ Notable Features</h4>

              <h4>Flexible Timer Modes ⏱️</h4>
              <p>The app offers more than Pomodoro. Pick what fits your work:</p>
              <ul>
                  <li><strong>Classic Pomodoro (Style A/B):</strong> Focus in fixed sessions (e.g., 25 min work, 5 min break) to build discipline and cadence.</li>
                  <li><strong>Flowtime Mode (Style 🌊 Flow):</strong> Ideal for deep work. The timer counts up; end when it feels right. Break time is suggested based on your focus time.</li>
                  <li><strong>Wind-down Buffer:</strong> A customizable buffer between focus and break to wrap up, jot the next step, and switch smoothly—without abrupt cutoffs.</li>
              </ul>

              <h4>Knowledge Base Per Subtopic 💡</h4>
              <p>
                  Each <strong>Subtopic</strong> now has its own dedicated Knowledge Base. This lets you build a focused library of methods and notes that only relate to what you’re studying in that subtopic.
              </p>
              <p>
                  For example, notes and methods for “Conversational English” will only appear when that subtopic is selected and won’t mix with formulas from a subtopic like “Calculus”.
              </p>
              <p>
                  The rich editor still lets you format headings, bold key points, create lists, and highlight important information for each subject.
              </p>

              <h4>Visual Topic Management</h4>
              <p>Easily organize your study goals. Use <strong>drag and drop</strong> to reorder Topics or move Subtopics across topics intuitively.</p>

              <h4>Integrated Tasks & Notes 📝</h4>
              <p>Right within the timer view, create to-dos for each subtopic and jot quick notes without breaking your flow.</p>

              <h4>Zen Mode 🧘</h4>
              <p>When you need absolute focus, click the eye icon (👁️). The interface hides, leaving only the background and timer. You can <strong>drag the timer</strong> anywhere for a clean workspace.</p>

              <h4>Statistics & Milestones 🏆</h4>
              <p>Track your journey through meaningful numbers. The app records and celebrates important focus-time milestones—turning effort into achievements.</p>

              <hr />
              <h4>⌨️ Smart Shortcuts</h4>
              <ul>
                  <li><kbd>Space</kbd>: Start / Pause / Resume the session.</li>
                  <li><kbd>N</kbd>: Skip the current focus or break session.</li>
                  <li><kbd>Esc</kbd>: Close open dialogs (e.g., Settings).</li>
              </ul>

              <hr />
              <h4>🛠️ Advanced Settings & Integrations</h4>

              <h4>Gemini AI Assistant 🧠</h4>
              <p>Turn the app into a smart study companion. Beyond Q&A, you can:</p>
              <ul>
                  <li><strong>Smart Auto-formatting:</strong> While writing under "Methods", let AI analyze and format your raw text—detect headings, bold key ideas, and lists.</li>
                  <li><strong>Setup:</strong> Visit Google AI Studio to create a free API Key and paste it into "Gemini API Key" in Settings.</li>
              </ul>

              <h4>Customize Interface & Sound 🎨</h4>
              <p>Make the workspace yours:</p>
              <ul>
                  <li><strong>Multiple Themes & Backgrounds:</strong> Choose from built-in themes (Light, Dark, Pastel...) or <strong>upload your own background</strong> for inspiration.</li>
                  <li><strong>Custom Alerts:</strong> <strong>Upload your own audio files (.mp3, .wav...)</strong> as alert sounds for focus and breaks.</li>
              </ul>

              <h4>YouTube Background Music 🎶</h4>
              <p>Create the perfect study ambiance by playing a YouTube video or playlist as background music. Paste the URL into the "YouTube Background Music" field in Settings.</p>

              <h4>Data Safety: Backup & Restore 🛡️</h4>
              <p>The app automatically backs up your progress daily. Customize how many days to keep and restore data from a previous day if needed. ⚠️ <strong>Warning:</strong> Restore will overwrite your current data.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Congratulations!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Continue the journey!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Settings</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Timer</button>
              <button class="tab-btn" data-tab="settings-ui">Interface & Sound</button>
              <button class="tab-btn" data-tab="settings-integrations">Integrations</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Style A </button>
                      <button class="btn ghost" data-preset-target="B"> Style B </button>
                      <button class="btn ghost" data-preset-target="C"> Style C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Pomodoro Durations</h4>
                      <div class="row">
                          <label>FOCUS (minutes)<input type="number" id="set_work" min="1" /></label>
                          <label>WIND-DOWN (minutes)<input type="number" id="set_winddown" min="0" /></label>
                          <label>SHORT BREAK (minutes)<input type="number" id="set_short" min="1" /></label>
                          <label>LONG BREAK (minutes)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Pomodoro Cycles<input type="number" id="set_cycles" min="1" /></label>
                          <label>Long Break Interval<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Break Ratio (Work / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Tip: Break time = total focus time / X. Default is 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Automatically start next session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Enable Wind-down after focus session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Prompt for note after each session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Interface</h4>
                      <div class="row">
                          <label>UI Theme
                                <select id="set_theme_color">
                                    <option value="default">Default (Dark Blue)</option>
                                    <option value="light">Light - Milk Tea</option>
                                    <option value="pastel">Pastel - Soft</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Background Display Mode
                              <select id="set_backgroundMode">
                                  <option value="cover">Cover (Default)</option>
                                  <option value="contain">Contain (Sharp)</option>
                                  <option value="auto">Original Size (Repeat)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Background Image
                              <label class="btn small ghost" for="uploadBg">Upload New Image</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Clear Background</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Panel Opacity</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Sound</h4>
                      <div class="row">
                          <label>Volume (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Alert Style
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Customize Alerts</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Alert at end of FOCUS</small>
                              <label title="Alert at end of FOCUS" class="btn small ghost" for="uploadSoundWork">FOCUS</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of SHORT BREAK</small>
                              <label title="Alert at end of SHORT BREAK" class="btn small ghost" for="uploadSoundBreak">SHORT BREAK</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of LONG BREAK</small>
                              <label title="Alert at end of LONG BREAK" class="btn small ghost" for="uploadSoundLong">LONG BREAK</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>AI Integration</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Paste your API Key here..." />
                      </label>
                      <div class="tiny">Required to use AI features. Get a free key at <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 YouTube Background Music</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Paste YouTube link here..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Use video thumbnail as background</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Stopping will not auto-play again until you press ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Volume</div>
                  </div>
                  <div>
                      <h4>🛡️ Backup Settings</h4>
                      <div class="row">
                          <label>Number of backup days to keep
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Restore Data</h4>
                      <p class="tiny">Restore from an automatic daily backup. This action will overwrite your current data.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Restore</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Defaults</button>
              <button class="btn acc" id="btnSaveSettings">Save</button>
              <button class="btn" id="btnCloseSettings">Close</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Note for the completed session</h3>
      <div class="row"><textarea id="noteText" placeholder="What did you learn? Any difficulties? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Summarize & Suggest</button>
        <button class="btn" id="btnSkipNote">Skip</button>
        <button class="btn acc" id="btnSaveNote">Save Note</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Title</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Cancel</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Dashboard</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Close</button>
        </div>
        <p class="tiny">Summary of time and sessions completed across all topics.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Edit Method</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Title<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Content</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Small heading">H</button>
          <button id="toolBold" class="btn small ghost" title="Bold">B</button>
          <button id="toolItalic" class="btn small ghost" title="Italic">I</button>
          <button id="toolList" class="btn small ghost" title="Numbered list">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Bulleted list">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Text color">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Default text color"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Accent color"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Positive color"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Warning color"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Danger color"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Purple"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="This feature requires a Gemini API Key">✨ Auto-format</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Cancel</button>
          <button class="btn acc" id="btnSaveMethod">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Press "Enable Sound" to allow background audio.</span>
    <button id="btnEnableSound" class="btn small acc">Enable Sound</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
    const _0x2deb62=_0x2ba0;(function(_0x317bbc,_0x4987de){const _0x3e6ca2=_0x2ba0,_0x1d12b7=_0x317bbc();while(!![]){try{const _0x46add4=-parseInt(_0x3e6ca2(0x252))/0x1*(parseInt(_0x3e6ca2(0x226))/0x2)+-parseInt(_0x3e6ca2(0x42a))/0x3*(parseInt(_0x3e6ca2(0x377))/0x4)+parseInt(_0x3e6ca2(0x3d5))/0x5+parseInt(_0x3e6ca2(0x370))/0x6+-parseInt(_0x3e6ca2(0x3c9))/0x7+parseInt(_0x3e6ca2(0x374))/0x8+parseInt(_0x3e6ca2(0x3f9))/0x9;if(_0x46add4===_0x4987de)break;else _0x1d12b7['push'](_0x1d12b7['shift']());}catch(_0x34ba84){_0x1d12b7['push'](_0x1d12b7['shift']());}}}(_0x5cb7,0x7aeac),window['addEventListener'](_0x2deb62(0x14c),()=>{try{updateFullscreenButton();}catch(_0x5a8080){}}));const IS_FILE_PROTOCOL=window[_0x2deb62(0x1e9)]['protocol']===_0x2deb62(0x2b8);function startYtApiWatchdog(){const _0x38df26=_0x2deb62,_0x123e19=document[_0x38df26(0x22a)](_0x38df26(0x3d6));if(!_0x123e19)return;const _0x4a878b=setTimeout(()=>{const _0x3b3404=_0x38df26;try{(!window['YT']||!window['YT'][_0x3b3404(0x3a6)])&&(_0x123e19[_0x3b3404(0x26a)]=_0x3b3404(0x30b),_0x123e19['style']['color']=_0x3b3404(0x35d));}catch(_0x4a7760){}},0x5dc),_0x34d828=setTimeout(()=>{const _0x2ed25c=_0x38df26;try{(!window['YT']||!window['YT'][_0x2ed25c(0x3a6)])&&(_0x123e19[_0x2ed25c(0x26a)]=_0x2ed25c(0x41d),_0x123e19[_0x2ed25c(0x300)][_0x2ed25c(0x447)]=_0x2ed25c(0x3e1));}catch(_0xcd54d5){}},0x1b58);window[_0x38df26(0x29a)]={'cancel'(){clearTimeout(_0x4a878b),clearTimeout(_0x34d828);}};}(function(){const _0x46e5f6=_0x2deb62,_0x5d7d65={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>'Cycle\x20'+current+'/'+target,'timer.selectSubtopicPrompt':_0x46e5f6(0x2ac)};window['t']=function _0x2f28fb(_0x395e27,_0x77b7e){const _0xa6e63b=_0x46e5f6;try{const _0x213d07=_0x5d7d65[_0x395e27];if(typeof _0x213d07==='function')return _0x213d07(_0x77b7e||{});if(typeof _0x213d07===_0xa6e63b(0x267))return _0x213d07;}catch(_0x39bee0){}return _0x395e27;},window[_0x46e5f6(0x2cd)]=function _0xf55935(_0x23bcb0){const _0x46298d=_0x46e5f6;try{localStorage['setItem'](_0x46298d(0x219),_0x23bcb0||'en');}catch(_0x26e2ea){}return Promise[_0x46298d(0x3a1)]();};}());function ensureYouTubeAPI(){const _0x15aee9=_0x2deb62;if(IS_FILE_PROTOCOL)return Promise[_0x15aee9(0x3a1)](![]);try{if(window['YT']&&window['YT'][_0x15aee9(0x3a6)])return Promise[_0x15aee9(0x3a1)](!![]);}catch(_0x1dbb1d){}if(window[_0x15aee9(0x371)])return window['__ytApiPromise'];return startYtApiWatchdog(),window['__ytApiPromise']=new Promise((_0x2b2607,_0xc5e5ee)=>{const _0x421fc3=_0x15aee9;try{const _0x24107=document[_0x421fc3(0x429)](_0x421fc3(0x37f));_0x24107[_0x421fc3(0x189)]=_0x421fc3(0x39b),_0x24107[_0x421fc3(0x333)]=!![],_0x24107[_0x421fc3(0x2d5)]=!![],_0x24107[_0x421fc3(0x37c)]=()=>_0x2b2607(!![]),_0x24107[_0x421fc3(0x15d)]=()=>_0xc5e5ee(new Error('Failed\x20to\x20load\x20YouTube\x20API')),document['head'][_0x421fc3(0x2bc)](_0x24107);}catch(_0x3e24aa){_0xc5e5ee(_0x3e24aa);}}),window['__ytApiPromise'];}const storageManager={'DB_NAME':_0x2deb62(0x277),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x2cde87,_0x43d742)=>{const _0x55c409=_0x2ba0;if(this['db'])return _0x2cde87(this['db']);const _0x116872=indexedDB[_0x55c409(0x150)](this['DB_NAME'],this['DB_VERSION']);_0x116872['onupgradeneeded']=_0x248e02=>{const _0x45cc8a=_0x55c409,_0xd90b88=_0x248e02[_0x45cc8a(0x1f7)][_0x45cc8a(0x292)];!_0xd90b88[_0x45cc8a(0x3c5)][_0x45cc8a(0x141)](_0x45cc8a(0x1b8))&&_0xd90b88[_0x45cc8a(0x37e)](_0x45cc8a(0x1b8));!_0xd90b88['objectStoreNames']['contains'](_0x45cc8a(0x2d9))&&_0xd90b88[_0x45cc8a(0x37e)](_0x45cc8a(0x2d9),{'keyPath':'id'});if(!_0xd90b88[_0x45cc8a(0x3c5)][_0x45cc8a(0x141)](_0x45cc8a(0x212))){const _0x54d85c=_0xd90b88[_0x45cc8a(0x37e)](_0x45cc8a(0x212),{'keyPath':'id'});_0x54d85c[_0x45cc8a(0x2fe)]('by_topic',_0x45cc8a(0x2e4));}!_0xd90b88['objectStoreNames'][_0x45cc8a(0x141)](_0x45cc8a(0x1cb))&&_0xd90b88[_0x45cc8a(0x37e)](_0x45cc8a(0x1cb),{'keyPath':_0x45cc8a(0x1af)});},_0x116872[_0x55c409(0x13f)]=_0x5964b3=>{const _0x20071e=_0x55c409;this['db']=_0x5964b3[_0x20071e(0x1f7)][_0x20071e(0x292)],console[_0x20071e(0x356)](_0x20071e(0x373)),_0x2cde87(this['db']);},_0x116872[_0x55c409(0x15d)]=_0x111797=>{const _0x1554a5=_0x55c409;console['error']('IndexedDB\x20error:',_0x111797[_0x1554a5(0x1f7)]['errorCode']),_0x43d742(_0x111797['target']['error']);};});},async '_getStore'(_0x572a02,_0x542393=_0x2deb62(0x315)){const _0x1c5918=_0x2deb62;await this[_0x1c5918(0x3a3)]();const _0x4b1bf7=this['db']['transaction']([_0x572a02],_0x542393);return _0x4b1bf7[_0x1c5918(0x154)](_0x572a02);},async 'getSettings'(){const _0x19a06a=_0x2deb62,_0x240ff4=await this[_0x19a06a(0x1c7)](_0x19a06a(0x1b8));return new Promise((_0x20db33,_0x335bef)=>{const _0x5f3f35=_0x19a06a,_0x2394c0=_0x240ff4[_0x5f3f35(0x1bb)]('main_settings');_0x2394c0['onsuccess']=()=>_0x20db33(_0x2394c0[_0x5f3f35(0x292)]),_0x2394c0['onerror']=()=>_0x335bef(_0x2394c0[_0x5f3f35(0x1b1)]);});},async 'updateSettings'(_0xb851de){const _0x4beb17=_0x2deb62,_0x27cd67=await this[_0x4beb17(0x1c7)](_0x4beb17(0x1b8),_0x4beb17(0x411));return new Promise((_0x102f36,_0xb58415)=>{const _0x2bb030=_0x4beb17,_0x35ef83=_0x27cd67[_0x2bb030(0x166)](_0xb851de,_0x2bb030(0x215));_0x35ef83['onsuccess']=()=>_0x102f36(_0x35ef83['result']),_0x35ef83[_0x2bb030(0x15d)]=()=>_0xb58415(_0x35ef83[_0x2bb030(0x1b1)]);});},async 'getAll'(_0x55ca73){const _0x447fed=_0x2deb62,_0x5216ce=await this[_0x447fed(0x1c7)](_0x55ca73);return new Promise((_0x12c936,_0xf0b903)=>{const _0x1d8afa=_0x447fed,_0x4c1f99=_0x5216ce['getAll']();_0x4c1f99['onsuccess']=()=>_0x12c936(_0x4c1f99[_0x1d8afa(0x292)]),_0x4c1f99['onerror']=()=>_0xf0b903(_0x4c1f99[_0x1d8afa(0x1b1)]);});},async 'update'(_0x29215d,_0x5e574c){const _0x5e2bcc=_0x2deb62,_0x7e81c1=await this[_0x5e2bcc(0x1c7)](_0x29215d,'readwrite');return new Promise((_0x4cf175,_0x25877c)=>{const _0x58bb31=_0x5e2bcc,_0x174866=_0x7e81c1[_0x58bb31(0x166)](_0x5e574c);_0x174866[_0x58bb31(0x13f)]=()=>_0x4cf175(_0x174866[_0x58bb31(0x292)]),_0x174866[_0x58bb31(0x15d)]=()=>_0x25877c(_0x174866[_0x58bb31(0x1b1)]);});},async 'add'(_0x54c2af,_0x8f926d){const _0x398307=_0x2deb62,_0x5e7ad1=await this[_0x398307(0x1c7)](_0x54c2af,_0x398307(0x411));return new Promise((_0x4c397c,_0x4cb78b)=>{const _0x4eec68=_0x398307,_0x252c9b=_0x5e7ad1[_0x4eec68(0x33b)](_0x8f926d);_0x252c9b[_0x4eec68(0x13f)]=()=>_0x4c397c(_0x252c9b['result']),_0x252c9b['onerror']=()=>_0x4cb78b(_0x252c9b[_0x4eec68(0x1b1)]);});},async 'delete'(_0x258eaf,_0x4f7abf){const _0x5f1cd3=_0x2deb62,_0x3ae257=await this[_0x5f1cd3(0x1c7)](_0x258eaf,_0x5f1cd3(0x411));return new Promise((_0x1c292b,_0x28afcc)=>{const _0x354e1e=_0x5f1cd3,_0x485b64=_0x3ae257[_0x354e1e(0x202)](_0x4f7abf);_0x485b64[_0x354e1e(0x13f)]=()=>_0x1c292b(_0x485b64['result']),_0x485b64['onerror']=()=>_0x28afcc(_0x485b64[_0x354e1e(0x1b1)]);});},async 'save'(_0x1fa5ae){return await this['initDB'](),new Promise((_0x17634e,_0x13d46a)=>{const _0x1f4bb9=_0x2ba0,_0x4deda4=this['db'][_0x1f4bb9(0x3e0)]([_0x1f4bb9(0x1b8),_0x1f4bb9(0x2d9),_0x1f4bb9(0x212)],_0x1f4bb9(0x411)),_0x959a3=_0x4deda4[_0x1f4bb9(0x154)]('settings'),_0x40a56c=_0x4deda4[_0x1f4bb9(0x154)](_0x1f4bb9(0x2d9)),_0x190868=_0x4deda4[_0x1f4bb9(0x154)](_0x1f4bb9(0x212));_0x959a3['put'](_0x1fa5ae[_0x1f4bb9(0x1b8)],_0x1f4bb9(0x215)),_0x40a56c[_0x1f4bb9(0x14f)](),_0x190868[_0x1f4bb9(0x14f)](),_0x1fa5ae[_0x1f4bb9(0x2d9)][_0x1f4bb9(0x19c)](_0x536e01=>{const _0x17851f=_0x1f4bb9,{subtopics:_0x8e7ed7,..._0x1ba225}=_0x536e01;_0x40a56c[_0x17851f(0x166)](_0x1ba225),(_0x8e7ed7||[])[_0x17851f(0x19c)](_0x45623e=>_0x190868[_0x17851f(0x166)](_0x45623e));}),_0x4deda4[_0x1f4bb9(0x3e8)]=()=>_0x17634e(),_0x4deda4[_0x1f4bb9(0x15d)]=_0x4b917d=>_0x13d46a(_0x4b917d[_0x1f4bb9(0x1f7)][_0x1f4bb9(0x1b1)]);});},async 'autoBackup'(_0x486127){const _0x438377=_0x2deb62;await this[_0x438377(0x3a3)]();const _0x24e335=new Date()[_0x438377(0x20d)]()[_0x438377(0x419)](0x0,0xa),_0x5d9398=localStorage[_0x438377(0x318)](_0x438377(0x33e));if(_0x24e335!==_0x5d9398){console[_0x438377(0x356)]('Creating\x20backup\x20for\x20'+_0x24e335+'...');const _0xb1004b={'date':_0x24e335,'data':JSON['parse'](JSON[_0x438377(0x1c5)](_0x486127))},_0x71b97e=this['db'][_0x438377(0x3e0)]([_0x438377(0x1cb)],_0x438377(0x411)),_0x193843=_0x71b97e[_0x438377(0x154)]('backups'),_0x253861=_0x193843['put'](_0xb1004b);_0x253861[_0x438377(0x13f)]=()=>{const _0x221b83=_0x438377;localStorage[_0x221b83(0x157)]('lastBackupDate',_0x24e335),console[_0x221b83(0x356)]('Daily\x20backup\x20successful.'),this[_0x221b83(0x33a)](_0x486127?.[_0x221b83(0x1b8)]?.[_0x221b83(0x23d)]||0x7);},_0x253861[_0x438377(0x15d)]=_0x485d2b=>{const _0x1b4c26=_0x438377;console[_0x1b4c26(0x1b1)](_0x1b4c26(0x3b1),_0x485d2b[_0x1b4c26(0x1f7)]['error']);};}},async 'cleanupOldBackups'(_0x287daf){const _0x4ed1e3=_0x2deb62;await this[_0x4ed1e3(0x3a3)]();const _0x55decb=this['db'][_0x4ed1e3(0x3e0)]([_0x4ed1e3(0x1cb)],_0x4ed1e3(0x411)),_0x214d68=_0x55decb['objectStore']('backups'),_0x92c93f=_0x214d68['getAllKeys']();_0x92c93f['onsuccess']=()=>{const _0x19af0f=_0x4ed1e3,_0x5ed14d=_0x92c93f[_0x19af0f(0x292)][_0x19af0f(0x3d7)]()[_0x19af0f(0x416)]();if(_0x5ed14d[_0x19af0f(0x2f0)]>_0x287daf){const _0x1f22a0=_0x5ed14d[_0x19af0f(0x419)](_0x287daf);_0x1f22a0[_0x19af0f(0x19c)](_0x2e8f2b=>{const _0x4eb44d=_0x19af0f;_0x214d68[_0x4eb44d(0x202)](_0x2e8f2b),console[_0x4eb44d(0x356)]('Deleted\x20old\x20backup:\x20'+_0x2e8f2b);});}};},async 'getBackupList'(){return await this['initDB'](),new Promise((_0x3f761b,_0x43bd8b)=>{const _0x4d64e7=_0x2ba0,_0x52117c=this['db'][_0x4d64e7(0x3e0)]([_0x4d64e7(0x1cb)],'readonly'),_0x1fdcf6=_0x52117c[_0x4d64e7(0x154)](_0x4d64e7(0x1cb)),_0x39796a=_0x1fdcf6['getAll']();_0x39796a[_0x4d64e7(0x13f)]=()=>_0x3f761b(_0x39796a[_0x4d64e7(0x292)]['sort']((_0x58ba42,_0x169b9c)=>_0x169b9c['date'][_0x4d64e7(0x24a)](_0x58ba42[_0x4d64e7(0x1af)]))),_0x39796a[_0x4d64e7(0x15d)]=_0x19e783=>_0x43bd8b(_0x19e783[_0x4d64e7(0x1f7)][_0x4d64e7(0x1b1)]);});},async 'restoreBackup'(_0x5c5d12){return await this['initDB'](),new Promise((_0x77ca2e,_0x2acef4)=>{const _0xdeeefc=_0x2ba0,_0x2a8738=this['db'][_0xdeeefc(0x3e0)]([_0xdeeefc(0x1cb)],_0xdeeefc(0x315)),_0x56473e=_0x2a8738[_0xdeeefc(0x154)]('backups'),_0x3d500c=_0x56473e['get'](_0x5c5d12);_0x3d500c['onsuccess']=()=>{const _0x3d0d2f=_0xdeeefc;_0x3d500c[_0x3d0d2f(0x292)]&&_0x3d500c[_0x3d0d2f(0x292)][_0x3d0d2f(0x18d)]?(localStorage['setItem']('pomodoroData_v11',JSON[_0x3d0d2f(0x1c5)](_0x3d500c[_0x3d0d2f(0x292)][_0x3d0d2f(0x18d)])),_0x77ca2e(_0x3d500c[_0x3d0d2f(0x292)][_0x3d0d2f(0x18d)])):_0x2acef4(new Error('Backup\x20not\x20found.'));},_0x3d500c[_0xdeeefc(0x15d)]=_0x5efe80=>_0x2acef4(_0x5efe80[_0xdeeefc(0x1f7)][_0xdeeefc(0x1b1)]);});},'exportData'(_0x5ca23a){const _0x8d22c8=_0x2deb62;let _0x3e9c37={};try{_0x3e9c37=JSON[_0x8d22c8(0x1f2)](JSON['stringify'](_0x5ca23a||{}));}catch(_0x3f098d){_0x3e9c37=_0x5ca23a;}try{if(_0x3e9c37&&_0x3e9c37[_0x8d22c8(0x1b8)])_0x3e9c37[_0x8d22c8(0x1b8)][_0x8d22c8(0x2da)]='';}catch(_0x47311f){}const _0x1c6a94=new Blob([JSON[_0x8d22c8(0x1c5)](_0x3e9c37,null,0x2)],{'type':_0x8d22c8(0x16d)}),_0x354cf2=document['createElement']('a'),_0x5387e2=new Date(),_0x4bfaec=_0x36f2da=>(''+_0x36f2da)[_0x8d22c8(0x44c)](0x2,'0');_0x354cf2['href']=URL[_0x8d22c8(0x1a7)](_0x1c6a94),_0x354cf2['download']=_0x8d22c8(0x28a)+_0x5387e2[_0x8d22c8(0x147)]()+_0x4bfaec(_0x5387e2[_0x8d22c8(0x17a)]()+0x1)+_0x4bfaec(_0x5387e2['getDate']())+_0x8d22c8(0x3b9),_0x354cf2['click'](),URL[_0x8d22c8(0x15a)](_0x354cf2[_0x8d22c8(0x414)]);},async 'importData'(_0x58f9ea){const _0x40f8a9=_0x2deb62,_0x30ce25=await _0x58f9ea[_0x40f8a9(0x417)](),_0x3aa195=JSON[_0x40f8a9(0x1f2)](_0x30ce25);if(!_0x3aa195[_0x40f8a9(0x25a)]||!_0x3aa195[_0x40f8a9(0x1b8)]||!Array['isArray'](_0x3aa195[_0x40f8a9(0x2d9)]))throw new Error(_0x40f8a9(0x384));try{const _0x26f22d=window['data']&&window['data'][_0x40f8a9(0x1b8)]&&window[_0x40f8a9(0x18d)][_0x40f8a9(0x1b8)][_0x40f8a9(0x2da)]||'';(!(_0x40f8a9(0x2da)in _0x3aa195[_0x40f8a9(0x1b8)])||_0x3aa195['settings']['apiKey']==='')&&(_0x3aa195[_0x40f8a9(0x1b8)]['apiKey']=_0x26f22d);}catch(_0xa74642){}return localStorage[_0x40f8a9(0x157)](_0x40f8a9(0x320),JSON[_0x40f8a9(0x1c5)](_0x3aa195)),_0x3aa195;}},$=(_0x405b06,_0x1afbf5=document)=>_0x1afbf5['querySelector'](_0x405b06),breakSuggestions=[_0x2deb62(0x1bd),_0x2deb62(0x32b),_0x2deb62(0x276),_0x2deb62(0x218),_0x2deb62(0x3f2),_0x2deb62(0x304),'Play\x20a\x20favorite\x20song\x20briefly.',_0x2deb62(0x255),_0x2deb62(0x28c),_0x2deb62(0x2db),_0x2deb62(0x330),'Open\x20a\x20window\x20for\x20some\x20fresh\x20air.',_0x2deb62(0x3b0),_0x2deb62(0x21e),_0x2deb62(0x40f),_0x2deb62(0x164),_0x2deb62(0x155),_0x2deb62(0x196),_0x2deb62(0x312),_0x2deb62(0x344),_0x2deb62(0x23c),'Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.',_0x2deb62(0x2a5),_0x2deb62(0x423),_0x2deb62(0x2b1),_0x2deb62(0x3ff),_0x2deb62(0x185),_0x2deb62(0x1ce),'Refuel\x20with\x20a\x20healthy\x20snack.',_0x2deb62(0x2b9),'Check\x20your\x20breathing—if\x20rushed,\x20slow\x20it\x20down.',_0x2deb62(0x3eb)],$$=(_0xaff1d3,_0x585cda=document)=>Array[_0x2deb62(0x2e9)](_0x585cda[_0x2deb62(0x203)](_0xaff1d3));function on(_0x399998,_0x403d4d,_0x4e3459){const _0x39da64=_0x2deb62;if(!_0x399998){console[_0x39da64(0x1d0)](_0x39da64(0x305),_0x403d4d);return;}_0x399998[_0x39da64(0x396)](_0x403d4d,_0x4e3459);}const formatMMSS=_0x3f18ac=>{const _0x205dda=_0x2deb62,_0x5699d7=Math[_0x205dda(0x413)](_0x3f18ac/0x3c)[_0x205dda(0x1c2)]()[_0x205dda(0x44c)](0x2,'0'),_0x1eb163=Math[_0x205dda(0x413)](_0x3f18ac%0x3c)[_0x205dda(0x1c2)]()[_0x205dda(0x44c)](0x2,'0');return _0x5699d7+':'+_0x1eb163;},uid=(_0x2106b0='id')=>_0x2106b0+'_'+Date[_0x2deb62(0x3ad)]()+'_'+Math['random']()['toString'](0x24)[_0x2deb62(0x419)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0xf4e55e){const _0x3d6b80=_0x2deb62;try{const _0x293d80=_0xf4e55e[_0x3d6b80(0x203)](_0x3d6b80(0x2dc));if(!_0x293d80[_0x3d6b80(0x2f0)])return;const _0x51b625=_0x293d80[0x0],_0x258101=_0x293d80[_0x293d80[_0x3d6b80(0x2f0)]-0x1],_0x941427=_0xcffc61=>{const _0x631170=_0x3d6b80;if(_0xcffc61[_0x631170(0x2ee)]===_0x631170(0x1b0)){if(_0xcffc61[_0x631170(0x316)]&&document[_0x631170(0x21c)]===_0x51b625)_0xcffc61['preventDefault'](),_0x258101[_0x631170(0x168)]();else!_0xcffc61[_0x631170(0x316)]&&document[_0x631170(0x21c)]===_0x258101&&(_0xcffc61[_0x631170(0x216)](),_0x51b625[_0x631170(0x168)]());}};_0xf4e55e[_0x3d6b80(0x396)](_0x3d6b80(0x2a9),_0x941427),_0x51b625['focus'](),__releaseFocusTrap=()=>{const _0xe1fe91=_0x3d6b80;try{_0xf4e55e[_0xe1fe91(0x425)](_0xe1fe91(0x2a9),_0x941427);}catch(_0x396558){}};}catch(_0x5c8668){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x413acf){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x2deb62(0x20d)]();function toast(_0x2b51b8,_0x5e8d3f=0xa28){const _0x3f5a98=_0x2deb62,_0x571f60=$(_0x3f5a98(0x2a3)),_0x463e85=document[_0x3f5a98(0x429)](_0x3f5a98(0x34c));_0x463e85['className']=_0x3f5a98(0x237),_0x463e85['textContent']=_0x2b51b8,_0x571f60[_0x3f5a98(0x2bc)](_0x463e85),setTimeout(()=>{const _0x4ade37=_0x3f5a98;_0x463e85[_0x4ade37(0x300)]['opacity']='0';},_0x5e8d3f-0x12c),setTimeout(()=>_0x571f60['removeChild'](_0x463e85),_0x5e8d3f);}function escapeHTML(_0x574113){const _0x40023c=_0x2deb62;return _0x574113['replace'](/[&<>"']/g,_0xdb50d3=>({'&':_0x40023c(0x440),'<':_0x40023c(0x27e),'>':_0x40023c(0x20f),'\x22':_0x40023c(0x193),'\x27':_0x40023c(0x2d1)}[_0xdb50d3]));}function formatDaysHoursMinutes(_0x44682f){const _0x2c0e21=_0x2deb62;if(!_0x44682f||_0x44682f<0x1)return _0x2c0e21(0x2b7);const _0xa1dea3=Math[_0x2c0e21(0x413)](_0x44682f/0x3c),_0x3b6e3e=_0x44682f%0x3c,_0x135af3=_0x3b6e3e[_0x2c0e21(0x1c2)]()[_0x2c0e21(0x44c)](0x2,'0');return _0xa1dea3+_0x2c0e21(0x408)+_0x135af3+'\x20min';}function formatGeminiResponse(_0x3c33da){return _0x3c33da['replace'](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x49a720){const _0x4129d5=_0x2deb62,_0x2e9d6d=(_0x49a720||'')[_0x4129d5(0x38d)]('\x0a');let _0xe36f7d='',_0x24284a=null;const _0x7c3e17=()=>{const _0x37400f=_0x4129d5;_0x24284a&&(_0xe36f7d+=_0x24284a==='ol'?_0x37400f(0x323):_0x37400f(0x22c),_0x24284a=null);};for(let _0x57a46f of _0x2e9d6d){let _0xee411d=(_0x57a46f||'')['trim']();if(!_0xee411d){_0x7c3e17();continue;}if(_0xee411d[_0x4129d5(0x22d)](_0x4129d5(0x195)))_0x7c3e17(),_0xe36f7d+='<h4>'+escapeHTML(_0xee411d[_0x4129d5(0x38e)](0x5))+_0x4129d5(0x28b);else{if(/^\d+\.\s/[_0x4129d5(0x3b3)](_0xee411d)){_0x24284a!=='ol'&&(_0x7c3e17(),_0xe36f7d+=_0x4129d5(0x2eb),_0x24284a='ol');const _0x22ba9e=_0xee411d[_0x4129d5(0x38e)](_0xee411d[_0x4129d5(0x21f)]('\x20')+0x1);_0xe36f7d+='<li>'+escapeHTML(_0x22ba9e)+_0x4129d5(0x42f);}else _0xee411d[_0x4129d5(0x22d)]('-\x20')?(_0x24284a!=='ul'&&(_0x7c3e17(),_0xe36f7d+=_0x4129d5(0x3f8),_0x24284a='ul'),_0xe36f7d+=_0x4129d5(0x36a)+escapeHTML(_0xee411d['substring'](0x2))+_0x4129d5(0x42f)):(_0x7c3e17(),_0xee411d=escapeHTML(_0xee411d)[_0x4129d5(0x2b4)](/\*\*(.*?)\*\*/g,'<strong>$1</strong>')['replace'](/_(.*?)_/g,'<i>$1</i>'),_0xe36f7d+='<p>'+_0xee411d+_0x4129d5(0x146));}}return _0x7c3e17(),_0xe36f7d;}function wrapTextInMarkdown(_0x3fdad4,_0xe9ca93,_0x1ad3ab=''){const _0x1db778=_0x2deb62;if(!_0x3fdad4)return;const _0x38b4f3=_0x3fdad4['selectionStart']||0x0,_0x15ef6e=_0x3fdad4[_0x1db778(0x359)]||0x0,_0x373e32=_0x3fdad4['value'][_0x1db778(0x38e)](_0x38b4f3,_0x15ef6e),_0x31bb0c=_0xe9ca93+_0x373e32+(_0x1ad3ab||_0xe9ca93);_0x3fdad4['setRangeText'](_0x31bb0c,_0x38b4f3,_0x15ef6e,'end'),_0x3fdad4['focus']();}function updateEditorPreview(){const _0x27f6cf=_0x2deb62,_0x154f7f=$('#methodEditorContentInput'),_0x560446=$(_0x27f6cf(0x354));if(!_0x154f7f||!_0x560446)return;const _0x2f2c88=_0x154f7f['value']||'';_0x560446[_0x27f6cf(0x143)]=parseSimpleMarkdown(_0x2f2c88);}function normalizeDataStructure(_0x100fbb){const _0x30b260=_0x2deb62;if(!_0x100fbb||typeof _0x100fbb!=='object')return;const _0x435b29=_0x100fbb[_0x30b260(0x1b8)]||{},_0x3021c9={...defaults['settings'],..._0x435b29,'durations':{...defaults[_0x30b260(0x1b8)]['durations'],..._0x435b29['durations']||{}}};if(!Array['isArray'](_0x3021c9[_0x30b260(0x297)]))_0x3021c9[_0x30b260(0x297)]=[];_0x100fbb['settings']=_0x3021c9,_0x100fbb[_0x30b260(0x2d9)]=Array[_0x30b260(0x39c)](_0x100fbb[_0x30b260(0x2d9)])?_0x100fbb[_0x30b260(0x2d9)]:[],_0x100fbb[_0x30b260(0x2d9)][_0x30b260(0x19c)](_0x43ad2f=>{const _0x223736=_0x30b260;_0x43ad2f[_0x223736(0x212)]=Array[_0x223736(0x39c)](_0x43ad2f[_0x223736(0x212)])?_0x43ad2f['subtopics']:[],_0x43ad2f[_0x223736(0x212)][_0x223736(0x19c)](_0x1b8c83=>{const _0x2518ca=_0x223736;_0x1b8c83['tasks']=_0x1b8c83['tasks']||[],_0x1b8c83[_0x2518ca(0x228)]=_0x1b8c83[_0x2518ca(0x228)]||[],_0x1b8c83[_0x2518ca(0x197)]=_0x1b8c83[_0x2518ca(0x197)]||[],_0x1b8c83['chatHistory']=_0x1b8c83[_0x2518ca(0x390)]||[],_0x1b8c83[_0x2518ca(0x348)]=Array[_0x2518ca(0x39c)](_0x1b8c83[_0x2518ca(0x348)])?_0x1b8c83['methods']:[],_0x1b8c83[_0x2518ca(0x309)]=_0x1b8c83[_0x2518ca(0x309)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x1b8c83[_0x2518ca(0x16c)]=_0x1b8c83[_0x2518ca(0x16c)]||[],_0x1b8c83[_0x2518ca(0x2af)]=_0x1b8c83[_0x2518ca(0x2af)]||{'state':_0x2518ca(0x213),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x2ba7ba){const _0x2b61e9=_0x2deb62;if(!_0x2ba7ba)return null;const _0x194789=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0xe18acb=_0x2ba7ba[_0x2b61e9(0x387)](_0x194789);return _0xe18acb?_0xe18acb[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x530d0b=_0x2deb62;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x3c660a=document['getElementById']('set_youtubeUrl'),_0xc7754c=(_0x3c660a&&_0x3c660a['value']?_0x3c660a['value']:'')[_0x530d0b(0x37a)]();return _0xc7754c;}catch(_0x3a5497){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}async function migrateSharedMethodsToCurrentSubtopic(){const _0x5d9334=_0x2deb62;try{const _0x3d6d30=data?.[_0x5d9334(0x1b8)]?.[_0x5d9334(0x348)]||[];if(!Array[_0x5d9334(0x39c)](_0x3d6d30)||_0x3d6d30['length']===0x0)return;const _0x445c3c=getCurrentSubtopic();if(!_0x445c3c)return;(!Array[_0x5d9334(0x39c)](_0x445c3c['methods'])||_0x445c3c['methods'][_0x5d9334(0x2f0)]===0x0)&&(_0x445c3c[_0x5d9334(0x348)]=_0x3d6d30,data['settings'][_0x5d9334(0x348)]=[],await saveData());}catch(_0x1c9531){}}function handleYoutubeUrlInput(){const _0x30840f=_0x2deb62,_0x22ed7a=$(_0x30840f(0x3ee)),_0x5be976=$(_0x30840f(0x3b4)),_0x3d127a=$(_0x30840f(0x231)),_0x37ed0a=_0x22ed7a[_0x30840f(0x1b9)][_0x30840f(0x37a)](),_0x1273ab=extractYouTubeID(_0x37ed0a);if(_0x1273ab){_0x5be976[_0x30840f(0x26a)]='OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...',_0x5be976[_0x30840f(0x300)][_0x30840f(0x447)]=_0x30840f(0x3fa),_0x3d127a['disabled']=![],sessionYoutubeUrl=_0x37ed0a;try{ytUserPaused=![];}catch(_0x5c7e41){}try{const _0x46d648=_0x30840f(0x1b4)+_0x1273ab+'/maxresdefault.jpg',_0x172e48=new Image();_0x172e48[_0x30840f(0x37c)]=async()=>{const _0x3bfa33=_0x30840f;data[_0x3bfa33(0x1b8)][_0x3bfa33(0x3e4)]=_0x46d648;try{await saveData();}catch(_0x25dfee){}applyCustomBg();},_0x172e48[_0x30840f(0x15d)]=async()=>{const _0x27bb9a=_0x30840f,_0x24e898=_0x27bb9a(0x1b4)+_0x1273ab+_0x27bb9a(0x225);data['settings'][_0x27bb9a(0x3e4)]=_0x24e898;try{await saveData();}catch(_0x4a60a1){}applyCustomBg();},_0x172e48['src']=_0x46d648;}catch(_0x4e6561){}try{if(IS_FILE_PROTOCOL){const _0x181e6c=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x1273ab,{'autoplay':0x1,'mute':_0x181e6c});try{setTimeout(()=>{const _0x446314=_0x30840f;try{fallbackPostMessage(_0x446314(0x449));}catch(_0x5ddbfa){}},0xfa);}catch(_0x3beb99){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x42c87f=_0x30840f,_0x14c07c=document['getElementById'](_0x42c87f(0x3d6));if(_0x14c07c)_0x14c07c[_0x42c87f(0x26a)]=_0x42c87f(0x18b);},0x1f4);}catch(_0x43af73){}}else ensureYouTubeAPI()[_0x30840f(0x3a9)](()=>{const _0x156980=_0x30840f;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x156980(0x250)]&&ytPlayer[_0x156980(0x449)]&&(ytPlayer['mute'](),ytPlayer[_0x156980(0x449)](),_ytPrimed=!![],showSoundPermission());}catch(_0x1c6c8a){}})[_0x30840f(0x1e7)](()=>{});}catch(_0x618906){}}else{if(_0x37ed0a===''){_0x5be976[_0x30840f(0x26a)]='',_0x3d127a[_0x30840f(0x2f5)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x1b1a7b){}else ytPlayer&&ytPlayer[_0x30840f(0x456)]&&ytPlayer[_0x30840f(0x456)]();}else _0x5be976[_0x30840f(0x26a)]='❌\x20Invalid\x20or\x20unsupported\x20link.',_0x5be976[_0x30840f(0x300)]['color']=_0x30840f(0x3e1),_0x3d127a['disabled']=!![];}}function applyTheme(_0x410766){const _0x5a8c6a=_0x2deb62,_0x218812=_0x410766||data[_0x5a8c6a(0x1b8)][_0x5a8c6a(0x139)]||_0x5a8c6a(0x1a8);document[_0x5a8c6a(0x3d8)][_0x5a8c6a(0x192)]['theme']=_0x218812;const _0x5a2813=[_0x5a8c6a(0x2a8),'space'][_0x5a8c6a(0x20e)](_0x218812),_0x251633=_0x218812==='light'||_0x218812==='pastel',_0x13f7a8=data[_0x5a8c6a(0x1b8)]['customBg'],_0x334837=()=>{const _0x15bac0=_0x5a8c6a;try{document[_0x15bac0(0x3d8)][_0x15bac0(0x300)][_0x15bac0(0x1eb)]='';}catch(_0x469a56){}};if(_0x13f7a8&&!data[_0x5a8c6a(0x1b8)][_0x5a8c6a(0x2a6)])document[_0x5a8c6a(0x3d8)][_0x5a8c6a(0x300)][_0x5a8c6a(0x26e)](_0x5a8c6a(0x43a),_0x5a8c6a(0x2ec)+_0x13f7a8+')'),_0x334837();else{if(_0x13f7a8&&data['settings'][_0x5a8c6a(0x2a6)])document[_0x5a8c6a(0x3d8)]['style'][_0x5a8c6a(0x26e)](_0x5a8c6a(0x43a),_0x5a8c6a(0x2ec)+_0x13f7a8+')'),_0x334837();else{if(_0x5a2813)document['body']['style'][_0x5a8c6a(0x448)](_0x5a8c6a(0x43a)),_0x334837();else _0x251633?(document['body'][_0x5a8c6a(0x300)][_0x5a8c6a(0x26e)](_0x5a8c6a(0x43a),_0x5a8c6a(0x2ba)),_0x334837()):(document[_0x5a8c6a(0x3d8)][_0x5a8c6a(0x300)][_0x5a8c6a(0x26e)](_0x5a8c6a(0x43a),''),document[_0x5a8c6a(0x3d8)][_0x5a8c6a(0x300)][_0x5a8c6a(0x1eb)]=_0x5a8c6a(0x33f));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x2deb62(0x220),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':_0x2deb62(0x40b),'theme':_0x2deb62(0x1a8),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':_0x2deb62(0x151),'backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x2deb62(0x2ed),'content':_0x2deb62(0x410)},{'id':uid('m'),'title':_0x2deb62(0x383),'content':_0x2deb62(0x1e6)},{'id':uid('m'),'title':_0x2deb62(0x3de),'content':_0x2deb62(0x142)},{'id':uid('m'),'title':_0x2deb62(0x41c),'content':_0x2deb62(0x3ce)},{'id':uid('m'),'title':_0x2deb62(0x301),'content':_0x2deb62(0x420)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x5e780b=_0x2deb62;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x5e780b(0x407))]||window['webkitAudioContext'])();}function tone(_0xe5781a=0x370,_0x11644b=0xc8,_0xde4407=0.2,_0x571d8a=_0x2deb62(0x32f),_0x199fe5=0x0){const _0x4027b2=_0x2deb62;ensureAudio();const _0x3f7fb9=AUDIO_CTX,_0x4b7b78=_0x3f7fb9[_0x4027b2(0x20b)](),_0x5a8e81=_0x3f7fb9['createGain']();_0x4b7b78[_0x4027b2(0x1fd)]=_0x571d8a,_0x4b7b78[_0x4027b2(0x2c1)][_0x4027b2(0x1b9)]=_0xe5781a,_0x4b7b78[_0x4027b2(0x2ae)](_0x5a8e81),_0x5a8e81[_0x4027b2(0x2ae)](_0x3f7fb9[_0x4027b2(0x3af)]);const _0x2e45c4=_0x3f7fb9[_0x4027b2(0x36b)]+_0x199fe5;_0x5a8e81[_0x4027b2(0x400)][_0x4027b2(0x288)](0x0,_0x2e45c4),_0x5a8e81['gain'][_0x4027b2(0x3fc)](_0xde4407,_0x2e45c4+0.01),_0x5a8e81[_0x4027b2(0x400)][_0x4027b2(0x217)](0.0001,_0x2e45c4+_0x11644b/0x3e8),_0x4b7b78[_0x4027b2(0x3f5)](_0x2e45c4),_0x4b7b78[_0x4027b2(0x17e)](_0x2e45c4+_0x11644b/0x3e8+0.05);}function playSound(_0x30f5f7){const _0x3490d5=_0x2deb62;if(!data[_0x3490d5(0x1b8)][_0x3490d5(0x1dd)])return;const _0x1ef948=Math[_0x3490d5(0x1d5)](0x0,Math[_0x3490d5(0x27a)](0x1,data[_0x3490d5(0x1b8)]['volume']??0.8)),_0x36126f=data[_0x3490d5(0x1b8)][_0x3490d5(0x2fb)]?.[_0x30f5f7];let _0x7c4d52;if(_0x30f5f7==='work_end')_0x7c4d52=$(_0x3490d5(0x314));else{if(_0x30f5f7===_0x3490d5(0x3fe))_0x7c4d52=$(_0x3490d5(0x248));else{if(_0x30f5f7===_0x3490d5(0x44e))_0x7c4d52=$(_0x3490d5(0x3e2));}}if(_0x36126f&&_0x7c4d52){_0x36126f['startsWith'](_0x3490d5(0x21d))||_0x36126f[_0x3490d5(0x22d)]('http')||_0x36126f[_0x3490d5(0x22d)](_0x3490d5(0x2bf))?(_0x7c4d52[_0x3490d5(0x189)]=_0x36126f,_0x7c4d52[_0x3490d5(0x1e8)]=_0x1ef948,_0x7c4d52[_0x3490d5(0x3ac)]()[_0x3490d5(0x1e7)](_0x58ed3c=>console['error'](_0x3490d5(0x360),_0x58ed3c))):getStoredFileUrl(_0x36126f)[_0x3490d5(0x3a9)](_0x317ce1=>{const _0x553e49=_0x3490d5;_0x317ce1&&(_0x7c4d52[_0x553e49(0x189)]=_0x317ce1,_0x7c4d52[_0x553e49(0x1e8)]=_0x1ef948,_0x7c4d52[_0x553e49(0x3ac)]()[_0x553e49(0x1e7)](_0x111e8f=>console[_0x553e49(0x1b1)]('Audio\x20playback\x20error:',_0x111e8f)));});return;}const _0x5c88e3=data['settings']['soundTheme']||_0x3490d5(0x40b);if(_0x5c88e3===_0x3490d5(0x40b)){if(_0x30f5f7===_0x3490d5(0x2c3))tone(0x370,0xfa,_0x1ef948),tone(0x294,0xb4,_0x1ef948*0.8,_0x3490d5(0x32f),0.22);else{if(_0x30f5f7===_0x3490d5(0x3fe))tone(0x294,0xdc,_0x1ef948*0.9);else _0x30f5f7==='long_end'&&(tone(0x208,0xc8,_0x1ef948),tone(0x30c,0xc8,_0x1ef948,_0x3490d5(0x32f),0.22),tone(0x410,0xdc,_0x1ef948,_0x3490d5(0x32f),0.44));}}else{if(_0x30f5f7==='work_end')tone(0x4b0,0xa0,_0x1ef948*0.9,_0x3490d5(0x38a)),tone(0x384,0xdc,_0x1ef948*0.8,'triangle',0.18);else{if(_0x30f5f7===_0x3490d5(0x3fe))tone(0x370,0xf0,_0x1ef948*0.8,_0x3490d5(0x38a));else _0x30f5f7===_0x3490d5(0x44e)&&(tone(0x258,0xdc,_0x1ef948*0.9,_0x3490d5(0x38a)),tone(0x3b6,0xf0,_0x1ef948*0.9,_0x3490d5(0x38a),0.22),tone(0x4b0,0xf0,_0x1ef948,_0x3490d5(0x38a),0.44));}}}async function saveData(){const _0x56744b=_0x2deb62;try{await storageManager['save'](data);}catch(_0x5b534d){console[_0x56744b(0x1b1)](_0x56744b(0x259),_0x5b534d),toast(_0x56744b(0x1c6)+_0x5b534d[_0x56744b(0x210)]);}}async function ensureValidSelection(){const _0x1d6ddf=_0x2deb62,_0x338835=data['settings'];if(!data['topics']||data[_0x1d6ddf(0x2d9)]['length']===0x0){_0x338835[_0x1d6ddf(0x2e5)]='',_0x338835[_0x1d6ddf(0x22b)]='',await saveData();return;}const _0x575684=data[_0x1d6ddf(0x2d9)][_0x1d6ddf(0x3c0)](_0x5e33a6=>_0x5e33a6['id']===_0x338835[_0x1d6ddf(0x2e5)]),_0x1db9b2=_0x575684?.['subtopics']['find'](_0x4fd628=>_0x4fd628['id']===_0x338835[_0x1d6ddf(0x22b)]);if(!_0x575684||!_0x1db9b2){const _0x381051=data[_0x1d6ddf(0x2d9)][0x0],_0x4d7560=_0x381051?.[_0x1d6ddf(0x212)]?.[0x0];_0x338835[_0x1d6ddf(0x2e5)]=_0x381051?.['id']||'',_0x338835[_0x1d6ddf(0x22b)]=_0x4d7560?.['id']||'',await saveData();}}function showInputModal(_0x4f45e1,_0x492584,_0x18ac6e=''){const _0x18405=_0x2deb62;$(_0x18405(0x1de))['textContent']=_0x4f45e1,$(_0x18405(0x39e))[_0x18405(0x362)][_0x18405(0x33b)](_0x18405(0x3ea));const _0x4b942b=$(_0x18405(0x270));_0x4b942b[_0x18405(0x1b9)]=_0x18ac6e,_0x4b942b[_0x18405(0x362)][_0x18405(0x223)]('hidden'),$('#modalGeneric')[_0x18405(0x362)][_0x18405(0x33b)]('show');try{trapFocus($(_0x18405(0x433)));}catch(_0x450b63){}_0x4b942b['focus'](),_0x4b942b[_0x18405(0x1ab)]();const _0x450db6=()=>{const _0xe93b54=_0x18405;_0x492584(_0x4b942b[_0xe93b54(0x1b9)]),_0x2f6a02();},_0x598a7c=()=>_0x2f6a02(),_0x1e4c14=_0x269663=>{const _0x4feb21=_0x18405;if(_0x269663['key']==='Enter')_0x450db6();if(_0x269663['key']===_0x4feb21(0x421))_0x598a7c();};$(_0x18405(0x2e7))[_0x18405(0x17f)]=_0x450db6,$(_0x18405(0x229))[_0x18405(0x17f)]=_0x598a7c,_0x4b942b[_0x18405(0x434)]=_0x1e4c14;function _0x2f6a02(){const _0x12fc5b=_0x18405;$(_0x12fc5b(0x433))[_0x12fc5b(0x362)]['remove'](_0x12fc5b(0x286)),$(_0x12fc5b(0x2e7))[_0x12fc5b(0x17f)]=null,$('#btnGenericCancel')[_0x12fc5b(0x17f)]=null,_0x4b942b['onkeydown']=null;try{releaseFocus();}catch(_0x313f50){}}}function showConfirmModal(_0xffb187,_0x488999,_0x2331d1){const _0x113e63=_0x2deb62;$(_0x113e63(0x1de))['textContent']=_0xffb187;const _0x51092c=$(_0x113e63(0x39e));_0x51092c[_0x113e63(0x26a)]=_0x488999,_0x51092c[_0x113e63(0x362)][_0x113e63(0x223)](_0x113e63(0x3ea)),$(_0x113e63(0x270))['classList'][_0x113e63(0x33b)]('hidden'),$(_0x113e63(0x433))[_0x113e63(0x362)][_0x113e63(0x33b)](_0x113e63(0x286));try{trapFocus($(_0x113e63(0x433)));}catch(_0x5d4918){}const _0x378b5b=()=>{_0x2331d1(!![]),_0x8f4e68();},_0x15e2b4=()=>{_0x2331d1(![]),_0x8f4e68();};$('#btnGenericOk')[_0x113e63(0x17f)]=_0x378b5b,$(_0x113e63(0x229))[_0x113e63(0x17f)]=_0x15e2b4;function _0x8f4e68(){const _0x48b9aa=_0x113e63;$(_0x48b9aa(0x433))[_0x48b9aa(0x362)][_0x48b9aa(0x223)](_0x48b9aa(0x286)),$(_0x48b9aa(0x2e7))[_0x48b9aa(0x17f)]=null,$(_0x48b9aa(0x229))[_0x48b9aa(0x17f)]=null;try{releaseFocus();}catch(_0xaf24d3){}}}let pendingNoteSessionId=null;function openNoteModal(_0x3685ab){const _0x49f422=_0x2deb62;pendingNoteSessionId=_0x3685ab||null;const _0x29d4ba=$(_0x49f422(0x3a0));if(!_0x29d4ba)return;const _0x4231a4=$(_0x49f422(0x1aa));if(_0x4231a4)try{_0x4231a4[_0x49f422(0x1b9)]='';}catch(_0x75823b){}_0x29d4ba[_0x49f422(0x362)][_0x49f422(0x33b)](_0x49f422(0x286));try{trapFocus(_0x29d4ba);}catch(_0x26254e){}}function closeNoteModal(){const _0x1ca873=_0x2deb62,_0x3a928f=$('#modalNote');if(!_0x3a928f)return;_0x3a928f[_0x1ca873(0x362)]['remove'](_0x1ca873(0x286)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0xcde5c8){}}async function switchView(_0x2aad1e){const _0x1d565f=_0x2deb62;$$(_0x1d565f(0x16f))[_0x1d565f(0x19c)](_0x13feea=>_0x13feea['classList'][_0x1d565f(0x223)](_0x1d565f(0x30d))),$('#view-'+_0x2aad1e)[_0x1d565f(0x362)][_0x1d565f(0x33b)](_0x1d565f(0x30d)),$$('.nav-btn')[_0x1d565f(0x19c)](_0xd9311d=>_0xd9311d[_0x1d565f(0x362)][_0x1d565f(0x223)](_0x1d565f(0x30d)));const _0x398ae7=$('.nav-btn[data-view=\x22'+_0x2aad1e+'\x22]');if(_0x398ae7)_0x398ae7['classList'][_0x1d565f(0x33b)]('active');data['settings']['currentView']=_0x2aad1e,await saveData(),_0x2aad1e==='stats'&&renderDashboard();}function _0x5cb7(){const _0x1c967b=['btn\x20small\x20ghost\x20actions-menu-btn','https://www.youtube.com/iframe_api','isArray','#btnToggleBg','#genericMessage','#chatMessages','#modalNote','resolve','#btnSaveNote','initDB','longBreakIntervalB','#btnResume','Player','#btnSkipNote','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','then','en-US','<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>','play','now','PAUSED','destination','Gently\x20massage\x20your\x20temples.','Backup\x20failed:','clientX','test','#ytUrlFeedback','https://www.youtube.com','ArrowLeft','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22','bold','.json','#btnAddTopic','left','note','button','Backup\x20from:\x20','No\x20Subtopic\x20Selected','find','\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**✨\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**🚀\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]','#view-methods\x20.methods-container','Hide\x20interface','\x0a-\x20','objectStoreNames','<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>','#btnDashboard','expanded','4501546uyjrhw','</td></tr>','#methodEditorTitleInput','requestFullscreen','\x20(B)','<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you’re\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don’t\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>','long','#welcomePanel\x20p','.color-picker-wrapper','innerWidth','To\x20You,\x2050\x20Hours\x20(Momentum)','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','2663550cHfoKn','ytUrlFeedback','sort','body','cyclesA','#btnSummarizeNote','scrollTop','styleWithCSS','#btnClearBg','The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','no-subtopic-selected','transaction','var(--danger)','#audioLongEnd','Saved\x20alert\x20for\x20FOCUS.','customBg','POST','Add\x20subtopic','toggle','oncomplete','Send','hidden','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','Content\x20blocked\x20for:\x20','transition','#set_youtubeUrl','className','badge\x20state\x20break','#btnClearChat','Do\x20a\x20few\x20deep-breathing\x20cycles.','.app-content','methodId','start','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>','youtubeVolume','<ul>','6509196uMWtut','var(--acc-2)','#set_interval','linearRampToValueAtTime','Initialization\x20error:\x20','break_end','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','gain','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?','#chatInput','function','#btnHelpCreateTopic','B_long','update','AudioContext','\x20hours\x20','autoStartNext','To\x20You,\x201,000\x20Hours\x20(Transformation)','beep','#subtopicTasksList','badge\x20state\x20work','tasks','Count\x20down\x20slowly\x20from\x2020\x20to\x200.','<p>The\x20core\x20idea:\x20\x22If\x20you\x20can’t\x20explain\x20a\x20topic\x20simply,\x20you\x20don’t\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can’t\x20explain\x20smoothly,\x20you’ve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it’s\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool—pinpointing\x20exactly\x20where\x20you’re\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>','readwrite','auto','floor','href','beginWork','reverse','text','#selectedContext','slice','ArrowRight','Switched\x20to\x20Style\x20','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.','break','setPreset','<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20🧠</h4><p>Based\x20on\x20the\x20“Forgetting\x20Curve,”\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you’re\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you’ll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20📱</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20❌</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>—creating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010–20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory’s\x20“sweet\x20spot.”\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>','Escape','\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22','Have\x20a\x20sip\x20of\x20water.','pastel','removeEventListener','?\x20Current\x20data\x20will\x20be\x20overwritten.','#methodEditorTitle','To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','createElement','3QPOpAu','#timerPresetSelector\x20button','.method-item','Gemini\x20API\x20Error:','stroke','</li>','.sub-row','Edit','#btnMilestoneClose','#modalGeneric','onkeydown','closest','right','pauseVideo','text/plain','<div>','--bg-image','http','modalMethodEditor','To\x20You,\x2020\x20Hours\x20(Foundation)','#modalMilestone','wind_down','&amp;','cycleIndex','Summarize','#btnSummarize','Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.','#btnDefaults','#settings-flowtime','color','removeProperty','playVideo','.method-delete','Switch\x20to\x20Style\x20','padStart','#dashboardContent','long_end','.nav-btn[data-view]','getVolume','Custom\x20background\x20removed.','bg-view-mode','createdAt','New\x20Subtopic\x20name?','scrollHeight','stopVideo','Please\x20select\x20a\x20backup.','theme','flatMap','beginBreak','preset','currentConfig','No\x20notes\x20to\x20summarize.','onsuccess','\x20|\x20<strong>Total\x20sessions:</strong>\x20','contains','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203–5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20“Force\x20Multiplier”:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','innerHTML','#btnStart','#set_work','</p>','getFullYear','unshift','destroy','candidates','Confirm\x20Switch','load','\x20min\x20via\x20Flowtime\x20(','tasksCompleted','clear','open','cover','.tab-btn','bottom','objectStore','Check\x20and\x20correct\x20your\x20sitting\x20posture.','AI\x20finished\x20formatting!','setItem','https://www.youtube.com/embed/','Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22','revokeObjectURL','append','input,select,textarea','onerror','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','onYouTubeIframeAPIReady','currentDurations','#set_flowRatio','flowtimeBreakRatio','#set_backupDays','Ask\x20yourself:\x20‘How\x20do\x20I\x20feel\x20right\x20now?’','note-content','put','tickHandle','focus','.actions-menu.show','Content\x20required\x20for\x20AI\x20formatting.','getBackupList','sessions','application/json','READY','.view','backgroundMode','Add\x20note','prevState','unMute','removing','btn\x20small','#toolH4','<div\x20class=\x22spinner\x22></div>','AI\x20cannot\x20format\x20at\x20the\x20moment.','remaining','getMonth','Note\x20saved','ArrowUp','note-item','stop','onclick','<tr><td>','hours','option','width','exitFullscreen','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','interval','#set_autoStartNext','actions-menu','src','download','Playing','isCompleted','data','Background\x20music\x20stopped.','To\x20You,\x205,000+\x20Hours\x20(Legacy)','file','Chat\x20history\x20cleared.','dataset','&quot;','autoBackup','####\x20','Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.','summaries','.method-edit','A_short','timer.cycleInfo','soundTheme','forEach','Exit\x20fullscreen','#settings-pomodoro','toLocaleDateString','Saved\x20alert\x20for\x20LONG\x20BREAK.','var(--warn)','setAttribute','no-repeat','pomodoro_files','method-item','\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.','createObjectURL','default','SHORT\x20BREAK','#noteText','select','#set_long','reduce','BUFFERING','date','Tab','error','work','hist-item','https://img.youtube.com/vi/','role','acc','#set_enableSessionNotes','settings','value','#toolItalic','get','relative','Stand\x20up\x20and\x20stretch.','Please\x20select\x20a\x20subtopic\x20first.','.presets\x20button','exportData','#btnFullscreen','toString','Failed\x20to\x20delete\x20summary:','click','stringify','Error\x20saving\x20data:\x20','_getStore','Sound\x20has\x20been\x20enabled!','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>','(none\x20selected)','backups','paused','chime','Loosen\x20your\x20finger\x20joints\x20after\x20typing.','filter','warn','Five\x20focused\x20hours!\x20You’ve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','onupgradeneeded','#btnAddGeneralNote','foreColor','max','50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You’re\x20on\x20the\x20right\x20path—keep\x20going.','enableWinddown','execCommand','_onFinishSegment','ghost','#customSoundsContainer','getDate','soundOn','#genericTitle','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>','flex','#btnRestoreBackup','Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a','#milestoneTitle','timer.selectSubtopicPrompt','.aux-panel,\x20.modal-card','<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively—rather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later—once\x20you’ve\x20forgotten\x20the\x20original\x20style—use\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn’t\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses—turning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don’t\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>','catch','volume','location','#timeDisplay','backgroundImage','.\x20Please\x20try\x20again\x20with\x20different\x20content.','random','topic-actions','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','#set_backgroundMode','Use\x20AI\x20to\x20auto-format\x20text','parse','Unable\x20to\x20save\x20changes.','Confirm\x20Deletion','#draggableTimer','#importFile','target','collapsedTopics','#btnPresetB','#modalDashboard','<option\x20value=\x22\x22>No\x20backups\x20available</option>','#uploadSoundLong','type','sessionsCompleted','_sortable','absolute','File\x20save\x20error.','delete','querySelectorAll','PLAYING','querySelector','finishFlowSession','<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>','AutoBackup\x20error:','top','item','createOscillator','#backupList','toISOString','includes','&gt;','message','durations','subtopics','idle','Background\x20updated.','main_settings','preventDefault','exponentialRampToValueAtTime','Take\x20a\x20short\x20walk\x20around\x20the\x20room.','lang','#toolColor','img.youtube.com/vi/','activeElement','data:','Look\x20at\x20something\x20cute\x20or\x20uplifting.','indexOf','timer','clientY','round','remove','postMessage','/hqdefault.jpg','437206VyjVre','(Could\x20not\x20generate\x20summary)','generalNotes','#btnGenericCancel','getElementById','selectedSubtopicId','</ul>','startsWith','autoplay;\x20encrypted-media;\x20picture-in-picture','presetTarget','getIframe','#btnToggleYtSound','persistTimerState','protocol','.actions-menu','Please\x20select\x20a\x20Subtopic\x20first','command','toast','#btnCancelMethodEditor','btn\x20small\x20ghost\x20method-edit','tid','long_break','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','backupDaysToKeep','chat-msg\x20','Delete','Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren’t\x20just\x20time—they’re\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You’re\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.','subtopic','sum','btnToggleYtSound','#cycleInfo','isContentEditable','#btnPause','Error\x20calling\x20Gemini\x20API:','#audioBreakEnd','btn\x20small\x20danger\x20method-delete','localeCompare','reset','#statTotal','content','pause','.color-swatch','mute','#milestoneMessage','1VPvFlN','getBoundingClientRect','topic-header','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','💡\x20Suggestion:\x20','totalMinutes','#welcomePanel','Failed\x20to\x20save\x20data:','version','var(--muted)','offsetHeight','#btnAutoFormat','#btnSaveMethod','#btnSettings','/maxresdefault.jpg','\x20(A)','span','Gemini\x20error:\x20','json','#historyList','#newSubtopicTaskInput','string','Sortable','#btnFinishFlow','textContent','updateUI','Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You’ve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.','#btnCloseDashboard','setProperty','strokeDasharray','#genericInput','Error:\x20','durationMinutes','note-content-wrapper','documentElement','resume','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.','PomodoroAppDB','repeat','oldIndex','min','sess','5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‘How\x20do\x20I\x20focus?’\x20to\x20‘What\x20value\x20will\x20this\x20focus\x20create?’.\x20You’re\x20not\x20just\x20working—you’re\x20building\x20a\x20legacy.','#breakSuggestionDisplay','&lt;','#btnEnableSound','baseVal','undefined','all','getSettings','Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.','To\x20You,\x20250\x20Hours\x20(Perseverance)','show','light','setValueAtTime','--panel-opacity','pomodoro_backup_','</h4>','Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.','#set_theme_color','✨\x20Auto-format','contentWindow','summary_','origin','result','#btnCloseSettings','#btnBreakEarly','note-meta','isConnected','achievedMilestones','position','parts','__ytApiWatchdog','mousedown','#currentSubtopicName','Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.','map','.modal','#topicsList','.subtopics','setVolume','#toasts','Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.','useYtThumbnailAsBg','youtube-player-container','lofi','keydown','task','...','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','sub-row','connect','timerState','yt-fallback','Stand\x20up\x20and\x20take\x20a\x20few\x20steps.','🌊\x20Flow','topic-title','replace','#set_panelOpacity','files','0\x20min','file:','Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','none','soundPermissionBar','appendChild','panelOpacity','name','blob:','currentView','frequency','#modalSettings','work_end','unknown','segmentTotal','#uploadSoundBreak','model','#ytSoundVolume','#btnSkip','workMinutes','chev\x20btn\x20small\x20ghost','Edit\x20Knowledge','loadLanguage','finished','Great!\x20Time\x20for\x20a\x20long\x20break.','Subtopic:\x20','&#39;','#set_volume','title','promptFeedback','defer','toLowerCase','iframe','beforeunload','topics','apiKey','Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','parentElement','.color-palette','#btnPresetC','#set_apiKey','dateISO','subtopics-group','</label>','topicId','selectedTopicId','fullscreenElement','#btnGenericOk','pointerdown','from','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20its\x20Knowledge\x20Base.</p>','<ol>','url(','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','key','#uploadBg','length','Confirm\x20Restore','Enter','B_short','scroll','disabled','user','.topic-item.menu-active','cueVideoById','input','topic','customSounds','Fullscreen','summary','createIndex','#btnSaveSettings','style','Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','menu-item','updateSettings','Tidy\x20or\x20rearrange\x20your\x20workspace.','Missing\x20element','#modalMethodEditor','.timer-circle-container','#set_ytThumbAsBg','stats','stopPropagation','Loading\x20YouTube\x20API...','splice','active','\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22','More\x20options','</td><td>','Export','Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.','backgroundRepeat','#audioWorkEnd','readonly','shiftKey','change','getItem','Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.','#btnAddSubtopicTask','B_winddown','getAll','view','\x20|\x20<strong>Total\x20tasks:</strong>\x20','?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.','pomodoroData_v11','.actions-menu-btn','Playing\x20background\x20music...','</ol>','findIndex','cancel','Summary\x20failed.','aria-expanded','skip','timerState_','actions','Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.','#btnPresetA','Rename\x20Topic','breathing','sine','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.','.topic-item','isNaN','async','longBreakIntervalA','PlayerState','newIndex','statusText','sid','innerHeight','cleanupOldBackups','add','#set_winddown','Rename\x20Subtopic','lastBackupDate','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','italic','.tab-content','#statTasks','A_long','Notice\x20the\x20room’s\x20temperature\x20and\x20lighting.','code','insertUnorderedList','abs','methods','#set_cycles','reload','formatBlock','div','toLocaleString','A_work','#btnSendMessage','#set_enableWinddown','badge','Delete\x20Subtopic','sound_unlocked','#editorPreview','menu-active','log','push','#btnReset','selectionEnd','B_work','Data\x20restored\x20successfully!\x20Reloading...','A_winddown','var(--sub)','state','To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','Audio\x20playback\x20error:','</div>','classList','cyclesB','<h4>','enableSessionNotes','To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>','Untitled','menu-item\x20danger','<li>','currentTime','Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.','#uploadSoundWork','blockReason','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','674994FNpsFp','__ytApiPromise','mode','IndexedDB\x20initialized\x20successfully.','6262872DDZKbY','#set_theme','allow','3144652SbPvRL','status','http:','trim','#methodEditorContentInput','onload','cycles','createObjectStore','script','Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20','#statSessions','getPlayerState','Benjamin\x20Franklin’s\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','Invalid\x20file\x20format','checked','#methodEditorId','match','\x20·\x20','textarea','triangle','\x20hidden','#set_short','split','substring','display','chatHistory','offsetWidth','#toolBullet','short','btn\x20small\x20danger','Summary\x20deleted.','addEventListener','reloading','#windDownChecklist','_startTick'];_0x5cb7=function(){return _0x1c967b;};return _0x5cb7();}function closeAllMenus(){const _0x14f490=_0x2deb62;$$(_0x14f490(0x169))[_0x14f490(0x19c)](_0x316c77=>_0x316c77['classList']['remove'](_0x14f490(0x286))),$$(_0x14f490(0x2f7))['forEach'](_0x43c423=>_0x43c423['classList'][_0x14f490(0x223)]('menu-active'));}function renderTopics(){const _0x2612ae=_0x2deb62,_0x4fcbb0=$(_0x2612ae(0x2a0));if(!_0x4fcbb0)return;_0x4fcbb0[_0x2612ae(0x143)]='';const _0x36ba65=data[_0x2612ae(0x1b8)][_0x2612ae(0x1f8)]||{};data[_0x2612ae(0x2d9)]['forEach'](_0x554994=>{const _0x4ab34c=_0x2612ae,_0x3fe9f1=document[_0x4ab34c(0x429)](_0x4ab34c(0x34c));_0x3fe9f1[_0x4ab34c(0x3ef)]='topic-item',_0x3fe9f1['dataset'][_0x4ab34c(0x23a)]=_0x554994['id'];const _0x1fcfb3=document[_0x4ab34c(0x429)](_0x4ab34c(0x34c));_0x1fcfb3[_0x4ab34c(0x3ef)]=_0x4ab34c(0x254);const _0x185ce1=!!_0x36ba65[_0x554994['id']],_0x547dd1=document['createElement'](_0x4ab34c(0x3bd));_0x547dd1[_0x4ab34c(0x3ef)]=_0x4ab34c(0x2cb),_0x547dd1[_0x4ab34c(0x1a2)](_0x4ab34c(0x327),String(!_0x185ce1)),_0x547dd1['innerHTML']='<span\x20class=\x22ico\x22>▾</span>';const _0x320230=document[_0x4ab34c(0x429)](_0x4ab34c(0x34c));_0x320230[_0x4ab34c(0x3ef)]=_0x4ab34c(0x2b3),_0x320230[_0x4ab34c(0x26a)]=_0x554994[_0x4ab34c(0x2be)];const _0x5b89f6=document[_0x4ab34c(0x429)](_0x4ab34c(0x34c));_0x5b89f6['className']=_0x4ab34c(0x1ee);const _0x52997f=document[_0x4ab34c(0x429)](_0x4ab34c(0x3bd));_0x52997f['className']=_0x4ab34c(0x175),_0x52997f[_0x4ab34c(0x143)]='＋\x20Add',_0x52997f[_0x4ab34c(0x2d3)]=_0x4ab34c(0x3e6);const _0x4b8b8f=document['createElement']('div');_0x4b8b8f[_0x4ab34c(0x300)][_0x4ab34c(0x298)]=_0x4ab34c(0x1bc);const _0x2d1011=document['createElement']('button');_0x2d1011[_0x4ab34c(0x3ef)]=_0x4ab34c(0x39a),_0x2d1011[_0x4ab34c(0x143)]=_0x4ab34c(0x2ab),_0x2d1011['title']='More\x20options';const _0x1c2e0f=document[_0x4ab34c(0x429)](_0x4ab34c(0x34c));_0x1c2e0f[_0x4ab34c(0x3ef)]=_0x4ab34c(0x188);const _0x403958=document[_0x4ab34c(0x429)](_0x4ab34c(0x3bd));_0x403958[_0x4ab34c(0x3ef)]=_0x4ab34c(0x302),_0x403958['innerHTML']='Rename\x20Topic';const _0x455091=document['createElement'](_0x4ab34c(0x3bd));_0x455091[_0x4ab34c(0x3ef)]=_0x4ab34c(0x369),_0x455091[_0x4ab34c(0x143)]='Delete\x20Topic',_0x1c2e0f[_0x4ab34c(0x15b)](_0x403958,_0x455091),_0x4b8b8f[_0x4ab34c(0x15b)](_0x2d1011,_0x1c2e0f),_0x5b89f6[_0x4ab34c(0x15b)](_0x52997f,_0x4b8b8f),_0x1fcfb3['append'](_0x547dd1,_0x320230,_0x5b89f6),_0x547dd1[_0x4ab34c(0x396)]('click',async _0x3ba4c1=>{const _0x4a976d=_0x4ab34c;_0x3ba4c1[_0x4a976d(0x30a)]();const _0x2aa5ab=!!_0x36ba65[_0x554994['id']];_0x2aa5ab?delete _0x36ba65[_0x554994['id']]:_0x36ba65[_0x554994['id']]=!![],data[_0x4a976d(0x1b8)][_0x4a976d(0x1f8)]=_0x36ba65,await storageManager[_0x4a976d(0x303)](data[_0x4a976d(0x1b8)]),renderTopics();});const _0x234b3e=async()=>{const _0x583b94=_0x4ab34c,_0x3c434c=!!_0x36ba65[_0x554994['id']];_0x3c434c?delete _0x36ba65[_0x554994['id']]:_0x36ba65[_0x554994['id']]=!![],data[_0x583b94(0x1b8)]['collapsedTopics']=_0x36ba65,await storageManager[_0x583b94(0x303)](data[_0x583b94(0x1b8)]),renderTopics();};_0x1fcfb3['addEventListener'](_0x4ab34c(0x1c4),async _0x5c5f40=>{const _0x3d8a2f=_0x4ab34c,_0x4f2c37=_0x5c5f40[_0x3d8a2f(0x1f7)];if(_0x4f2c37&&_0x4f2c37[_0x3d8a2f(0x435)]){if(_0x4f2c37[_0x3d8a2f(0x435)](_0x3d8a2f(0x234))||_0x4f2c37[_0x3d8a2f(0x435)](_0x3d8a2f(0x321))||_0x4f2c37['closest']('button')||_0x4f2c37[_0x3d8a2f(0x435)](_0x3d8a2f(0x15c)))return;}_0x5c5f40['stopPropagation'](),await _0x234b3e();}),_0x320230[_0x4ab34c(0x396)](_0x4ab34c(0x1c4),async _0x5ca72e=>{const _0x3388b0=_0x4ab34c;_0x5ca72e[_0x3388b0(0x30a)](),await _0x234b3e();}),_0x3fe9f1[_0x4ab34c(0x396)](_0x4ab34c(0x1c4),async _0x3ae146=>{const _0x51fcbd=_0x4ab34c,_0x13e85a=_0x3ae146['target'];if(_0x13e85a&&_0x13e85a[_0x51fcbd(0x435)]){if(_0x13e85a[_0x51fcbd(0x435)](_0x51fcbd(0x2a1)))return;if(_0x13e85a[_0x51fcbd(0x435)]('.actions-menu')||_0x13e85a[_0x51fcbd(0x435)]('.actions-menu-btn')||_0x13e85a[_0x51fcbd(0x435)](_0x51fcbd(0x3bd))||_0x13e85a['closest'](_0x51fcbd(0x15c)))return;}await _0x234b3e();});const _0x57eedc=document[_0x4ab34c(0x429)](_0x4ab34c(0x34c));_0x57eedc[_0x4ab34c(0x3ef)]=_0x4ab34c(0x212)+(_0x185ce1?_0x4ab34c(0x38b):''),_0x57eedc[_0x4ab34c(0x192)][_0x4ab34c(0x23a)]=_0x554994['id'],_0x554994[_0x4ab34c(0x212)][_0x4ab34c(0x19c)](_0x51a225=>{const _0xc1c0f6=_0x4ab34c,_0x1a9fd3=document['createElement'](_0xc1c0f6(0x34c));_0x1a9fd3['className']=_0xc1c0f6(0x2ad),_0x1a9fd3[_0xc1c0f6(0x192)][_0xc1c0f6(0x338)]=_0x51a225['id'];const _0x8cfaf9=document[_0xc1c0f6(0x429)](_0xc1c0f6(0x3bd));_0x8cfaf9[_0xc1c0f6(0x3ef)]='btn\x20subtopic-btn',_0x8cfaf9[_0xc1c0f6(0x26a)]='•\x20'+_0x51a225['name'],_0x8cfaf9[_0xc1c0f6(0x192)][_0xc1c0f6(0x338)]=_0x51a225['id'],_0x8cfaf9[_0xc1c0f6(0x192)][_0xc1c0f6(0x23a)]=_0x554994['id'];if(data['settings'][_0xc1c0f6(0x22b)]===_0x51a225['id'])_0x8cfaf9['classList']['add'](_0xc1c0f6(0x30d));const _0x21e5cb=document['createElement'](_0xc1c0f6(0x34c));_0x21e5cb['className']=_0xc1c0f6(0x32a);const _0x4c439e=document[_0xc1c0f6(0x429)]('div');_0x4c439e[_0xc1c0f6(0x300)][_0xc1c0f6(0x298)]='relative';const _0x396fc6=document[_0xc1c0f6(0x429)](_0xc1c0f6(0x3bd));_0x396fc6[_0xc1c0f6(0x3ef)]='btn\x20small\x20ghost\x20actions-menu-btn',_0x396fc6[_0xc1c0f6(0x143)]='...',_0x396fc6[_0xc1c0f6(0x2d3)]=_0xc1c0f6(0x30f);const _0x2169f6=document[_0xc1c0f6(0x429)](_0xc1c0f6(0x34c));_0x2169f6[_0xc1c0f6(0x3ef)]=_0xc1c0f6(0x188);const _0x3f168d=document['createElement'](_0xc1c0f6(0x3bd));_0x3f168d[_0xc1c0f6(0x3ef)]=_0xc1c0f6(0x302),_0x3f168d[_0xc1c0f6(0x143)]=_0xc1c0f6(0x33d);const _0x4a4fae=document['createElement'](_0xc1c0f6(0x3bd));_0x4a4fae[_0xc1c0f6(0x3ef)]=_0xc1c0f6(0x369),_0x4a4fae[_0xc1c0f6(0x143)]=_0xc1c0f6(0x352),_0x2169f6[_0xc1c0f6(0x15b)](_0x3f168d,_0x4a4fae),_0x4c439e[_0xc1c0f6(0x15b)](_0x396fc6,_0x2169f6),_0x21e5cb[_0xc1c0f6(0x15b)](_0x4c439e),_0x1a9fd3[_0xc1c0f6(0x15b)](_0x8cfaf9,_0x21e5cb),_0x57eedc[_0xc1c0f6(0x2bc)](_0x1a9fd3),_0x8cfaf9[_0xc1c0f6(0x396)](_0xc1c0f6(0x1c4),()=>selectSubtopic(_0x554994['id'],_0x51a225['id'])),_0x396fc6['addEventListener'](_0xc1c0f6(0x1c4),_0x22e5b4=>{const _0x4098bf=_0xc1c0f6;_0x22e5b4[_0x4098bf(0x30a)]();const _0x24c31a=_0x2169f6['classList']['contains'](_0x4098bf(0x286));closeAllMenus(),_0x24c31a?_0x3fe9f1[_0x4098bf(0x362)][_0x4098bf(0x223)]('menu-active'):(_0x2169f6[_0x4098bf(0x362)][_0x4098bf(0x33b)]('show'),_0x3fe9f1['classList'][_0x4098bf(0x33b)](_0x4098bf(0x355)));}),_0x3f168d[_0xc1c0f6(0x396)](_0xc1c0f6(0x1c4),()=>showInputModal(_0xc1c0f6(0x33d),async _0x2c6949=>{const _0x5d7eff=_0xc1c0f6;if(!_0x2c6949)return;_0x51a225[_0x5d7eff(0x2be)]=_0x2c6949,await storageManager[_0x5d7eff(0x406)](_0x5d7eff(0x212),_0x51a225),renderAll();},_0x51a225['name'])),_0x4a4fae[_0xc1c0f6(0x396)](_0xc1c0f6(0x1c4),()=>showConfirmModal('Confirm\x20Deletion','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22'+_0x51a225[_0xc1c0f6(0x2be)]+_0xc1c0f6(0x1a6),async _0xa72698=>{const _0xd95137=_0xc1c0f6;if(!_0xa72698)return;_0x554994[_0xd95137(0x212)]=_0x554994[_0xd95137(0x212)]['filter'](_0xc69db5=>_0xc69db5['id']!==_0x51a225['id']);const _0x38f038=data[_0xd95137(0x1b8)];_0x38f038['selectedSubtopicId']===_0x51a225['id']&&(_0x38f038[_0xd95137(0x22b)]='',_0x38f038[_0xd95137(0x2e5)]='',ensureValidSelection()),await storageManager[_0xd95137(0x202)](_0xd95137(0x212),_0x51a225['id']),renderAll();}));}),_0x2d1011[_0x4ab34c(0x396)](_0x4ab34c(0x1c4),_0x2d1fcc=>{const _0x486220=_0x4ab34c;_0x2d1fcc[_0x486220(0x30a)]();const _0x32ce5f=_0x1c2e0f[_0x486220(0x362)]['contains'](_0x486220(0x286));closeAllMenus(),_0x32ce5f?_0x3fe9f1[_0x486220(0x362)][_0x486220(0x223)](_0x486220(0x355)):(_0x1c2e0f['classList'][_0x486220(0x33b)](_0x486220(0x286)),_0x3fe9f1[_0x486220(0x362)][_0x486220(0x33b)](_0x486220(0x355)));}),_0x52997f[_0x4ab34c(0x396)](_0x4ab34c(0x1c4),()=>showInputModal(_0x4ab34c(0x454),async _0x3f5ba8=>{const _0x52fa42=_0x4ab34c;if(!_0x3f5ba8)return;const _0x560677={'id':uid('s'),'topicId':_0x554994['id'],'name':_0x3f5ba8,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':'idle','prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};try{const _0xbf551b=data?.[_0x52fa42(0x1b8)]?.[_0x52fa42(0x348)]||[];Array[_0x52fa42(0x39c)](_0xbf551b)&&_0xbf551b[_0x52fa42(0x2f0)]>0x0&&(_0x560677[_0x52fa42(0x348)]=_0xbf551b,data['settings'][_0x52fa42(0x348)]=[],await storageManager[_0x52fa42(0x303)](data['settings']));}catch(_0x5d62c4){}_0x554994['subtopics'][_0x52fa42(0x357)](_0x560677),await storageManager['add'](_0x52fa42(0x212),_0x560677),renderTopics();})),_0x403958[_0x4ab34c(0x396)](_0x4ab34c(0x1c4),()=>showInputModal(_0x4ab34c(0x32d),async _0x236ce9=>{const _0x99d8f2=_0x4ab34c;if(!_0x236ce9)return;_0x554994[_0x99d8f2(0x2be)]=_0x236ce9,await storageManager[_0x99d8f2(0x406)](_0x99d8f2(0x2d9),_0x554994),renderTopics();},_0x554994['name'])),_0x455091[_0x4ab34c(0x396)](_0x4ab34c(0x1c4),()=>showConfirmModal(_0x4ab34c(0x1f4),_0x4ab34c(0x3b7)+_0x554994[_0x4ab34c(0x2be)]+'\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.',async _0x4a3788=>{const _0x184547=_0x4ab34c;if(!_0x4a3788)return;data[_0x184547(0x2d9)]=data[_0x184547(0x2d9)][_0x184547(0x1cf)](_0x2f02c2=>_0x2f02c2['id']!==_0x554994['id']),delete _0x36ba65[_0x554994['id']];data[_0x184547(0x1b8)][_0x184547(0x2e5)]===_0x554994['id']&&(data[_0x184547(0x1b8)][_0x184547(0x2e5)]='',data[_0x184547(0x1b8)][_0x184547(0x22b)]='',ensureValidSelection());await storageManager['delete']('topics',_0x554994['id']);for(const _0xc1e964 of _0x554994[_0x184547(0x212)]){await storageManager[_0x184547(0x202)]('subtopics',_0xc1e964['id']);}renderAll();})),_0x52997f[_0x4ab34c(0x396)]('click',_0x4b789d=>_0x4b789d[_0x4ab34c(0x30a)]()),_0x403958[_0x4ab34c(0x396)](_0x4ab34c(0x1c4),_0x252076=>_0x252076['stopPropagation']()),_0x455091['addEventListener'](_0x4ab34c(0x1c4),_0x41c278=>_0x41c278['stopPropagation']()),_0x3fe9f1[_0x4ab34c(0x15b)](_0x1fcfb3,_0x57eedc),_0x4fcbb0[_0x4ab34c(0x2bc)](_0x3fe9f1);});if(window[_0x2612ae(0x268)]){const _0x30b77e=document[_0x2612ae(0x22a)]('topicsList');if(_0x30b77e){if(_0x30b77e[_0x2612ae(0x1ff)])try{_0x30b77e['_sortable'][_0x2612ae(0x149)]();}catch(_0x290437){}_0x30b77e[_0x2612ae(0x1ff)]=new Sortable(_0x30b77e,{'animation':0x96,'draggable':_0x2612ae(0x331),'onEnd':async function(_0x1829cf){const _0x35b52e=_0x2612ae;if(_0x1829cf[_0x35b52e(0x279)]===_0x1829cf['newIndex'])return;const _0x2b6c5f=data[_0x35b52e(0x2d9)][_0x35b52e(0x30c)](_0x1829cf[_0x35b52e(0x279)],0x1)[0x0];data[_0x35b52e(0x2d9)][_0x35b52e(0x30c)](_0x1829cf['newIndex'],0x0,_0x2b6c5f),await saveData(),renderTopics();}}),_0x30b77e[_0x2612ae(0x203)]('.subtopics')['forEach'](_0x24fdde=>{const _0x4611c5=_0x2612ae;new Sortable(_0x24fdde,{'group':_0x4611c5(0x2e2),'animation':0x96,'draggable':_0x4611c5(0x430),'onEnd':async function(_0xc40e4f){const _0x7986b2=_0x4611c5,_0x3950cf=_0xc40e4f['from']?.[_0x7986b2(0x192)]?.[_0x7986b2(0x23a)]||_0xc40e4f[_0x7986b2(0x2e9)]?.['closest'](_0x7986b2(0x331))?.[_0x7986b2(0x192)]?.[_0x7986b2(0x23a)],_0x4e84de=_0xc40e4f['to']?.[_0x7986b2(0x192)]?.[_0x7986b2(0x23a)]||_0xc40e4f['to']?.[_0x7986b2(0x435)](_0x7986b2(0x331))?.[_0x7986b2(0x192)]?.['tid'],_0x39cff0=data['topics']['find'](_0x152060=>_0x152060['id']===_0x3950cf),_0x34ca7a=data[_0x7986b2(0x2d9)]['find'](_0x14f7ed=>_0x14f7ed['id']===_0x4e84de);if(!_0x39cff0||!_0x34ca7a)return;let _0x15b9b1=null;const _0x1d4aab=_0xc40e4f[_0x7986b2(0x20a)]?.['dataset']?.['sid']||_0xc40e4f[_0x7986b2(0x20a)]?.['querySelector']('.subtopic-btn')?.[_0x7986b2(0x192)]?.[_0x7986b2(0x338)];if(_0x1d4aab){const _0x18e92e=_0x39cff0[_0x7986b2(0x212)]['findIndex'](_0x56be20=>_0x56be20['id']===_0x1d4aab);if(_0x18e92e>=0x0)_0x15b9b1=_0x39cff0['subtopics'][_0x7986b2(0x30c)](_0x18e92e,0x1)[0x0];}!_0x15b9b1&&(_0x15b9b1=_0x39cff0[_0x7986b2(0x212)][_0x7986b2(0x30c)](_0xc40e4f[_0x7986b2(0x279)],0x1)[0x0]);if(!_0x15b9b1)return;_0x15b9b1[_0x7986b2(0x2e4)]=_0x34ca7a['id'],_0x34ca7a[_0x7986b2(0x212)][_0x7986b2(0x30c)](_0xc40e4f[_0x7986b2(0x336)],0x0,_0x15b9b1),data[_0x7986b2(0x1b8)][_0x7986b2(0x22b)]===_0x15b9b1['id']&&(data[_0x7986b2(0x1b8)][_0x7986b2(0x2e5)]=_0x34ca7a['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x11608f,_0x2f88a9){const _0x32f5a6=_0x2deb62,_0x365f7b=$('.app-content'),_0x3d2fb2=getCurrentSubtopic();_0x3d2fb2&&timer[_0x32f5a6(0x35e)]!==_0x32f5a6(0x213)&&(_0x3d2fb2[_0x32f5a6(0x2af)]={'state':timer[_0x32f5a6(0x35e)],'prevState':timer['prevState'],'remaining':timer[_0x32f5a6(0x179)],'segmentTotal':timer['segmentTotal'],'cycleIndex':timer[_0x32f5a6(0x441)]}),_0x365f7b[_0x32f5a6(0x362)]['add'](_0x32f5a6(0x397)),setTimeout(async()=>{const _0x39c494=_0x32f5a6;data[_0x39c494(0x1b8)][_0x39c494(0x2e5)]=_0x11608f,data[_0x39c494(0x1b8)][_0x39c494(0x22b)]=_0x2f88a9;const _0x14fbf6=getCurrentSubtopic();_0x14fbf6[_0x39c494(0x2af)]?(timer[_0x39c494(0x35e)]=_0x14fbf6[_0x39c494(0x2af)][_0x39c494(0x35e)],timer[_0x39c494(0x172)]=_0x14fbf6[_0x39c494(0x2af)][_0x39c494(0x172)]||null,timer['remaining']=_0x14fbf6['timerState'][_0x39c494(0x179)],timer[_0x39c494(0x2c5)]=_0x14fbf6[_0x39c494(0x2af)][_0x39c494(0x2c5)],timer[_0x39c494(0x441)]=_0x14fbf6[_0x39c494(0x2af)]['cycleIndex']):timer['reset'](),await saveData(),timer[_0x39c494(0x26b)](),renderAll(),switchView(_0x39c494(0x220)),_0x365f7b['classList'][_0x39c494(0x223)](_0x39c494(0x397));},0xc8);}function getCurrentSubtopic(){const _0x5c1dcd=_0x2deb62,_0x25cd6e=data[_0x5c1dcd(0x1b8)][_0x5c1dcd(0x2e5)],_0x371af3=data['settings'][_0x5c1dcd(0x22b)];if(!_0x25cd6e||!_0x371af3)return null;const _0x2e7853=data[_0x5c1dcd(0x2d9)][_0x5c1dcd(0x3c0)](_0x31a0c8=>_0x31a0c8['id']===_0x25cd6e);if(!_0x2e7853)return null;return _0x2e7853[_0x5c1dcd(0x212)][_0x5c1dcd(0x3c0)](_0x2557d9=>_0x2557d9['id']===_0x371af3)||null;}function renderContextBadge(){const _0x355fe4=_0x2deb62,_0xbdbe7f=getCurrentSubtopic(),_0x1236f5=_0xbdbe7f?_0xbdbe7f[_0x355fe4(0x2be)]:_0x355fe4(0x1ca),_0x32b50a=$(_0x355fe4(0x418)),_0x4a2033=$(_0x355fe4(0x29c)),_0x16a90e=$('#currentSubtopicNameChat');if(_0x32b50a)_0x32b50a['textContent']=_0xbdbe7f?_0x355fe4(0x2d0)+_0xbdbe7f[_0x355fe4(0x2be)]:_0x355fe4(0x3bf);if(_0x4a2033)_0x4a2033[_0x355fe4(0x26a)]=_0x1236f5;if(_0x16a90e)_0x16a90e[_0x355fe4(0x26a)]=_0x1236f5;}function renderSubtopicTasks(){const _0x2dac04=_0x2deb62,_0x436317=getCurrentSubtopic(),_0x59b976=$(_0x2dac04(0x40c)),_0x59c662=$(_0x2dac04(0x266));if(!_0x59b976||!_0x59c662)return;const _0x144fd4=_0x59c662[_0x2dac04(0x2dd)];if(!_0x436317){_0x59b976[_0x2dac04(0x143)]=_0x2dac04(0x1df),_0x144fd4[_0x2dac04(0x362)][_0x2dac04(0x33b)]('hidden');return;}_0x144fd4[_0x2dac04(0x362)][_0x2dac04(0x223)](_0x2dac04(0x3ea)),_0x59b976[_0x2dac04(0x143)]='';const _0x6c9cf0=_0x436317[_0x2dac04(0x40e)]?_0x436317[_0x2dac04(0x40e)][_0x2dac04(0x1cf)](_0x4ce3b6=>!_0x4ce3b6[_0x2dac04(0x18c)]):[];_0x6c9cf0['length']===0x0&&(_0x59b976['innerHTML']=_0x2dac04(0x367)),_0x6c9cf0[_0x2dac04(0x19c)](_0x51e24f=>{const _0x3310ed=_0x2dac04,_0x1de1c5=document[_0x3310ed(0x429)]('li');_0x1de1c5[_0x3310ed(0x143)]='<input\x20type=\x22checkbox\x22\x20id=\x22'+_0x51e24f['id']+_0x3310ed(0x422)+_0x51e24f['id']+'\x22>'+escapeHTML(_0x51e24f[_0x3310ed(0x417)])+_0x3310ed(0x2e3),_0x1de1c5[_0x3310ed(0x205)]('input')[_0x3310ed(0x396)](_0x3310ed(0x317),_0x1687e3=>toggleSubtopicTask(_0x1687e3[_0x3310ed(0x1f7)]['id'],_0x1de1c5)),_0x59b976[_0x3310ed(0x2bc)](_0x1de1c5);});}async function addSubtopicTask(){const _0x1caf2f=_0x2deb62,_0x279a0e=getCurrentSubtopic();if(!_0x279a0e){toast(t(_0x1caf2f(0x1e4)));return;}const _0x3866e3=$(_0x1caf2f(0x266)),_0x201143=_0x3866e3[_0x1caf2f(0x1b9)]['trim']();if(_0x201143){if(!_0x279a0e[_0x1caf2f(0x40e)])_0x279a0e[_0x1caf2f(0x40e)]=[];_0x279a0e['tasks']['push']({'id':uid(_0x1caf2f(0x2aa)),'text':_0x201143,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x3866e3[_0x1caf2f(0x1b9)]='';}_0x3866e3[_0x1caf2f(0x168)]();}async function toggleSubtopicTask(_0x589036,_0x34e1c3){const _0x423033=_0x2deb62,_0x593138=getCurrentSubtopic();if(!_0x593138||!_0x593138[_0x423033(0x40e)])return;const _0x3097e5=_0x593138[_0x423033(0x40e)][_0x423033(0x3c0)](_0x21669a=>_0x21669a['id']===_0x589036);_0x3097e5&&(_0x3097e5[_0x423033(0x18c)]=!![],_0x593138[_0x423033(0x309)]['tasksCompleted']=(_0x593138['stats'][_0x423033(0x14e)]||0x0)+0x1,await saveData(),_0x34e1c3[_0x423033(0x362)][_0x423033(0x33b)](_0x423033(0x174)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':_0x2deb62(0x213),'prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x50da7c,{silent:silent=![]}={}){const _0x4817d7=_0x2deb62,_0xd82a46=data[_0x4817d7(0x1b8)];this['mode']=_0x50da7c,this['cyclesTarget']=_0x50da7c==='A'?_0xd82a46[_0x4817d7(0x3d9)]:_0x50da7c==='B'?_0xd82a46[_0x4817d7(0x363)]:0x0,_0xd82a46['preset']=_0x50da7c,await saveData(),this[_0x4817d7(0x35e)]===_0x4817d7(0x213)&&this[_0x4817d7(0x24b)]();},'currentDurations'(){const _0x42e9eb=_0x2deb62,_0x39f054=data[_0x42e9eb(0x1b8)][_0x42e9eb(0x211)];if(this[_0x42e9eb(0x372)]==='A')return{'work':_0x39f054[_0x42e9eb(0x34e)],'short':_0x39f054['A_short'],'long':_0x39f054[_0x42e9eb(0x343)],'winddown':_0x39f054[_0x42e9eb(0x35c)]??0x0};if(this[_0x42e9eb(0x372)]==='B')return{'work':_0x39f054[_0x42e9eb(0x35a)],'short':_0x39f054[_0x42e9eb(0x2f3)],'long':_0x39f054[_0x42e9eb(0x405)],'winddown':_0x39f054[_0x42e9eb(0x31b)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x18f557=_0x2deb62,_0x563f20=data[_0x18f557(0x1b8)];if(this[_0x18f557(0x372)]==='A')return{'cycles':_0x563f20[_0x18f557(0x3d9)],'interval':_0x563f20[_0x18f557(0x334)]};if(this[_0x18f557(0x372)]==='B')return{'cycles':_0x563f20[_0x18f557(0x363)],'interval':_0x563f20[_0x18f557(0x3a4)]};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x4859a4=_0x2deb62,_0x4d5e9f=$('#stateBadge'),_0x2e02df=$('.timer-circle-progress'),_0x186925=$(_0x4859a4(0x307));if(!_0x4d5e9f||!_0x2e02df||!_0x186925)return;const _0x1b6e30=this['mode']==='C';$(_0x4859a4(0x144))[_0x4859a4(0x362)][_0x4859a4(0x3e7)](_0x4859a4(0x3ea),this[_0x4859a4(0x35e)]!==_0x4859a4(0x213)||_0x1b6e30&&this[_0x4859a4(0x35e)]===_0x4859a4(0x1b2)),$(_0x4859a4(0x269))[_0x4859a4(0x362)]['toggle'](_0x4859a4(0x3ea),!(_0x1b6e30&&this['state']===_0x4859a4(0x1b2))),$(_0x4859a4(0x246))['classList']['toggle'](_0x4859a4(0x3ea),![_0x4859a4(0x1b2),_0x4859a4(0x41e),_0x4859a4(0x23b)][_0x4859a4(0x20e)](this[_0x4859a4(0x35e)])),$(_0x4859a4(0x3a5))[_0x4859a4(0x362)]['toggle']('hidden',this[_0x4859a4(0x35e)]!==_0x4859a4(0x1cc));let _0xa8e029=_0x4859a4(0x25b);if(this[_0x4859a4(0x35e)]===_0x4859a4(0x1b2))_0x4d5e9f[_0x4859a4(0x26a)]=_0x1b6e30?'FOCUS\x20(FLOW)':'FOCUS',_0x4d5e9f[_0x4859a4(0x3ef)]=_0x4859a4(0x40d),_0xa8e029='var(--acc)';else{if(this[_0x4859a4(0x35e)]==='break')_0x4d5e9f[_0x4859a4(0x26a)]=_0x4859a4(0x1a9),_0x4d5e9f[_0x4859a4(0x3ef)]=_0x4859a4(0x3f0),_0xa8e029=_0x4859a4(0x1a1);else{if(this['state']===_0x4859a4(0x23b))_0x4d5e9f[_0x4859a4(0x26a)]='LONG\x20BREAK',_0x4d5e9f[_0x4859a4(0x3ef)]='badge\x20state\x20long',_0xa8e029=_0x4859a4(0x3e1);else{if(this[_0x4859a4(0x35e)]===_0x4859a4(0x43f)){_0x4d5e9f[_0x4859a4(0x26a)]='WIND-DOWN',_0x4d5e9f[_0x4859a4(0x3ef)]=_0x4859a4(0x40d),_0xa8e029=_0x4859a4(0x3fa);try{$(_0x4859a4(0x398))[_0x4859a4(0x362)][_0x4859a4(0x223)](_0x4859a4(0x3ea)),$('#btnBreakEarly')[_0x4859a4(0x362)][_0x4859a4(0x223)]('hidden');}catch(_0x4551be){}}else this['state']===_0x4859a4(0x1cc)?(_0x4d5e9f['textContent']=_0x4859a4(0x3ae),_0x4d5e9f[_0x4859a4(0x3ef)]='badge'):(_0x4d5e9f[_0x4859a4(0x26a)]=_0x4859a4(0x16e),_0x4d5e9f[_0x4859a4(0x3ef)]=_0x4859a4(0x351));}}}[_0x4859a4(0x1b2),_0x4859a4(0x41e),_0x4859a4(0x23b),_0x4859a4(0x43f)]['includes'](this[_0x4859a4(0x35e)])?_0x186925[_0x4859a4(0x362)][_0x4859a4(0x33b)](_0x4859a4(0x32e)):_0x186925[_0x4859a4(0x362)]['remove'](_0x4859a4(0x32e));_0x2e02df[_0x4859a4(0x300)][_0x4859a4(0x42e)]=_0xa8e029,_0x186925[_0x4859a4(0x362)][_0x4859a4(0x223)](_0x4859a4(0x2ce));const _0x1917aa=$(_0x4859a4(0x1ea));if(_0x1917aa)_0x1917aa[_0x4859a4(0x26a)]=formatMMSS(this['remaining']);const _0x366e06=_0x2e02df['r'][_0x4859a4(0x280)][_0x4859a4(0x1b9)],_0x530cd7=0x2*Math['PI']*_0x366e06,_0x5ac6fc=this['segmentTotal']>0x0?_0x530cd7-this[_0x4859a4(0x179)]/this['segmentTotal']*_0x530cd7:_0x530cd7;_0x2e02df[_0x4859a4(0x300)][_0x4859a4(0x26f)]=_0x530cd7,_0x2e02df['style']['strokeDashoffset']=isNaN(_0x5ac6fc)?_0x530cd7:_0x5ac6fc;const _0x528c05=$(_0x4859a4(0x244));if(_0x528c05){const _0x12e7e8=this['currentConfig']();_0x528c05[_0x4859a4(0x26a)]=t(_0x4859a4(0x19a),{'current':this[_0x4859a4(0x441)],'target':_0x12e7e8[_0x4859a4(0x37d)]}),_0x528c05[_0x4859a4(0x362)][_0x4859a4(0x3e7)](_0x4859a4(0x3ea),_0x1b6e30);}const _0x12d3ce=$(_0x4859a4(0x27d));_0x12d3ce&&_0x12d3ce[_0x4859a4(0x362)][_0x4859a4(0x3e7)](_0x4859a4(0x3ea),_0x1b6e30&&this[_0x4859a4(0x35e)]==='work');const _0x18b451=$('#draggableTimer');if(_0x18b451)_0x18b451[_0x4859a4(0x26a)]=formatMMSS(this[_0x4859a4(0x179)]);if(this[_0x4859a4(0x35e)]!=='wind_down')try{$(_0x4859a4(0x398))[_0x4859a4(0x362)][_0x4859a4(0x33b)](_0x4859a4(0x3ea)),$(_0x4859a4(0x294))[_0x4859a4(0x362)][_0x4859a4(0x33b)](_0x4859a4(0x3ea));}catch(_0x250714){}},'persistTimerState'(_0x1768be=![]){const _0x3e551a=_0x2deb62;try{const _0x53214a=getCurrentSubtopic();if(!_0x53214a)return;const _0x2cc145={'state':this[_0x3e551a(0x35e)],'prevState':this[_0x3e551a(0x172)],'remaining':this[_0x3e551a(0x179)],'segmentTotal':this[_0x3e551a(0x2c5)],'cycleIndex':this['cycleIndex']};_0x53214a[_0x3e551a(0x2af)]=_0x2cc145;try{localStorage['setItem'](_0x3e551a(0x329)+_0x53214a['id'],JSON[_0x3e551a(0x1c5)](_0x2cc145));}catch(_0x39bba1){}this['lastPersist']=Date[_0x3e551a(0x3ad)]();}catch(_0x23fb47){}},'_startTick'(){const _0x30e665=_0x2deb62;if(this['tickHandle'])clearInterval(this[_0x30e665(0x167)]);if(this[_0x30e665(0x372)]==='C'&&this['state']===_0x30e665(0x1b2)){this[_0x30e665(0x167)]=setInterval(()=>{const _0x3e6f53=_0x30e665;this[_0x3e6f53(0x179)]+=0x1,this[_0x3e6f53(0x26b)](),this[_0x3e6f53(0x232)]();},0x3e8);return;}this[_0x30e665(0x167)]=setInterval(()=>{const _0x2437e6=_0x30e665;this['remaining']>0x0&&(this[_0x2437e6(0x179)]-=0x1,this[_0x2437e6(0x26b)](),this[_0x2437e6(0x232)]()),this['remaining']<=0x0&&(clearInterval(this[_0x2437e6(0x167)]),this['tickHandle']=null,this[_0x2437e6(0x1d9)]());},0x3e8);},'_onFinishSegment'(){const _0x50f2a7=_0x2deb62;if(this[_0x50f2a7(0x35e)]===_0x50f2a7(0x1b2)){const _0x3a6a2f=getCurrentSubtopic();if(_0x3a6a2f){const _0x39a95f=this[_0x50f2a7(0x160)]()[_0x50f2a7(0x1b2)];_0x3a6a2f['stats'][_0x50f2a7(0x257)]=(_0x3a6a2f[_0x50f2a7(0x309)][_0x50f2a7(0x257)]||0x0)+_0x39a95f,_0x3a6a2f[_0x50f2a7(0x309)][_0x50f2a7(0x1fe)]=(_0x3a6a2f[_0x50f2a7(0x309)][_0x50f2a7(0x1fe)]||0x0)+0x1;const _0x3ea2df={'id':uid(_0x50f2a7(0x27b)),'dateISO':todayISO(),'durationMinutes':_0x39a95f,'mode':this[_0x50f2a7(0x372)],'note':''};if(!_0x3a6a2f[_0x50f2a7(0x16c)])_0x3a6a2f['sessions']=[];_0x3a6a2f[_0x50f2a7(0x16c)][_0x50f2a7(0x148)](_0x3ea2df);if(data?.[_0x50f2a7(0x1b8)]?.['enableSessionNotes'])try{openNoteModal(_0x3ea2df['id']);}catch(_0x568117){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0x50f2a7(0x441)]++;}if(typeof data!==_0x50f2a7(0x281)&&data&&data[_0x50f2a7(0x1b8)]&&data['settings']['enableWinddown']===![]&&this[_0x50f2a7(0x35e)]===_0x50f2a7(0x1b2))playSound('work_end');else(this[_0x50f2a7(0x35e)]===_0x50f2a7(0x43f)||this[_0x50f2a7(0x35e)]===_0x50f2a7(0x41e)||this['state']===_0x50f2a7(0x23b))&&playSound('break_end');const _0x1d8fd0=$(_0x50f2a7(0x307));if(_0x1d8fd0)_0x1d8fd0[_0x50f2a7(0x362)]['add']('finished');if(data[_0x50f2a7(0x1b8)][_0x50f2a7(0x409)]){if(this['state']===_0x50f2a7(0x1b2))data['settings'][_0x50f2a7(0x1d7)]===![]?this[_0x50f2a7(0x13b)]():this['beginWindDown']();else this['state']===_0x50f2a7(0x43f)?this['beginBreak']():this['beginWork']();}else this['tickHandle']&&(clearInterval(this[_0x50f2a7(0x167)]),this['tickHandle']=null),this[_0x50f2a7(0x35e)]=_0x50f2a7(0x213),this['prevState']=null,this[_0x50f2a7(0x26b)](),toast(_0x50f2a7(0x29d));},'beginWindDown'(){const _0x3c6ec5=_0x2deb62;if(data?.[_0x3c6ec5(0x1b8)]?.[_0x3c6ec5(0x1d7)]===![]){this['beginBreak']();return;}this['prevState']=this[_0x3c6ec5(0x35e)],this[_0x3c6ec5(0x35e)]='wind_down';const _0x589f88=(this[_0x3c6ec5(0x160)]()['winddown']||0x0)*0x3c;if(_0x589f88<=0x0){this[_0x3c6ec5(0x13b)]();return;}this['segmentTotal']=_0x589f88,this['remaining']=_0x589f88;try{playSound(_0x3c6ec5(0x3fe));}catch(_0x223c05){}try{toast('Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.');}catch(_0x2b91a0){}this[_0x3c6ec5(0x399)](),this[_0x3c6ec5(0x26b)]();},'beginWork'(){const _0x153b68=_0x2deb62;this[_0x153b68(0x172)]=this[_0x153b68(0x35e)],this[_0x153b68(0x35e)]='work';if(this[_0x153b68(0x372)]==='C'){this[_0x153b68(0x2c5)]=0x0;if(this[_0x153b68(0x172)]!==_0x153b68(0x1cc))this[_0x153b68(0x179)]=0x0;}else{const _0x44eb67=this[_0x153b68(0x160)]()['work']*0x3c;this['segmentTotal']=_0x44eb67;if(this['prevState']!==_0x153b68(0x1cc))this[_0x153b68(0x179)]=_0x44eb67;}const _0x16fb1e=$(_0x153b68(0x27d));_0x16fb1e&&(_0x16fb1e[_0x153b68(0x26a)]=''),this[_0x153b68(0x399)](),this[_0x153b68(0x26b)]();},'finishFlowSession'(){const _0x89b4c9=_0x2deb62;if(this['mode']!=='C'||this[_0x89b4c9(0x35e)]!==_0x89b4c9(0x1b2))return;this[_0x89b4c9(0x167)]&&(clearInterval(this[_0x89b4c9(0x167)]),this[_0x89b4c9(0x167)]=null);const _0x3c936c=Math[_0x89b4c9(0x1d5)](0x1,parseInt(data[_0x89b4c9(0x1b8)][_0x89b4c9(0x162)]??0x5,0xa)),_0x220ce9=Math[_0x89b4c9(0x1d5)](0x0,this[_0x89b4c9(0x179)]|0x0),_0x5b1679=Math[_0x89b4c9(0x1d5)](0x3c,Math[_0x89b4c9(0x413)](_0x220ce9/_0x3c936c));try{const _0x33a1bb=getCurrentSubtopic();if(_0x33a1bb){const _0x1b7d98=Math[_0x89b4c9(0x1d5)](0x1,Math[_0x89b4c9(0x222)](_0x220ce9/0x3c));_0x33a1bb['stats'][_0x89b4c9(0x257)]=(_0x33a1bb[_0x89b4c9(0x309)][_0x89b4c9(0x257)]||0x0)+_0x1b7d98,_0x33a1bb[_0x89b4c9(0x309)]['sessionsCompleted']=(_0x33a1bb[_0x89b4c9(0x309)][_0x89b4c9(0x1fe)]||0x0)+0x1;const _0x269914={'id':uid(_0x89b4c9(0x27b)),'dateISO':todayISO(),'durationMinutes':_0x1b7d98,'mode':this['mode'],'note':''};if(!_0x33a1bb[_0x89b4c9(0x16c)])_0x33a1bb[_0x89b4c9(0x16c)]=[];_0x33a1bb['sessions'][_0x89b4c9(0x148)](_0x269914),saveData(),renderStatsHistory(),data?.[_0x89b4c9(0x1b8)]?.[_0x89b4c9(0x365)]&&openNoteModal(_0x269914['id']);}}catch(_0xe34100){}this[_0x89b4c9(0x35e)]=_0x89b4c9(0x41e),this['segmentTotal']=_0x5b1679,this['remaining']=_0x5b1679,this['_startTick'](),this[_0x89b4c9(0x26b)](),this[_0x89b4c9(0x232)](!![]);try{toast('Break\x20'+Math[_0x89b4c9(0x222)](_0x5b1679/0x3c)+_0x89b4c9(0x14d)+_0x3c936c+').');}catch(_0x29dcb4){}},'beginBreak'(){const _0x15e1c9=_0x2deb62;this[_0x15e1c9(0x172)]=this['state'];const _0x3324a1=this[_0x15e1c9(0x13d)](),_0x5a2307=this[_0x15e1c9(0x160)]();if(this[_0x15e1c9(0x441)]>0x0&&this['cycleIndex']%_0x3324a1[_0x15e1c9(0x186)]===0x0){this['state']='long_break';const _0x1abd0f=_0x5a2307[_0x15e1c9(0x3cf)]*0x3c;this[_0x15e1c9(0x2c5)]=_0x1abd0f;if(this['prevState']!=='paused')this[_0x15e1c9(0x179)]=_0x1abd0f;toast(_0x15e1c9(0x2cf));}else{this['state']='break';const _0xa5ab8b=_0x5a2307[_0x15e1c9(0x393)]*0x3c;this[_0x15e1c9(0x2c5)]=_0xa5ab8b;if(this['prevState']!==_0x15e1c9(0x1cc))this[_0x15e1c9(0x179)]=_0xa5ab8b;}const _0x3d62d2=$('#breakSuggestionDisplay');if(_0x3d62d2){const _0x28216e=Math[_0x15e1c9(0x413)](Math[_0x15e1c9(0x1ed)]()*breakSuggestions[_0x15e1c9(0x2f0)]);_0x3d62d2[_0x15e1c9(0x26a)]=_0x15e1c9(0x256)+breakSuggestions[_0x28216e];}this[_0x15e1c9(0x399)](),this[_0x15e1c9(0x26b)]();},async 'start'(){const _0x21c2cc=_0x2deb62;if(!getCurrentSubtopic()){toast(_0x21c2cc(0x235));return;}ensureAudio();if(this[_0x21c2cc(0x372)]==='C'&&this[_0x21c2cc(0x35e)]===_0x21c2cc(0x213))this[_0x21c2cc(0x35e)]=_0x21c2cc(0x1b2),this[_0x21c2cc(0x179)]=0x0,this[_0x21c2cc(0x2c5)]=0x0,this[_0x21c2cc(0x441)]=0x0,this[_0x21c2cc(0x399)](),this[_0x21c2cc(0x26b)]();else{if(this[_0x21c2cc(0x35e)]===_0x21c2cc(0x213))this[_0x21c2cc(0x441)]=this[_0x21c2cc(0x441)]||0x0,this[_0x21c2cc(0x415)]();else this[_0x21c2cc(0x35e)]==='paused'&&this['resume']();}await this[_0x21c2cc(0x232)](!![]);},async 'pause'(){const _0x74e746=_0x2deb62;this['tickHandle']&&(clearInterval(this[_0x74e746(0x167)]),this[_0x74e746(0x167)]=null),this[_0x74e746(0x172)]=this[_0x74e746(0x35e)],this[_0x74e746(0x35e)]='paused',this['updateUI'](),await this[_0x74e746(0x232)](!![]);},async 'resume'(){const _0x3fad8c=_0x2deb62;if(this['state']!=='paused')return;this['state']=this['prevState']||_0x3fad8c(0x1b2),this[_0x3fad8c(0x399)](),this[_0x3fad8c(0x26b)](),await this[_0x3fad8c(0x232)](!![]);},async 'skip'(){const _0x2dd0f6=_0x2deb62;if(this[_0x2dd0f6(0x372)]==='C'&&this[_0x2dd0f6(0x35e)]===_0x2dd0f6(0x1b2)){this[_0x2dd0f6(0x206)](),await this['persistTimerState'](!![]);return;}this[_0x2dd0f6(0x35e)]===_0x2dd0f6(0x1b2)?(this['tickHandle']&&(clearInterval(this[_0x2dd0f6(0x167)]),this[_0x2dd0f6(0x167)]=null),this[_0x2dd0f6(0x179)]=0x0,this['_onFinishSegment']()):(this['remaining']=0x0,this[_0x2dd0f6(0x167)]&&(clearInterval(this[_0x2dd0f6(0x167)]),this[_0x2dd0f6(0x167)]=null),this[_0x2dd0f6(0x1d9)]()),await this['persistTimerState'](!![]);},async 'reset'(){const _0x276bf1=_0x2deb62;this['tickHandle']&&(clearInterval(this[_0x276bf1(0x167)]),this[_0x276bf1(0x167)]=null);this[_0x276bf1(0x35e)]='idle',this[_0x276bf1(0x172)]=null,this[_0x276bf1(0x179)]=0x0,this[_0x276bf1(0x2c5)]=0x0,this['cycleIndex']=0x0;const _0x250a00=$(_0x276bf1(0x27d));_0x250a00&&(_0x250a00[_0x276bf1(0x26a)]=''),this[_0x276bf1(0x26b)](),await this[_0x276bf1(0x232)](!![]);}};async function deleteSummary(_0x1f0436){const _0x3e01ad=_0x2deb62;showConfirmModal('Confirm\x20Deletion',_0x3e01ad(0x401),async _0x134559=>{const _0x19ec14=_0x3e01ad;if(!_0x134559)return;const _0x50b613=getCurrentSubtopic();if(!_0x50b613||!_0x50b613[_0x19ec14(0x197)])return;const _0xe290cc=[..._0x50b613[_0x19ec14(0x197)]];_0x50b613['summaries']=_0x50b613['summaries']['filter'](_0x5715e1=>_0x5715e1['id']!==_0x1f0436);try{await storageManager['update']('subtopics',_0x50b613),renderSummaries(),toast(_0x19ec14(0x395));}catch(_0x59584a){console[_0x19ec14(0x1b1)](_0x19ec14(0x1c3),_0x59584a),_0x50b613[_0x19ec14(0x197)]=_0xe290cc,toast(_0x19ec14(0x1f3));}});}function exportSummary(_0x4312dd){const _0x4d9da6=_0x2deb62,_0x216573=new Blob([_0x4312dd[_0x4d9da6(0x24d)]],{'type':_0x4d9da6(0x438)}),_0x406821=document[_0x4d9da6(0x429)]('a'),_0x391dab=new Date(_0x4312dd[_0x4d9da6(0x453)]),_0x1b95a9=_0x2506f0=>(''+_0x2506f0)[_0x4d9da6(0x44c)](0x2,'0');_0x406821['href']=URL[_0x4d9da6(0x1a7)](_0x216573),_0x406821[_0x4d9da6(0x18a)]=_0x4d9da6(0x290)+_0x391dab[_0x4d9da6(0x147)]()+_0x1b95a9(_0x391dab['getMonth']()+0x1)+_0x1b95a9(_0x391dab[_0x4d9da6(0x1dc)]())+'.txt',_0x406821[_0x4d9da6(0x1c4)](),URL['revokeObjectURL'](_0x406821[_0x4d9da6(0x414)]);}function renderStatsHistory(){const _0x2dd3a4=_0x2deb62,_0x34e5ea=getCurrentSubtopic(),_0x5be0c9=$(_0x2dd3a4(0x24c)),_0x13cda4=$(_0x2dd3a4(0x381)),_0x1a6d25=$(_0x2dd3a4(0x342)),_0xed64a=$(_0x2dd3a4(0x265));if(!_0x5be0c9||!_0x13cda4||!_0x1a6d25||!_0xed64a)return;if(!_0x34e5ea){_0x5be0c9[_0x2dd3a4(0x26a)]=_0x2dd3a4(0x2b7),_0x13cda4[_0x2dd3a4(0x26a)]='0',_0x1a6d25[_0x2dd3a4(0x26a)]='0',_0xed64a['innerHTML']='<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>';return;}const _0xc09a42=_0x34e5ea[_0x2dd3a4(0x309)]&&_0x34e5ea[_0x2dd3a4(0x309)][_0x2dd3a4(0x257)]?_0x34e5ea[_0x2dd3a4(0x309)][_0x2dd3a4(0x257)]:0x0,_0x459ada=_0x34e5ea[_0x2dd3a4(0x309)]&&_0x34e5ea[_0x2dd3a4(0x309)]['sessionsCompleted']?_0x34e5ea['stats'][_0x2dd3a4(0x1fe)]:0x0,_0x4d1460=_0x34e5ea[_0x2dd3a4(0x40e)]?_0x34e5ea[_0x2dd3a4(0x40e)][_0x2dd3a4(0x1cf)](_0x325eec=>_0x325eec[_0x2dd3a4(0x18c)])[_0x2dd3a4(0x2f0)]:0x0;_0x5be0c9['textContent']=formatDaysHoursMinutes(_0xc09a42),_0x13cda4['textContent']=String(_0x459ada),_0x1a6d25[_0x2dd3a4(0x26a)]=String(_0x4d1460),_0xed64a['innerHTML']='';const _0x5c128f=Array[_0x2dd3a4(0x39c)](_0x34e5ea['sessions'])?_0x34e5ea['sessions']:[];if(_0x5c128f[_0x2dd3a4(0x2f0)]===0x0){_0xed64a['innerHTML']=_0x2dd3a4(0x3ab);return;}_0x5c128f[_0x2dd3a4(0x19c)](_0x1e755d=>{const _0x5cd4af=_0x2dd3a4,_0x417591=document[_0x5cd4af(0x429)](_0x5cd4af(0x34c));_0x417591['className']=_0x5cd4af(0x1b3);const _0x109e59=document[_0x5cd4af(0x429)]('div'),_0x3013ec=_0x1e755d['dateISO']?new Date(_0x1e755d[_0x5cd4af(0x2e1)]):new Date(),_0x497a91=_0x1e755d[_0x5cd4af(0x272)]!=null?_0x1e755d[_0x5cd4af(0x272)]:_0x1e755d[_0x5cd4af(0x2ca)]||0x0,_0x4497b0='<div\x20class=\x22hist-meta\x22>'+_0x3013ec[_0x5cd4af(0x34d)]()+_0x5cd4af(0x388)+_0x497a91+'\x27\x20·\x20Mode\x20'+(_0x1e755d['mode']||'')+_0x5cd4af(0x361);let _0x43164a='';if(_0x1e755d[_0x5cd4af(0x3bc)])_0x43164a=_0x5cd4af(0x439)+escapeHTML(_0x1e755d['note'])+_0x5cd4af(0x361);else data?.[_0x5cd4af(0x1b8)]?.['enableSessionNotes']&&(_0x43164a='<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>');_0x109e59['innerHTML']=_0x4497b0+_0x43164a,_0x417591[_0x5cd4af(0x2bc)](_0x109e59),_0xed64a[_0x5cd4af(0x2bc)](_0x417591);});}function renderGeneralNotes(){const _0x1e99a8=_0x2deb62,_0x3567b3=$('#generalNotesList');if(!_0x3567b3)return;const _0x4e9502=getCurrentSubtopic();if(!_0x4e9502){_0x3567b3[_0x1e99a8(0x143)]=_0x1e99a8(0x1c9);return;}_0x4e9502[_0x1e99a8(0x228)]=_0x4e9502[_0x1e99a8(0x228)]||[];if(_0x4e9502[_0x1e99a8(0x228)][_0x1e99a8(0x2f0)]===0x0){_0x3567b3[_0x1e99a8(0x143)]='<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>';return;}_0x3567b3[_0x1e99a8(0x143)]='',_0x4e9502['generalNotes'][_0x1e99a8(0x19c)](_0x2444af=>{const _0x312ae2=_0x1e99a8,_0x396a49=document['createElement'](_0x312ae2(0x34c));_0x396a49[_0x312ae2(0x3ef)]=_0x312ae2(0x17d);const _0x3bc43c=document['createElement']('div');_0x3bc43c[_0x312ae2(0x3ef)]=_0x312ae2(0x165),_0x3bc43c[_0x312ae2(0x26a)]=typeof _0x2444af===_0x312ae2(0x267)?_0x2444af:_0x2444af[_0x312ae2(0x417)]||'';const _0x323d97=document[_0x312ae2(0x429)](_0x312ae2(0x34c));_0x323d97[_0x312ae2(0x3ef)]=_0x312ae2(0x295),_0x323d97[_0x312ae2(0x26a)]=_0x2444af[_0x312ae2(0x453)]?new Date(_0x2444af[_0x312ae2(0x453)])['toLocaleString']():'';const _0x1998d5=document[_0x312ae2(0x429)](_0x312ae2(0x34c)),_0x4bebaf=document[_0x312ae2(0x429)](_0x312ae2(0x3bd));_0x4bebaf[_0x312ae2(0x3ef)]='btn\x20small\x20danger',_0x4bebaf[_0x312ae2(0x26a)]=_0x312ae2(0x23f),_0x4bebaf['onclick']=async _0x5a0943=>{const _0x5eb839=_0x312ae2;_0x5a0943['stopPropagation']();const _0x5371f0=getCurrentSubtopic();if(!_0x5371f0)return;_0x5371f0[_0x5eb839(0x228)]=(_0x5371f0['generalNotes']||[])['filter'](_0x50590c=>(_0x50590c['id']||_0x50590c)!==(_0x2444af['id']||_0x2444af)),await saveData(),renderGeneralNotes();},_0x1998d5[_0x312ae2(0x2bc)](_0x4bebaf);const _0x212f35=document['createElement'](_0x312ae2(0x34c));_0x212f35[_0x312ae2(0x3ef)]=_0x312ae2(0x273),_0x212f35[_0x312ae2(0x15b)](_0x3bc43c,_0x323d97),_0x396a49[_0x312ae2(0x15b)](_0x212f35,_0x1998d5),_0x3567b3[_0x312ae2(0x2bc)](_0x396a49);});}function renderMethods(){const _0x68879a=_0x2deb62,_0x43a003=document[_0x68879a(0x205)](_0x68879a(0x3c2));if(!_0x43a003)return;_0x43a003['innerHTML']='';const _0xcc7934=getCurrentSubtopic();if(!_0xcc7934){_0x43a003['innerHTML']=_0x68879a(0x2ea);return;}const _0x2aa26c=Array[_0x68879a(0x39c)](_0xcc7934[_0x68879a(0x348)])?_0xcc7934[_0x68879a(0x348)]:[];if(_0x2aa26c['length']===0x0){_0x43a003['innerHTML']=_0x68879a(0x3f6);return;}_0x2aa26c[_0x68879a(0x19c)](_0x483a9d=>{const _0x59c9f4=_0x68879a,_0x316599=document['createElement']('details');_0x316599['className']=_0x59c9f4(0x1a5),_0x316599['dataset'][_0x59c9f4(0x3f4)]=_0x483a9d['id'];const _0x1075f1=document[_0x59c9f4(0x429)](_0x59c9f4(0x2fd)),_0x2cbb1d=document[_0x59c9f4(0x429)](_0x59c9f4(0x262));_0x2cbb1d[_0x59c9f4(0x3ef)]='method-title',_0x2cbb1d['textContent']=_0x483a9d['title']||_0x59c9f4(0x368),_0x2cbb1d['addEventListener'](_0x59c9f4(0x1c4),_0x5bf9a6=>{const _0x1063c6=_0x59c9f4;_0x5bf9a6[_0x1063c6(0x216)](),_0x5bf9a6[_0x1063c6(0x30a)](),_0x316599['open']=!_0x316599[_0x1063c6(0x150)];});const _0x13a51e=document['createElement'](_0x59c9f4(0x34c));_0x13a51e[_0x59c9f4(0x3ef)]=_0x59c9f4(0x1ee);const _0x313128=document[_0x59c9f4(0x429)](_0x59c9f4(0x3bd));_0x313128[_0x59c9f4(0x3ef)]=_0x59c9f4(0x239),_0x313128[_0x59c9f4(0x26a)]=_0x59c9f4(0x431),_0x313128[_0x59c9f4(0x192)]['id']=_0x483a9d['id'];const _0x1efd78=document['createElement'](_0x59c9f4(0x3bd));_0x1efd78[_0x59c9f4(0x3ef)]=_0x59c9f4(0x249),_0x1efd78[_0x59c9f4(0x26a)]='Delete',_0x1efd78['dataset']['id']=_0x483a9d['id'],_0x13a51e[_0x59c9f4(0x15b)](_0x313128,_0x1efd78),_0x1075f1[_0x59c9f4(0x15b)](_0x2cbb1d,_0x13a51e);const _0x10b8b8=document[_0x59c9f4(0x429)](_0x59c9f4(0x34c));_0x10b8b8[_0x59c9f4(0x3ef)]='method-content',_0x10b8b8['innerHTML']=_0x483a9d[_0x59c9f4(0x24d)]||'',_0x316599[_0x59c9f4(0x15b)](_0x1075f1,_0x10b8b8),_0x43a003[_0x59c9f4(0x2bc)](_0x316599),_0x316599[_0x59c9f4(0x396)]('click',_0x1cc03b=>{const _0x47420a=_0x59c9f4,_0x51f52b=_0x1cc03b[_0x47420a(0x1f7)];if(!_0x51f52b)return;if(_0x51f52b[_0x47420a(0x435)](_0x47420a(0x3bd))||_0x51f52b[_0x47420a(0x435)]('a')||_0x51f52b[_0x47420a(0x435)](_0x47420a(0x3d1))||_0x51f52b[_0x47420a(0x435)](_0x47420a(0x2de)))return;if(!_0x316599[_0x47420a(0x150)])_0x316599[_0x47420a(0x150)]=!![];});});const _0x75d611=_0x43a003[_0x68879a(0x203)](_0x68879a(0x42c));_0x75d611[_0x68879a(0x19c)](_0x112a2c=>{const _0x2ade71=_0x68879a;_0x112a2c[_0x2ade71(0x396)](_0x2ade71(0x3e7),()=>{const _0x5206b9=_0x2ade71;_0x112a2c[_0x5206b9(0x150)]&&_0x75d611['forEach'](_0x32b1a3=>{const _0x8816b3=_0x5206b9;if(_0x32b1a3!==_0x112a2c)_0x32b1a3[_0x8816b3(0x150)]=![];});});}),window[_0x68879a(0x268)]&&new Sortable(_0x43a003,{'animation':0x96,'draggable':_0x68879a(0x42c),'onEnd':async function(_0x572184){const _0x46a1d3=_0x68879a;if(_0x572184[_0x46a1d3(0x279)]===_0x572184[_0x46a1d3(0x336)])return;const _0x33dd21=getCurrentSubtopic();if(!_0x33dd21||!Array[_0x46a1d3(0x39c)](_0x33dd21[_0x46a1d3(0x348)]))return;const _0x3f6ef4=_0x33dd21['methods'][_0x46a1d3(0x30c)](_0x572184[_0x46a1d3(0x279)],0x1)[0x0];_0x33dd21[_0x46a1d3(0x348)]['splice'](_0x572184[_0x46a1d3(0x336)],0x0,_0x3f6ef4),await saveData();}});}function addGeneralNote(){const _0x4c0829=_0x2deb62;showInputModal(_0x4c0829(0x171),async _0x2ca620=>{const _0x5cbb1e=_0x4c0829;if(!_0x2ca620)return;const _0x534af3=getCurrentSubtopic();if(!_0x534af3){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}_0x534af3[_0x5cbb1e(0x228)]=_0x534af3[_0x5cbb1e(0x228)]||[],_0x534af3[_0x5cbb1e(0x228)][_0x5cbb1e(0x148)]({'id':uid('gn'),'text':_0x2ca620,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x2d28aa=_0x2deb62,_0x2a8c71=getCurrentSubtopic();if(!_0x2a8c71){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x19192f=(_0x2a8c71[_0x2d28aa(0x228)]||[])[_0x2d28aa(0x29e)](_0x5103fd=>typeof _0x5103fd===_0x2d28aa(0x267)?_0x5103fd:_0x5103fd[_0x2d28aa(0x417)]||'')[_0x2d28aa(0x1cf)](Boolean);if(_0x19192f[_0x2d28aa(0x2f0)]===0x0){toast(_0x2d28aa(0x13e));return;}const _0x27f6ea=$(_0x2d28aa(0x443));_0x27f6ea&&(_0x27f6ea['disabled']=!![],_0x27f6ea['innerHTML']=_0x2d28aa(0x177));try{const _0x409695=_0x2d28aa(0x1e2)+_0x19192f['join'](_0x2d28aa(0x3c4)),_0xb84eca=await callGeminiAPI(_0x409695);if(!_0x2a8c71[_0x2d28aa(0x197)])_0x2a8c71[_0x2d28aa(0x197)]=[];_0x2a8c71[_0x2d28aa(0x197)]['unshift']({'id':uid(_0x2d28aa(0x242)),'content':_0xb84eca||_0x2d28aa(0x227),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x4a260a){console[_0x2d28aa(0x1b1)](_0x4a260a),toast(_0x2d28aa(0x326));}finally{_0x27f6ea&&(_0x27f6ea[_0x2d28aa(0x2f5)]=![],_0x27f6ea[_0x2d28aa(0x26a)]=_0x2d28aa(0x442));}}function renderSummaries(){const _0x12d324=_0x2deb62,_0x21767d=$('#summariesList');if(!_0x21767d)return;const _0x3d03da=getCurrentSubtopic();if(!_0x3d03da){_0x21767d[_0x12d324(0x143)]='<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>';return;}_0x21767d[_0x12d324(0x143)]='';if(!_0x3d03da[_0x12d324(0x197)]||_0x3d03da[_0x12d324(0x197)][_0x12d324(0x2f0)]===0x0){_0x21767d[_0x12d324(0x143)]=_0x12d324(0x1ef);return;}_0x3d03da['summaries'][_0x12d324(0x19c)](_0x25a51b=>{const _0x1ae042=_0x12d324,_0x216ee2=document[_0x1ae042(0x429)](_0x1ae042(0x34c));_0x216ee2[_0x1ae042(0x3ef)]=_0x1ae042(0x17d);const _0x18fedd=document[_0x1ae042(0x429)](_0x1ae042(0x34c));_0x18fedd[_0x1ae042(0x3ef)]=_0x1ae042(0x273);const _0x31b97b=document[_0x1ae042(0x429)](_0x1ae042(0x34c));_0x31b97b[_0x1ae042(0x3ef)]=_0x1ae042(0x165),_0x31b97b[_0x1ae042(0x26a)]=_0x25a51b['content'];const _0x2a38ba=document[_0x1ae042(0x429)](_0x1ae042(0x34c));_0x2a38ba['className']=_0x1ae042(0x295),_0x2a38ba[_0x1ae042(0x26a)]=new Date(_0x25a51b['createdAt'])['toLocaleString'](),_0x18fedd[_0x1ae042(0x15b)](_0x31b97b,_0x2a38ba);const _0x2ba243=document[_0x1ae042(0x429)](_0x1ae042(0x34c)),_0x45cf31=document[_0x1ae042(0x429)]('button');_0x45cf31[_0x1ae042(0x3ef)]='btn\x20small',_0x45cf31[_0x1ae042(0x26a)]=_0x1ae042(0x311),_0x45cf31[_0x1ae042(0x17f)]=_0x1524e2=>{_0x1524e2['stopPropagation'](),exportSummary(_0x25a51b);};const _0x4a8323=document[_0x1ae042(0x429)](_0x1ae042(0x3bd));_0x4a8323[_0x1ae042(0x3ef)]=_0x1ae042(0x394),_0x4a8323[_0x1ae042(0x26a)]=_0x1ae042(0x23f),_0x4a8323['onclick']=_0x2206b6=>{_0x2206b6['stopPropagation'](),deleteSummary(_0x25a51b['id']);},_0x2ba243[_0x1ae042(0x15b)](_0x45cf31,_0x4a8323),_0x216ee2[_0x1ae042(0x15b)](_0x18fedd,_0x2ba243),_0x216ee2[_0x1ae042(0x396)](_0x1ae042(0x1c4),()=>_0x31b97b[_0x1ae042(0x362)][_0x1ae042(0x3e7)](_0x1ae042(0x3c8))),_0x21767d[_0x1ae042(0x2bc)](_0x216ee2);});}function loadEditingPresetFields(){const _0x295990=_0x2deb62,_0x4ec1c9=data['settings'],_0x2015f4=_0x4ec1c9[_0x295990(0x211)],_0x3ec8c2=$(_0x295990(0x19e)),_0x18ea05=$(_0x295990(0x446));if(_0x3ec8c2&&_0x18ea05){const _0x5a63cb=editingPreset==='C';_0x3ec8c2['classList'][_0x295990(0x3e7)](_0x295990(0x3ea),_0x5a63cb),_0x18ea05['classList'][_0x295990(0x3e7)](_0x295990(0x3ea),!_0x5a63cb);}if(editingPreset==='A'){$(_0x295990(0x145))['value']=_0x2015f4[_0x295990(0x34e)];if($('#set_winddown'))$(_0x295990(0x33c))[_0x295990(0x1b9)]=_0x2015f4[_0x295990(0x35c)]??0x0;$('#set_short')[_0x295990(0x1b9)]=_0x2015f4[_0x295990(0x199)],$('#set_long')['value']=_0x2015f4[_0x295990(0x343)],$(_0x295990(0x349))[_0x295990(0x1b9)]=_0x4ec1c9['cyclesA'],$('#set_interval')[_0x295990(0x1b9)]=_0x4ec1c9[_0x295990(0x334)];}else{if(editingPreset==='B'){$('#set_work')['value']=_0x2015f4[_0x295990(0x35a)];if($(_0x295990(0x33c)))$('#set_winddown')[_0x295990(0x1b9)]=_0x2015f4[_0x295990(0x31b)]??0x0;$(_0x295990(0x38c))['value']=_0x2015f4[_0x295990(0x2f3)],$('#set_long')[_0x295990(0x1b9)]=_0x2015f4['B_long'],$('#set_cycles')[_0x295990(0x1b9)]=_0x4ec1c9[_0x295990(0x363)],$(_0x295990(0x3fb))[_0x295990(0x1b9)]=_0x4ec1c9['longBreakIntervalB'];}else{if(editingPreset==='C'){const _0x47d1eb=$(_0x295990(0x161));if(_0x47d1eb)_0x47d1eb[_0x295990(0x1b9)]=_0x4ec1c9[_0x295990(0x162)]??0x5;}}}}function highlightPresetSelector(){const _0x198dfd=_0x2deb62;$$(_0x198dfd(0x42b))[_0x198dfd(0x19c)](_0x1cf202=>{const _0x12cc40=_0x198dfd,_0x1a33c4=_0x1cf202[_0x12cc40(0x192)][_0x12cc40(0x22f)]===editingPreset;_0x1cf202[_0x12cc40(0x362)][_0x12cc40(0x3e7)](_0x12cc40(0x1b6),_0x1a33c4),_0x1cf202[_0x12cc40(0x362)][_0x12cc40(0x3e7)](_0x12cc40(0x1da),!_0x1a33c4);});}function openSettings(){const _0x34afff=_0x2deb62,_0x29bf44=data[_0x34afff(0x1b8)];editingPreset=_0x29bf44[_0x34afff(0x13c)],$(_0x34afff(0x2e0))[_0x34afff(0x1b9)]=_0x29bf44['apiKey']||'',loadEditingPresetFields(),highlightPresetSelector(),$(_0x34afff(0x2d2))[_0x34afff(0x1b9)]=_0x29bf44['volume']??0.8,$('#set_theme')['value']=_0x29bf44[_0x34afff(0x19b)]||_0x34afff(0x40b),$(_0x34afff(0x28d))[_0x34afff(0x1b9)]=_0x29bf44[_0x34afff(0x139)]||_0x34afff(0x1a8);const _0x5d61a3=getActiveYoutubeUrl();$('#set_youtubeUrl')['value']=_0x5d61a3||'';const _0x55fe50=extractYouTubeID(_0x5d61a3);$('#btnToggleYtSound')[_0x34afff(0x2f5)]=!_0x55fe50;$(_0x34afff(0x3b4))&&($(_0x34afff(0x3b4))[_0x34afff(0x26a)]='');$(_0x34afff(0x2c8))['value']=_0x29bf44[_0x34afff(0x3f7)]||0x50,$('#set_ytThumbAsBg')[_0x34afff(0x385)]=!!_0x29bf44[_0x34afff(0x2a6)],$(_0x34afff(0x2b5))['value']=_0x29bf44['panelOpacity']||0.85;$(_0x34afff(0x1f0))&&($(_0x34afff(0x1f0))[_0x34afff(0x1b9)]=_0x29bf44[_0x34afff(0x170)]||_0x34afff(0x151));$('#set_autoStartNext')&&($(_0x34afff(0x187))[_0x34afff(0x385)]=!!_0x29bf44[_0x34afff(0x409)]);$(_0x34afff(0x350))&&($(_0x34afff(0x350))['checked']=_0x29bf44['enableWinddown']!==![]);$(_0x34afff(0x1b7))&&($(_0x34afff(0x1b7))[_0x34afff(0x385)]=!!_0x29bf44[_0x34afff(0x365)]);$('#set_backupDays')&&($(_0x34afff(0x163))[_0x34afff(0x1b9)]=_0x29bf44[_0x34afff(0x23d)]||0x7);const _0xe97aa5=$('#backupList');_0xe97aa5&&storageManager[_0x34afff(0x16b)]()[_0x34afff(0x3a9)](_0x4da5b5=>{const _0x5e0ea6=_0x34afff;_0xe97aa5['innerHTML']=_0x5e0ea6(0x3c6),_0x4da5b5&&_0x4da5b5[_0x5e0ea6(0x2f0)]>0x0?_0x4da5b5['forEach'](_0x277c04=>{const _0xd866ce=_0x5e0ea6,_0x3bdc67=document[_0xd866ce(0x429)](_0xd866ce(0x182));_0x3bdc67[_0xd866ce(0x1b9)]=_0x277c04[_0xd866ce(0x1af)],_0x3bdc67[_0xd866ce(0x26a)]=_0xd866ce(0x3be)+new Date(_0x277c04['date'])[_0xd866ce(0x19f)](_0xd866ce(0x3aa)),_0xe97aa5[_0xd866ce(0x2bc)](_0x3bdc67);}):_0xe97aa5[_0x5e0ea6(0x143)]=_0x5e0ea6(0x1fb);});$(_0x34afff(0x2c2))['classList'][_0x34afff(0x33b)](_0x34afff(0x286));try{trapFocus($(_0x34afff(0x2c2)));}catch(_0x21d531){}}function closeSettings(){const _0x53253f=_0x2deb62;$(_0x53253f(0x2c2))[_0x53253f(0x362)][_0x53253f(0x223)]('show');try{releaseFocus();}catch(_0x878b7b){}}async function setDefaults(){const _0x192e87=_0x2deb62;data['settings'][_0x192e87(0x211)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x192e87(0x1b8)][_0x192e87(0x3d9)]=0x4,data[_0x192e87(0x1b8)][_0x192e87(0x334)]=0x4,data[_0x192e87(0x1b8)][_0x192e87(0x363)]=0x4,data['settings'][_0x192e87(0x3a4)]=0x4,data[_0x192e87(0x1b8)][_0x192e87(0x162)]=0x5,data['settings'][_0x192e87(0x13c)]='A',data[_0x192e87(0x1b8)][_0x192e87(0x1e8)]=0.8,data[_0x192e87(0x1b8)][_0x192e87(0x19b)]='beep',await saveData(),openSettings(),toast('Defaults\x20restored');}async function saveSettings(){const _0x3de389=_0x2deb62,_0x3831fa=data['settings'];_0x3831fa[_0x3de389(0x2da)]=$(_0x3de389(0x2e0))[_0x3de389(0x1b9)][_0x3de389(0x37a)]();const _0x1f0c55=_0x3831fa[_0x3de389(0x211)];if(editingPreset==='A')_0x1f0c55['A_work']=clampInt($(_0x3de389(0x145))[_0x3de389(0x1b9)],0x1,0x3e7),_0x1f0c55[_0x3de389(0x35c)]=clampInt($(_0x3de389(0x33c))[_0x3de389(0x1b9)],0x0,0x3e7),_0x1f0c55[_0x3de389(0x199)]=clampInt($(_0x3de389(0x38c))[_0x3de389(0x1b9)],0x1,0x3e7),_0x1f0c55['A_long']=clampInt($(_0x3de389(0x1ac))[_0x3de389(0x1b9)],0x1,0x3e7),_0x3831fa[_0x3de389(0x3d9)]=clampInt($(_0x3de389(0x349))['value'],0x1,0xc),_0x3831fa[_0x3de389(0x334)]=clampInt($(_0x3de389(0x3fb))[_0x3de389(0x1b9)],0x2,0xc);else{if(editingPreset==='B')_0x1f0c55['B_work']=clampInt($(_0x3de389(0x145))[_0x3de389(0x1b9)],0x1,0x3e7),_0x1f0c55[_0x3de389(0x31b)]=clampInt($(_0x3de389(0x33c))[_0x3de389(0x1b9)],0x0,0x3e7),_0x1f0c55['B_short']=clampInt($(_0x3de389(0x38c))[_0x3de389(0x1b9)],0x1,0x3e7),_0x1f0c55[_0x3de389(0x405)]=clampInt($(_0x3de389(0x1ac))[_0x3de389(0x1b9)],0x1,0x3e7),_0x3831fa[_0x3de389(0x363)]=clampInt($(_0x3de389(0x349))[_0x3de389(0x1b9)],0x1,0xc),_0x3831fa[_0x3de389(0x3a4)]=clampInt($(_0x3de389(0x3fb))[_0x3de389(0x1b9)],0x2,0xc);else{if(editingPreset==='C'){const _0x533fc9=$(_0x3de389(0x161));if(_0x533fc9)_0x3831fa[_0x3de389(0x162)]=clampInt(_0x533fc9['value'],0x1,0x14);}}}_0x3831fa[_0x3de389(0x1e8)]=clampFloat($(_0x3de389(0x2d2))[_0x3de389(0x1b9)],0x0,0x1,0.8),_0x3831fa[_0x3de389(0x19b)]=$(_0x3de389(0x375))[_0x3de389(0x1b9)]===_0x3de389(0x1cd)?_0x3de389(0x1cd):_0x3de389(0x40b),_0x3831fa[_0x3de389(0x139)]=$('#set_theme_color')['value'],_0x3831fa[_0x3de389(0x2bd)]=parseFloat($('#set_panelOpacity')['value'])||0.85;$(_0x3de389(0x1f0))&&(_0x3831fa[_0x3de389(0x170)]=$('#set_backgroundMode')[_0x3de389(0x1b9)]);_0x3831fa[_0x3de389(0x409)]=!!($('#set_autoStartNext')&&$(_0x3de389(0x187))['checked']),_0x3831fa[_0x3de389(0x1d7)]=!!($('#set_enableWinddown')&&$(_0x3de389(0x350))[_0x3de389(0x385)]),_0x3831fa[_0x3de389(0x365)]=!!($(_0x3de389(0x1b7))&&$(_0x3de389(0x1b7))['checked']);$('#set_backupDays')&&(_0x3831fa[_0x3de389(0x23d)]=clampInt($(_0x3de389(0x163))['value'],0x1,0x1e));_0x3831fa['theme']===_0x3de389(0x287)||_0x3831fa['theme']===_0x3de389(0x424)?(_0x3831fa[_0x3de389(0x2a6)]=![],typeof _0x3831fa[_0x3de389(0x3e4)]===_0x3de389(0x267)&&_0x3831fa[_0x3de389(0x3e4)][_0x3de389(0x20e)](_0x3de389(0x21b))&&(_0x3831fa['customBg']='')):_0x3831fa[_0x3de389(0x2a6)]=!![];const _0x1fb62f=$('#set_youtubeUrl')[_0x3de389(0x1b9)][_0x3de389(0x37a)]();_0x3831fa[_0x3de389(0x2a6)]=$(_0x3de389(0x308))[_0x3de389(0x385)],_0x3831fa[_0x3de389(0x3f7)]=parseInt($('#ytSoundVolume')[_0x3de389(0x1b9)],0xa),sessionYoutubeUrl=_0x1fb62f;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x3de389(0x2a2)](_0x3831fa[_0x3de389(0x3f7)]);}else try{fallbackPostMessage(_0x3de389(0x2a2),[_0x3831fa[_0x3de389(0x3f7)]]);}catch(_0x2d4d4d){}}catch(_0x1e061c){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x3de389(0x41f)](_0x3831fa[_0x3de389(0x13c)],{'silent':!![]}),closeSettings(),toast('Settings\x20saved');}function clampInt(_0x1f2fbc,_0x18aad0,_0x40503a){const _0x16875a=_0x2deb62;_0x1f2fbc=parseInt(_0x1f2fbc||0x0,0xa);if(isNaN(_0x1f2fbc))_0x1f2fbc=_0x18aad0;return Math[_0x16875a(0x1d5)](_0x18aad0,Math[_0x16875a(0x27a)](_0x40503a,_0x1f2fbc));}function clampFloat(_0x4ad294,_0x57f5f9,_0x2d5cc5,_0xaf3c51){const _0x5d1d42=_0x2deb62;_0x4ad294=parseFloat(_0x4ad294);if(Number[_0x5d1d42(0x332)](_0x4ad294))_0x4ad294=_0xaf3c51;return Math[_0x5d1d42(0x1d5)](_0x57f5f9,Math['min'](_0x2d5cc5,_0x4ad294));}const dbPromise=new Promise((_0x21744d,_0x3db757)=>{const _0x2642c5=_0x2deb62,_0x2949fe=indexedDB[_0x2642c5(0x150)](_0x2642c5(0x1a4),0x1);_0x2949fe[_0x2642c5(0x1d2)]=_0x2dce3e=>_0x2dce3e[_0x2642c5(0x1f7)][_0x2642c5(0x292)][_0x2642c5(0x37e)](_0x2642c5(0x2b6)),_0x2949fe[_0x2642c5(0x13f)]=_0x601d0a=>_0x21744d(_0x601d0a[_0x2642c5(0x1f7)][_0x2642c5(0x292)]),_0x2949fe[_0x2642c5(0x15d)]=_0x50caa4=>_0x3db757(_0x50caa4);}),fileCache={};function handleFileUpload(_0x4547e4,_0x348b57){const _0x35ec43=_0x2deb62;if(!_0x4547e4)return;dbPromise[_0x35ec43(0x3a9)](_0x512000=>{const _0x12fb06=_0x35ec43,_0x528150=uid(_0x12fb06(0x190)),_0x24a53d=_0x512000[_0x12fb06(0x3e0)]('files',_0x12fb06(0x411));_0x24a53d['objectStore'](_0x12fb06(0x2b6))[_0x12fb06(0x166)](_0x4547e4,_0x528150),_0x24a53d[_0x12fb06(0x3e8)]=()=>_0x348b57(_0x528150),_0x24a53d[_0x12fb06(0x15d)]=()=>toast(_0x12fb06(0x201));});}function getStoredFileUrl(_0x2ab490){const _0x402fc2=_0x2deb62;if(!_0x2ab490)return Promise['resolve']('');if(fileCache[_0x2ab490])return Promise[_0x402fc2(0x3a1)](fileCache[_0x2ab490]);return dbPromise['then'](_0x4f24e2=>new Promise(_0x41eb6b=>{const _0x32e926=_0x402fc2,_0x3bd902=_0x4f24e2[_0x32e926(0x3e0)](_0x32e926(0x2b6),_0x32e926(0x315)),_0x409cde=_0x3bd902['objectStore'](_0x32e926(0x2b6))[_0x32e926(0x1bb)](_0x2ab490);_0x409cde['onsuccess']=_0x5b5437=>{const _0x5407c4=_0x32e926,_0x225aaa=_0x5b5437[_0x5407c4(0x1f7)][_0x5407c4(0x292)];if(_0x225aaa){const _0x55784c=URL[_0x5407c4(0x1a7)](_0x225aaa);fileCache[_0x2ab490]=_0x55784c,_0x41eb6b(_0x55784c);}else _0x41eb6b('');},_0x409cde[_0x32e926(0x15d)]=()=>_0x41eb6b('');}));}function applyCustomBg(){const _0x310425=_0x2deb62,_0x19d683=data[_0x310425(0x1b8)],_0x234d1e=_0x19d683[_0x310425(0x3e4)],_0x4d9c11=_0x19d683[_0x310425(0x139)],_0x5014c4=[_0x310425(0x2a8),'space'][_0x310425(0x20e)](_0x4d9c11),_0x2024b2=_0x4d9c11===_0x310425(0x287)||_0x4d9c11===_0x310425(0x424),_0x5c501f=_0x19d683[_0x310425(0x170)]||_0x310425(0x151);document[_0x310425(0x3d8)][_0x310425(0x300)]['backgroundSize']=_0x5c501f,document['body']['style'][_0x310425(0x313)]=_0x5c501f===_0x310425(0x412)?_0x310425(0x278):_0x310425(0x1a3);const _0x127203=()=>{const _0x9d59e3=_0x310425;try{document['body'][_0x9d59e3(0x300)][_0x9d59e3(0x1eb)]='';}catch(_0x4e011e){}};if(_0x234d1e){const _0xd6c3d3=_0x234d1e[_0x310425(0x22d)]('data:')||_0x234d1e[_0x310425(0x22d)](_0x310425(0x43b))||_0x234d1e[_0x310425(0x22d)](_0x310425(0x2bf))?Promise['resolve'](_0x234d1e):getStoredFileUrl(_0x234d1e);_0xd6c3d3[_0x310425(0x3a9)](_0x450ef4=>{const _0x381214=_0x310425;_0x450ef4?document[_0x381214(0x3d8)][_0x381214(0x300)]['setProperty'](_0x381214(0x43a),_0x381214(0x2ec)+_0x450ef4+')'):document['body'][_0x381214(0x300)]['setProperty']('--bg-image',_0x2024b2?_0x381214(0x2ba):''),_0x127203();});}else!_0x5014c4?_0x2024b2?(document[_0x310425(0x3d8)][_0x310425(0x300)]['setProperty']('--bg-image','none'),_0x127203()):document[_0x310425(0x3d8)][_0x310425(0x300)][_0x310425(0x26e)](_0x310425(0x43a),_0x310425(0x33f)):(document[_0x310425(0x3d8)]['style'][_0x310425(0x448)](_0x310425(0x43a)),_0x127203());}function applyPanelOpacity(){const _0x3ac23f=_0x2deb62;document['documentElement']['style'][_0x3ac23f(0x26e)](_0x3ac23f(0x289),data['settings']['panelOpacity']);}function renderDashboard(){const _0x34b6a0=_0x2deb62,_0x4711b6=data[_0x34b6a0(0x2d9)][_0x34b6a0(0x13a)](_0x3f62ea=>_0x3f62ea[_0x34b6a0(0x212)][_0x34b6a0(0x29e)](_0x3be770=>({'topic':_0x3f62ea[_0x34b6a0(0x2be)],'subtopic':_0x3be770['name'],'m':_0x3be770[_0x34b6a0(0x309)][_0x34b6a0(0x257)]||0x0,'c':_0x3be770[_0x34b6a0(0x309)][_0x34b6a0(0x1fe)]||0x0,'t':_0x3be770['stats'][_0x34b6a0(0x14e)]||0x0}))),_0x54f9a8=_0x4711b6[_0x34b6a0(0x1ad)]((_0x497b53,_0x2431b7)=>_0x497b53+_0x2431b7['m'],0x0),_0x422055=_0x4711b6[_0x34b6a0(0x1ad)]((_0x156855,_0x1942f0)=>_0x156855+_0x1942f0['c'],0x0),_0xfceff1=_0x4711b6['reduce']((_0x58a0ba,_0x1f6d67)=>_0x58a0ba+_0x1f6d67['t'],0x0);let _0x2c33dc='<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20'+formatDaysHoursMinutes(_0x54f9a8)+_0x34b6a0(0x140)+_0x422055+_0x34b6a0(0x31e)+_0xfceff1+_0x34b6a0(0x3a8);_0x4711b6['forEach'](_0x1b5749=>{const _0x48f7c9=_0x34b6a0;_0x2c33dc+=_0x48f7c9(0x180)+escapeHTML(_0x1b5749[_0x48f7c9(0x2fa)])+'</td><td>'+escapeHTML(_0x1b5749[_0x48f7c9(0x241)])+_0x48f7c9(0x310)+formatDaysHoursMinutes(_0x1b5749['m'])+_0x48f7c9(0x310)+_0x1b5749['c']+_0x48f7c9(0x310)+_0x1b5749['t']+_0x48f7c9(0x3ca);}),_0x2c33dc+='</tbody></table>';const _0x5a03c8=$(_0x34b6a0(0x44d));if(_0x5a03c8)_0x5a03c8[_0x34b6a0(0x143)]=_0x2c33dc;}function getMilestones(){const _0x41045d=_0x2deb62;return[{'hours':0x5,'title':_0x41045d(0x35f),'message':_0x41045d(0x1d1)},{'hours':0x14,'title':_0x41045d(0x43d),'message':_0x41045d(0x240)},{'hours':0x32,'title':_0x41045d(0x3d3),'message':_0x41045d(0x1d6)},{'hours':0x64,'title':_0x41045d(0x428),'message':'100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment—it’s\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.'},{'hours':0xfa,'title':_0x41045d(0x285),'message':'250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You’ve\x20met\x20hard\x20days\x20and\x20distractions—and\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.'},{'hours':0x1f4,'title':_0x41045d(0x366),'message':_0x41045d(0x26c)},{'hours':0x3e8,'title':_0x41045d(0x40a),'message':'Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time—it\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‘superpower’\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.'},{'hours':0x1388,'title':_0x41045d(0x18f),'message':_0x41045d(0x27c)}][_0x41045d(0x3d7)]((_0x11d8be,_0x50867f)=>_0x50867f[_0x41045d(0x181)]-_0x11d8be['hours']);}async function checkAndShowMilestones(){const _0x2495b1=_0x2deb62;if(!data||!data[_0x2495b1(0x1b8)])return;if(!Array[_0x2495b1(0x39c)](data['settings'][_0x2495b1(0x297)]))data['settings'][_0x2495b1(0x297)]=[];const _0x355803=data[_0x2495b1(0x2d9)][_0x2495b1(0x1ad)]((_0x1c18fc,_0x4e8e37)=>{const _0x302ead=_0x2495b1;return _0x1c18fc+_0x4e8e37[_0x302ead(0x212)]['reduce']((_0x3acc21,_0x7d68b4)=>{const _0x204795=_0x302ead;return _0x3acc21+(_0x7d68b4[_0x204795(0x309)][_0x204795(0x257)]||0x0);},0x0);},0x0),_0x78ae8e=_0x355803/0x3c,_0x82ae9=getMilestones(),_0x5e6ad7=Array[_0x2495b1(0x39c)](data[_0x2495b1(0x1b8)]['achievedMilestones'])?data['settings'][_0x2495b1(0x297)]:[],_0x316028=_0x82ae9[_0x2495b1(0x1cf)](_0x2e60ed=>_0x78ae8e>=_0x2e60ed[_0x2495b1(0x181)]&&!_0x5e6ad7[_0x2495b1(0x20e)](_0x2e60ed[_0x2495b1(0x181)]));if(_0x316028[_0x2495b1(0x2f0)]===0x0)return![];const _0x1694e6=_0x316028[_0x2495b1(0x1ad)]((_0x4fde45,_0x392f5e)=>_0x4fde45&&_0x4fde45[_0x2495b1(0x181)]>_0x392f5e[_0x2495b1(0x181)]?_0x4fde45:_0x392f5e,null);if(!_0x1694e6)return![];$(_0x2495b1(0x1e3))['textContent']=_0x1694e6[_0x2495b1(0x2d3)],$(_0x2495b1(0x251))[_0x2495b1(0x26a)]=_0x1694e6[_0x2495b1(0x210)],$(_0x2495b1(0x43e))[_0x2495b1(0x362)][_0x2495b1(0x33b)](_0x2495b1(0x286));try{trapFocus($('#modalMilestone'));}catch(_0x3c5670){}return data[_0x2495b1(0x1b8)][_0x2495b1(0x297)][_0x2495b1(0x357)](_0x1694e6[_0x2495b1(0x181)]),await saveData(),!![];}async function seedAchievedMilestones(){const _0x326efd=_0x2deb62;if(!data||!data[_0x326efd(0x1b8)])return;!Array[_0x326efd(0x39c)](data[_0x326efd(0x1b8)][_0x326efd(0x297)])&&(data[_0x326efd(0x1b8)][_0x326efd(0x297)]=[],await saveData());}async function handleSendMessage(){const _0x37a136=_0x2deb62,_0x413268=$('#btnSendMessage'),_0x193849=$(_0x37a136(0x402)),_0x38f99e=_0x193849[_0x37a136(0x1b9)]['trim'](),_0x47c128=getCurrentSubtopic();if(!_0x38f99e)return;if(!_0x47c128){toast(t(_0x37a136(0x1e4)));return;}_0x193849[_0x37a136(0x1b9)]='',_0x413268[_0x37a136(0x2f5)]=!![],_0x413268[_0x37a136(0x143)]='<div\x20class=\x22spinner\x22></div>',_0x47c128['chatHistory'][_0x37a136(0x357)]({'role':_0x37a136(0x2f6),'text':_0x38f99e}),renderChat();const _0x13a776=await callGeminiAPI(_0x38f99e);_0x13a776&&(_0x47c128[_0x37a136(0x390)]['push']({'role':_0x37a136(0x2c7),'text':_0x13a776}),await saveData(),renderChat()),_0x413268['disabled']=![],_0x413268['innerHTML']=_0x37a136(0x3e9);}function renderChat(){const _0x507e46=_0x2deb62,_0x2ebad2=getCurrentSubtopic(),_0x2e1578=$(_0x507e46(0x39f)),_0x2342f8=$(_0x507e46(0x402)),_0x20fa90=$('#btnSendMessage');if(!_0x2e1578||!_0x2342f8||!_0x20fa90)return;if(!_0x2ebad2){_0x2e1578[_0x507e46(0x143)]=_0x507e46(0x207),_0x2342f8[_0x507e46(0x2f5)]=!![],_0x20fa90['disabled']=!![];return;}_0x2342f8[_0x507e46(0x2f5)]=![],_0x20fa90['disabled']=![],_0x2e1578['innerHTML']='';if(!_0x2ebad2[_0x507e46(0x390)]||_0x2ebad2[_0x507e46(0x390)][_0x507e46(0x2f0)]===0x0){_0x2e1578['innerHTML']='<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>';return;}_0x2ebad2[_0x507e46(0x390)][_0x507e46(0x19c)](_0x455881=>{const _0x2fc3c9=_0x507e46,_0x3c19c0=document[_0x2fc3c9(0x429)](_0x2fc3c9(0x34c));_0x3c19c0[_0x2fc3c9(0x3ef)]=_0x2fc3c9(0x23e)+_0x455881[_0x2fc3c9(0x1b5)],_0x3c19c0[_0x2fc3c9(0x26a)]=_0x455881[_0x2fc3c9(0x417)],_0x2e1578[_0x2fc3c9(0x2bc)](_0x3c19c0);}),_0x2e1578[_0x507e46(0x3db)]=_0x2e1578[_0x507e46(0x455)];}async function handleSummarizeNote(){const _0x1d190b=_0x2deb62,_0x5f29e2=$(_0x1d190b(0x3da)),_0x2aa0be=$(_0x1d190b(0x1aa)),_0x27e84b=_0x2aa0be[_0x1d190b(0x1b9)][_0x1d190b(0x37a)](),_0x1de2ec=getCurrentSubtopic();if(!_0x27e84b){toast('Please\x20enter\x20a\x20note\x20before\x20summarizing.');return;}const _0x2c81de=_0x5f29e2[_0x1d190b(0x143)];_0x5f29e2[_0x1d190b(0x143)]=_0x1d190b(0x177),_0x5f29e2['disabled']=!![];const _0x398918='Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22'+(_0x1de2ec?.[_0x1d190b(0x2be)]||_0x1d190b(0x2c4))+_0x1d190b(0x30e)+_0x27e84b+_0x1d190b(0x3c1),_0x34066e=await callGeminiAPI(_0x398918);_0x34066e&&(_0x2aa0be[_0x1d190b(0x1b9)]+='\x0a\x0a'+_0x34066e),_0x5f29e2[_0x1d190b(0x143)]=_0x2c81de,_0x5f29e2[_0x1d190b(0x2f5)]=![];}function clearChat(){const _0x14f954=_0x2deb62,_0x2b0a79=getCurrentSubtopic();if(!_0x2b0a79){toast(t(_0x14f954(0x1e4)));return;}showConfirmModal('Confirm\x20Deletion','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?',async _0x4e1a71=>{const _0x14c18e=_0x14f954;_0x4e1a71&&(_0x2b0a79[_0x14c18e(0x390)]=[],await saveData(),renderChat(),toast(_0x14c18e(0x191)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0xf82943,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x36b2bd=_0x2deb62,_0xfca1c1=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0xf82943,'enablejsapi':'1','origin':_0x36b2bd(0x3b5)})[_0x36b2bd(0x1c2)]();return _0x36b2bd(0x158)+_0xf82943+'?'+_0xfca1c1;}function ensureFallbackFrame(){const _0x482c43=_0x2deb62,_0x1722e6=document[_0x482c43(0x22a)]('youtube-player-container');if(!_0x1722e6)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x482c43(0x296)])return ytFallbackFrame;const _0x2b5892=document[_0x482c43(0x429)](_0x482c43(0x2d7));return _0x2b5892['id']=_0x482c43(0x2b0),_0x2b5892[_0x482c43(0x183)]='1',_0x2b5892['height']='1',_0x2b5892[_0x482c43(0x300)][_0x482c43(0x298)]=_0x482c43(0x200),_0x2b5892['style']['top']='-9999px',_0x2b5892[_0x482c43(0x300)][_0x482c43(0x3bb)]='-9999px',_0x2b5892[_0x482c43(0x376)]='autoplay;\x20encrypted-media;\x20picture-in-picture',_0x1722e6[_0x482c43(0x143)]='',_0x1722e6['appendChild'](_0x2b5892),ytFallbackFrame=_0x2b5892,_0x2b5892;}function fallbackLoadVideo(_0xd5665a,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x39437d=_0x2deb62,_0x56407b=document[_0x39437d(0x22a)](_0x39437d(0x2a7));if(!_0x56407b)return;_0x56407b[_0x39437d(0x143)]='';const _0x557582=document[_0x39437d(0x429)](_0x39437d(0x2d7));_0x557582['id']=_0x39437d(0x2b0),_0x557582['width']='1',_0x557582['height']='1',_0x557582[_0x39437d(0x300)][_0x39437d(0x298)]='absolute',_0x557582['style'][_0x39437d(0x209)]='-9999px',_0x557582[_0x39437d(0x300)][_0x39437d(0x3bb)]='-9999px',_0x557582[_0x39437d(0x376)]=_0x39437d(0x22e),_0x557582['src']=buildFallbackSrc(_0xd5665a,{'autoplay':autoplay,'mute':mute}),_0x56407b[_0x39437d(0x2bc)](_0x557582),ytFallbackFrame=_0x557582,ytFallbackIsPlaying=!!autoplay;try{const _0x4939b9=document[_0x39437d(0x22a)](_0x39437d(0x243));if(_0x4939b9)_0x4939b9[_0x39437d(0x26a)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x49f018){}}function fallbackPostMessage(_0x3749a5,_0x19d7af=[]){const _0x3a313b=_0x2deb62;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x3a313b(0x28f)])return;ytFallbackFrame['contentWindow'][_0x3a313b(0x224)](JSON[_0x3a313b(0x1c5)]({'event':_0x3a313b(0x236),'func':_0x3749a5,'args':_0x19d7af}),_0x3a313b(0x3b5));}catch(_0x2632e7){}}function fallbackPlay(){fallbackPostMessage('playVideo');}function fallbackStop(){const _0x4c9f41=_0x2deb62;try{ytFallbackFrame&&(ytFallbackFrame[_0x4c9f41(0x189)]='about:blank',ytFallbackIsPlaying=![]);}catch(_0x634b7e){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){fallbackPostMessage('unMute');}function fallbackMute(){fallbackPostMessage('mute');}window[_0x2deb62(0x15f)]=function(){const _0x1ad248=_0x2deb62;if(IS_FILE_PROTOCOL){try{window[_0x1ad248(0x29a)]&&window[_0x1ad248(0x29a)]['cancel']();}catch(_0x57caa2){}return;}const _0x3a29e3={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':'https://www.youtube.com'};(window[_0x1ad248(0x1e9)]['protocol']===_0x1ad248(0x379)||window[_0x1ad248(0x1e9)][_0x1ad248(0x233)]==='https:')&&(_0x3a29e3[_0x1ad248(0x291)]=window[_0x1ad248(0x1e9)]['origin']);ytPlayer=new YT[(_0x1ad248(0x3a6))](_0x1ad248(0x2a7),_0x3a29e3);try{window['__ytApiWatchdog']&&window[_0x1ad248(0x29a)][_0x1ad248(0x325)]();const _0x100b2d=document['getElementById'](_0x1ad248(0x3d6));_0x100b2d&&(_0x100b2d[_0x1ad248(0x26a)]='');}catch(_0x2b78d4){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage[_0x2deb62(0x318)](_0x2deb62(0x353))==='1';}catch(_0x237c16){}function showSoundPermission(){const _0xf8b707=_0x2deb62,_0x3809be=document[_0xf8b707(0x22a)](_0xf8b707(0x2bb));if(!_0x3809be)return;if(_ytUnlocked){_0x3809be[_0xf8b707(0x362)][_0xf8b707(0x223)](_0xf8b707(0x286));return;}_0x3809be[_0xf8b707(0x362)][_0xf8b707(0x33b)]('show');}function hideSoundPermission(){const _0x1ef42f=_0x2deb62,_0x56c796=document[_0x1ef42f(0x22a)](_0x1ef42f(0x2bb));if(!_0x56c796)return;_0x56c796[_0x1ef42f(0x362)][_0x1ef42f(0x223)](_0x1ef42f(0x286));}function unlockAudioChain(){const _0x4d402a=_0x2deb62;try{if(AUDIO_CTX&&typeof AUDIO_CTX['resume']===_0x4d402a(0x403))AUDIO_CTX['resume']();}catch(_0x33339a){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x4d402a(0x173)]&&(ytPlayer[_0x4d402a(0x173)](),ytPlayer[_0x4d402a(0x449)]());}catch(_0x1c0795){}_ytUnlocked=!![];try{localStorage['setItem']('sound_unlocked','1');}catch(_0x1e1f1e){}hideSoundPermission(),toast(_0x4d402a(0x1c8));}function onPlayerReady(_0x4f985f){const _0x24dc17=_0x2deb62;try{const _0x50c8a0=ytPlayer&&ytPlayer[_0x24dc17(0x230)]?ytPlayer[_0x24dc17(0x230)]():null;_0x50c8a0&&_0x50c8a0[_0x24dc17(0x1a2)](_0x24dc17(0x376),_0x24dc17(0x22e));}catch(_0x4dc495){}try{if(ytPlayer&&ytPlayer[_0x24dc17(0x2a2)])ytPlayer['setVolume'](data&&data[_0x24dc17(0x1b8)]&&data[_0x24dc17(0x1b8)][_0x24dc17(0x3f7)]||0x50);}catch(_0x3ef2ee){}try{const _0x129913=getActiveVideoId&&getActiveVideoId();if(_0x129913&&ytPlayer&&ytPlayer[_0x24dc17(0x250)]&&ytPlayer[_0x24dc17(0x449)]){ytPlayer[_0x24dc17(0x250)](),ytPlayer['playVideo'](),_ytPrimed=!![];const _0x163d82=()=>{const _0x338340=_0x24dc17;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x3753db){}window[_0x338340(0x425)](_0x338340(0x2e8),_0x163d82,!![]),window[_0x338340(0x425)](_0x338340(0x2a9),_0x163d82,!![]);};window['addEventListener'](_0x24dc17(0x2e8),_0x163d82,!![]),window[_0x24dc17(0x396)](_0x24dc17(0x2a9),_0x163d82,!![]),showSoundPermission();}}catch(_0x383ed1){}updateYouTubePlayer();}function onPlayerStateChange(_0x53579b){const _0x4d2fa7=_0x2deb62,_0x2488b2=$('#btnToggleYtSound');_0x53579b[_0x4d2fa7(0x18d)]==YT[_0x4d2fa7(0x335)][_0x4d2fa7(0x204)]?(_0x2488b2[_0x4d2fa7(0x26a)]='⏸️',hideSoundPermission()):_0x2488b2[_0x4d2fa7(0x26a)]='▶';if(_0x53579b[_0x4d2fa7(0x18d)]===YT[_0x4d2fa7(0x335)]['ENDED']){if(!ytUserPaused)ytPlayer[_0x4d2fa7(0x449)]();}}function _0x2ba0(_0x4f2ff6,_0x25b0c4){const _0x5cb74a=_0x5cb7();return _0x2ba0=function(_0x2ba08e,_0x48a01f){_0x2ba08e=_0x2ba08e-0x139;let _0x39778e=_0x5cb74a[_0x2ba08e];return _0x39778e;},_0x2ba0(_0x4f2ff6,_0x25b0c4);}async function ytFadeTo(_0x51d0da,_0x427cd6=0xfa){const _0x507c2a=_0x2deb62;try{if(!ytPlayer||!ytPlayer['getVolume']||!ytPlayer[_0x507c2a(0x2a2)])return;ytPlayer['unMute']();const _0x272f83=ytPlayer[_0x507c2a(0x450)](),_0x1c251a=_0x51d0da-_0x272f83;if(Math[_0x507c2a(0x347)](_0x1c251a)<0x1||_0x427cd6<=0x0){ytPlayer['setVolume'](_0x51d0da);return;}const _0x55ead5=performance[_0x507c2a(0x3ad)]();await new Promise(_0x3711ed=>{const _0x4c6ca1=_0x57272a=>{const _0x2e0a7e=Math['min'](0x1,(_0x57272a-_0x55ead5)/_0x427cd6),_0x47cfc=Math['round'](_0x272f83+_0x1c251a*_0x2e0a7e);ytPlayer['setVolume'](_0x47cfc);if(_0x2e0a7e<0x1)requestAnimationFrame(_0x4c6ca1);else _0x3711ed();};requestAnimationFrame(_0x4c6ca1);});}catch(_0x321e6a){}}async function ytFadeInPlay(_0x4481ad=0xdc){const _0x2ee8bb=_0x2deb62;try{const _0x360e97=Math['max'](0x0,Math[_0x2ee8bb(0x27a)](0x64,data&&data[_0x2ee8bb(0x1b8)]&&data[_0x2ee8bb(0x1b8)][_0x2ee8bb(0x3f7)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer['unMute'](),ytPlayer['playVideo']();try{ytPlayer['setVolume'](0x0);}catch(_0x5819dd){}await ytFadeTo(_0x360e97,_0x4481ad);}else{const _0x1f0ac5=getActiveVideoId();_0x1f0ac5&&fallbackLoadVideo(_0x1f0ac5,{'autoplay':0x1,'mute':0x0});}}catch(_0x356db8){}}async function ytFadeOutPause(_0x223441=0xb4){const _0x46b60b=_0x2deb62;try{const _0x4978b2=Math['max'](0x0,Math[_0x46b60b(0x27a)](0x64,data&&data[_0x46b60b(0x1b8)]&&data[_0x46b60b(0x1b8)]['youtubeVolume']||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x223441);try{ytPlayer[_0x46b60b(0x437)](),ytPlayer['setVolume'](_0x4978b2);}catch(_0x400b51){}}else try{fallbackPause();}catch(_0x11afa1){}}catch(_0x24498c){}}async function updateYouTubePlayer(){const _0x2c6ebe=_0x2deb62,_0x4c4a2b=getActiveVideoId();if(data[_0x2c6ebe(0x1b8)][_0x2c6ebe(0x2a6)]&&_0x4c4a2b){const _0x3ff329=_0x2c6ebe(0x1b4)+_0x4c4a2b+_0x2c6ebe(0x260),_0x52cf9b=new Image();_0x52cf9b[_0x2c6ebe(0x37c)]=async()=>{const _0x2bf892=_0x2c6ebe;data[_0x2bf892(0x1b8)][_0x2bf892(0x3e4)]=_0x3ff329,await saveData(),applyCustomBg();},_0x52cf9b['onerror']=async()=>{const _0x2608d3=_0x2c6ebe,_0x26cd25=_0x2608d3(0x1b4)+_0x4c4a2b+_0x2608d3(0x225);data[_0x2608d3(0x1b8)]['customBg']=_0x26cd25,await saveData(),applyCustomBg();},_0x52cf9b[_0x2c6ebe(0x189)]=_0x3ff329;}else!_0x4c4a2b&&(data[_0x2c6ebe(0x1b8)][_0x2c6ebe(0x3e4)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x4c4a2b){fallbackStop(),hideSoundPermission();return;}const _0x40552b=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x4c4a2b,{'autoplay':0x1,'mute':_0x40552b});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer['cueVideoById']){try{ensureYouTubeAPI();}catch(_0x33be84){}return;}if(!_0x4c4a2b){if(ytPlayer['stopVideo'])ytPlayer[_0x2c6ebe(0x456)]();hideSoundPermission();return;}ytPlayer[_0x2c6ebe(0x2f8)](_0x4c4a2b),ytPlayer[_0x2c6ebe(0x2a2)](data[_0x2c6ebe(0x1b8)][_0x2c6ebe(0x3f7)]);}function toggleYtSound(){const _0x22598f=_0x2deb62;if(!_ytUnlocked){try{ensureAudio();}catch(_0xdcd0d7){}try{unlockAudioChain();}catch(_0x205bfd){}return;}if(IS_FILE_PROTOCOL){const _0x542134=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0x22598f(0x296)]){if(!_0x542134){toast('No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.');return;}fallbackLoadVideo(_0x542134,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x50844e=document['getElementById']('btnToggleYtSound');if(_0x50844e)_0x50844e['textContent']='⏸️';}catch(_0x467e90){}toast(_0x22598f(0x322));return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0x22598f(0x437)),ytFallbackIsPlaying=![],toast(_0x22598f(0x18e));else{if(!_0x542134){toast('No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.');return;}fallbackPostMessage(_0x22598f(0x449)),ytFallbackIsPlaying=!![],toast(_0x22598f(0x322));}try{const _0x3e4941=document[_0x22598f(0x22a)](_0x22598f(0x243));if(_0x3e4941)_0x3e4941[_0x22598f(0x26a)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x2a97fe){}return;}if(!ytPlayer||typeof ytPlayer[_0x22598f(0x382)]!==_0x22598f(0x403)){try{ensureYouTubeAPI();}catch(_0x2b5de2){}return;}const _0x5caf4c=ytPlayer['getPlayerState']();_0x5caf4c===YT[_0x22598f(0x335)][_0x22598f(0x204)]||_0x5caf4c===YT[_0x22598f(0x335)][_0x22598f(0x1ae)]?(ytFadeOutPause(),ytUserPaused=!![],toast(_0x22598f(0x18e))):(ytFadeInPlay(),ytUserPaused=![],toast(_0x22598f(0x322)));}function bindEvents(){const _0x3c29b2=_0x2deb62;try{const _0x482012=document[_0x3c29b2(0x205)](_0x3c29b2(0x3d0));_0x482012&&(_0x482012['innerHTML']=_0x3c29b2(0x284));}catch(_0x5503e5){}on($(_0x3c29b2(0x39d)),_0x3c29b2(0x1c4),toggleBackgroundView),on($(_0x3c29b2(0x432)),_0x3c29b2(0x1c4),()=>{const _0x2c0ed5=_0x3c29b2;$(_0x2c0ed5(0x43e))[_0x2c0ed5(0x362)]['remove'](_0x2c0ed5(0x286));try{releaseFocus();}catch(_0x5f19a0){}}),on($(_0x3c29b2(0x3ba)),'click',()=>showInputModal('New\x20Topic\x20name?',async _0x6cd8fc=>{const _0x4c6b09=_0x3c29b2;if(!_0x6cd8fc)return;data['topics'][_0x4c6b09(0x357)]({'id':uid('t'),'name':_0x6cd8fc,'subtopics':[]}),await saveData(),renderTopics();})),on($('#btnExport'),_0x3c29b2(0x1c4),()=>storageManager[_0x3c29b2(0x1c0)](data)),on($(_0x3c29b2(0x1f6)),'change',_0x33ce37=>{const _0x380826=_0x3c29b2,_0x1b7666=_0x33ce37[_0x380826(0x1f7)]['files'][0x0];if(!_0x1b7666)return;storageManager['importData'](_0x1b7666)[_0x380826(0x3a9)](async _0xeeacf6=>{data=_0xeeacf6,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast('Data\x20imported\x20successfully!'),renderAll();})[_0x380826(0x1e7)](_0x3922fd=>toast('Import\x20failed:\x20'+_0x3922fd[_0x380826(0x210)])),_0x33ce37['target'][_0x380826(0x1b9)]=null;}),on($(_0x3c29b2(0x1e1)),'click',()=>{const _0x1c9e00=_0x3c29b2,_0x555f8d=$(_0x1c9e00(0x20c)),_0x483539=_0x555f8d?_0x555f8d[_0x1c9e00(0x1b9)]:'';if(!_0x483539){toast(_0x1c9e00(0x457));return;}showConfirmModal(_0x1c9e00(0x2f1),'Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20'+new Date(_0x483539)[_0x1c9e00(0x19f)]()+_0x1c9e00(0x426),_0x471875=>{_0x471875&&storageManager['restoreBackup'](_0x483539)['then'](_0x917f2f=>{const _0x39b43f=_0x2ba0;data=_0x917f2f,toast(_0x39b43f(0x35b)),setTimeout(()=>window[_0x39b43f(0x1e9)][_0x39b43f(0x34a)](),0x5dc);})['catch'](_0x4fbdc3=>{const _0x4434d7=_0x2ba0;toast(_0x4434d7(0x271)+_0x4fbdc3[_0x4434d7(0x210)]);});});}),on($(_0x3c29b2(0x28d)),_0x3c29b2(0x2f9),_0x4f9028=>{const _0x3fb3a8=_0x3c29b2,_0x5be26e=_0x4f9028[_0x3fb3a8(0x1f7)]['value'];applyTheme(_0x5be26e);if(_0x5be26e===_0x3fb3a8(0x287)||_0x5be26e==='pastel'){const _0x11074c=$(_0x3fb3a8(0x308));_0x11074c&&(_0x11074c['checked']=![],toast(_0x3fb3a8(0x36c),0x7d0));try{document[_0x3fb3a8(0x3d8)]['style'][_0x3fb3a8(0x26e)](_0x3fb3a8(0x43a),_0x3fb3a8(0x2ba));}catch(_0x2487d2){}}else{const _0x1dda2d=$(_0x3fb3a8(0x308));_0x1dda2d&&(_0x1dda2d['checked']=!![]);try{updateYouTubePlayer();}catch(_0xff3163){}}}),on($(_0x3c29b2(0x25f)),_0x3c29b2(0x1c4),openSettings),on($(_0x3c29b2(0x404)),_0x3c29b2(0x1c4),()=>{const _0x5c793d=_0x3c29b2;switchView('topics'),$(_0x5c793d(0x3ba))[_0x5c793d(0x1c4)]();}),on($(_0x3c29b2(0x3c7)),'click',()=>{const _0x45c45d=_0x3c29b2;renderDashboard(),$(_0x45c45d(0x1fa))[_0x45c45d(0x362)]['add']('show');}),on($(_0x3c29b2(0x26d)),_0x3c29b2(0x1c4),()=>{const _0x5f5daf=_0x3c29b2;$(_0x5f5daf(0x1fa))[_0x5f5daf(0x362)][_0x5f5daf(0x223)](_0x5f5daf(0x286));}),on($(_0x3c29b2(0x293)),'click',closeSettings),on($(_0x3c29b2(0x2ff)),_0x3c29b2(0x1c4),saveSettings),on($(_0x3c29b2(0x445)),'click',setDefaults),on($('#btnTestSound'),_0x3c29b2(0x1c4),()=>{const _0x2fd9aa=_0x3c29b2;ensureAudio(),playSound(_0x2fd9aa(0x2c3));}),on($('#btnToggleCustomSounds'),_0x3c29b2(0x1c4),_0x5f4970=>{const _0x35f177=_0x3c29b2;_0x5f4970[_0x35f177(0x216)]();const _0x2b49d7=$(_0x35f177(0x1db));if(_0x2b49d7)_0x2b49d7['classList']['toggle'](_0x35f177(0x3ea));}),on($(_0x3c29b2(0x3a2)),_0x3c29b2(0x1c4),async()=>{const _0x29fbbc=_0x3c29b2,_0x3b5d9c=getCurrentSubtopic();if(!_0x3b5d9c)return;const _0xa917f0=pendingNoteSessionId,_0x488c92=_0x3b5d9c[_0x29fbbc(0x16c)][_0x29fbbc(0x3c0)](_0x692567=>_0x692567['id']===_0xa917f0);_0x488c92&&(_0x488c92[_0x29fbbc(0x3bc)]=$(_0x29fbbc(0x1aa))[_0x29fbbc(0x1b9)][_0x29fbbc(0x37a)](),await saveData(),renderStatsHistory(),toast(_0x29fbbc(0x17b))),closeNoteModal();}),on($(_0x3c29b2(0x3a7)),_0x3c29b2(0x1c4),()=>closeNoteModal()),on($(_0x3c29b2(0x1d3)),'click',addGeneralNote),on($('#btnSummarizeNote'),_0x3c29b2(0x1c4),handleSummarizeNote),on($(_0x3c29b2(0x34f)),_0x3c29b2(0x1c4),handleSendMessage),on($('#chatInput'),_0x3c29b2(0x2a9),_0x5728c3=>{const _0x484fa9=_0x3c29b2;if(_0x5728c3[_0x484fa9(0x2ee)]==='Enter')handleSendMessage();}),$$('#aiPromptSuggestions\x20button')[_0x3c29b2(0x19c)](_0x285fad=>{on(_0x285fad,'click',()=>{const _0x161342=_0x2ba0,_0x125468=_0x285fad[_0x161342(0x192)]['prompt'];$(_0x161342(0x402))[_0x161342(0x1b9)]=_0x125468,$(_0x161342(0x402))['focus']();});}),on($(_0x3c29b2(0x3f1)),_0x3c29b2(0x1c4),clearChat),on($(_0x3c29b2(0x31a)),_0x3c29b2(0x1c4),addSubtopicTask),on($(_0x3c29b2(0x266)),'keydown',_0x54635b=>{const _0x2806e0=_0x3c29b2;if(_0x54635b['key']===_0x2806e0(0x2f2))addSubtopicTask();}),on($('#btnToggleYtSound'),_0x3c29b2(0x1c4),toggleYtSound),on($(_0x3c29b2(0x27f)),_0x3c29b2(0x1c4),()=>{ensureAudio(),unlockAudioChain();}),on($('#ytSoundVolume'),_0x3c29b2(0x2f9),_0x5334e7=>{const _0x2e33c3=_0x3c29b2,_0x37e52c=parseInt(_0x5334e7['target']['value'],0xa);ytPlayer&&ytPlayer[_0x2e33c3(0x2a2)]&&ytPlayer[_0x2e33c3(0x2a2)](_0x37e52c);}),on($(_0x3c29b2(0x3ee)),_0x3c29b2(0x2f9),handleYoutubeUrlInput),$$(_0x3c29b2(0x44f))[_0x3c29b2(0x19c)](_0x49e113=>{const _0x2f998d=_0x3c29b2;_0x49e113[_0x2f998d(0x396)](_0x2f998d(0x1c4),()=>{const _0x27da61=_0x2f998d,_0x1b9ea6=_0x49e113[_0x27da61(0x192)][_0x27da61(0x31d)],_0x58316d=data?.[_0x27da61(0x1b8)]?.[_0x27da61(0x2c0)]||_0x27da61(0x220);if(_0x58316d===_0x1b9ea6&&_0x1b9ea6!==_0x27da61(0x220))switchView(_0x27da61(0x220));else switchView(_0x1b9ea6);});}),$$('.tab-btn')[_0x3c29b2(0x19c)](_0x3a9e38=>{const _0x4d8882=_0x3c29b2;_0x3a9e38[_0x4d8882(0x396)](_0x4d8882(0x1c4),()=>{const _0x374f0e=_0x4d8882,_0x1936f5=_0x3a9e38[_0x374f0e(0x192)]['tab'],_0x23dae5=_0x3a9e38[_0x374f0e(0x435)](_0x374f0e(0x1e5));if(!_0x23dae5)return;_0x23dae5['querySelectorAll'](_0x374f0e(0x152))[_0x374f0e(0x19c)](_0x2ba188=>_0x2ba188['classList']['remove'](_0x374f0e(0x30d))),_0x3a9e38[_0x374f0e(0x362)][_0x374f0e(0x33b)](_0x374f0e(0x30d)),_0x23dae5[_0x374f0e(0x203)](_0x374f0e(0x341))[_0x374f0e(0x19c)](_0x4c8449=>{const _0x1bd899=_0x374f0e;_0x4c8449[_0x1bd899(0x362)][_0x1bd899(0x223)](_0x1bd899(0x30d)),_0x4c8449[_0x1bd899(0x300)][_0x1bd899(0x38f)]='none';});const _0x35bdb4=_0x23dae5[_0x374f0e(0x205)]('#'+_0x1936f5);_0x35bdb4&&(_0x35bdb4[_0x374f0e(0x362)][_0x374f0e(0x33b)](_0x374f0e(0x30d)),_0x35bdb4[_0x374f0e(0x300)][_0x374f0e(0x38f)]='block',_0x23dae5[_0x374f0e(0x435)](_0x374f0e(0x2c2))&&(_0x35bdb4['style'][_0x374f0e(0x38f)]=_0x374f0e(0x1e0)));});});const _0xb1017c=$(_0x3c29b2(0x37b));function _0x3bfba2(_0x48a973,_0x59ef71=null){const _0x9812d6=_0x3c29b2;try{document[_0x9812d6(0x1d8)](_0x9812d6(0x3dc),![],!![]);}catch(_0x53aa91){}try{document[_0x9812d6(0x1d8)](_0x48a973,![],_0x59ef71);}catch(_0x8a3403){}if(_0xb1017c)_0xb1017c[_0x9812d6(0x168)]();}on($('#toolBold'),'click',()=>_0x3bfba2(_0x3c29b2(0x3b8))),on($(_0x3c29b2(0x1ba)),'click',()=>_0x3bfba2(_0x3c29b2(0x340))),on($(_0x3c29b2(0x176)),_0x3c29b2(0x1c4),()=>_0x3bfba2(_0x3c29b2(0x34b),_0x3c29b2(0x364))),on($('#toolList'),_0x3c29b2(0x1c4),()=>_0x3bfba2('insertOrderedList')),on($(_0x3c29b2(0x392)),_0x3c29b2(0x1c4),()=>_0x3bfba2(_0x3c29b2(0x346)));const _0x12c543=$(_0x3c29b2(0x3d1)),_0x2229bd=$('.color-palette');on($(_0x3c29b2(0x21a)),_0x3c29b2(0x1c4),_0x503d4a=>{const _0x577852=_0x3c29b2;if(!_0x2229bd)return;_0x503d4a[_0x577852(0x30a)](),_0x2229bd[_0x577852(0x362)]['toggle'](_0x577852(0x3ea));}),$$(_0x3c29b2(0x24f))['forEach'](_0x469211=>{on(_0x469211,'click',_0x4a1279=>{const _0x4b2cfb=_0x2ba0;_0x4a1279[_0x4b2cfb(0x216)]();const _0x36f4b5=_0x469211[_0x4b2cfb(0x192)][_0x4b2cfb(0x447)]||'';let _0xd0c363=_0x36f4b5;try{const _0x74d13c=_0x36f4b5['match'](/--[a-zA-Z0-9_-]+/);if(_0x74d13c)_0xd0c363=getComputedStyle(document[_0x4b2cfb(0x3d8)])['getPropertyValue'](_0x74d13c[0x0])['trim']();}catch(_0x33b4a0){}_0x3bfba2(_0x4b2cfb(0x1d4),_0xd0c363);if(_0x2229bd)_0x2229bd[_0x4b2cfb(0x362)]['add'](_0x4b2cfb(0x3ea));});}),on(document,_0x3c29b2(0x1c4),_0x5b743b=>{const _0x142cc7=_0x3c29b2;if(!_0x12c543||!_0x2229bd)return;!_0x12c543['contains'](_0x5b743b[_0x142cc7(0x1f7)])&&!_0x2229bd[_0x142cc7(0x362)]['contains'](_0x142cc7(0x3ea))&&_0x2229bd[_0x142cc7(0x362)][_0x142cc7(0x33b)](_0x142cc7(0x3ea));});function _0x587758(_0x5cc112){const _0x4e76ed=_0x3c29b2,_0x284e69=getCurrentSubtopic();if(!_0x284e69){toast(_0x4e76ed(0x1be));return;}const _0x577488=Array[_0x4e76ed(0x39c)](_0x284e69[_0x4e76ed(0x348)])?_0x284e69[_0x4e76ed(0x348)]:[],_0x21ccd5=_0x5cc112?_0x577488['find'](_0x907d8e=>_0x907d8e['id']===_0x5cc112):null;$('#methodEditorId')['value']=_0x21ccd5&&_0x21ccd5['id']||'',$(_0x4e76ed(0x427))[_0x4e76ed(0x26a)]=_0x21ccd5?_0x4e76ed(0x2cc):'Add\x20New\x20Knowledge',$(_0x4e76ed(0x3cb))[_0x4e76ed(0x1b9)]=_0x21ccd5&&_0x21ccd5[_0x4e76ed(0x2d3)]||'';const _0x5ca4c9=$(_0x4e76ed(0x37b));if(_0x5ca4c9)_0x5ca4c9[_0x4e76ed(0x143)]=_0x21ccd5&&_0x21ccd5['content']||'';$('#modalMethodEditor')[_0x4e76ed(0x362)][_0x4e76ed(0x33b)]('show');try{trapFocus($(_0x4e76ed(0x306)));}catch(_0x28d81e){}try{const _0x5068c4=$('#btnAutoFormat');if(_0x5068c4){const _0x3cf2ae=!!(data?.[_0x4e76ed(0x1b8)]?.[_0x4e76ed(0x2da)]&&data[_0x4e76ed(0x1b8)][_0x4e76ed(0x2da)][_0x4e76ed(0x37a)]());_0x5068c4[_0x4e76ed(0x2f5)]=!_0x3cf2ae,_0x5068c4[_0x4e76ed(0x2d3)]=_0x3cf2ae?_0x4e76ed(0x1f1):_0x4e76ed(0x319);}}catch(_0x1a58d5){}}on($(_0x3c29b2(0x238)),_0x3c29b2(0x1c4),()=>{const _0x31ea09=_0x3c29b2;$('#modalMethodEditor')[_0x31ea09(0x362)]['remove']('show');try{releaseFocus();}catch(_0x3a4ad8){}}),on($(_0x3c29b2(0x25e)),_0x3c29b2(0x1c4),async()=>{const _0xc181f0=_0x3c29b2,_0x39b8c7=$(_0xc181f0(0x386))[_0xc181f0(0x1b9)]||uid('m'),_0x21f6db=($(_0xc181f0(0x3cb))[_0xc181f0(0x1b9)]||'')[_0xc181f0(0x37a)](),_0x43de96=$(_0xc181f0(0x37b)),_0x3c52a3=_0x43de96?_0x43de96['innerHTML']||'':'',_0x17f011=getCurrentSubtopic();if(!_0x17f011){toast(_0xc181f0(0x1be));return;}if(!Array[_0xc181f0(0x39c)](_0x17f011['methods']))_0x17f011[_0xc181f0(0x348)]=[];const _0x3f29=_0x17f011[_0xc181f0(0x348)][_0xc181f0(0x324)](_0x4f9413=>_0x4f9413['id']===_0x39b8c7),_0x567d26={'id':_0x39b8c7,'title':_0x21f6db,'content':_0x3c52a3};if(_0x3f29>=0x0)_0x17f011[_0xc181f0(0x348)][_0x3f29]=_0x567d26;else _0x17f011[_0xc181f0(0x348)]['unshift'](_0x567d26);await saveData(),renderMethods(),$('#modalMethodEditor')['classList']['remove']('show');try{releaseFocus();}catch(_0x427a35){}}),on($('#btnAutoFormat'),'click',async()=>{const _0x88f098=_0x3c29b2,_0x156e10=$(_0x88f098(0x37b));if(!_0x156e10)return;const _0x54f10a=(_0x156e10['textContent']||'')[_0x88f098(0x37a)]();if(!_0x54f10a||_0x54f10a[_0x88f098(0x2f0)]<0x14){toast(_0x88f098(0x16a));return;}const _0x27340e=$(_0x88f098(0x25d));_0x27340e&&(_0x27340e[_0x88f098(0x2f5)]=!![],_0x27340e['innerHTML']=_0x88f098(0x177));const _0x37ad92=_0x88f098(0x159)+_0x54f10a+'\x22',_0x26a138=await callGeminiAPI(_0x37ad92);_0x26a138?(_0x156e10[_0x88f098(0x143)]=_0x26a138,toast(_0x88f098(0x156))):toast(_0x88f098(0x178)),_0x27340e&&(_0x27340e[_0x88f098(0x2f5)]=![],_0x27340e[_0x88f098(0x143)]=_0x88f098(0x28e));}),on($('#btnAddMethod'),_0x3c29b2(0x1c4),()=>_0x587758());const _0x1de358=document['querySelector']('#view-methods');_0x1de358&&_0x1de358[_0x3c29b2(0x396)](_0x3c29b2(0x1c4),_0x4123c7=>{const _0xcf9a0f=_0x3c29b2,_0x4859ef=_0x4123c7['target'][_0xcf9a0f(0x435)]&&_0x4123c7[_0xcf9a0f(0x1f7)][_0xcf9a0f(0x435)](_0xcf9a0f(0x198)),_0xccddc=!_0x4859ef&&_0x4123c7[_0xcf9a0f(0x1f7)][_0xcf9a0f(0x435)]&&_0x4123c7[_0xcf9a0f(0x1f7)][_0xcf9a0f(0x435)](_0xcf9a0f(0x44a));if(_0x4859ef){_0x4123c7['preventDefault'](),_0x4123c7['stopPropagation']();const _0x19faa6=_0x4859ef['dataset']['id'];if(_0x19faa6)_0x587758(_0x19faa6);return;}if(_0xccddc){_0x4123c7[_0xcf9a0f(0x216)](),_0x4123c7[_0xcf9a0f(0x30a)]();const _0x5bfbb3=_0xccddc[_0xcf9a0f(0x192)]['id'];if(!_0x5bfbb3)return;const _0x491109=getCurrentSubtopic();if(!_0x491109){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x46fdb4=Array['isArray'](_0x491109['methods'])?_0x491109[_0xcf9a0f(0x348)]:[],_0x14ba69=_0x46fdb4[_0xcf9a0f(0x3c0)](_0x5704b1=>_0x5704b1['id']===_0x5bfbb3);if(!_0x14ba69)return;showConfirmModal(_0xcf9a0f(0x1f4),'Delete\x20knowledge\x20\x22'+(_0x14ba69[_0xcf9a0f(0x2d3)]||'')+'\x22?',async _0x13d6f9=>{const _0x3a59a3=_0xcf9a0f;if(!_0x13d6f9)return;_0x491109[_0x3a59a3(0x348)]=_0x46fdb4[_0x3a59a3(0x1cf)](_0x53d6f8=>_0x53d6f8['id']!==_0x5bfbb3),await saveData(),renderMethods();});}});$$(_0x3c29b2(0x42b))[_0x3c29b2(0x19c)](_0x474cde=>{_0x474cde['addEventListener']('click',()=>{const _0x1491d1=_0x2ba0;editingPreset=_0x474cde[_0x1491d1(0x192)][_0x1491d1(0x22f)],highlightPresetSelector(),loadEditingPresetFields();});}),$$(_0x3c29b2(0x1bf))['forEach'](_0x2d37aa=>{const _0xc0acb4=_0x3c29b2;_0x2d37aa['addEventListener'](_0xc0acb4(0x1c4),_0x12c73b=>{const _0x2f0f8=_0xc0acb4,_0x134ded=_0x12c73b[_0x2f0f8(0x1f7)][_0x2f0f8(0x192)][_0x2f0f8(0x13c)],_0x59d93f=data[_0x2f0f8(0x1b8)]['preset'];if(_0x134ded===_0x59d93f)return;timer[_0x2f0f8(0x35e)]!=='idle'?showConfirmModal(_0x2f0f8(0x14b),_0x2f0f8(0x44b)+_0x134ded+_0x2f0f8(0x31f),_0x8330c3=>{const _0x1d5fd2=_0x2f0f8;_0x8330c3&&(timer[_0x1d5fd2(0x24b)](),timer[_0x1d5fd2(0x41f)](_0x134ded),renderAll(),toast(_0x1d5fd2(0x41b)+_0x134ded+'.'));}):(timer['setPreset'](_0x134ded),renderAll(),toast('Switched\x20to\x20Style\x20'+_0x134ded+'.'));});}),on($(_0x3c29b2(0x144)),_0x3c29b2(0x1c4),()=>timer[_0x3c29b2(0x3f5)]()),on($('#btnFinishFlow'),'click',()=>timer[_0x3c29b2(0x206)]()),on($(_0x3c29b2(0x246)),_0x3c29b2(0x1c4),()=>timer['pause']()),on($(_0x3c29b2(0x3a5)),_0x3c29b2(0x1c4),()=>timer[_0x3c29b2(0x275)]()),on($(_0x3c29b2(0x2c9)),_0x3c29b2(0x1c4),()=>timer[_0x3c29b2(0x328)]()),on($(_0x3c29b2(0x358)),_0x3c29b2(0x1c4),()=>timer[_0x3c29b2(0x24b)]()),on($(_0x3c29b2(0x294)),_0x3c29b2(0x1c4),()=>timer['beginBreak']()),on($(_0x3c29b2(0x2ef)),_0x3c29b2(0x317),_0x7f2893=>{const _0x216f5b=_0x3c29b2;handleFileUpload(_0x7f2893[_0x216f5b(0x1f7)][_0x216f5b(0x2b6)][0x0],async _0x29c62f=>{const _0x90d1b2=_0x216f5b;data[_0x90d1b2(0x1b8)][_0x90d1b2(0x3e4)]=_0x29c62f,await saveData(),applyCustomBg(),toast(_0x90d1b2(0x214));}),_0x7f2893[_0x216f5b(0x1f7)][_0x216f5b(0x1b9)]=null;}),on($(_0x3c29b2(0x3dd)),_0x3c29b2(0x1c4),async()=>{const _0x5531a6=_0x3c29b2;data[_0x5531a6(0x1b8)]['customBg']='',data['settings'][_0x5531a6(0x2a6)]=![],await saveData(),applyCustomBg(),toast(_0x5531a6(0x451)),$(_0x5531a6(0x2c2))[_0x5531a6(0x362)][_0x5531a6(0x141)](_0x5531a6(0x286))&&openSettings();}),on($(_0x3c29b2(0x36d)),'change',_0x191e1d=>{const _0x1dc879=_0x3c29b2;handleFileUpload(_0x191e1d[_0x1dc879(0x1f7)][_0x1dc879(0x2b6)][0x0],async _0x5acb4f=>{const _0x43b395=_0x1dc879;data[_0x43b395(0x1b8)][_0x43b395(0x2fb)][_0x43b395(0x2c3)]=_0x5acb4f,await saveData(),toast(_0x43b395(0x3e3));}),_0x191e1d[_0x1dc879(0x1f7)]['value']=null;}),on($(_0x3c29b2(0x2c6)),'change',_0x3ae8e0=>{const _0x48c01b=_0x3c29b2;handleFileUpload(_0x3ae8e0[_0x48c01b(0x1f7)]['files'][0x0],async _0x5a490d=>{const _0x6c8351=_0x48c01b;data[_0x6c8351(0x1b8)][_0x6c8351(0x2fb)][_0x6c8351(0x3fe)]=_0x5a490d,await saveData(),toast('Saved\x20alert\x20for\x20SHORT\x20BREAK.');}),_0x3ae8e0[_0x48c01b(0x1f7)]['value']=null;}),on($(_0x3c29b2(0x1fc)),'change',_0x3817c0=>{const _0x52b301=_0x3c29b2;handleFileUpload(_0x3817c0[_0x52b301(0x1f7)][_0x52b301(0x2b6)][0x0],async _0x3d789a=>{const _0x1395b1=_0x52b301;data['settings'][_0x1395b1(0x2fb)][_0x1395b1(0x44e)]=_0x3d789a,await saveData(),toast(_0x1395b1(0x1a0));}),_0x3817c0[_0x52b301(0x1f7)][_0x52b301(0x1b9)]=null;}),on($(_0x3c29b2(0x1c1)),'click',toggleFullScreen),document[_0x3c29b2(0x396)]('fullscreenchange',updateFullscreenButton),window['addEventListener'](_0x3c29b2(0x2a9),_0xc56708=>{const _0x1099c3=_0x3c29b2,_0x54cc94=_0xc56708[_0x1099c3(0x1f7)],_0x2c99ce=(_0x54cc94['tagName']||'')[_0x1099c3(0x2d6)](),_0x1e3546=[_0x1099c3(0x2f9),_0x1099c3(0x389),_0x1099c3(0x1ab)][_0x1099c3(0x20e)](_0x2c99ce)||_0x54cc94[_0x1099c3(0x245)];if(_0xc56708[_0x1099c3(0x345)]==='Space'&&!_0x1e3546){_0xc56708['preventDefault']();if(timer[_0x1099c3(0x35e)]==='idle'||timer['state']===_0x1099c3(0x1cc))timer['start']();else timer[_0x1099c3(0x24e)]();}(_0xc56708[_0x1099c3(0x2ee)]==='n'||_0xc56708[_0x1099c3(0x2ee)]==='N')&&(!_0x1e3546&&(_0xc56708[_0x1099c3(0x216)](),timer[_0x1099c3(0x328)]()));if(_0xc56708['key']==='Escape'){$$(_0x1099c3(0x29f))['forEach'](_0x3edb71=>_0x3edb71[_0x1099c3(0x362)][_0x1099c3(0x223)](_0x1099c3(0x286)));try{releaseFocus();}catch(_0x4e1453){}}if(_0xc56708['altKey']&&!_0x1e3546){if(_0xc56708[_0x1099c3(0x2ee)]===_0x1099c3(0x17c))_0xc56708[_0x1099c3(0x216)](),_0x12ffb3(0x0,-0xa);else{if(_0xc56708[_0x1099c3(0x2ee)]==='ArrowDown')_0xc56708[_0x1099c3(0x216)](),_0x12ffb3(0x0,0xa);else{if(_0xc56708[_0x1099c3(0x2ee)]===_0x1099c3(0x3b6))_0xc56708['preventDefault'](),_0x12ffb3(-0xa,0x0);else _0xc56708[_0x1099c3(0x2ee)]===_0x1099c3(0x41a)&&(_0xc56708[_0x1099c3(0x216)](),_0x12ffb3(0xa,0x0));}}}}),$$(_0x3c29b2(0x29f))[_0x3c29b2(0x19c)](_0x156e1f=>_0x156e1f[_0x3c29b2(0x396)](_0x3c29b2(0x1c4),_0x295e64=>{const _0x27a6af=_0x3c29b2;if(_0x295e64&&_0x295e64[_0x27a6af(0x1f7)]&&_0x295e64[_0x27a6af(0x1f7)]['id']===_0x27a6af(0x43c))return;if(_0x295e64[_0x27a6af(0x1f7)]===_0x156e1f){_0x156e1f[_0x27a6af(0x362)][_0x27a6af(0x223)]('show');try{releaseFocus();}catch(_0x423920){}}})),window['addEventListener'](_0x3c29b2(0x1c4),_0x260c87=>{const _0x2bb096=_0x3c29b2;!_0x260c87[_0x2bb096(0x1f7)][_0x2bb096(0x435)]('.actions-menu-btn')&&!_0x260c87[_0x2bb096(0x1f7)]['closest']('.actions-menu')&&closeAllMenus();});try{const _0xec0080=document['querySelector'](_0x3c29b2(0x3f3));if(_0xec0080)_0xec0080[_0x3c29b2(0x396)](_0x3c29b2(0x2f4),closeAllMenus);}catch(_0x585c25){}try{window[_0x3c29b2(0x396)]('scroll',closeAllMenus,!![]);}catch(_0x200fea){}window[_0x3c29b2(0x396)](_0x3c29b2(0x2d8),()=>timer['persistTimerState'](!![]));try{const _0x2710b4=Array['from'](document[_0x3c29b2(0x203)]('#view-methods\x20.method-item'));_0x2710b4[_0x3c29b2(0x2f0)]&&_0x2710b4[_0x3c29b2(0x19c)](_0x56b2cb=>{_0x56b2cb['addEventListener']('toggle',()=>{const _0x2ee3c2=_0x2ba0;_0x56b2cb['open']&&_0x2710b4[_0x2ee3c2(0x19c)](_0xacdccf=>{const _0x3aa268=_0x2ee3c2;if(_0xacdccf!==_0x56b2cb)_0xacdccf[_0x3aa268(0x150)]=![];});});});}catch(_0x5687f7){}const _0x5ab553=$(_0x3c29b2(0x1f5));let _0x3f13a0=![],_0x24ea54,_0x4be3fe;_0x5ab553&&(_0x5ab553[_0x3c29b2(0x396)](_0x3c29b2(0x29b),_0x3b752f=>{const _0x43254d=_0x3c29b2;_0x3f13a0=!![];const _0x4c098c=_0x5ab553[_0x43254d(0x253)]();_0x24ea54=_0x3b752f[_0x43254d(0x3b2)]-_0x4c098c['left'],_0x4be3fe=_0x3b752f[_0x43254d(0x221)]-_0x4c098c['top'],_0x5ab553[_0x43254d(0x300)][_0x43254d(0x3ed)]='none';}),document[_0x3c29b2(0x396)]('mousemove',_0x47575a=>{const _0x169c61=_0x3c29b2;if(!_0x3f13a0)return;let _0x3abc3d=_0x47575a['clientX']-_0x24ea54,_0x431f5d=_0x47575a['clientY']-_0x4be3fe;const _0x58e938=window[_0x169c61(0x3d2)]-_0x5ab553['offsetWidth'],_0x1c8656=window['innerHeight']-_0x5ab553[_0x169c61(0x25c)];_0x3abc3d=Math['max'](0x0,Math[_0x169c61(0x27a)](_0x3abc3d,_0x58e938)),_0x431f5d=Math[_0x169c61(0x1d5)](0x0,Math[_0x169c61(0x27a)](_0x431f5d,_0x1c8656)),_0x5ab553[_0x169c61(0x300)]['left']=_0x3abc3d+'px',_0x5ab553['style']['top']=_0x431f5d+'px',_0x5ab553[_0x169c61(0x300)][_0x169c61(0x153)]=_0x169c61(0x412),_0x5ab553[_0x169c61(0x300)][_0x169c61(0x436)]=_0x169c61(0x412);}),document[_0x3c29b2(0x396)]('mouseup',()=>{const _0x5dc747=_0x3c29b2;if(!_0x3f13a0)return;_0x3f13a0=![],_0x5ab553['style'][_0x5dc747(0x3ed)]='';}));function _0x4d3dfa(_0x209a30){const _0x393b3a=_0x3c29b2,_0x72b3b4=$('#draggableTimer');if(!_0x72b3b4)return;_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x298)]='fixed',_0x72b3b4['style'][_0x393b3a(0x3ed)]='',_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x3bb)]=_0x393b3a(0x412),_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x209)]='auto',_0x72b3b4['style']['right']='auto',_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x153)]=_0x393b3a(0x412);const _0x49e700=0x10;_0x209a30==='tl'&&(_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x3bb)]=_0x49e700+'px',_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x209)]=_0x49e700+'px'),_0x209a30==='tr'&&(_0x72b3b4['style'][_0x393b3a(0x436)]=_0x49e700+'px',_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x209)]=_0x49e700+'px'),_0x209a30==='bl'&&(_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x3bb)]=_0x49e700+'px',_0x72b3b4['style']['bottom']=_0x49e700+'px'),_0x209a30==='br'&&(_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x436)]=_0x49e700+'px',_0x72b3b4[_0x393b3a(0x300)][_0x393b3a(0x153)]=_0x49e700+'px');}function _0x12ffb3(_0x54ec72,_0x9aa95b){const _0x205230=_0x3c29b2,_0x321baa=$('#draggableTimer');if(!_0x321baa)return;const _0x5873ed=_0x321baa[_0x205230(0x253)](),_0x2dad10=Math[_0x205230(0x1d5)](0x0,Math[_0x205230(0x27a)](_0x5873ed[_0x205230(0x3bb)]+_0x54ec72,window['innerWidth']-_0x321baa[_0x205230(0x391)])),_0x5e1f20=Math[_0x205230(0x1d5)](0x0,Math['min'](_0x5873ed[_0x205230(0x209)]+_0x9aa95b,window[_0x205230(0x339)]-_0x321baa[_0x205230(0x25c)]));_0x321baa['style'][_0x205230(0x3bb)]=_0x2dad10+'px',_0x321baa[_0x205230(0x300)][_0x205230(0x209)]=_0x5e1f20+'px',_0x321baa['style'][_0x205230(0x436)]=_0x205230(0x412),_0x321baa['style']['bottom']=_0x205230(0x412);}}function toggleBackgroundView(){const _0x534a9a=_0x2deb62,_0x34685f=document[_0x534a9a(0x3d8)];_0x34685f[_0x534a9a(0x362)][_0x534a9a(0x3e7)](_0x534a9a(0x452));const _0x59e176=_0x34685f[_0x534a9a(0x362)][_0x534a9a(0x141)](_0x534a9a(0x452)),_0x645e08=$('#btnToggleBg');if(!_0x645e08)return;_0x59e176?(_0x645e08[_0x534a9a(0x2d3)]='Show\x20interface',_0x645e08['innerHTML']='<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>'):(_0x645e08[_0x534a9a(0x2d3)]=_0x534a9a(0x3c3),_0x645e08[_0x534a9a(0x143)]=_0x534a9a(0x36f));}function updateMainViewVisibility(){const _0x285acd=_0x2deb62,_0x1bc942=!!getCurrentSubtopic(),_0x974901=$('#view-timer'),_0x2e8db4=$(_0x285acd(0x258));_0x2e8db4&&_0x2e8db4[_0x285acd(0x362)][_0x285acd(0x3e7)](_0x285acd(0x3ea),_0x1bc942),_0x974901&&(_0x1bc942?_0x974901[_0x285acd(0x362)]['remove'](_0x285acd(0x3df)):_0x974901[_0x285acd(0x362)][_0x285acd(0x33b)](_0x285acd(0x3df)));}function updatePresetButtonsText(){const _0x183a84=_0x2deb62,_0x439488=data[_0x183a84(0x1b8)],_0x4a3ae0=_0x439488[_0x183a84(0x3d9)],_0x4ee84c=_0x439488[_0x183a84(0x363)],_0x4f144f=_0x439488['durations'][_0x183a84(0x34e)],_0x1b18d8=_0x439488[_0x183a84(0x211)]['B_work'],_0x53ae78=$(_0x183a84(0x32c)),_0x17fec7=$(_0x183a84(0x1f9)),_0x249dcf=$(_0x183a84(0x2df));_0x53ae78&&(_0x53ae78['textContent']=_0x4a3ae0+'×'+_0x4f144f+_0x183a84(0x261)),_0x17fec7&&(_0x17fec7[_0x183a84(0x26a)]=_0x4ee84c+'×'+_0x1b18d8+_0x183a84(0x3cd)),_0x249dcf&&(_0x249dcf['textContent']=_0x183a84(0x2b2));}function renderAll(){const _0x1a8894=_0x2deb62;updatePresetButtonsText();const _0x27262a=data[_0x1a8894(0x1b8)][_0x1a8894(0x13c)];$$(_0x1a8894(0x1bf))[_0x1a8894(0x19c)](_0x82bbfb=>{const _0x5e012c=_0x1a8894,_0xce8a50=_0x82bbfb['dataset']['preset']===_0x27262a;_0x82bbfb[_0x5e012c(0x362)][_0x5e012c(0x3e7)]('acc',_0xce8a50),_0x82bbfb[_0x5e012c(0x362)]['toggle'](_0x5e012c(0x1da),!_0xce8a50),_0x82bbfb[_0x5e012c(0x1a2)]('aria-pressed',_0xce8a50);}),updateMainViewVisibility(),timer[_0x1a8894(0x41f)](data[_0x1a8894(0x1b8)][_0x1a8894(0x13c)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x1a8894(0x1b8)][_0x1a8894(0x2c0)]);}function toggleFullScreen(){const _0x2f0b2f=_0x2deb62;!document['fullscreenElement']?document[_0x2f0b2f(0x274)][_0x2f0b2f(0x3cc)]()[_0x2f0b2f(0x1e7)](_0x57a299=>{const _0x59e947=_0x2f0b2f;toast(_0x59e947(0x380)+_0x57a299[_0x59e947(0x210)]);}):document[_0x2f0b2f(0x184)]&&document[_0x2f0b2f(0x184)]();}function updateFullscreenButton(){const _0xb09807=_0x2deb62,_0x6ae018=$(_0xb09807(0x1c1));document[_0xb09807(0x2e6)]?(_0x6ae018[_0xb09807(0x143)]='↙',_0x6ae018[_0xb09807(0x2d3)]=_0xb09807(0x19d)):(_0x6ae018['innerHTML']='↗',_0x6ae018[_0xb09807(0x2d3)]=_0xb09807(0x2fc));}async function initializeApp(){const _0x927f7d=_0x2deb62;try{await storageManager[_0x927f7d(0x3a3)]();const [_0x4b8799,_0x3bcac9,_0xbc4335]=await Promise[_0x927f7d(0x282)]([storageManager[_0x927f7d(0x283)](),storageManager[_0x927f7d(0x31c)](_0x927f7d(0x2d9)),storageManager[_0x927f7d(0x31c)](_0x927f7d(0x212))]);let _0x528506;if(!_0x4b8799){const _0x3ef09d=JSON[_0x927f7d(0x1f2)](JSON['stringify'](defaults));await storageManager['updateSettings'](_0x3ef09d[_0x927f7d(0x1b8)]);for(const _0x104a77 of _0x3ef09d[_0x927f7d(0x2d9)]){const {subtopics:_0xb471f4,..._0x35f966}=_0x104a77;await storageManager[_0x927f7d(0x33b)](_0x927f7d(0x2d9),_0x35f966);for(const _0x9e252e of _0xb471f4){await storageManager[_0x927f7d(0x33b)](_0x927f7d(0x212),{..._0x9e252e,'topicId':_0x104a77['id']});}}_0x528506=_0x3ef09d;}else{const _0x482266={};for(const _0x5b049f of _0x3bcac9)_0x482266[_0x5b049f['id']]={..._0x5b049f,'subtopics':[]};for(const _0x41283d of _0xbc4335)_0x482266[_0x41283d[_0x927f7d(0x2e4)]]?.['subtopics'][_0x927f7d(0x357)](_0x41283d);_0x528506={'version':defaults['version'],'settings':_0x4b8799,'topics':Object['values'](_0x482266)};}data=window[_0x927f7d(0x18d)]=_0x528506,normalizeDataStructure(data),await ensureValidSelection(),await migrateSharedMethodsToCurrentSubtopic(),await seedAchievedMilestones(),renderAll();try{storageManager[_0x927f7d(0x194)](data);}catch(_0xa8d197){console[_0x927f7d(0x1d0)](_0x927f7d(0x208),_0xa8d197);}bindEvents(),applyTheme();}catch(_0x46d7a2){console[_0x927f7d(0x1b1)]('Initialization\x20error:',_0x46d7a2),toast(_0x927f7d(0x3fd)+_0x46d7a2['message']);}}callGeminiAPI=async function(_0x502165,_0x36e080=0x3,_0x82aa64=0x3e8){const _0x48fde4=_0x2deb62,_0x17445e=data?.['settings']?.[_0x48fde4(0x2da)]||'';if(!_0x17445e)return toast(_0x48fde4(0x444)),null;const _0x303fed=_0x48fde4(0x15e)+_0x17445e,_0x1b9d29={'contents':[{'role':'user','parts':[{'text':_0x502165}]}]};try{const _0x5e98eb=await fetch(_0x303fed,{'method':_0x48fde4(0x3e5),'headers':{'Content-Type':'application/json'},'body':JSON['stringify'](_0x1b9d29)});if(!_0x5e98eb['ok']){if(_0x5e98eb['status']===0x1ad&&_0x36e080>0x0)return await new Promise(_0x35acea=>setTimeout(_0x35acea,_0x82aa64)),callGeminiAPI(_0x502165,_0x36e080-0x1,_0x82aa64*0x2);let _0x169c50=null;try{_0x169c50=await _0x5e98eb['json']();}catch(_0x283768){}let _0x167d2f='HTTP\x20error:\x20'+_0x5e98eb[_0x48fde4(0x378)];if(_0x5e98eb[_0x48fde4(0x378)]===0x190)_0x167d2f='Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.';else{if(_0x5e98eb['status']===0x1ad)_0x167d2f='Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.';else _0x169c50?.[_0x48fde4(0x1b1)]?.[_0x48fde4(0x210)]&&(_0x167d2f=_0x48fde4(0x263)+_0x169c50[_0x48fde4(0x1b1)][_0x48fde4(0x210)]);}return toast(_0x167d2f,0xfa0),console[_0x48fde4(0x1b1)](_0x48fde4(0x42d),_0x169c50||_0x5e98eb[_0x48fde4(0x337)]),null;}const _0x1bce8e=await _0x5e98eb[_0x48fde4(0x264)]();if(_0x1bce8e['candidates']&&_0x1bce8e[_0x48fde4(0x14a)][0x0]?.[_0x48fde4(0x24d)]?.[_0x48fde4(0x299)]?.[0x0]?.[_0x48fde4(0x417)])return formatGeminiResponse(_0x1bce8e[_0x48fde4(0x14a)][0x0][_0x48fde4(0x24d)][_0x48fde4(0x299)][0x0][_0x48fde4(0x417)]);else{console[_0x48fde4(0x1b1)]('API\x20response\x20structure\x20is\x20unexpected:',_0x1bce8e);if(_0x1bce8e[_0x48fde4(0x2d4)]?.[_0x48fde4(0x36e)])return _0x48fde4(0x3ec)+_0x1bce8e[_0x48fde4(0x2d4)][_0x48fde4(0x36e)]+_0x48fde4(0x1ec);return _0x48fde4(0x3d4);}}catch(_0x343c87){return console[_0x48fde4(0x1b1)](_0x48fde4(0x247),_0x343c87),toast(_0x48fde4(0x2a4),0xfa0),null;}},loadLanguage(localStorage[_0x2deb62(0x318)]('lang')||'en')['then'](initializeApp);
    </script>
</body>
</html>
