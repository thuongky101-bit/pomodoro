<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="A Pomodoro application for studying, featuring Gemini AI integration and a modern interface." />
    <title>Pomodoro Study App — Gemini AI Integration (New UI)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — FOCUSED UI VERSION (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Default) - Updated from file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Add RGB variable for panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: ADD NEW THEMES === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: ADD NEW THEMES === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Add border rules for light/pastel themes */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Modified: remove default border */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: UPDATE TOPIC MANAGEMENT UI === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Modified */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Raise the open menu block above others */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: UPDATE TOPIC MANAGEMENT UI === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Modified */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Keep background transparent on hover */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Color tweak */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Color tweak */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: SOFTER DIVIDER CUSTOMIZATION === */
    #view-timer .panel-bg hr {
        border: none; /* Remove default border */
        height: 1px;  /* Set divider height */
        background-color: var(--muted); /* Use theme's secondary color */
        opacity: 0.3; /* Make it subtle to blend with background */
        margin-top: 0; /* Adjust spacing */
    }
    /* === END: SOFTER DIVIDER CUSTOMIZATION === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Modified */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Modified */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Modified */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Raise z-index to sit above header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Modified */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Modified */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Modified */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Modified */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Modified */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Modified: switched to translucent white background */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Faint white border */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Fine-tune: closer to spec */
        border-color: var(--acc);
    }
    /* === START: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Use translucent black instead of white on light theme */
        border-color: rgba(0, 0, 0, 0.1); /* Faint black border on light themes */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Increase density on focus */
    }
    /* === END: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */

    /* Improve option background and text color per current theme */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Tweak */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Reduce/remove text shadow on light themes to avoid blur/glare */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Timer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Timer</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Topics">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Topics</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Stats">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Stats</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Knowledge Base">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Knowledge Base</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Settings">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Settings</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Guide</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">No Subtopic Selected</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard">📊 Dashboard </button>
          <a href="https://forms.gle/61hYjvwAkR328EaC9" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Send your feedback">💬 Feedback</a>
          <button class="btn ghost small" id="btnExport" title="Export JSON">⬇️ Export File</button>
          <label class="btn ghost small" for="importFile" title="Import JSON">⬆️ Import File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Show/Hide Interface">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Fullscreen">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Welcome to the Pomodoro Study App!</h3>
                <p>Get started by selecting a <strong>Subtopic</strong> or creating a new Topic/Subtopic.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Create New Topic</button>
            </div>
            <div class="presets" role="group" aria-label="Choose preset mode">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">STATUS</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Wind-down Checklist</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Save your current work (Save/Commit).</li>
                <li>Jot down the "Next step".</li>
                <li>Tidy up your workspace.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Start (Space)">▶️ Start</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="End focus session">🧘 Start Break</button>
              <button class="btn" id="btnPause" aria-label="Pause (Space)">⏸️ Pause</button>
              <button class="btn" id="btnResume" aria-label="Resume (Space)">⏵ Resume</button>
              <button class="btn warn" id="btnSkip" aria-label="Skip (N)">⏭️ Skip</button>
              <button class="btn danger" id="btnReset">↺ Reset</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Break Early</button>
            </div>
            <div class="tiny">Shortcuts: <strong>Space</strong> = Start/Pause/Resume, <strong>N</strong> = Next/Skip</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Tasks</button>
                <button class="tab-btn" data-tab="notes">Notes</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-dos for this subtopic:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Add a new task..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Add</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Add a new note..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Add Note</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini for: <span id="currentSubtopicNameChat">(none selected)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Clear History">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Explain the key concepts of this topic">Explain Concept</button>
                  <button class="btn small ghost" data-prompt="Create a detailed outline for this topic">Create Outline</button>
                  <button class="btn small ghost" data-prompt="List 5 important review questions for this topic">Create Review Questions</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Ask Gemini something..." />
                  <button id="btnSendMessage" class="btn acc">Send</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Topic Management</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Add Topic</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Click the arrow to expand/collapse the subtopic list.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Statistics & History — <span id="currentSubtopicName">(none selected)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Total Time</h4><div class="stat-value" id="statTotal">0 min</div></div>
              <div class="stat-card"><h4>Sessions</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Tasks Completed</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">History (FOCUS)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Knowledge Base per Subtopic</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Add Knowledge</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Click on an item to see details.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Discover the Pomodoro Study App</h3>
              <p>
                  Welcome to a study space designed for focus and efficiency. Explore the features that support your learning journey.
              </p>

              <h4>🚀 Quick Start in 4 Steps</h4>
              <p>To keep your journey organized, the app uses a <strong>Main Topic → Subtopic</strong> structure.</p>
              <ol>
                  <li>Open <strong>📚 Topics</strong> from the side navigation.</li>
                  <li>Click <strong>＋ Add Topic</strong> to create a main area (e.g., "Conversational English").</li>
                  <li>Next to the topic, click <strong>＋ Add</strong> to create a more specific subtopic (e.g., "Lesson 1: Practice IPA").</li>
                  <li>Select that subtopic. You’re now ready to start your first focus session!</li>
              </ol>

              <hr />
              <h4>✨ Notable Features</h4>

              <h4>Flexible Timer Modes ⏱️</h4>
              <p>The app offers more than Pomodoro. Pick what fits your work:</p>
              <ul>
                  <li><strong>Classic Pomodoro (Style A/B):</strong> Focus in fixed sessions (e.g., 25 min work, 5 min break) to build discipline and cadence.</li>
                  <li><strong>Flowtime Mode (Style 🌊 Flow):</strong> Ideal for deep work. The timer counts up; end when it feels right. Break time is suggested based on your focus time.</li>
                  <li><strong>Wind-down Buffer:</strong> A customizable buffer between focus and break to wrap up, jot the next step, and switch smoothly—without abrupt cutoffs.</li>
              </ul>

              <h4>Knowledge Base Per Subtopic 💡</h4>
              <p>
                  Each <strong>Subtopic</strong> now has its own dedicated Knowledge Base. This lets you build a focused library of methods and notes that only relate to what you’re studying in that subtopic.
              </p>
              <p>
                  For example, notes and methods for “Conversational English” will only appear when that subtopic is selected and won’t mix with formulas from a subtopic like “Calculus”.
              </p>
              <p>
                  The rich editor still lets you format headings, bold key points, create lists, and highlight important information for each subject.
              </p>

              <h4>Visual Topic Management</h4>
              <p>Easily organize your study goals. Use <strong>drag and drop</strong> to reorder Topics or move Subtopics across topics intuitively.</p>

              <h4>Integrated Tasks & Notes 📝</h4>
              <p>Right within the timer view, create to-dos for each subtopic and jot quick notes without breaking your flow.</p>

              <h4>Zen Mode 🧘</h4>
              <p>When you need absolute focus, click the eye icon (👁️). The interface hides, leaving only the background and timer. You can <strong>drag the timer</strong> anywhere for a clean workspace.</p>

              <h4>Statistics & Milestones 🏆</h4>
              <p>Track your journey through meaningful numbers. The app records and celebrates important focus-time milestones—turning effort into achievements.</p>

              <hr />
              <h4>⌨️ Smart Shortcuts</h4>
              <ul>
                  <li><kbd>Space</kbd>: Start / Pause / Resume the session.</li>
                  <li><kbd>N</kbd>: Skip the current focus or break session.</li>
                  <li><kbd>Esc</kbd>: Close open dialogs (e.g., Settings).</li>
              </ul>

              <hr />
              <h4>🛠️ Advanced Settings & Integrations</h4>

              <h4>Gemini AI Assistant 🧠</h4>
              <p>Turn the app into a smart study companion. Beyond Q&A, you can:</p>
              <ul>
                  <li><strong>Smart Auto-formatting:</strong> While writing under "Methods", let AI analyze and format your raw text—detect headings, bold key ideas, and lists.</li>
                  <li><strong>Setup:</strong> Visit Google AI Studio to create a free API Key and paste it into "Gemini API Key" in Settings.</li>
              </ul>

              <h4>Customize Interface & Sound 🎨</h4>
              <p>Make the workspace yours:</p>
              <ul>
                  <li><strong>Multiple Themes & Backgrounds:</strong> Choose from built-in themes (Light, Dark, Pastel...) or <strong>upload your own background</strong> for inspiration.</li>
                  <li><strong>Custom Alerts:</strong> <strong>Upload your own audio files (.mp3, .wav...)</strong> as alert sounds for focus and breaks.</li>
              </ul>

              <h4>YouTube Background Music 🎶</h4>
              <p>Create the perfect study ambiance by playing a YouTube video or playlist as background music. Paste the URL into the "YouTube Background Music" field in Settings.</p>

              <h4>Data Safety: Backup & Restore 🛡️</h4>
              <p>The app automatically backs up your progress daily. Customize how many days to keep and restore data from a previous day if needed. ⚠️ <strong>Warning:</strong> Restore will overwrite your current data.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Congratulations!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Continue the journey!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Settings</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Timer</button>
              <button class="tab-btn" data-tab="settings-ui">Interface & Sound</button>
              <button class="tab-btn" data-tab="settings-integrations">Integrations</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Style A </button>
                      <button class="btn ghost" data-preset-target="B"> Style B </button>
                      <button class="btn ghost" data-preset-target="C"> Style C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Pomodoro Durations</h4>
                      <div class="row">
                          <label>FOCUS (minutes)<input type="number" id="set_work" min="1" /></label>
                          <label>WIND-DOWN (minutes)<input type="number" id="set_winddown" min="0" /></label>
                          <label>SHORT BREAK (minutes)<input type="number" id="set_short" min="1" /></label>
                          <label>LONG BREAK (minutes)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Pomodoro Cycles<input type="number" id="set_cycles" min="1" /></label>
                          <label>Long Break Interval<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Break Ratio (Work / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Tip: Break time = total focus time / X. Default is 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Automatically start next session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Enable Wind-down after focus session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Prompt for note after each session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Interface</h4>
                      <div class="row">
                          <label>UI Theme
                                <select id="set_theme_color">
                                    <option value="default">Default (Dark Blue)</option>
                                    <option value="light">Light - Milk Tea</option>
                                    <option value="pastel">Pastel - Soft</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Background Display Mode
                              <select id="set_backgroundMode">
                                  <option value="cover">Cover (Default)</option>
                                  <option value="contain">Contain (Sharp)</option>
                                  <option value="auto">Original Size (Repeat)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Background Image
                              <label class="btn small ghost" for="uploadBg">Upload New Image</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Clear Background</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Panel Opacity</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Sound</h4>
                      <div class="row">
                          <label>Volume (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Alert Style
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Customize Alerts</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Alert at end of FOCUS</small>
                              <label title="Alert at end of FOCUS" class="btn small ghost" for="uploadSoundWork">FOCUS</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of SHORT BREAK</small>
                              <label title="Alert at end of SHORT BREAK" class="btn small ghost" for="uploadSoundBreak">SHORT BREAK</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of LONG BREAK</small>
                              <label title="Alert at end of LONG BREAK" class="btn small ghost" for="uploadSoundLong">LONG BREAK</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>AI Integration</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Paste your API Key here..." />
                      </label>
                      <div class="tiny">Required to use AI features. Get a free key at <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 YouTube Background Music</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Paste YouTube link here..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Use video thumbnail as background</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Stopping will not auto-play again until you press ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Volume</div>
                  </div>
                  <div>
                      <h4>🛡️ Backup Settings</h4>
                      <div class="row">
                          <label>Number of backup days to keep
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Restore Data</h4>
                      <p class="tiny">Restore from an automatic daily backup. This action will overwrite your current data.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Restore</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Defaults</button>
              <button class="btn acc" id="btnSaveSettings">Save</button>
              <button class="btn" id="btnCloseSettings">Close</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Note for the completed session</h3>
      <div class="row"><textarea id="noteText" placeholder="What did you learn? Any difficulties? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Summarize & Suggest</button>
        <button class="btn" id="btnSkipNote">Skip</button>
        <button class="btn acc" id="btnSaveNote">Save Note</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Title</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Cancel</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Dashboard</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Close</button>
        </div>
        <p class="tiny">Summary of time and sessions completed across all topics.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Edit Method</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Title<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Content</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Small heading">H</button>
          <button id="toolBold" class="btn small ghost" title="Bold">B</button>
          <button id="toolItalic" class="btn small ghost" title="Italic">I</button>
          <button id="toolList" class="btn small ghost" title="Numbered list">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Bulleted list">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Text color">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Default text color"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Accent color"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Positive color"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Warning color"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Danger color"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Purple"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="This feature requires a Gemini API Key">✨ Auto-format</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Cancel</button>
          <button class="btn acc" id="btnSaveMethod">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Press "Enable Sound" to allow background audio.</span>
    <button id="btnEnableSound" class="btn small acc">Enable Sound</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
    const _0x58e2db=_0x5eb1;(function(_0x77a47c,_0x583c6e){const _0x589727=_0x5eb1,_0x2b44f9=_0x77a47c();while(!![]){try{const _0x37b496=-parseInt(_0x589727(0x31b))/0x1*(parseInt(_0x589727(0x30c))/0x2)+parseInt(_0x589727(0x332))/0x3*(-parseInt(_0x589727(0x3de))/0x4)+-parseInt(_0x589727(0x364))/0x5*(-parseInt(_0x589727(0x476))/0x6)+-parseInt(_0x589727(0x2d2))/0x7*(-parseInt(_0x589727(0x3b9))/0x8)+-parseInt(_0x589727(0x42b))/0x9+parseInt(_0x589727(0x470))/0xa+-parseInt(_0x589727(0x32c))/0xb*(-parseInt(_0x589727(0x39f))/0xc);if(_0x37b496===_0x583c6e)break;else _0x2b44f9['push'](_0x2b44f9['shift']());}catch(_0x2b3d99){_0x2b44f9['push'](_0x2b44f9['shift']());}}}(_0x35f3,0xdd0ee),window[_0x58e2db(0x379)]('load',()=>{try{updateFullscreenButton();}catch(_0x3ddb8e){}}));const IS_FILE_PROTOCOL=window[_0x58e2db(0x39d)][_0x58e2db(0x4ef)]===_0x58e2db(0x243);function startYtApiWatchdog(){const _0x96b2b6=_0x58e2db,_0x3f7020=document[_0x96b2b6(0x4bc)](_0x96b2b6(0x4cc));if(!_0x3f7020)return;const _0x3dfed4=setTimeout(()=>{const _0x1592a7=_0x96b2b6;try{(!window['YT']||!window['YT'][_0x1592a7(0x3c7)])&&(_0x3f7020[_0x1592a7(0x351)]=_0x1592a7(0x236),_0x3f7020['style']['color']=_0x1592a7(0x249));}catch(_0x29bdd9){}},0x5dc),_0x34a6a5=setTimeout(()=>{const _0x19c03f=_0x96b2b6;try{(!window['YT']||!window['YT'][_0x19c03f(0x3c7)])&&(_0x3f7020[_0x19c03f(0x351)]=_0x19c03f(0x3e3),_0x3f7020['style'][_0x19c03f(0x430)]=_0x19c03f(0x2d6));}catch(_0x538fad){}},0x1b58);window[_0x96b2b6(0x448)]={'cancel'(){clearTimeout(_0x3dfed4),clearTimeout(_0x34a6a5);}};}(function(){const _0x46f413=_0x58e2db,_0x3897fc={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x46f413(0x2ef)+current+'/'+target,'timer.selectSubtopicPrompt':_0x46f413(0x4bf)};window['t']=function _0x2be861(_0x31a8f3,_0x12900f){const _0x1d7bc0=_0x46f413;try{const _0x479444=_0x3897fc[_0x31a8f3];if(typeof _0x479444===_0x1d7bc0(0x321))return _0x479444(_0x12900f||{});if(typeof _0x479444===_0x1d7bc0(0x224))return _0x479444;}catch(_0x26cabf){}return _0x31a8f3;},window[_0x46f413(0x4da)]=function _0x533309(_0x579add){const _0x374f66=_0x46f413;try{localStorage[_0x374f66(0x4eb)](_0x374f66(0x4b7),_0x579add||'en');}catch(_0x279986){}return Promise[_0x374f66(0x306)]();};}());function ensureYouTubeAPI(){const _0x36c492=_0x58e2db;if(IS_FILE_PROTOCOL)return Promise[_0x36c492(0x306)](![]);try{if(window['YT']&&window['YT']['Player'])return Promise[_0x36c492(0x306)](!![]);}catch(_0x35fd3d){}if(window[_0x36c492(0x215)])return window[_0x36c492(0x215)];return startYtApiWatchdog(),window[_0x36c492(0x215)]=new Promise((_0x3c15d5,_0x317a39)=>{const _0xf56606=_0x36c492;try{const _0x122851=document['createElement'](_0xf56606(0x2f8));_0x122851[_0xf56606(0x4fc)]=_0xf56606(0x464),_0x122851[_0xf56606(0x2e5)]=!![],_0x122851[_0xf56606(0x210)]=!![],_0x122851['onload']=()=>_0x3c15d5(!![]),_0x122851[_0xf56606(0x48a)]=()=>_0x317a39(new Error(_0xf56606(0x311))),document[_0xf56606(0x26d)][_0xf56606(0x4cb)](_0x122851);}catch(_0x5bbbbb){_0x317a39(_0x5bbbbb);}}),window[_0x36c492(0x215)];}const storageManager={'DB_NAME':_0x58e2db(0x483),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x4ce666,_0x364878)=>{const _0x16641e=_0x5eb1;if(this['db'])return _0x4ce666(this['db']);const _0x563b5e=indexedDB[_0x16641e(0x458)](this[_0x16641e(0x4db)],this[_0x16641e(0x4a8)]);_0x563b5e[_0x16641e(0x282)]=_0x4b28bf=>{const _0xaf410b=_0x16641e,_0x319f61=_0x4b28bf[_0xaf410b(0x2aa)]['result'];!_0x319f61[_0xaf410b(0x354)][_0xaf410b(0x355)](_0xaf410b(0x314))&&_0x319f61[_0xaf410b(0x1fd)](_0xaf410b(0x314));!_0x319f61[_0xaf410b(0x354)][_0xaf410b(0x355)](_0xaf410b(0x48f))&&_0x319f61[_0xaf410b(0x1fd)]('topics',{'keyPath':'id'});if(!_0x319f61[_0xaf410b(0x354)][_0xaf410b(0x355)](_0xaf410b(0x4b5))){const _0x5a6797=_0x319f61['createObjectStore'](_0xaf410b(0x4b5),{'keyPath':'id'});_0x5a6797[_0xaf410b(0x44d)](_0xaf410b(0x227),_0xaf410b(0x2fe));}!_0x319f61[_0xaf410b(0x354)][_0xaf410b(0x355)](_0xaf410b(0x1e2))&&_0x319f61[_0xaf410b(0x1fd)](_0xaf410b(0x1e2),{'keyPath':_0xaf410b(0x3cf)});},_0x563b5e[_0x16641e(0x479)]=_0x220a76=>{const _0x3be317=_0x16641e;this['db']=_0x220a76[_0x3be317(0x2aa)][_0x3be317(0x31e)],console[_0x3be317(0x37d)](_0x3be317(0x26a)),_0x4ce666(this['db']);},_0x563b5e[_0x16641e(0x48a)]=_0x21692b=>{const _0xae2d21=_0x16641e;console[_0xae2d21(0x363)](_0xae2d21(0x253),_0x21692b[_0xae2d21(0x2aa)][_0xae2d21(0x396)]),_0x364878(_0x21692b['target'][_0xae2d21(0x363)]);};});},async '_getStore'(_0x291325,_0x234fee='readonly'){const _0x20db48=_0x58e2db;await this[_0x20db48(0x2de)]();const _0x5f41d1=this['db']['transaction']([_0x291325],_0x234fee);return _0x5f41d1['objectStore'](_0x291325);},async 'getSettings'(){const _0x5b796e=_0x58e2db,_0x514518=await this['_getStore'](_0x5b796e(0x314));return new Promise((_0x2b4a39,_0x247c12)=>{const _0x29990f=_0x5b796e,_0x2950cf=_0x514518['get'](_0x29990f(0x200));_0x2950cf[_0x29990f(0x479)]=()=>_0x2b4a39(_0x2950cf[_0x29990f(0x31e)]),_0x2950cf[_0x29990f(0x48a)]=()=>_0x247c12(_0x2950cf[_0x29990f(0x363)]);});},async 'updateSettings'(_0x18ed43){const _0x5cb968=_0x58e2db,_0x2c8f9b=await this['_getStore'](_0x5cb968(0x314),_0x5cb968(0x2ae));return new Promise((_0x35a76d,_0x5962ba)=>{const _0x12c207=_0x5cb968,_0x50ddcd=_0x2c8f9b[_0x12c207(0x2df)](_0x18ed43,_0x12c207(0x200));_0x50ddcd[_0x12c207(0x479)]=()=>_0x35a76d(_0x50ddcd['result']),_0x50ddcd[_0x12c207(0x48a)]=()=>_0x5962ba(_0x50ddcd[_0x12c207(0x363)]);});},async 'getAll'(_0x3d06de){const _0x117db0=await this['_getStore'](_0x3d06de);return new Promise((_0x1de862,_0x468d47)=>{const _0x34bc22=_0x5eb1,_0x2102b9=_0x117db0[_0x34bc22(0x4ba)]();_0x2102b9['onsuccess']=()=>_0x1de862(_0x2102b9[_0x34bc22(0x31e)]),_0x2102b9[_0x34bc22(0x48a)]=()=>_0x468d47(_0x2102b9[_0x34bc22(0x363)]);});},async 'update'(_0x282c1c,_0x304d9e){const _0x305511=_0x58e2db,_0x29ddfc=await this[_0x305511(0x204)](_0x282c1c,_0x305511(0x2ae));return new Promise((_0x346a2b,_0x32a15a)=>{const _0xc71a6a=_0x305511,_0xc8132f=_0x29ddfc['put'](_0x304d9e);_0xc8132f[_0xc71a6a(0x479)]=()=>_0x346a2b(_0xc8132f['result']),_0xc8132f[_0xc71a6a(0x48a)]=()=>_0x32a15a(_0xc8132f[_0xc71a6a(0x363)]);});},async 'add'(_0x21550a,_0x1262ae){const _0xa879fe=_0x58e2db,_0x2db1f0=await this[_0xa879fe(0x204)](_0x21550a,'readwrite');return new Promise((_0x3180fb,_0x2bd469)=>{const _0x2e2330=_0xa879fe,_0x4bb06a=_0x2db1f0[_0x2e2330(0x325)](_0x1262ae);_0x4bb06a[_0x2e2330(0x479)]=()=>_0x3180fb(_0x4bb06a[_0x2e2330(0x31e)]),_0x4bb06a['onerror']=()=>_0x2bd469(_0x4bb06a[_0x2e2330(0x363)]);});},async 'delete'(_0x491b9d,_0x3868a5){const _0x5239bd=_0x58e2db,_0x1f9ed9=await this[_0x5239bd(0x204)](_0x491b9d,'readwrite');return new Promise((_0xa5be99,_0x35f9ab)=>{const _0x4c1631=_0x5239bd,_0x45b5c5=_0x1f9ed9['delete'](_0x3868a5);_0x45b5c5[_0x4c1631(0x479)]=()=>_0xa5be99(_0x45b5c5[_0x4c1631(0x31e)]),_0x45b5c5[_0x4c1631(0x48a)]=()=>_0x35f9ab(_0x45b5c5['error']);});},async 'save'(_0x5c993f){const _0x503420=_0x58e2db;return await this[_0x503420(0x2de)](),new Promise((_0x52a1fb,_0x5eeeda)=>{const _0x4bf1dc=_0x503420,_0x4eabce=this['db'][_0x4bf1dc(0x250)](['settings',_0x4bf1dc(0x48f),_0x4bf1dc(0x4b5)],_0x4bf1dc(0x2ae)),_0x28d553=_0x4eabce[_0x4bf1dc(0x35b)]('settings'),_0x24a468=_0x4eabce[_0x4bf1dc(0x35b)](_0x4bf1dc(0x48f)),_0x5078e3=_0x4eabce[_0x4bf1dc(0x35b)]('subtopics');_0x28d553[_0x4bf1dc(0x2df)](_0x5c993f[_0x4bf1dc(0x314)],_0x4bf1dc(0x200)),_0x24a468[_0x4bf1dc(0x4c1)](),_0x5078e3[_0x4bf1dc(0x4c1)](),_0x5c993f[_0x4bf1dc(0x48f)][_0x4bf1dc(0x345)](_0x1cb792=>{const _0x2a1bc2=_0x4bf1dc,{subtopics:_0x12e0a7,..._0x1472b2}=_0x1cb792;_0x24a468[_0x2a1bc2(0x2df)](_0x1472b2),(_0x12e0a7||[])[_0x2a1bc2(0x345)](_0x5b669f=>_0x5078e3[_0x2a1bc2(0x2df)](_0x5b669f));}),_0x4eabce[_0x4bf1dc(0x4ca)]=()=>_0x52a1fb(),_0x4eabce[_0x4bf1dc(0x48a)]=_0x3c3bd6=>_0x5eeeda(_0x3c3bd6[_0x4bf1dc(0x2aa)][_0x4bf1dc(0x363)]);});},async 'autoBackup'(_0x2d124b){const _0x5a0736=_0x58e2db;await this[_0x5a0736(0x2de)]();const _0x3afb86=new Date()[_0x5a0736(0x495)]()[_0x5a0736(0x244)](0x0,0xa),_0x31d778=localStorage[_0x5a0736(0x307)](_0x5a0736(0x309));if(_0x3afb86!==_0x31d778){console[_0x5a0736(0x37d)](_0x5a0736(0x41d)+_0x3afb86+'...');const _0x4b877d={'date':_0x3afb86,'data':JSON['parse'](JSON['stringify'](_0x2d124b))},_0x270514=this['db'][_0x5a0736(0x250)](['backups'],_0x5a0736(0x2ae)),_0xa19055=_0x270514[_0x5a0736(0x35b)](_0x5a0736(0x1e2)),_0x57fee7=_0xa19055['put'](_0x4b877d);_0x57fee7[_0x5a0736(0x479)]=()=>{const _0x169ad1=_0x5a0736;localStorage[_0x169ad1(0x4eb)]('lastBackupDate',_0x3afb86),console[_0x169ad1(0x37d)](_0x169ad1(0x477)),this[_0x169ad1(0x42c)](_0x2d124b?.['settings']?.[_0x169ad1(0x1ec)]||0x7);},_0x57fee7[_0x5a0736(0x48a)]=_0x362fcc=>{const _0x39aba3=_0x5a0736;console[_0x39aba3(0x363)](_0x39aba3(0x27b),_0x362fcc[_0x39aba3(0x2aa)][_0x39aba3(0x363)]);};}},async 'cleanupOldBackups'(_0x5cb476){const _0x4da0b1=_0x58e2db;await this['initDB']();const _0x4f1c9a=this['db'][_0x4da0b1(0x250)]([_0x4da0b1(0x1e2)],_0x4da0b1(0x2ae)),_0x6d49ed=_0x4f1c9a[_0x4da0b1(0x35b)]('backups'),_0x477231=_0x6d49ed[_0x4da0b1(0x49e)]();_0x477231['onsuccess']=()=>{const _0x1d6a3d=_0x4da0b1,_0x56e37d=_0x477231[_0x1d6a3d(0x31e)][_0x1d6a3d(0x4ac)]()['reverse']();if(_0x56e37d['length']>_0x5cb476){const _0x5e1c29=_0x56e37d[_0x1d6a3d(0x244)](_0x5cb476);_0x5e1c29[_0x1d6a3d(0x345)](_0x310204=>{const _0x19393f=_0x1d6a3d;_0x6d49ed['delete'](_0x310204),console[_0x19393f(0x37d)](_0x19393f(0x4f4)+_0x310204);});}};},async 'getBackupList'(){const _0x5be61c=_0x58e2db;return await this[_0x5be61c(0x2de)](),new Promise((_0x1f1da6,_0x1c9596)=>{const _0x2869e2=_0x5be61c,_0x14ac40=this['db'][_0x2869e2(0x250)]([_0x2869e2(0x1e2)],_0x2869e2(0x228)),_0x491136=_0x14ac40[_0x2869e2(0x35b)](_0x2869e2(0x1e2)),_0x4ca1d7=_0x491136[_0x2869e2(0x4ba)]();_0x4ca1d7[_0x2869e2(0x479)]=()=>_0x1f1da6(_0x4ca1d7[_0x2869e2(0x31e)][_0x2869e2(0x4ac)]((_0x20d179,_0x43d5fe)=>_0x43d5fe[_0x2869e2(0x3cf)][_0x2869e2(0x3eb)](_0x20d179['date']))),_0x4ca1d7[_0x2869e2(0x48a)]=_0x5bb16c=>_0x1c9596(_0x5bb16c[_0x2869e2(0x2aa)][_0x2869e2(0x363)]);});},async 'restoreBackup'(_0x28aa9c){const _0x277731=_0x58e2db;return await this[_0x277731(0x2de)](),new Promise((_0x5192b6,_0x4b2c49)=>{const _0x368494=_0x277731,_0x3a8ebc=this['db'][_0x368494(0x250)]([_0x368494(0x1e2)],_0x368494(0x228)),_0x5928ae=_0x3a8ebc[_0x368494(0x35b)]('backups'),_0x10b909=_0x5928ae['get'](_0x28aa9c);_0x10b909['onsuccess']=()=>{const _0x312d43=_0x368494;_0x10b909['result']&&_0x10b909[_0x312d43(0x31e)][_0x312d43(0x3c0)]?(localStorage[_0x312d43(0x4eb)](_0x312d43(0x2a6),JSON[_0x312d43(0x440)](_0x10b909[_0x312d43(0x31e)]['data'])),_0x5192b6(_0x10b909['result'][_0x312d43(0x3c0)])):_0x4b2c49(new Error(_0x312d43(0x3ac)));},_0x10b909[_0x368494(0x48a)]=_0x1f933f=>_0x4b2c49(_0x1f933f[_0x368494(0x2aa)][_0x368494(0x363)]);});},'exportData'(_0x46b5a1){const _0x494875=_0x58e2db;let _0x48a0fc={};try{_0x48a0fc=JSON[_0x494875(0x3e1)](JSON[_0x494875(0x440)](_0x46b5a1||{}));}catch(_0x52787d){_0x48a0fc=_0x46b5a1;}try{if(_0x48a0fc&&_0x48a0fc[_0x494875(0x314)])_0x48a0fc[_0x494875(0x314)]['apiKey']='';}catch(_0x12a920){}const _0x247498=new Blob([JSON['stringify'](_0x48a0fc,null,0x2)],{'type':_0x494875(0x2e6)}),_0x2baa36=document['createElement']('a'),_0xdedb41=new Date(),_0x1f75ec=_0x544051=>(''+_0x544051)[_0x494875(0x2bd)](0x2,'0');_0x2baa36['href']=URL[_0x494875(0x496)](_0x247498),_0x2baa36[_0x494875(0x4c6)]=_0x494875(0x33e)+_0xdedb41[_0x494875(0x391)]()+_0x1f75ec(_0xdedb41[_0x494875(0x44c)]()+0x1)+_0x1f75ec(_0xdedb41[_0x494875(0x21f)]())+'.json',_0x2baa36[_0x494875(0x38d)](),URL['revokeObjectURL'](_0x2baa36['href']);},async 'importData'(_0x2cb095){const _0x3d5af1=_0x58e2db,_0xd39a4f=await _0x2cb095['text'](),_0xa183a=JSON['parse'](_0xd39a4f);if(!_0xa183a[_0x3d5af1(0x4f2)]||!_0xa183a[_0x3d5af1(0x314)]||!Array[_0x3d5af1(0x316)](_0xa183a[_0x3d5af1(0x48f)]))throw new Error(_0x3d5af1(0x237));try{const _0x833044=window['data']&&window[_0x3d5af1(0x3c0)]['settings']&&window[_0x3d5af1(0x3c0)]['settings'][_0x3d5af1(0x463)]||'';(!(_0x3d5af1(0x463)in _0xa183a[_0x3d5af1(0x314)])||_0xa183a['settings'][_0x3d5af1(0x463)]==='')&&(_0xa183a[_0x3d5af1(0x314)]['apiKey']=_0x833044);}catch(_0x203573){}return localStorage[_0x3d5af1(0x4eb)](_0x3d5af1(0x2a6),JSON[_0x3d5af1(0x440)](_0xa183a)),_0xa183a;}},$=(_0xdd7d31,_0x800b79=document)=>_0x800b79[_0x58e2db(0x276)](_0xdd7d31),breakSuggestions=[_0x58e2db(0x23f),'Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.',_0x58e2db(0x3d1),'Take\x20a\x20short\x20walk\x20around\x20the\x20room.','Do\x20a\x20few\x20deep-breathing\x20cycles.',_0x58e2db(0x3f2),'Play\x20a\x20favorite\x20song\x20briefly.',_0x58e2db(0x2db),_0x58e2db(0x248),'Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.',_0x58e2db(0x360),_0x58e2db(0x2ee),_0x58e2db(0x3a4),_0x58e2db(0x23a),_0x58e2db(0x462),_0x58e2db(0x4c5),_0x58e2db(0x423),_0x58e2db(0x33f),_0x58e2db(0x4f1),_0x58e2db(0x394),_0x58e2db(0x3fe),'Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.','Have\x20a\x20sip\x20of\x20water.',_0x58e2db(0x4fe),_0x58e2db(0x35a),_0x58e2db(0x1f2),_0x58e2db(0x32f),'Refuel\x20with\x20a\x20healthy\x20snack.',_0x58e2db(0x24e),_0x58e2db(0x4e3),_0x58e2db(0x2eb)],$$=(_0x28113f,_0x14f3a7=document)=>Array['from'](_0x14f3a7['querySelectorAll'](_0x28113f));function on(_0x456227,_0x1ed4b0,_0x46caec){const _0x34ecb9=_0x58e2db;if(!_0x456227){console[_0x34ecb9(0x362)]('Missing\x20element',_0x1ed4b0);return;}_0x456227[_0x34ecb9(0x379)](_0x1ed4b0,_0x46caec);}const formatMMSS=_0x4a6fca=>{const _0x1ce6af=_0x58e2db,_0x2d0340=Math[_0x1ce6af(0x406)](_0x4a6fca/0x3c)[_0x1ce6af(0x2ab)]()['padStart'](0x2,'0'),_0x238c67=Math[_0x1ce6af(0x406)](_0x4a6fca%0x3c)['toString']()[_0x1ce6af(0x2bd)](0x2,'0');return _0x2d0340+':'+_0x238c67;},uid=(_0x2b4516='id')=>_0x2b4516+'_'+Date['now']()+'_'+Math[_0x58e2db(0x37c)]()[_0x58e2db(0x2ab)](0x24)[_0x58e2db(0x244)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x242af8){const _0xe472b1=_0x58e2db;try{const _0x2ef29b=_0x242af8[_0xe472b1(0x257)](_0xe472b1(0x234));if(!_0x2ef29b[_0xe472b1(0x326)])return;const _0x4d56e8=_0x2ef29b[0x0],_0x45f458=_0x2ef29b[_0x2ef29b[_0xe472b1(0x326)]-0x1],_0x2791cc=_0x4c857b=>{const _0x420e44=_0xe472b1;if(_0x4c857b[_0x420e44(0x407)]===_0x420e44(0x32d)){if(_0x4c857b['shiftKey']&&document[_0x420e44(0x392)]===_0x4d56e8)_0x4c857b[_0x420e44(0x3f9)](),_0x45f458[_0x420e44(0x49d)]();else!_0x4c857b[_0x420e44(0x3c8)]&&document[_0x420e44(0x392)]===_0x45f458&&(_0x4c857b[_0x420e44(0x3f9)](),_0x4d56e8[_0x420e44(0x49d)]());}};_0x242af8[_0xe472b1(0x379)](_0xe472b1(0x279),_0x2791cc),_0x4d56e8[_0xe472b1(0x49d)](),__releaseFocusTrap=()=>{const _0x2936ec=_0xe472b1;try{_0x242af8[_0x2936ec(0x2b6)]('keydown',_0x2791cc);}catch(_0x309d7c){}};}catch(_0x115d8e){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x1f7f9b){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x58e2db(0x495)]();function toast(_0x3c8a60,_0x510c2a=0xa28){const _0x121c31=_0x58e2db,_0x598a98=$(_0x121c31(0x4a1)),_0x5745c6=document[_0x121c31(0x383)](_0x121c31(0x3aa));_0x5745c6[_0x121c31(0x2b8)]=_0x121c31(0x4ee),_0x5745c6[_0x121c31(0x351)]=_0x3c8a60,_0x598a98['appendChild'](_0x5745c6),setTimeout(()=>{const _0x166e99=_0x121c31;_0x5745c6[_0x166e99(0x22c)][_0x166e99(0x4e0)]='0';},_0x510c2a-0x12c),setTimeout(()=>_0x598a98[_0x121c31(0x320)](_0x5745c6),_0x510c2a);}function escapeHTML(_0x1356fa){const _0x1e2faa=_0x58e2db;return _0x1356fa[_0x1e2faa(0x3ba)](/[&<>"']/g,_0x450e8a=>({'&':_0x1e2faa(0x2c6),'<':'&lt;','>':_0x1e2faa(0x2c2),'\x22':_0x1e2faa(0x366),'\x27':_0x1e2faa(0x488)}[_0x450e8a]));}function formatDaysHoursMinutes(_0x1c578f){const _0xf090d0=_0x58e2db;if(!_0x1c578f||_0x1c578f<0x1)return'0\x20min';const _0x1ecd41=Math[_0xf090d0(0x406)](_0x1c578f/0x3c),_0x35dcf1=_0x1c578f%0x3c,_0x1c2c66=_0x35dcf1[_0xf090d0(0x2ab)]()[_0xf090d0(0x2bd)](0x2,'0');return _0x1ecd41+'\x20hours\x20'+_0x1c2c66+'\x20min';}function formatGeminiResponse(_0x5559a9){const _0x468ae6=_0x58e2db;return _0x5559a9[_0x468ae6(0x3ba)](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0x2e001c){const _0x4bea67=_0x58e2db,_0x3c6611=(_0x2e001c||'')['split']('\x0a');let _0x11fb69='',_0x35f601=null;const _0xc201f1=()=>{const _0x3ad61c=_0x5eb1;_0x35f601&&(_0x11fb69+=_0x35f601==='ol'?'</ol>':_0x3ad61c(0x4dd),_0x35f601=null);};for(let _0x3975f1 of _0x3c6611){let _0x8bf415=(_0x3975f1||'')[_0x4bea67(0x22a)]();if(!_0x8bf415){_0xc201f1();continue;}if(_0x8bf415[_0x4bea67(0x498)](_0x4bea67(0x2d7)))_0xc201f1(),_0x11fb69+=_0x4bea67(0x2cf)+escapeHTML(_0x8bf415[_0x4bea67(0x435)](0x5))+_0x4bea67(0x1e7);else{if(/^\d+\.\s/[_0x4bea67(0x1e6)](_0x8bf415)){_0x35f601!=='ol'&&(_0xc201f1(),_0x11fb69+=_0x4bea67(0x1e3),_0x35f601='ol');const _0x1cc2c0=_0x8bf415[_0x4bea67(0x435)](_0x8bf415[_0x4bea67(0x4a9)]('\x20')+0x1);_0x11fb69+=_0x4bea67(0x415)+escapeHTML(_0x1cc2c0)+_0x4bea67(0x46b);}else _0x8bf415[_0x4bea67(0x498)]('-\x20')?(_0x35f601!=='ul'&&(_0xc201f1(),_0x11fb69+=_0x4bea67(0x3d5),_0x35f601='ul'),_0x11fb69+=_0x4bea67(0x415)+escapeHTML(_0x8bf415[_0x4bea67(0x435)](0x2))+_0x4bea67(0x46b)):(_0xc201f1(),_0x8bf415=escapeHTML(_0x8bf415)['replace'](/\*\*(.*?)\*\*/g,_0x4bea67(0x29a))[_0x4bea67(0x3ba)](/_(.*?)_/g,_0x4bea67(0x42a)),_0x11fb69+=_0x4bea67(0x4c2)+_0x8bf415+'</p>');}}return _0xc201f1(),_0x11fb69;}function wrapTextInMarkdown(_0x5393c8,_0x4399d4,_0x4425a4=''){const _0x50abb3=_0x58e2db;if(!_0x5393c8)return;const _0x3cb4c8=_0x5393c8[_0x50abb3(0x21d)]||0x0,_0x2de535=_0x5393c8[_0x50abb3(0x331)]||0x0,_0xacadfa=_0x5393c8['value'][_0x50abb3(0x435)](_0x3cb4c8,_0x2de535),_0x1827be=_0x4399d4+_0xacadfa+(_0x4425a4||_0x4399d4);_0x5393c8[_0x50abb3(0x313)](_0x1827be,_0x3cb4c8,_0x2de535,_0x50abb3(0x485)),_0x5393c8[_0x50abb3(0x49d)]();}function updateEditorPreview(){const _0x5478d4=_0x58e2db,_0x28e4b6=$(_0x5478d4(0x255)),_0x27fd43=$(_0x5478d4(0x208));if(!_0x28e4b6||!_0x27fd43)return;const _0x566461=_0x28e4b6[_0x5478d4(0x2e8)]||'';_0x27fd43['innerHTML']=parseSimpleMarkdown(_0x566461);}function normalizeDataStructure(_0x162551){const _0x2a3c66=_0x58e2db;if(!_0x162551||typeof _0x162551!==_0x2a3c66(0x2b3))return;const _0x1ebd3f=_0x162551[_0x2a3c66(0x314)]||{},_0x12398e={...defaults[_0x2a3c66(0x314)],..._0x1ebd3f,'durations':{...defaults[_0x2a3c66(0x314)][_0x2a3c66(0x3ec)],..._0x1ebd3f[_0x2a3c66(0x3ec)]||{}}};if(!Array[_0x2a3c66(0x316)](_0x12398e['achievedMilestones']))_0x12398e[_0x2a3c66(0x21c)]=[];_0x162551['settings']=_0x12398e,_0x162551[_0x2a3c66(0x48f)]=Array[_0x2a3c66(0x316)](_0x162551[_0x2a3c66(0x48f)])?_0x162551[_0x2a3c66(0x48f)]:[],_0x162551['topics'][_0x2a3c66(0x345)](_0x5039e2=>{const _0x34b9cf=_0x2a3c66;_0x5039e2[_0x34b9cf(0x4b5)]=Array[_0x34b9cf(0x316)](_0x5039e2['subtopics'])?_0x5039e2[_0x34b9cf(0x4b5)]:[],_0x5039e2[_0x34b9cf(0x4b5)][_0x34b9cf(0x345)](_0x4bb732=>{const _0x279787=_0x34b9cf;_0x4bb732[_0x279787(0x38c)]=_0x4bb732[_0x279787(0x38c)]||[],_0x4bb732[_0x279787(0x4f0)]=_0x4bb732['generalNotes']||[],_0x4bb732['summaries']=_0x4bb732[_0x279787(0x3e2)]||[],_0x4bb732[_0x279787(0x2dd)]=_0x4bb732[_0x279787(0x2dd)]||[],_0x4bb732[_0x279787(0x24b)]=Array['isArray'](_0x4bb732[_0x279787(0x24b)])?_0x4bb732[_0x279787(0x24b)]:[],_0x4bb732[_0x279787(0x20b)]=_0x4bb732[_0x279787(0x20b)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x4bb732[_0x279787(0x43f)]=_0x4bb732[_0x279787(0x43f)]||[],_0x4bb732['timerState']=_0x4bb732['timerState']||{'state':_0x279787(0x1ea),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x7bd995){const _0x44f5cf=_0x58e2db;if(!_0x7bd995)return null;const _0x3c1cb9=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0xde9253=_0x7bd995[_0x44f5cf(0x3db)](_0x3c1cb9);return _0xde9253?_0xde9253[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x1ac5fe=_0x58e2db;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x166df5=document[_0x1ac5fe(0x4bc)](_0x1ac5fe(0x35f)),_0x3b18e0=(_0x166df5&&_0x166df5[_0x1ac5fe(0x2e8)]?_0x166df5['value']:'')[_0x1ac5fe(0x22a)]();return _0x3b18e0;}catch(_0x290c21){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}async function migrateSharedMethodsToCurrentSubtopic(){const _0x549ecc=_0x58e2db;try{const _0x1b6e2f=data?.[_0x549ecc(0x314)]?.['methods']||[];if(!Array[_0x549ecc(0x316)](_0x1b6e2f)||_0x1b6e2f[_0x549ecc(0x326)]===0x0)return;const _0x4ff887=getCurrentSubtopic();if(!_0x4ff887)return;(!Array[_0x549ecc(0x316)](_0x4ff887[_0x549ecc(0x24b)])||_0x4ff887[_0x549ecc(0x24b)][_0x549ecc(0x326)]===0x0)&&(_0x4ff887[_0x549ecc(0x24b)]=_0x1b6e2f,data[_0x549ecc(0x314)][_0x549ecc(0x24b)]=[],await saveData());}catch(_0x155dcf){}}function handleYoutubeUrlInput(){const _0x129783=_0x58e2db,_0x3fca3b=$(_0x129783(0x4d2)),_0x1ef6aa=$(_0x129783(0x402)),_0x493562=$(_0x129783(0x47e)),_0x5a6cf1=_0x3fca3b[_0x129783(0x2e8)][_0x129783(0x22a)](),_0x564a50=extractYouTubeID(_0x5a6cf1);if(_0x564a50){_0x1ef6aa[_0x129783(0x351)]=_0x129783(0x39c),_0x1ef6aa[_0x129783(0x22c)]['color']=_0x129783(0x3c4),_0x493562['disabled']=![],sessionYoutubeUrl=_0x5a6cf1;try{ytUserPaused=![];}catch(_0x338c70){}try{const _0x2d8226=_0x129783(0x3b8)+_0x564a50+_0x129783(0x1ed),_0x5badcc=new Image();_0x5badcc[_0x129783(0x410)]=async()=>{const _0x5b718f=_0x129783;data[_0x5b718f(0x314)][_0x5b718f(0x251)]=_0x2d8226;try{await saveData();}catch(_0x13bc86){}applyCustomBg();},_0x5badcc[_0x129783(0x48a)]=async()=>{const _0x47a672=_0x129783,_0x3adce9=_0x47a672(0x3b8)+_0x564a50+_0x47a672(0x42e);data[_0x47a672(0x314)][_0x47a672(0x251)]=_0x3adce9;try{await saveData();}catch(_0x28694b){}applyCustomBg();},_0x5badcc['src']=_0x2d8226;}catch(_0x12b3c7){}try{if(IS_FILE_PROTOCOL){const _0x352952=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x564a50,{'autoplay':0x1,'mute':_0x352952});try{setTimeout(()=>{try{fallbackPostMessage('playVideo');}catch(_0x408fe9){}},0xfa);}catch(_0x4527ae){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x53fcb6=_0x129783,_0x5bdcd0=document[_0x53fcb6(0x4bc)](_0x53fcb6(0x4cc));if(_0x5bdcd0)_0x5bdcd0[_0x53fcb6(0x351)]='Playing';},0x1f4);}catch(_0x2b7165){}}else ensureYouTubeAPI()[_0x129783(0x25b)](()=>{const _0x38dff9=_0x129783;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x38dff9(0x299)]&&ytPlayer[_0x38dff9(0x247)]&&(ytPlayer[_0x38dff9(0x299)](),ytPlayer[_0x38dff9(0x247)](),_ytPrimed=!![],showSoundPermission());}catch(_0x183681){}})[_0x129783(0x2f4)](()=>{});}catch(_0x432619){}}else{if(_0x5a6cf1===''){_0x1ef6aa[_0x129783(0x351)]='',_0x493562[_0x129783(0x3fb)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x191c3d){}else ytPlayer&&ytPlayer[_0x129783(0x258)]&&ytPlayer['stopVideo']();}else _0x1ef6aa['textContent']='❌\x20Invalid\x20or\x20unsupported\x20link.',_0x1ef6aa[_0x129783(0x22c)]['color']='var(--danger)',_0x493562[_0x129783(0x3fb)]=!![];}}function applyTheme(_0x5000a3){const _0x5be2ce=_0x58e2db,_0x289652=_0x5000a3||data[_0x5be2ce(0x314)]['theme']||_0x5be2ce(0x4de);document[_0x5be2ce(0x2a4)]['dataset'][_0x5be2ce(0x1f6)]=_0x289652;const _0x565c57=['lofi','space'][_0x5be2ce(0x2ea)](_0x289652),_0x3f03c1=_0x289652==='light'||_0x289652===_0x5be2ce(0x3c1),_0x287013=data[_0x5be2ce(0x314)][_0x5be2ce(0x251)],_0x70ab60=()=>{const _0x182899=_0x5be2ce;try{document[_0x182899(0x2a4)][_0x182899(0x22c)][_0x182899(0x239)]='';}catch(_0xc76972){}};if(_0x287013&&!data[_0x5be2ce(0x314)][_0x5be2ce(0x43a)])document[_0x5be2ce(0x2a4)]['style']['setProperty']('--bg-image','url('+_0x287013+')'),_0x70ab60();else{if(_0x287013&&data['settings']['useYtThumbnailAsBg'])document[_0x5be2ce(0x2a4)]['style']['setProperty']('--bg-image','url('+_0x287013+')'),_0x70ab60();else{if(_0x565c57)document['body'][_0x5be2ce(0x22c)][_0x5be2ce(0x2ce)](_0x5be2ce(0x218)),_0x70ab60();else _0x3f03c1?(document[_0x5be2ce(0x2a4)]['style'][_0x5be2ce(0x1fe)](_0x5be2ce(0x218),_0x5be2ce(0x459)),_0x70ab60()):(document[_0x5be2ce(0x2a4)][_0x5be2ce(0x22c)]['setProperty'](_0x5be2ce(0x218),''),document[_0x5be2ce(0x2a4)][_0x5be2ce(0x22c)]['backgroundImage']=_0x5be2ce(0x3c5));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x58e2db(0x274),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':_0x58e2db(0x352),'theme':'default','cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':_0x58e2db(0x1db),'backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x58e2db(0x441),'content':_0x58e2db(0x369)},{'id':uid('m'),'title':_0x58e2db(0x501),'content':_0x58e2db(0x20d)},{'id':uid('m'),'title':'The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','content':_0x58e2db(0x380)},{'id':uid('m'),'title':_0x58e2db(0x24a),'content':'<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you’re\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don’t\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>'},{'id':uid('m'),'title':'Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','content':_0x58e2db(0x4e7)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x3a4201=_0x58e2db;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x3a4201(0x399))]||window['webkitAudioContext'])();}function tone(_0x3a085e=0x370,_0x4d6603=0xc8,_0x34af17=0.2,_0x3f9b27=_0x58e2db(0x3ff),_0x3fa85f=0x0){const _0x336505=_0x58e2db;ensureAudio();const _0x161c33=AUDIO_CTX,_0xd2cf0c=_0x161c33[_0x336505(0x20e)](),_0x4fb421=_0x161c33[_0x336505(0x425)]();_0xd2cf0c[_0x336505(0x1f4)]=_0x3f9b27,_0xd2cf0c[_0x336505(0x490)][_0x336505(0x2e8)]=_0x3a085e,_0xd2cf0c[_0x336505(0x318)](_0x4fb421),_0x4fb421[_0x336505(0x318)](_0x161c33[_0x336505(0x412)]);const _0x31e8a1=_0x161c33['currentTime']+_0x3fa85f;_0x4fb421[_0x336505(0x22e)][_0x336505(0x472)](0x0,_0x31e8a1),_0x4fb421['gain']['linearRampToValueAtTime'](_0x34af17,_0x31e8a1+0.01),_0x4fb421[_0x336505(0x22e)][_0x336505(0x4a2)](0.0001,_0x31e8a1+_0x4d6603/0x3e8),_0xd2cf0c['start'](_0x31e8a1),_0xd2cf0c[_0x336505(0x4cd)](_0x31e8a1+_0x4d6603/0x3e8+0.05);}function playSound(_0x22a4bb){const _0x2c7add=_0x58e2db;if(!data[_0x2c7add(0x314)]['soundOn'])return;const _0x2c3f16=Math['max'](0x0,Math[_0x2c7add(0x3d8)](0x1,data['settings']['volume']??0.8)),_0x1e100e=data[_0x2c7add(0x314)][_0x2c7add(0x285)]?.[_0x22a4bb];let _0x5bdabd;if(_0x22a4bb==='work_end')_0x5bdabd=$(_0x2c7add(0x284));else{if(_0x22a4bb===_0x2c7add(0x290))_0x5bdabd=$(_0x2c7add(0x310));else{if(_0x22a4bb===_0x2c7add(0x4b2))_0x5bdabd=$(_0x2c7add(0x25f));}}if(_0x1e100e&&_0x5bdabd){_0x1e100e[_0x2c7add(0x498)]('data:')||_0x1e100e[_0x2c7add(0x498)](_0x2c7add(0x494))||_0x1e100e['startsWith'](_0x2c7add(0x36e))?(_0x5bdabd[_0x2c7add(0x4fc)]=_0x1e100e,_0x5bdabd['volume']=_0x2c3f16,_0x5bdabd[_0x2c7add(0x4e8)]()[_0x2c7add(0x2f4)](_0x985ef0=>console[_0x2c7add(0x363)](_0x2c7add(0x4c7),_0x985ef0))):getStoredFileUrl(_0x1e100e)[_0x2c7add(0x25b)](_0x3f9854=>{const _0x26acb3=_0x2c7add;_0x3f9854&&(_0x5bdabd[_0x26acb3(0x4fc)]=_0x3f9854,_0x5bdabd['volume']=_0x2c3f16,_0x5bdabd['play']()['catch'](_0x5b02ac=>console[_0x26acb3(0x363)](_0x26acb3(0x4c7),_0x5b02ac)));});return;}const _0x1fc63d=data[_0x2c7add(0x314)][_0x2c7add(0x221)]||_0x2c7add(0x352);if(_0x1fc63d==='beep'){if(_0x22a4bb===_0x2c7add(0x29d))tone(0x370,0xfa,_0x2c3f16),tone(0x294,0xb4,_0x2c3f16*0.8,_0x2c7add(0x3ff),0.22);else{if(_0x22a4bb===_0x2c7add(0x290))tone(0x294,0xdc,_0x2c3f16*0.9);else _0x22a4bb==='long_end'&&(tone(0x208,0xc8,_0x2c3f16),tone(0x30c,0xc8,_0x2c3f16,_0x2c7add(0x3ff),0.22),tone(0x410,0xdc,_0x2c3f16,_0x2c7add(0x3ff),0.44));}}else{if(_0x22a4bb===_0x2c7add(0x29d))tone(0x4b0,0xa0,_0x2c3f16*0.9,_0x2c7add(0x1f8)),tone(0x384,0xdc,_0x2c3f16*0.8,_0x2c7add(0x1f8),0.18);else{if(_0x22a4bb===_0x2c7add(0x290))tone(0x370,0xf0,_0x2c3f16*0.8,_0x2c7add(0x1f8));else _0x22a4bb==='long_end'&&(tone(0x258,0xdc,_0x2c3f16*0.9,'triangle'),tone(0x3b6,0xf0,_0x2c3f16*0.9,_0x2c7add(0x1f8),0.22),tone(0x4b0,0xf0,_0x2c3f16,_0x2c7add(0x1f8),0.44));}}}async function saveData(){const _0x50a7c9=_0x58e2db;try{await storageManager[_0x50a7c9(0x233)](data);}catch(_0x407617){console[_0x50a7c9(0x363)](_0x50a7c9(0x235),_0x407617),toast('Error\x20saving\x20data:\x20'+_0x407617[_0x50a7c9(0x3d4)]);}}async function ensureValidSelection(){const _0x5329ee=_0x58e2db,_0x2bfbcb=data[_0x5329ee(0x314)];if(!data['topics']||data[_0x5329ee(0x48f)][_0x5329ee(0x326)]===0x0){_0x2bfbcb[_0x5329ee(0x277)]='',_0x2bfbcb[_0x5329ee(0x389)]='',await saveData();return;}const _0x596620=data[_0x5329ee(0x48f)]['find'](_0x11f328=>_0x11f328['id']===_0x2bfbcb['selectedTopicId']),_0x54ae86=_0x596620?.['subtopics'][_0x5329ee(0x4c3)](_0x3fa68a=>_0x3fa68a['id']===_0x2bfbcb['selectedSubtopicId']);if(!_0x596620||!_0x54ae86){const _0x4eba06=data[_0x5329ee(0x48f)][0x0],_0x3acb5d=_0x4eba06?.[_0x5329ee(0x4b5)]?.[0x0];_0x2bfbcb[_0x5329ee(0x277)]=_0x4eba06?.['id']||'',_0x2bfbcb[_0x5329ee(0x389)]=_0x3acb5d?.['id']||'',await saveData();}}function showInputModal(_0x36124a,_0x56f8c8,_0x36a316=''){const _0x86ffea=_0x58e2db;$(_0x86ffea(0x339))['textContent']=_0x36124a,$(_0x86ffea(0x2e4))[_0x86ffea(0x2e9)][_0x86ffea(0x325)](_0x86ffea(0x40a));const _0x2d23e1=$(_0x86ffea(0x2e2));_0x2d23e1[_0x86ffea(0x2e8)]=_0x36a316,_0x2d23e1[_0x86ffea(0x2e9)]['remove'](_0x86ffea(0x40a)),$('#modalGeneric')[_0x86ffea(0x2e9)][_0x86ffea(0x325)](_0x86ffea(0x40d));try{trapFocus($(_0x86ffea(0x2cb)));}catch(_0x43f878){}_0x2d23e1[_0x86ffea(0x49d)](),_0x2d23e1[_0x86ffea(0x29f)]();const _0x50b93c=()=>{const _0x5dfd0c=_0x86ffea;_0x56f8c8(_0x2d23e1[_0x5dfd0c(0x2e8)]),_0x3913e0();},_0x7523f1=()=>_0x3913e0(),_0xb35d16=_0x2ddc3c=>{const _0x57156c=_0x86ffea;if(_0x2ddc3c[_0x57156c(0x407)]===_0x57156c(0x427))_0x50b93c();if(_0x2ddc3c['key']===_0x57156c(0x2a9))_0x7523f1();};$(_0x86ffea(0x469))[_0x86ffea(0x328)]=_0x50b93c,$(_0x86ffea(0x312))[_0x86ffea(0x328)]=_0x7523f1,_0x2d23e1['onkeydown']=_0xb35d16;function _0x3913e0(){const _0x563bf6=_0x86ffea;$(_0x563bf6(0x2cb))[_0x563bf6(0x2e9)][_0x563bf6(0x41a)](_0x563bf6(0x40d)),$(_0x563bf6(0x469))[_0x563bf6(0x328)]=null,$(_0x563bf6(0x312))[_0x563bf6(0x328)]=null,_0x2d23e1[_0x563bf6(0x223)]=null;try{releaseFocus();}catch(_0x2b500a){}}}function showConfirmModal(_0x23c249,_0x51f42e,_0x147cfa){const _0x17c5e9=_0x58e2db;$('#genericTitle')['textContent']=_0x23c249;const _0x265858=$('#genericMessage');_0x265858[_0x17c5e9(0x351)]=_0x51f42e,_0x265858['classList']['remove'](_0x17c5e9(0x40a)),$(_0x17c5e9(0x2e2))[_0x17c5e9(0x2e9)][_0x17c5e9(0x325)](_0x17c5e9(0x40a)),$(_0x17c5e9(0x2cb))[_0x17c5e9(0x2e9)]['add'](_0x17c5e9(0x40d));try{trapFocus($('#modalGeneric'));}catch(_0x178aef){}const _0x556a6d=()=>{_0x147cfa(!![]),_0x1df1aa();},_0x2116c0=()=>{_0x147cfa(![]),_0x1df1aa();};$(_0x17c5e9(0x469))[_0x17c5e9(0x328)]=_0x556a6d,$(_0x17c5e9(0x312))['onclick']=_0x2116c0;function _0x1df1aa(){const _0x3017ca=_0x17c5e9;$('#modalGeneric')[_0x3017ca(0x2e9)][_0x3017ca(0x41a)](_0x3017ca(0x40d)),$(_0x3017ca(0x469))[_0x3017ca(0x328)]=null,$('#btnGenericCancel')[_0x3017ca(0x328)]=null;try{releaseFocus();}catch(_0x1a69ab){}}}let pendingNoteSessionId=null;function openNoteModal(_0xd73a2f){const _0x332811=_0x58e2db;pendingNoteSessionId=_0xd73a2f||null;const _0x4cc89f=$(_0x332811(0x37b));if(!_0x4cc89f)return;const _0x135f72=$(_0x332811(0x36c));if(_0x135f72)try{_0x135f72[_0x332811(0x2e8)]='';}catch(_0x1e27eb){}_0x4cc89f[_0x332811(0x2e9)][_0x332811(0x325)](_0x332811(0x40d));try{trapFocus(_0x4cc89f);}catch(_0x4dd728){}}function closeNoteModal(){const _0x986f4f=_0x58e2db,_0x337a71=$('#modalNote');if(!_0x337a71)return;_0x337a71[_0x986f4f(0x2e9)][_0x986f4f(0x41a)]('show'),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x447266){}}async function switchView(_0xd20ef8){const _0x16228b=_0x58e2db;$$(_0x16228b(0x2d4))['forEach'](_0x34ab64=>_0x34ab64[_0x16228b(0x2e9)][_0x16228b(0x41a)](_0x16228b(0x2ff))),$(_0x16228b(0x2fb)+_0xd20ef8)[_0x16228b(0x2e9)][_0x16228b(0x325)](_0x16228b(0x2ff)),$$(_0x16228b(0x261))[_0x16228b(0x345)](_0x358b2d=>_0x358b2d[_0x16228b(0x2e9)][_0x16228b(0x41a)](_0x16228b(0x2ff)));const _0x26a929=$('.nav-btn[data-view=\x22'+_0xd20ef8+'\x22]');if(_0x26a929)_0x26a929[_0x16228b(0x2e9)][_0x16228b(0x325)]('active');data[_0x16228b(0x314)]['currentView']=_0xd20ef8,await saveData(),_0xd20ef8===_0x16228b(0x20b)&&renderDashboard();}function closeAllMenus(){const _0xfa264a=_0x58e2db;$$(_0xfa264a(0x28f))['forEach'](_0xbfd611=>_0xbfd611['classList'][_0xfa264a(0x41a)](_0xfa264a(0x40d))),$$(_0xfa264a(0x3ce))['forEach'](_0x38874e=>_0x38874e['classList']['remove'](_0xfa264a(0x327)));}function renderTopics(){const _0x410218=_0x58e2db,_0x2c9a05=$(_0x410218(0x4e1));if(!_0x2c9a05)return;_0x2c9a05[_0x410218(0x373)]='';const _0x4e3d02=data[_0x410218(0x314)][_0x410218(0x451)]||{};data[_0x410218(0x48f)][_0x410218(0x345)](_0x52d7e8=>{const _0x45ad33=_0x410218,_0x55cdb9=document[_0x45ad33(0x383)](_0x45ad33(0x3aa));_0x55cdb9[_0x45ad33(0x2b8)]=_0x45ad33(0x205),_0x55cdb9['dataset'][_0x45ad33(0x482)]=_0x52d7e8['id'];const _0x518c45=document[_0x45ad33(0x383)](_0x45ad33(0x3aa));_0x518c45['className']=_0x45ad33(0x202);const _0x2f1b8f=!!_0x4e3d02[_0x52d7e8['id']],_0x31db8b=document['createElement'](_0x45ad33(0x245));_0x31db8b[_0x45ad33(0x2b8)]=_0x45ad33(0x288),_0x31db8b['setAttribute'](_0x45ad33(0x2a7),String(!_0x2f1b8f)),_0x31db8b[_0x45ad33(0x373)]=_0x45ad33(0x3b3);const _0x1624fe=document[_0x45ad33(0x383)](_0x45ad33(0x3aa));_0x1624fe[_0x45ad33(0x2b8)]='topic-title',_0x1624fe[_0x45ad33(0x351)]=_0x52d7e8[_0x45ad33(0x4fb)];const _0x4411b7=document[_0x45ad33(0x383)](_0x45ad33(0x3aa));_0x4411b7[_0x45ad33(0x2b8)]=_0x45ad33(0x342);const _0x3e58a8=document['createElement'](_0x45ad33(0x245));_0x3e58a8[_0x45ad33(0x2b8)]=_0x45ad33(0x1d7),_0x3e58a8[_0x45ad33(0x373)]='＋\x20Add',_0x3e58a8[_0x45ad33(0x3cb)]=_0x45ad33(0x436);const _0x4f909e=document[_0x45ad33(0x383)](_0x45ad33(0x3aa));_0x4f909e[_0x45ad33(0x22c)][_0x45ad33(0x47f)]='relative';const _0x3de578=document['createElement']('button');_0x3de578[_0x45ad33(0x2b8)]=_0x45ad33(0x252),_0x3de578['innerHTML']='...',_0x3de578[_0x45ad33(0x3cb)]=_0x45ad33(0x489);const _0x3925d3=document[_0x45ad33(0x383)](_0x45ad33(0x3aa));_0x3925d3['className']='actions-menu';const _0x243ae3=document[_0x45ad33(0x383)](_0x45ad33(0x245));_0x243ae3[_0x45ad33(0x2b8)]='menu-item',_0x243ae3[_0x45ad33(0x373)]=_0x45ad33(0x431);const _0x37a933=document[_0x45ad33(0x383)](_0x45ad33(0x245));_0x37a933[_0x45ad33(0x2b8)]=_0x45ad33(0x24d),_0x37a933[_0x45ad33(0x373)]='Delete\x20Topic',_0x3925d3['append'](_0x243ae3,_0x37a933),_0x4f909e[_0x45ad33(0x30e)](_0x3de578,_0x3925d3),_0x4411b7[_0x45ad33(0x30e)](_0x3e58a8,_0x4f909e),_0x518c45['append'](_0x31db8b,_0x1624fe,_0x4411b7),_0x31db8b[_0x45ad33(0x379)](_0x45ad33(0x38d),async _0x19006d=>{const _0x564007=_0x45ad33;_0x19006d[_0x564007(0x3c2)]();const _0x593dc5=!!_0x4e3d02[_0x52d7e8['id']];_0x593dc5?delete _0x4e3d02[_0x52d7e8['id']]:_0x4e3d02[_0x52d7e8['id']]=!![],data['settings'][_0x564007(0x451)]=_0x4e3d02,await storageManager[_0x564007(0x21b)](data[_0x564007(0x314)]),renderTopics();});const _0x23b93f=async()=>{const _0x49199c=_0x45ad33,_0xd18144=!!_0x4e3d02[_0x52d7e8['id']];_0xd18144?delete _0x4e3d02[_0x52d7e8['id']]:_0x4e3d02[_0x52d7e8['id']]=!![],data[_0x49199c(0x314)][_0x49199c(0x451)]=_0x4e3d02,await storageManager[_0x49199c(0x21b)](data['settings']),renderTopics();};_0x518c45[_0x45ad33(0x379)](_0x45ad33(0x38d),async _0x4f24ff=>{const _0x3bf40c=_0x45ad33,_0x502d3b=_0x4f24ff['target'];if(_0x502d3b&&_0x502d3b[_0x3bf40c(0x3b6)]){if(_0x502d3b[_0x3bf40c(0x3b6)](_0x3bf40c(0x473))||_0x502d3b[_0x3bf40c(0x3b6)](_0x3bf40c(0x2c4))||_0x502d3b['closest'](_0x3bf40c(0x245))||_0x502d3b[_0x3bf40c(0x3b6)](_0x3bf40c(0x49b)))return;}_0x4f24ff['stopPropagation'](),await _0x23b93f();}),_0x1624fe[_0x45ad33(0x379)]('click',async _0x4e3b71=>{_0x4e3b71['stopPropagation'](),await _0x23b93f();}),_0x55cdb9[_0x45ad33(0x379)](_0x45ad33(0x38d),async _0x9c6a68=>{const _0x3d7e55=_0x45ad33,_0x12e898=_0x9c6a68[_0x3d7e55(0x2aa)];if(_0x12e898&&_0x12e898[_0x3d7e55(0x3b6)]){if(_0x12e898[_0x3d7e55(0x3b6)](_0x3d7e55(0x3f3)))return;if(_0x12e898[_0x3d7e55(0x3b6)](_0x3d7e55(0x473))||_0x12e898[_0x3d7e55(0x3b6)](_0x3d7e55(0x2c4))||_0x12e898[_0x3d7e55(0x3b6)](_0x3d7e55(0x245))||_0x12e898[_0x3d7e55(0x3b6)](_0x3d7e55(0x49b)))return;}await _0x23b93f();});const _0x3063e8=document[_0x45ad33(0x383)](_0x45ad33(0x3aa));_0x3063e8[_0x45ad33(0x2b8)]=_0x45ad33(0x4b5)+(_0x2f1b8f?_0x45ad33(0x4bb):''),_0x3063e8[_0x45ad33(0x4f8)][_0x45ad33(0x482)]=_0x52d7e8['id'],_0x52d7e8[_0x45ad33(0x4b5)]['forEach'](_0x428569=>{const _0x403c22=_0x45ad33,_0x205c98=document[_0x403c22(0x383)](_0x403c22(0x3aa));_0x205c98[_0x403c22(0x2b8)]=_0x403c22(0x28e),_0x205c98[_0x403c22(0x4f8)]['sid']=_0x428569['id'];const _0x3a8fbc=document['createElement'](_0x403c22(0x245));_0x3a8fbc[_0x403c22(0x2b8)]=_0x403c22(0x1e8),_0x3a8fbc[_0x403c22(0x351)]='•\x20'+_0x428569[_0x403c22(0x4fb)],_0x3a8fbc['dataset'][_0x403c22(0x2ec)]=_0x428569['id'],_0x3a8fbc['dataset']['tid']=_0x52d7e8['id'];if(data[_0x403c22(0x314)]['selectedSubtopicId']===_0x428569['id'])_0x3a8fbc[_0x403c22(0x2e9)]['add']('active');const _0x289a2a=document[_0x403c22(0x383)]('div');_0x289a2a[_0x403c22(0x2b8)]=_0x403c22(0x3b4);const _0x86f17b=document['createElement'](_0x403c22(0x3aa));_0x86f17b['style'][_0x403c22(0x47f)]='relative';const _0x3d8020=document[_0x403c22(0x383)](_0x403c22(0x245));_0x3d8020[_0x403c22(0x2b8)]=_0x403c22(0x252),_0x3d8020[_0x403c22(0x373)]=_0x403c22(0x45a),_0x3d8020[_0x403c22(0x3cb)]=_0x403c22(0x489);const _0x2fb7eb=document[_0x403c22(0x383)](_0x403c22(0x3aa));_0x2fb7eb[_0x403c22(0x2b8)]=_0x403c22(0x41c);const _0x33e1a8=document[_0x403c22(0x383)](_0x403c22(0x245));_0x33e1a8[_0x403c22(0x2b8)]=_0x403c22(0x4ae),_0x33e1a8['innerHTML']=_0x403c22(0x278);const _0x377e1e=document['createElement'](_0x403c22(0x245));_0x377e1e[_0x403c22(0x2b8)]=_0x403c22(0x24d),_0x377e1e[_0x403c22(0x373)]=_0x403c22(0x387),_0x2fb7eb['append'](_0x33e1a8,_0x377e1e),_0x86f17b['append'](_0x3d8020,_0x2fb7eb),_0x289a2a['append'](_0x86f17b),_0x205c98[_0x403c22(0x30e)](_0x3a8fbc,_0x289a2a),_0x3063e8[_0x403c22(0x4cb)](_0x205c98),_0x3a8fbc['addEventListener'](_0x403c22(0x38d),()=>selectSubtopic(_0x52d7e8['id'],_0x428569['id'])),_0x3d8020[_0x403c22(0x379)](_0x403c22(0x38d),_0x14de59=>{const _0x56d7f7=_0x403c22;_0x14de59[_0x56d7f7(0x3c2)]();const _0x27c4e1=_0x2fb7eb[_0x56d7f7(0x2e9)]['contains'](_0x56d7f7(0x40d));closeAllMenus(),_0x27c4e1?_0x55cdb9[_0x56d7f7(0x2e9)][_0x56d7f7(0x41a)]('menu-active'):(_0x2fb7eb[_0x56d7f7(0x2e9)][_0x56d7f7(0x325)](_0x56d7f7(0x40d)),_0x55cdb9[_0x56d7f7(0x2e9)]['add'](_0x56d7f7(0x327)));}),_0x33e1a8['addEventListener'](_0x403c22(0x38d),()=>showInputModal('Rename\x20Subtopic',async _0x991e1e=>{const _0x463ed2=_0x403c22;if(!_0x991e1e)return;_0x428569['name']=_0x991e1e,await storageManager[_0x463ed2(0x293)](_0x463ed2(0x4b5),_0x428569),renderAll();},_0x428569['name'])),_0x377e1e[_0x403c22(0x379)](_0x403c22(0x38d),()=>showConfirmModal(_0x403c22(0x230),'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22'+_0x428569['name']+_0x403c22(0x1ff),async _0x59b069=>{const _0x555174=_0x403c22;if(!_0x59b069)return;_0x52d7e8[_0x555174(0x4b5)]=_0x52d7e8['subtopics'][_0x555174(0x207)](_0x4e0f2f=>_0x4e0f2f['id']!==_0x428569['id']);const _0x127405=data[_0x555174(0x314)];_0x127405['selectedSubtopicId']===_0x428569['id']&&(_0x127405[_0x555174(0x389)]='',_0x127405[_0x555174(0x277)]='',ensureValidSelection()),await storageManager[_0x555174(0x2f9)](_0x555174(0x4b5),_0x428569['id']),renderAll();}));}),_0x3de578[_0x45ad33(0x379)](_0x45ad33(0x38d),_0x32fef7=>{const _0x1955b3=_0x45ad33;_0x32fef7[_0x1955b3(0x3c2)]();const _0x1b88f8=_0x3925d3[_0x1955b3(0x2e9)][_0x1955b3(0x355)](_0x1955b3(0x40d));closeAllMenus(),_0x1b88f8?_0x55cdb9[_0x1955b3(0x2e9)][_0x1955b3(0x41a)]('menu-active'):(_0x3925d3[_0x1955b3(0x2e9)]['add']('show'),_0x55cdb9['classList'][_0x1955b3(0x325)](_0x1955b3(0x327)));}),_0x3e58a8[_0x45ad33(0x379)](_0x45ad33(0x38d),()=>showInputModal(_0x45ad33(0x4e2),async _0x1a933d=>{const _0x30911b=_0x45ad33;if(!_0x1a933d)return;const _0x4f9428={'id':uid('s'),'topicId':_0x52d7e8['id'],'name':_0x1a933d,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x30911b(0x1ea),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};try{const _0x3f3057=data?.[_0x30911b(0x314)]?.[_0x30911b(0x24b)]||[];Array[_0x30911b(0x316)](_0x3f3057)&&_0x3f3057[_0x30911b(0x326)]>0x0&&(_0x4f9428[_0x30911b(0x24b)]=_0x3f3057,data[_0x30911b(0x314)][_0x30911b(0x24b)]=[],await storageManager['updateSettings'](data['settings']));}catch(_0x199194){}_0x52d7e8[_0x30911b(0x4b5)][_0x30911b(0x4a7)](_0x4f9428),await storageManager[_0x30911b(0x325)](_0x30911b(0x4b5),_0x4f9428),renderTopics();})),_0x243ae3[_0x45ad33(0x379)](_0x45ad33(0x38d),()=>showInputModal('Rename\x20Topic',async _0x53c2e6=>{const _0x3ee6e1=_0x45ad33;if(!_0x53c2e6)return;_0x52d7e8[_0x3ee6e1(0x4fb)]=_0x53c2e6,await storageManager[_0x3ee6e1(0x293)](_0x3ee6e1(0x48f),_0x52d7e8),renderTopics();},_0x52d7e8[_0x45ad33(0x4fb)])),_0x37a933[_0x45ad33(0x379)]('click',()=>showConfirmModal(_0x45ad33(0x230),_0x45ad33(0x1d9)+_0x52d7e8['name']+_0x45ad33(0x2c5),async _0x2212ad=>{const _0x5ea0ed=_0x45ad33;if(!_0x2212ad)return;data[_0x5ea0ed(0x48f)]=data['topics'][_0x5ea0ed(0x207)](_0x112206=>_0x112206['id']!==_0x52d7e8['id']),delete _0x4e3d02[_0x52d7e8['id']];data[_0x5ea0ed(0x314)][_0x5ea0ed(0x277)]===_0x52d7e8['id']&&(data['settings']['selectedTopicId']='',data[_0x5ea0ed(0x314)][_0x5ea0ed(0x389)]='',ensureValidSelection());await storageManager['delete']('topics',_0x52d7e8['id']);for(const _0xba3918 of _0x52d7e8['subtopics']){await storageManager[_0x5ea0ed(0x2f9)](_0x5ea0ed(0x4b5),_0xba3918['id']);}renderAll();})),_0x3e58a8[_0x45ad33(0x379)](_0x45ad33(0x38d),_0x3a16f9=>_0x3a16f9[_0x45ad33(0x3c2)]()),_0x243ae3['addEventListener'](_0x45ad33(0x38d),_0x1e387e=>_0x1e387e['stopPropagation']()),_0x37a933[_0x45ad33(0x379)](_0x45ad33(0x38d),_0x3e1e32=>_0x3e1e32[_0x45ad33(0x3c2)]()),_0x55cdb9[_0x45ad33(0x30e)](_0x518c45,_0x3063e8),_0x2c9a05[_0x45ad33(0x4cb)](_0x55cdb9);});if(window[_0x410218(0x474)]){const _0x11e758=document[_0x410218(0x4bc)](_0x410218(0x28d));if(_0x11e758){if(_0x11e758[_0x410218(0x48e)])try{_0x11e758['_sortable'][_0x410218(0x48c)]();}catch(_0x263718){}_0x11e758[_0x410218(0x48e)]=new Sortable(_0x11e758,{'animation':0x96,'draggable':_0x410218(0x27c),'onEnd':async function(_0x5bfd70){const _0x4fbd50=_0x410218;if(_0x5bfd70['oldIndex']===_0x5bfd70[_0x4fbd50(0x41e)])return;const _0x27bcc4=data[_0x4fbd50(0x48f)][_0x4fbd50(0x491)](_0x5bfd70['oldIndex'],0x1)[0x0];data[_0x4fbd50(0x48f)][_0x4fbd50(0x491)](_0x5bfd70['newIndex'],0x0,_0x27bcc4),await saveData(),renderTopics();}}),_0x11e758[_0x410218(0x257)](_0x410218(0x3f3))[_0x410218(0x345)](_0xf0314a=>{const _0x268cfb=_0x410218;new Sortable(_0xf0314a,{'group':'subtopics-group','animation':0x96,'draggable':_0x268cfb(0x3e8),'onEnd':async function(_0x2a75a0){const _0x2fde42=_0x268cfb,_0x35ad36=_0x2a75a0[_0x2fde42(0x4af)]?.[_0x2fde42(0x4f8)]?.['tid']||_0x2a75a0[_0x2fde42(0x4af)]?.[_0x2fde42(0x3b6)](_0x2fde42(0x27c))?.['dataset']?.[_0x2fde42(0x482)],_0x82b03b=_0x2a75a0['to']?.[_0x2fde42(0x4f8)]?.['tid']||_0x2a75a0['to']?.[_0x2fde42(0x3b6)](_0x2fde42(0x27c))?.[_0x2fde42(0x4f8)]?.[_0x2fde42(0x482)],_0x51f70a=data[_0x2fde42(0x48f)]['find'](_0x41e1c5=>_0x41e1c5['id']===_0x35ad36),_0x14bd23=data[_0x2fde42(0x48f)][_0x2fde42(0x4c3)](_0x28b041=>_0x28b041['id']===_0x82b03b);if(!_0x51f70a||!_0x14bd23)return;let _0x820366=null;const _0x560163=_0x2a75a0[_0x2fde42(0x329)]?.[_0x2fde42(0x4f8)]?.[_0x2fde42(0x2ec)]||_0x2a75a0['item']?.['querySelector'](_0x2fde42(0x31c))?.[_0x2fde42(0x4f8)]?.[_0x2fde42(0x2ec)];if(_0x560163){const _0x3e4f6d=_0x51f70a[_0x2fde42(0x4b5)][_0x2fde42(0x4bd)](_0x3f90a2=>_0x3f90a2['id']===_0x560163);if(_0x3e4f6d>=0x0)_0x820366=_0x51f70a[_0x2fde42(0x4b5)][_0x2fde42(0x491)](_0x3e4f6d,0x1)[0x0];}!_0x820366&&(_0x820366=_0x51f70a[_0x2fde42(0x4b5)][_0x2fde42(0x491)](_0x2a75a0[_0x2fde42(0x297)],0x1)[0x0]);if(!_0x820366)return;_0x820366[_0x2fde42(0x2fe)]=_0x14bd23['id'],_0x14bd23[_0x2fde42(0x4b5)][_0x2fde42(0x491)](_0x2a75a0[_0x2fde42(0x41e)],0x0,_0x820366),data[_0x2fde42(0x314)][_0x2fde42(0x389)]===_0x820366['id']&&(data['settings'][_0x2fde42(0x277)]=_0x14bd23['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x286ce4,_0x5122d5){const _0x46ea9b=_0x58e2db,_0x5a8feb=$(_0x46ea9b(0x36d)),_0x5226ff=getCurrentSubtopic();_0x5226ff&&timer[_0x46ea9b(0x21e)]!=='idle'&&(_0x5226ff['timerState']={'state':timer['state'],'prevState':timer[_0x46ea9b(0x44b)],'remaining':timer[_0x46ea9b(0x49f)],'segmentTotal':timer[_0x46ea9b(0x338)],'cycleIndex':timer[_0x46ea9b(0x26e)]}),_0x5a8feb[_0x46ea9b(0x2e9)][_0x46ea9b(0x325)](_0x46ea9b(0x206)),setTimeout(async()=>{const _0x2d7f2c=_0x46ea9b;data[_0x2d7f2c(0x314)][_0x2d7f2c(0x277)]=_0x286ce4,data[_0x2d7f2c(0x314)][_0x2d7f2c(0x389)]=_0x5122d5;const _0x5559a4=getCurrentSubtopic();_0x5559a4[_0x2d7f2c(0x44a)]?(timer[_0x2d7f2c(0x21e)]=_0x5559a4['timerState']['state'],timer[_0x2d7f2c(0x44b)]=_0x5559a4['timerState'][_0x2d7f2c(0x44b)]||null,timer[_0x2d7f2c(0x49f)]=_0x5559a4[_0x2d7f2c(0x44a)][_0x2d7f2c(0x49f)],timer['segmentTotal']=_0x5559a4[_0x2d7f2c(0x44a)]['segmentTotal'],timer[_0x2d7f2c(0x26e)]=_0x5559a4['timerState']['cycleIndex']):timer[_0x2d7f2c(0x27a)](),await saveData(),timer[_0x2d7f2c(0x22d)](),renderAll(),switchView(_0x2d7f2c(0x274)),_0x5a8feb['classList'][_0x2d7f2c(0x41a)](_0x2d7f2c(0x206));},0xc8);}function getCurrentSubtopic(){const _0x36c582=_0x58e2db,_0x61d151=data['settings'][_0x36c582(0x277)],_0x2a2e4a=data[_0x36c582(0x314)]['selectedSubtopicId'];if(!_0x61d151||!_0x2a2e4a)return null;const _0x4b01cd=data[_0x36c582(0x48f)][_0x36c582(0x4c3)](_0x4471d6=>_0x4471d6['id']===_0x61d151);if(!_0x4b01cd)return null;return _0x4b01cd[_0x36c582(0x4b5)][_0x36c582(0x4c3)](_0x135bf8=>_0x135bf8['id']===_0x2a2e4a)||null;}function renderContextBadge(){const _0x123550=_0x58e2db,_0x5d65e6=getCurrentSubtopic(),_0x1fae00=_0x5d65e6?_0x5d65e6[_0x123550(0x4fb)]:_0x123550(0x317),_0x23e64e=$(_0x123550(0x4d3)),_0x3f232b=$(_0x123550(0x2b5)),_0x28f13f=$(_0x123550(0x47d));if(_0x23e64e)_0x23e64e['textContent']=_0x5d65e6?'Subtopic:\x20'+_0x5d65e6['name']:_0x123550(0x414);if(_0x3f232b)_0x3f232b[_0x123550(0x351)]=_0x1fae00;if(_0x28f13f)_0x28f13f[_0x123550(0x351)]=_0x1fae00;}function renderSubtopicTasks(){const _0xd35b77=_0x58e2db,_0x4e329d=getCurrentSubtopic(),_0x3e560a=$(_0xd35b77(0x32a)),_0x49ac0f=$('#newSubtopicTaskInput');if(!_0x3e560a||!_0x49ac0f)return;const _0x47ea3e=_0x49ac0f[_0xd35b77(0x217)];if(!_0x4e329d){_0x3e560a[_0xd35b77(0x373)]=_0xd35b77(0x3c3),_0x47ea3e[_0xd35b77(0x2e9)][_0xd35b77(0x325)]('hidden');return;}_0x47ea3e['classList'][_0xd35b77(0x41a)](_0xd35b77(0x40a)),_0x3e560a[_0xd35b77(0x373)]='';const _0x55a8aa=_0x4e329d[_0xd35b77(0x38c)]?_0x4e329d[_0xd35b77(0x38c)]['filter'](_0x44bbea=>!_0x44bbea['isCompleted']):[];_0x55a8aa[_0xd35b77(0x326)]===0x0&&(_0x3e560a[_0xd35b77(0x373)]=_0xd35b77(0x246)),_0x55a8aa[_0xd35b77(0x345)](_0x18fd5b=>{const _0x20568f=_0xd35b77,_0x1e8776=document['createElement']('li');_0x1e8776[_0x20568f(0x373)]=_0x20568f(0x370)+_0x18fd5b['id']+_0x20568f(0x3f1)+_0x18fd5b['id']+'\x22>'+escapeHTML(_0x18fd5b[_0x20568f(0x46d)])+_0x20568f(0x4d7),_0x1e8776[_0x20568f(0x276)]('input')['addEventListener'](_0x20568f(0x260),_0x2c70e3=>toggleSubtopicTask(_0x2c70e3['target']['id'],_0x1e8776)),_0x3e560a['appendChild'](_0x1e8776);});}async function addSubtopicTask(){const _0x385f5f=_0x58e2db,_0x3384c4=getCurrentSubtopic();if(!_0x3384c4){toast(t(_0x385f5f(0x1f3)));return;}const _0x478a7b=$('#newSubtopicTaskInput'),_0x382ee0=_0x478a7b[_0x385f5f(0x2e8)]['trim']();if(_0x382ee0){if(!_0x3384c4['tasks'])_0x3384c4[_0x385f5f(0x38c)]=[];_0x3384c4[_0x385f5f(0x38c)][_0x385f5f(0x4a7)]({'id':uid(_0x385f5f(0x2f3)),'text':_0x382ee0,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x478a7b[_0x385f5f(0x2e8)]='';}_0x478a7b[_0x385f5f(0x49d)]();}async function toggleSubtopicTask(_0x32aeb2,_0x4fe1cd){const _0x4d267d=_0x58e2db,_0x26095f=getCurrentSubtopic();if(!_0x26095f||!_0x26095f[_0x4d267d(0x38c)])return;const _0x54866c=_0x26095f[_0x4d267d(0x38c)][_0x4d267d(0x4c3)](_0x42ec09=>_0x42ec09['id']===_0x32aeb2);_0x54866c&&(_0x54866c[_0x4d267d(0x3e5)]=!![],_0x26095f[_0x4d267d(0x20b)][_0x4d267d(0x308)]=(_0x26095f[_0x4d267d(0x20b)][_0x4d267d(0x308)]||0x0)+0x1,await saveData(),_0x4fe1cd[_0x4d267d(0x2e9)][_0x4d267d(0x325)](_0x4d267d(0x401)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':_0x58e2db(0x1ea),'prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x155aee,{silent:silent=![]}={}){const _0x32376c=_0x58e2db,_0x648f63=data[_0x32376c(0x314)];this[_0x32376c(0x1de)]=_0x155aee,this[_0x32376c(0x33b)]=_0x155aee==='A'?_0x648f63[_0x32376c(0x3f7)]:_0x155aee==='B'?_0x648f63[_0x32376c(0x46c)]:0x0,_0x648f63[_0x32376c(0x335)]=_0x155aee,await saveData(),this[_0x32376c(0x21e)]===_0x32376c(0x1ea)&&this[_0x32376c(0x27a)]();},'currentDurations'(){const _0x42c28b=_0x58e2db,_0x551d47=data[_0x42c28b(0x314)][_0x42c28b(0x3ec)];if(this[_0x42c28b(0x1de)]==='A')return{'work':_0x551d47[_0x42c28b(0x4e4)],'short':_0x551d47['A_short'],'long':_0x551d47[_0x42c28b(0x37f)],'winddown':_0x551d47[_0x42c28b(0x4ab)]??0x0};if(this[_0x42c28b(0x1de)]==='B')return{'work':_0x551d47[_0x42c28b(0x340)],'short':_0x551d47[_0x42c28b(0x446)],'long':_0x551d47[_0x42c28b(0x3fd)],'winddown':_0x551d47[_0x42c28b(0x386)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x42ef4a=_0x58e2db,_0x9c75b3=data['settings'];if(this['mode']==='A')return{'cycles':_0x9c75b3[_0x42ef4a(0x3f7)],'interval':_0x9c75b3['longBreakIntervalA']};if(this['mode']==='B')return{'cycles':_0x9c75b3[_0x42ef4a(0x46c)],'interval':_0x9c75b3['longBreakIntervalB']};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x44d1e4=_0x58e2db,_0x342a36=$(_0x44d1e4(0x37a)),_0x586448=$(_0x44d1e4(0x397)),_0x3a2a49=$(_0x44d1e4(0x2f6));if(!_0x342a36||!_0x586448||!_0x3a2a49)return;const _0x229411=this[_0x44d1e4(0x1de)]==='C';$('#btnStart')[_0x44d1e4(0x2e9)]['toggle'](_0x44d1e4(0x40a),this[_0x44d1e4(0x21e)]!==_0x44d1e4(0x1ea)||_0x229411&&this['state']===_0x44d1e4(0x219)),$(_0x44d1e4(0x225))[_0x44d1e4(0x2e9)][_0x44d1e4(0x242)](_0x44d1e4(0x40a),!(_0x229411&&this[_0x44d1e4(0x21e)]===_0x44d1e4(0x219))),$('#btnPause')[_0x44d1e4(0x2e9)][_0x44d1e4(0x242)](_0x44d1e4(0x40a),!['work',_0x44d1e4(0x4d8),_0x44d1e4(0x2c3)][_0x44d1e4(0x2ea)](this[_0x44d1e4(0x21e)])),$(_0x44d1e4(0x4d9))[_0x44d1e4(0x2e9)]['toggle'](_0x44d1e4(0x40a),this[_0x44d1e4(0x21e)]!==_0x44d1e4(0x413));let _0xb79d3a=_0x44d1e4(0x26f);if(this[_0x44d1e4(0x21e)]===_0x44d1e4(0x219))_0x342a36[_0x44d1e4(0x351)]=_0x229411?'FOCUS\x20(FLOW)':_0x44d1e4(0x1f5),_0x342a36[_0x44d1e4(0x2b8)]='badge\x20state\x20work',_0xb79d3a=_0x44d1e4(0x449);else{if(this[_0x44d1e4(0x21e)]===_0x44d1e4(0x4d8))_0x342a36[_0x44d1e4(0x351)]=_0x44d1e4(0x229),_0x342a36[_0x44d1e4(0x2b8)]=_0x44d1e4(0x259),_0xb79d3a=_0x44d1e4(0x454);else{if(this[_0x44d1e4(0x21e)]===_0x44d1e4(0x2c3))_0x342a36[_0x44d1e4(0x351)]=_0x44d1e4(0x4f6),_0x342a36[_0x44d1e4(0x2b8)]=_0x44d1e4(0x349),_0xb79d3a=_0x44d1e4(0x2d6);else{if(this[_0x44d1e4(0x21e)]===_0x44d1e4(0x385)){_0x342a36[_0x44d1e4(0x351)]=_0x44d1e4(0x330),_0x342a36[_0x44d1e4(0x2b8)]=_0x44d1e4(0x3b7),_0xb79d3a=_0x44d1e4(0x3c4);try{$(_0x44d1e4(0x4ed))[_0x44d1e4(0x2e9)][_0x44d1e4(0x41a)]('hidden'),$(_0x44d1e4(0x2dc))['classList'][_0x44d1e4(0x41a)](_0x44d1e4(0x40a));}catch(_0x4c67a5){}}else this[_0x44d1e4(0x21e)]===_0x44d1e4(0x413)?(_0x342a36[_0x44d1e4(0x351)]='PAUSED',_0x342a36['className']=_0x44d1e4(0x4ad)):(_0x342a36[_0x44d1e4(0x351)]='READY',_0x342a36[_0x44d1e4(0x2b8)]='badge');}}}[_0x44d1e4(0x219),_0x44d1e4(0x4d8),_0x44d1e4(0x2c3),'wind_down'][_0x44d1e4(0x2ea)](this[_0x44d1e4(0x21e)])?_0x3a2a49[_0x44d1e4(0x2e9)][_0x44d1e4(0x325)](_0x44d1e4(0x49c)):_0x3a2a49[_0x44d1e4(0x2e9)][_0x44d1e4(0x41a)]('breathing');_0x586448[_0x44d1e4(0x22c)][_0x44d1e4(0x2cc)]=_0xb79d3a,_0x3a2a49[_0x44d1e4(0x2e9)]['remove'](_0x44d1e4(0x3d3));const _0x5a944=$('#timeDisplay');if(_0x5a944)_0x5a944[_0x44d1e4(0x351)]=formatMMSS(this[_0x44d1e4(0x49f)]);const _0x6d2fa8=_0x586448['r'][_0x44d1e4(0x4ce)][_0x44d1e4(0x2e8)],_0x395d19=0x2*Math['PI']*_0x6d2fa8,_0x90fbae=this[_0x44d1e4(0x338)]>0x0?_0x395d19-this[_0x44d1e4(0x49f)]/this[_0x44d1e4(0x338)]*_0x395d19:_0x395d19;_0x586448['style']['strokeDasharray']=_0x395d19,_0x586448[_0x44d1e4(0x22c)][_0x44d1e4(0x3af)]=isNaN(_0x90fbae)?_0x395d19:_0x90fbae;const _0x7f3f44=$(_0x44d1e4(0x43b));if(_0x7f3f44){const _0x534223=this['currentConfig']();_0x7f3f44[_0x44d1e4(0x351)]=t(_0x44d1e4(0x271),{'current':this[_0x44d1e4(0x26e)],'target':_0x534223[_0x44d1e4(0x2b0)]}),_0x7f3f44[_0x44d1e4(0x2e9)][_0x44d1e4(0x242)](_0x44d1e4(0x40a),_0x229411);}const _0x57bafa=$(_0x44d1e4(0x3a9));_0x57bafa&&_0x57bafa[_0x44d1e4(0x2e9)][_0x44d1e4(0x242)](_0x44d1e4(0x40a),_0x229411&&this[_0x44d1e4(0x21e)]===_0x44d1e4(0x219));const _0xc4bcc5=$('#draggableTimer');if(_0xc4bcc5)_0xc4bcc5[_0x44d1e4(0x351)]=formatMMSS(this[_0x44d1e4(0x49f)]);if(this[_0x44d1e4(0x21e)]!==_0x44d1e4(0x385))try{$(_0x44d1e4(0x4ed))[_0x44d1e4(0x2e9)]['add']('hidden'),$(_0x44d1e4(0x2dc))[_0x44d1e4(0x2e9)][_0x44d1e4(0x325)]('hidden');}catch(_0xb9132b){}},'persistTimerState'(_0x5b7b60=![]){const _0x49794d=_0x58e2db;try{const _0x493c9c=getCurrentSubtopic();if(!_0x493c9c)return;const _0x4f8830={'state':this[_0x49794d(0x21e)],'prevState':this[_0x49794d(0x44b)],'remaining':this[_0x49794d(0x49f)],'segmentTotal':this[_0x49794d(0x338)],'cycleIndex':this[_0x49794d(0x26e)]};_0x493c9c[_0x49794d(0x44a)]=_0x4f8830;try{localStorage[_0x49794d(0x4eb)]('timerState_'+_0x493c9c['id'],JSON[_0x49794d(0x440)](_0x4f8830));}catch(_0x4a583f){}this[_0x49794d(0x23e)]=Date['now']();}catch(_0x26e1bd){}},'_startTick'(){const _0x3a1762=_0x58e2db;if(this[_0x3a1762(0x3f5)])clearInterval(this[_0x3a1762(0x3f5)]);if(this['mode']==='C'&&this[_0x3a1762(0x21e)]===_0x3a1762(0x219)){this[_0x3a1762(0x3f5)]=setInterval(()=>{const _0x368d81=_0x3a1762;this[_0x368d81(0x49f)]+=0x1,this[_0x368d81(0x22d)](),this[_0x368d81(0x254)]();},0x3e8);return;}this[_0x3a1762(0x3f5)]=setInterval(()=>{const _0x50f6e2=_0x3a1762;this[_0x50f6e2(0x49f)]>0x0&&(this[_0x50f6e2(0x49f)]-=0x1,this['updateUI'](),this[_0x50f6e2(0x254)]()),this[_0x50f6e2(0x49f)]<=0x0&&(clearInterval(this['tickHandle']),this[_0x50f6e2(0x3f5)]=null,this[_0x50f6e2(0x4f7)]());},0x3e8);},'_onFinishSegment'(){const _0xecf51c=_0x58e2db;if(this[_0xecf51c(0x21e)]==='work'){const _0x2c6603=getCurrentSubtopic();if(_0x2c6603){const _0x14d562=this['currentDurations']()['work'];_0x2c6603['stats'][_0xecf51c(0x3ee)]=(_0x2c6603['stats'][_0xecf51c(0x3ee)]||0x0)+_0x14d562,_0x2c6603['stats'][_0xecf51c(0x3e9)]=(_0x2c6603[_0xecf51c(0x20b)][_0xecf51c(0x3e9)]||0x0)+0x1;const _0x44d8e9={'id':uid(_0xecf51c(0x47a)),'dateISO':todayISO(),'durationMinutes':_0x14d562,'mode':this['mode'],'note':''};if(!_0x2c6603[_0xecf51c(0x43f)])_0x2c6603[_0xecf51c(0x43f)]=[];_0x2c6603[_0xecf51c(0x43f)]['unshift'](_0x44d8e9);if(data?.[_0xecf51c(0x314)]?.[_0xecf51c(0x408)])try{openNoteModal(_0x44d8e9['id']);}catch(_0x22f052){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0xecf51c(0x26e)]++;}if(typeof data!==_0xecf51c(0x272)&&data&&data['settings']&&data[_0xecf51c(0x314)]['enableWinddown']===![]&&this[_0xecf51c(0x21e)]==='work')playSound(_0xecf51c(0x29d));else(this[_0xecf51c(0x21e)]===_0xecf51c(0x385)||this[_0xecf51c(0x21e)]===_0xecf51c(0x4d8)||this['state']===_0xecf51c(0x2c3))&&playSound(_0xecf51c(0x290));const _0x278fd6=$('.timer-circle-container');if(_0x278fd6)_0x278fd6[_0xecf51c(0x2e9)][_0xecf51c(0x325)](_0xecf51c(0x3d3));if(data[_0xecf51c(0x314)][_0xecf51c(0x438)]){if(this['state']===_0xecf51c(0x219))data[_0xecf51c(0x314)][_0xecf51c(0x4e9)]===![]?this['beginBreak']():this[_0xecf51c(0x375)]();else this['state']===_0xecf51c(0x385)?this[_0xecf51c(0x2bc)]():this['beginWork']();}else this[_0xecf51c(0x3f5)]&&(clearInterval(this[_0xecf51c(0x3f5)]),this[_0xecf51c(0x3f5)]=null),this[_0xecf51c(0x21e)]=_0xecf51c(0x1ea),this[_0xecf51c(0x44b)]=null,this[_0xecf51c(0x22d)](),toast('Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.');},'beginWindDown'(){const _0xbcdad=_0x58e2db;if(data?.[_0xbcdad(0x314)]?.[_0xbcdad(0x4e9)]===![]){this[_0xbcdad(0x2bc)]();return;}this[_0xbcdad(0x44b)]=this[_0xbcdad(0x21e)],this[_0xbcdad(0x21e)]=_0xbcdad(0x385);const _0x1fee5b=(this['currentDurations']()[_0xbcdad(0x4f9)]||0x0)*0x3c;if(_0x1fee5b<=0x0){this[_0xbcdad(0x2bc)]();return;}this[_0xbcdad(0x338)]=_0x1fee5b,this[_0xbcdad(0x49f)]=_0x1fee5b;try{playSound(_0xbcdad(0x290));}catch(_0x5ee80a){}try{toast(_0xbcdad(0x2be));}catch(_0x52a70f){}this['_startTick'](),this[_0xbcdad(0x22d)]();},'beginWork'(){const _0x11f485=_0x58e2db;this['prevState']=this['state'],this['state']='work';if(this[_0x11f485(0x1de)]==='C'){this[_0x11f485(0x338)]=0x0;if(this[_0x11f485(0x44b)]!==_0x11f485(0x413))this[_0x11f485(0x49f)]=0x0;}else{const _0xca3f97=this[_0x11f485(0x29c)]()['work']*0x3c;this[_0x11f485(0x338)]=_0xca3f97;if(this[_0x11f485(0x44b)]!=='paused')this['remaining']=_0xca3f97;}const _0x112dcd=$('#breakSuggestionDisplay');_0x112dcd&&(_0x112dcd[_0x11f485(0x351)]=''),this['_startTick'](),this[_0x11f485(0x22d)]();},'finishFlowSession'(){const _0x3924bc=_0x58e2db;if(this[_0x3924bc(0x1de)]!=='C'||this[_0x3924bc(0x21e)]!=='work')return;this['tickHandle']&&(clearInterval(this['tickHandle']),this[_0x3924bc(0x3f5)]=null);const _0x46c7aa=Math[_0x3924bc(0x23d)](0x1,parseInt(data[_0x3924bc(0x314)][_0x3924bc(0x439)]??0x5,0xa)),_0x327124=Math[_0x3924bc(0x23d)](0x0,this['remaining']|0x0),_0x4245a0=Math[_0x3924bc(0x23d)](0x3c,Math['floor'](_0x327124/_0x46c7aa));try{const _0x2a7672=getCurrentSubtopic();if(_0x2a7672){const _0x1fe6ac=Math[_0x3924bc(0x23d)](0x1,Math[_0x3924bc(0x468)](_0x327124/0x3c));_0x2a7672[_0x3924bc(0x20b)][_0x3924bc(0x3ee)]=(_0x2a7672[_0x3924bc(0x20b)][_0x3924bc(0x3ee)]||0x0)+_0x1fe6ac,_0x2a7672[_0x3924bc(0x20b)][_0x3924bc(0x3e9)]=(_0x2a7672[_0x3924bc(0x20b)][_0x3924bc(0x3e9)]||0x0)+0x1;const _0x4b4493={'id':uid(_0x3924bc(0x47a)),'dateISO':todayISO(),'durationMinutes':_0x1fe6ac,'mode':this['mode'],'note':''};if(!_0x2a7672[_0x3924bc(0x43f)])_0x2a7672['sessions']=[];_0x2a7672[_0x3924bc(0x43f)][_0x3924bc(0x466)](_0x4b4493),saveData(),renderStatsHistory(),data?.[_0x3924bc(0x314)]?.[_0x3924bc(0x408)]&&openNoteModal(_0x4b4493['id']);}}catch(_0x3155d8){}this[_0x3924bc(0x21e)]=_0x3924bc(0x4d8),this[_0x3924bc(0x338)]=_0x4245a0,this[_0x3924bc(0x49f)]=_0x4245a0,this[_0x3924bc(0x358)](),this['updateUI'](),this[_0x3924bc(0x254)](!![]);try{toast(_0x3924bc(0x302)+Math[_0x3924bc(0x468)](_0x4245a0/0x3c)+'\x20min\x20via\x20Flowtime\x20('+_0x46c7aa+').');}catch(_0x257f5d){}},'beginBreak'(){const _0x4451fb=_0x58e2db;this[_0x4451fb(0x44b)]=this[_0x4451fb(0x21e)];const _0x5156c3=this['currentConfig'](),_0xc1bde=this['currentDurations']();if(this[_0x4451fb(0x26e)]>0x0&&this['cycleIndex']%_0x5156c3[_0x4451fb(0x2e7)]===0x0){this[_0x4451fb(0x21e)]=_0x4451fb(0x2c3);const _0x19e141=_0xc1bde[_0x4451fb(0x2a3)]*0x3c;this[_0x4451fb(0x338)]=_0x19e141;if(this[_0x4451fb(0x44b)]!=='paused')this[_0x4451fb(0x49f)]=_0x19e141;toast(_0x4451fb(0x268));}else{this[_0x4451fb(0x21e)]=_0x4451fb(0x4d8);const _0x1e672d=_0xc1bde['short']*0x3c;this[_0x4451fb(0x338)]=_0x1e672d;if(this[_0x4451fb(0x44b)]!=='paused')this['remaining']=_0x1e672d;}const _0x298512=$('#breakSuggestionDisplay');if(_0x298512){const _0x3f5cc5=Math['floor'](Math['random']()*breakSuggestions[_0x4451fb(0x326)]);_0x298512[_0x4451fb(0x351)]=_0x4451fb(0x36a)+breakSuggestions[_0x3f5cc5];}this[_0x4451fb(0x358)](),this[_0x4451fb(0x22d)]();},async 'start'(){const _0x1f54c4=_0x58e2db;if(!getCurrentSubtopic()){toast(_0x1f54c4(0x347));return;}ensureAudio();if(this['mode']==='C'&&this[_0x1f54c4(0x21e)]===_0x1f54c4(0x1ea))this['state']=_0x1f54c4(0x219),this[_0x1f54c4(0x49f)]=0x0,this['segmentTotal']=0x0,this[_0x1f54c4(0x26e)]=0x0,this[_0x1f54c4(0x358)](),this[_0x1f54c4(0x22d)]();else{if(this[_0x1f54c4(0x21e)]===_0x1f54c4(0x1ea))this[_0x1f54c4(0x26e)]=this[_0x1f54c4(0x26e)]||0x0,this['beginWork']();else this[_0x1f54c4(0x21e)]===_0x1f54c4(0x413)&&this[_0x1f54c4(0x395)]();}await this[_0x1f54c4(0x254)](!![]);},async 'pause'(){const _0x2673a7=_0x58e2db;this[_0x2673a7(0x3f5)]&&(clearInterval(this['tickHandle']),this[_0x2673a7(0x3f5)]=null),this['prevState']=this[_0x2673a7(0x21e)],this[_0x2673a7(0x21e)]=_0x2673a7(0x413),this[_0x2673a7(0x22d)](),await this[_0x2673a7(0x254)](!![]);},async 'resume'(){const _0x7b2c5e=_0x58e2db;if(this[_0x7b2c5e(0x21e)]!==_0x7b2c5e(0x413))return;this[_0x7b2c5e(0x21e)]=this[_0x7b2c5e(0x44b)]||_0x7b2c5e(0x219),this[_0x7b2c5e(0x358)](),this[_0x7b2c5e(0x22d)](),await this['persistTimerState'](!![]);},async 'skip'(){const _0x483aa7=_0x58e2db;if(this['mode']==='C'&&this['state']==='work'){this[_0x483aa7(0x3cc)](),await this[_0x483aa7(0x254)](!![]);return;}this[_0x483aa7(0x21e)]===_0x483aa7(0x219)?(this[_0x483aa7(0x3f5)]&&(clearInterval(this['tickHandle']),this['tickHandle']=null),this[_0x483aa7(0x49f)]=0x0,this[_0x483aa7(0x4f7)]()):(this[_0x483aa7(0x49f)]=0x0,this[_0x483aa7(0x3f5)]&&(clearInterval(this['tickHandle']),this[_0x483aa7(0x3f5)]=null),this[_0x483aa7(0x4f7)]()),await this['persistTimerState'](!![]);},async 'reset'(){const _0x4d1490=_0x58e2db;this[_0x4d1490(0x3f5)]&&(clearInterval(this['tickHandle']),this[_0x4d1490(0x3f5)]=null);this[_0x4d1490(0x21e)]=_0x4d1490(0x1ea),this[_0x4d1490(0x44b)]=null,this['remaining']=0x0,this[_0x4d1490(0x338)]=0x0,this[_0x4d1490(0x26e)]=0x0;const _0x183a31=$(_0x4d1490(0x3a9));_0x183a31&&(_0x183a31[_0x4d1490(0x351)]=''),this[_0x4d1490(0x22d)](),await this[_0x4d1490(0x254)](!![]);}};async function deleteSummary(_0x47c4b4){const _0x18e2bf=_0x58e2db;showConfirmModal(_0x18e2bf(0x230),'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?',async _0x43f845=>{const _0x30115e=_0x18e2bf;if(!_0x43f845)return;const _0x45a069=getCurrentSubtopic();if(!_0x45a069||!_0x45a069[_0x30115e(0x3e2)])return;const _0x3e2c23=[..._0x45a069[_0x30115e(0x3e2)]];_0x45a069['summaries']=_0x45a069[_0x30115e(0x3e2)][_0x30115e(0x207)](_0x17479c=>_0x17479c['id']!==_0x47c4b4);try{await storageManager[_0x30115e(0x293)](_0x30115e(0x4b5),_0x45a069),renderSummaries(),toast(_0x30115e(0x37e));}catch(_0x32ac60){console[_0x30115e(0x363)](_0x30115e(0x241),_0x32ac60),_0x45a069[_0x30115e(0x3e2)]=_0x3e2c23,toast(_0x30115e(0x203));}});}function exportSummary(_0x1c37b5){const _0x1dd7c6=_0x58e2db,_0x50ce63=new Blob([_0x1c37b5[_0x1dd7c6(0x2d8)]],{'type':_0x1dd7c6(0x2ac)}),_0x136375=document[_0x1dd7c6(0x383)]('a'),_0x38281e=new Date(_0x1c37b5['createdAt']),_0x4d5ab9=_0x5ea5d4=>(''+_0x5ea5d4)['padStart'](0x2,'0');_0x136375[_0x1dd7c6(0x281)]=URL[_0x1dd7c6(0x496)](_0x50ce63),_0x136375[_0x1dd7c6(0x4c6)]=_0x1dd7c6(0x3dc)+_0x38281e[_0x1dd7c6(0x391)]()+_0x4d5ab9(_0x38281e[_0x1dd7c6(0x44c)]()+0x1)+_0x4d5ab9(_0x38281e['getDate']())+'.txt',_0x136375['click'](),URL[_0x1dd7c6(0x34d)](_0x136375[_0x1dd7c6(0x281)]);}function renderStatsHistory(){const _0x5de0a1=_0x58e2db,_0x39545b=getCurrentSubtopic(),_0x5a9382=$(_0x5de0a1(0x231)),_0xca0bdc=$(_0x5de0a1(0x45b)),_0x316c68=$(_0x5de0a1(0x371)),_0x1194b3=$('#historyList');if(!_0x5a9382||!_0xca0bdc||!_0x316c68||!_0x1194b3)return;if(!_0x39545b){_0x5a9382[_0x5de0a1(0x351)]=_0x5de0a1(0x4c9),_0xca0bdc[_0x5de0a1(0x351)]='0',_0x316c68[_0x5de0a1(0x351)]='0',_0x1194b3[_0x5de0a1(0x373)]=_0x5de0a1(0x343);return;}const _0x18daa4=_0x39545b[_0x5de0a1(0x20b)]&&_0x39545b[_0x5de0a1(0x20b)][_0x5de0a1(0x3ee)]?_0x39545b[_0x5de0a1(0x20b)]['totalMinutes']:0x0,_0x80c45d=_0x39545b[_0x5de0a1(0x20b)]&&_0x39545b[_0x5de0a1(0x20b)][_0x5de0a1(0x3e9)]?_0x39545b[_0x5de0a1(0x20b)][_0x5de0a1(0x3e9)]:0x0,_0x40c04e=_0x39545b[_0x5de0a1(0x38c)]?_0x39545b['tasks'][_0x5de0a1(0x207)](_0xffd1a2=>_0xffd1a2[_0x5de0a1(0x3e5)])[_0x5de0a1(0x326)]:0x0;_0x5a9382[_0x5de0a1(0x351)]=formatDaysHoursMinutes(_0x18daa4),_0xca0bdc['textContent']=String(_0x80c45d),_0x316c68['textContent']=String(_0x40c04e),_0x1194b3[_0x5de0a1(0x373)]='';const _0x2de5f5=Array[_0x5de0a1(0x316)](_0x39545b[_0x5de0a1(0x43f)])?_0x39545b[_0x5de0a1(0x43f)]:[];if(_0x2de5f5[_0x5de0a1(0x326)]===0x0){_0x1194b3[_0x5de0a1(0x373)]=_0x5de0a1(0x48d);return;}_0x2de5f5[_0x5de0a1(0x345)](_0x101ef0=>{const _0x14d28a=_0x5de0a1,_0x401a80=document[_0x14d28a(0x383)](_0x14d28a(0x3aa));_0x401a80[_0x14d28a(0x2b8)]=_0x14d28a(0x275);const _0x458cf7=document[_0x14d28a(0x383)](_0x14d28a(0x3aa)),_0x11ea8f=_0x101ef0[_0x14d28a(0x33a)]?new Date(_0x101ef0[_0x14d28a(0x33a)]):new Date(),_0x596e73=_0x101ef0['durationMinutes']!=null?_0x101ef0[_0x14d28a(0x32b)]:_0x101ef0[_0x14d28a(0x214)]||0x0,_0x2e18f4=_0x14d28a(0x475)+_0x11ea8f[_0x14d28a(0x4e6)]()+'\x20·\x20'+_0x596e73+_0x14d28a(0x48b)+(_0x101ef0['mode']||'')+_0x14d28a(0x421);let _0xeea9f='';if(_0x101ef0[_0x14d28a(0x256)])_0xeea9f=_0x14d28a(0x39e)+escapeHTML(_0x101ef0[_0x14d28a(0x256)])+_0x14d28a(0x421);else data?.[_0x14d28a(0x314)]?.[_0x14d28a(0x408)]&&(_0xeea9f=_0x14d28a(0x300));_0x458cf7['innerHTML']=_0x2e18f4+_0xeea9f,_0x401a80[_0x14d28a(0x4cb)](_0x458cf7),_0x1194b3[_0x14d28a(0x4cb)](_0x401a80);});}function renderGeneralNotes(){const _0x53b4b6=_0x58e2db,_0x4f16fa=$('#generalNotesList');if(!_0x4f16fa)return;const _0x392460=getCurrentSubtopic();if(!_0x392460){_0x4f16fa[_0x53b4b6(0x373)]=_0x53b4b6(0x20a);return;}_0x392460[_0x53b4b6(0x4f0)]=_0x392460[_0x53b4b6(0x4f0)]||[];if(_0x392460[_0x53b4b6(0x4f0)][_0x53b4b6(0x326)]===0x0){_0x4f16fa[_0x53b4b6(0x373)]=_0x53b4b6(0x3a7);return;}_0x4f16fa[_0x53b4b6(0x373)]='',_0x392460[_0x53b4b6(0x4f0)][_0x53b4b6(0x345)](_0x3cf822=>{const _0x423d62=_0x53b4b6,_0x4c099c=document[_0x423d62(0x383)](_0x423d62(0x3aa));_0x4c099c[_0x423d62(0x2b8)]='note-item';const _0x5a2894=document[_0x423d62(0x383)](_0x423d62(0x3aa));_0x5a2894[_0x423d62(0x2b8)]=_0x423d62(0x4d1),_0x5a2894['textContent']=typeof _0x3cf822===_0x423d62(0x224)?_0x3cf822:_0x3cf822['text']||'';const _0x55865c=document[_0x423d62(0x383)]('div');_0x55865c[_0x423d62(0x2b8)]=_0x423d62(0x46f),_0x55865c[_0x423d62(0x351)]=_0x3cf822[_0x423d62(0x3a5)]?new Date(_0x3cf822['createdAt'])[_0x423d62(0x4e6)]():'';const _0x38fcea=document[_0x423d62(0x383)](_0x423d62(0x3aa)),_0xa7714d=document[_0x423d62(0x383)](_0x423d62(0x245));_0xa7714d[_0x423d62(0x2b8)]='btn\x20small\x20danger',_0xa7714d[_0x423d62(0x351)]=_0x423d62(0x23b),_0xa7714d[_0x423d62(0x328)]=async _0x2b2543=>{const _0xa8a66d=_0x423d62;_0x2b2543[_0xa8a66d(0x3c2)]();const _0x35d062=getCurrentSubtopic();if(!_0x35d062)return;_0x35d062[_0xa8a66d(0x4f0)]=(_0x35d062[_0xa8a66d(0x4f0)]||[])['filter'](_0x41adfd=>(_0x41adfd['id']||_0x41adfd)!==(_0x3cf822['id']||_0x3cf822)),await saveData(),renderGeneralNotes();},_0x38fcea[_0x423d62(0x4cb)](_0xa7714d);const _0x34169d=document['createElement']('div');_0x34169d[_0x423d62(0x2b8)]='note-content-wrapper',_0x34169d[_0x423d62(0x30e)](_0x5a2894,_0x55865c),_0x4c099c[_0x423d62(0x30e)](_0x34169d,_0x38fcea),_0x4f16fa['appendChild'](_0x4c099c);});}function renderMethods(){const _0x5d5049=_0x58e2db,_0x4e18f3=document[_0x5d5049(0x276)]('#view-methods\x20.methods-container');if(!_0x4e18f3)return;_0x4e18f3[_0x5d5049(0x373)]='';const _0x25b1aa=getCurrentSubtopic();if(!_0x25b1aa){_0x4e18f3[_0x5d5049(0x373)]=_0x5d5049(0x2fd);return;}const _0x223d39=Array[_0x5d5049(0x316)](_0x25b1aa[_0x5d5049(0x24b)])?_0x25b1aa['methods']:[];if(_0x223d39['length']===0x0){_0x4e18f3[_0x5d5049(0x373)]=_0x5d5049(0x3ad);return;}_0x223d39[_0x5d5049(0x345)](_0x157acb=>{const _0x320fa=_0x5d5049,_0x324a05=document[_0x320fa(0x383)](_0x320fa(0x3aa));_0x324a05['className']=_0x320fa(0x444),_0x324a05[_0x320fa(0x4f8)]['methodId']=_0x157acb['id'];const _0x3c4c2d=document[_0x320fa(0x383)](_0x320fa(0x3aa)),_0x8df7dd=document[_0x320fa(0x383)](_0x320fa(0x270));_0x8df7dd[_0x320fa(0x2b8)]='method-title',_0x8df7dd[_0x320fa(0x351)]=_0x157acb[_0x320fa(0x3cb)]||_0x320fa(0x3ca),_0x8df7dd[_0x320fa(0x379)](_0x320fa(0x38d),_0x390358=>{const _0x3c2f02=_0x320fa;_0x390358[_0x3c2f02(0x3f9)](),_0x390358[_0x3c2f02(0x3c2)]();const _0x554b43=_0x324a05[_0x3c2f02(0x276)](_0x3c2f02(0x29b));if(!_0x554b43)return;const _0x3f1390=_0x554b43[_0x3c2f02(0x40a)];_0x4e18f3['querySelectorAll'](_0x3c2f02(0x3ef))['forEach'](_0x375077=>{const _0x4ef826=_0x3c2f02;_0x375077[_0x4ef826(0x40a)]=!![];}),_0x554b43[_0x3c2f02(0x40a)]=!_0x3f1390;});const _0x581fb2=document[_0x320fa(0x383)](_0x320fa(0x3aa));_0x581fb2['className']=_0x320fa(0x342);const _0x5d2f87=document[_0x320fa(0x383)]('button');_0x5d2f87[_0x320fa(0x2b8)]=_0x320fa(0x32e),_0x5d2f87[_0x320fa(0x351)]=_0x320fa(0x287),_0x5d2f87[_0x320fa(0x4f8)]['id']=_0x157acb['id'];const _0x1df11d=document[_0x320fa(0x383)](_0x320fa(0x245));_0x1df11d[_0x320fa(0x2b8)]=_0x320fa(0x1eb),_0x1df11d[_0x320fa(0x351)]='Delete',_0x1df11d[_0x320fa(0x4f8)]['id']=_0x157acb['id'],_0x581fb2[_0x320fa(0x30e)](_0x5d2f87,_0x1df11d),_0x3c4c2d[_0x320fa(0x30e)](_0x8df7dd,_0x581fb2);const _0x4c1895=document[_0x320fa(0x383)](_0x320fa(0x3aa));_0x4c1895[_0x320fa(0x2b8)]='method-content',_0x4c1895[_0x320fa(0x373)]=_0x157acb[_0x320fa(0x2d8)]||'',_0x4c1895[_0x320fa(0x40a)]=!![],_0x324a05['append'](_0x3c4c2d,_0x4c1895),_0x4e18f3[_0x320fa(0x4cb)](_0x324a05),_0x324a05[_0x320fa(0x379)](_0x320fa(0x38d),_0x557e77=>{const _0x32dd15=_0x320fa,_0x3da01d=_0x557e77['target'];if(!_0x3da01d)return;if(_0x3da01d[_0x32dd15(0x3b6)](_0x32dd15(0x245))||_0x3da01d[_0x32dd15(0x3b6)]('a')||_0x3da01d['closest'](_0x32dd15(0x356))||_0x3da01d[_0x32dd15(0x3b6)](_0x32dd15(0x465)))return;const _0x1dec31=_0x4c1895['hidden'];_0x4e18f3[_0x32dd15(0x257)](_0x32dd15(0x3ef))[_0x32dd15(0x345)](_0x1f89b9=>{const _0x35ab26=_0x32dd15;_0x1f89b9[_0x35ab26(0x40a)]=!![];}),_0x4c1895[_0x32dd15(0x40a)]=!_0x1dec31;});});const _0x4fa0fd=_0x4e18f3[_0x5d5049(0x257)](_0x5d5049(0x20c));_0x4fa0fd[_0x5d5049(0x345)](_0x5eb800=>{const _0x1b55c4=_0x5d5049;_0x5eb800[_0x1b55c4(0x379)](_0x1b55c4(0x242),()=>{const _0x3f1966=_0x1b55c4;_0x5eb800[_0x3f1966(0x458)]&&_0x4fa0fd[_0x3f1966(0x345)](_0x2c5b60=>{const _0x91aefc=_0x3f1966;if(_0x2c5b60!==_0x5eb800)_0x2c5b60[_0x91aefc(0x458)]=![];});});}),window[_0x5d5049(0x474)]&&new Sortable(_0x4e18f3,{'animation':0x96,'draggable':'.method-item','onEnd':async function(_0x53a4d5){const _0x27b55b=_0x5d5049;if(_0x53a4d5[_0x27b55b(0x297)]===_0x53a4d5[_0x27b55b(0x41e)])return;const _0x338064=getCurrentSubtopic();if(!_0x338064||!Array[_0x27b55b(0x316)](_0x338064[_0x27b55b(0x24b)]))return;const _0x4771b9=_0x338064[_0x27b55b(0x24b)][_0x27b55b(0x491)](_0x53a4d5['oldIndex'],0x1)[0x0];_0x338064[_0x27b55b(0x24b)]['splice'](_0x53a4d5[_0x27b55b(0x41e)],0x0,_0x4771b9),await saveData();}});}function addGeneralNote(){const _0x1bfe0a=_0x58e2db;showInputModal(_0x1bfe0a(0x212),async _0x45a24d=>{const _0x471932=_0x1bfe0a;if(!_0x45a24d)return;const _0x36fe08=getCurrentSubtopic();if(!_0x36fe08){toast(_0x471932(0x30f));return;}_0x36fe08['generalNotes']=_0x36fe08['generalNotes']||[],_0x36fe08[_0x471932(0x4f0)][_0x471932(0x466)]({'id':uid('gn'),'text':_0x45a24d,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x5837c6=_0x58e2db,_0x3c8ef7=getCurrentSubtopic();if(!_0x3c8ef7){toast(_0x5837c6(0x30f));return;}const _0x356d9c=(_0x3c8ef7[_0x5837c6(0x4f0)]||[])[_0x5837c6(0x3ea)](_0x37016b=>typeof _0x37016b===_0x5837c6(0x224)?_0x37016b:_0x37016b['text']||'')['filter'](Boolean);if(_0x356d9c['length']===0x0){toast(_0x5837c6(0x46e));return;}const _0x414a9e=$(_0x5837c6(0x45f));_0x414a9e&&(_0x414a9e[_0x5837c6(0x3fb)]=!![],_0x414a9e['innerHTML']=_0x5837c6(0x409));try{const _0x2c0c72=_0x5837c6(0x36f)+_0x356d9c[_0x5837c6(0x25d)](_0x5837c6(0x405)),_0x5a8ebe=await callGeminiAPI(_0x2c0c72);if(!_0x3c8ef7[_0x5837c6(0x3e2)])_0x3c8ef7[_0x5837c6(0x3e2)]=[];_0x3c8ef7[_0x5837c6(0x3e2)][_0x5837c6(0x466)]({'id':uid(_0x5837c6(0x3da)),'content':_0x5a8ebe||_0x5837c6(0x2ca),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x52de3d){console['error'](_0x52de3d),toast(_0x5837c6(0x2a0));}finally{_0x414a9e&&(_0x414a9e[_0x5837c6(0x3fb)]=![],_0x414a9e[_0x5837c6(0x351)]=_0x5837c6(0x3bb));}}function renderSummaries(){const _0x204417=_0x58e2db,_0x9a792=$(_0x204417(0x42f));if(!_0x9a792)return;const _0xa9c249=getCurrentSubtopic();if(!_0xa9c249){_0x9a792[_0x204417(0x373)]=_0x204417(0x350);return;}_0x9a792[_0x204417(0x373)]='';if(!_0xa9c249[_0x204417(0x3e2)]||_0xa9c249[_0x204417(0x3e2)][_0x204417(0x326)]===0x0){_0x9a792[_0x204417(0x373)]=_0x204417(0x286);return;}_0xa9c249[_0x204417(0x3e2)][_0x204417(0x345)](_0x4d091c=>{const _0x39e05a=_0x204417,_0xcf3caf=document[_0x39e05a(0x383)](_0x39e05a(0x3aa));_0xcf3caf['className']=_0x39e05a(0x357);const _0x4a8c7b=document[_0x39e05a(0x383)](_0x39e05a(0x3aa));_0x4a8c7b[_0x39e05a(0x2b8)]=_0x39e05a(0x4e5);const _0x53ad80=document[_0x39e05a(0x383)](_0x39e05a(0x3aa));_0x53ad80['className']=_0x39e05a(0x4d1),_0x53ad80[_0x39e05a(0x351)]=_0x4d091c[_0x39e05a(0x2d8)];const _0xd62822=document[_0x39e05a(0x383)](_0x39e05a(0x3aa));_0xd62822[_0x39e05a(0x2b8)]=_0x39e05a(0x46f),_0xd62822[_0x39e05a(0x351)]=new Date(_0x4d091c[_0x39e05a(0x3a5)])[_0x39e05a(0x4e6)](),_0x4a8c7b[_0x39e05a(0x30e)](_0x53ad80,_0xd62822);const _0x1f4c44=document[_0x39e05a(0x383)](_0x39e05a(0x3aa)),_0x1aeaec=document[_0x39e05a(0x383)](_0x39e05a(0x245));_0x1aeaec[_0x39e05a(0x2b8)]=_0x39e05a(0x1d7),_0x1aeaec['textContent']='Export',_0x1aeaec['onclick']=_0x4118f2=>{const _0x2528ca=_0x39e05a;_0x4118f2[_0x2528ca(0x3c2)](),exportSummary(_0x4d091c);};const _0x357d83=document[_0x39e05a(0x383)](_0x39e05a(0x245));_0x357d83['className']=_0x39e05a(0x1e9),_0x357d83[_0x39e05a(0x351)]='Delete',_0x357d83['onclick']=_0x3fded7=>{const _0x1c9c3c=_0x39e05a;_0x3fded7[_0x1c9c3c(0x3c2)](),deleteSummary(_0x4d091c['id']);},_0x1f4c44['append'](_0x1aeaec,_0x357d83),_0xcf3caf[_0x39e05a(0x30e)](_0x4a8c7b,_0x1f4c44),_0xcf3caf[_0x39e05a(0x379)](_0x39e05a(0x38d),()=>_0x53ad80[_0x39e05a(0x2e9)][_0x39e05a(0x242)](_0x39e05a(0x38e))),_0x9a792[_0x39e05a(0x4cb)](_0xcf3caf);});}function loadEditingPresetFields(){const _0x3132b3=_0x58e2db,_0x13b01d=data['settings'],_0x15dd1d=_0x13b01d[_0x3132b3(0x3ec)],_0x327073=$(_0x3132b3(0x4b8)),_0x343a09=$(_0x3132b3(0x3f8));if(_0x327073&&_0x343a09){const _0xbe3cd1=editingPreset==='C';_0x327073[_0x3132b3(0x2e9)][_0x3132b3(0x242)]('hidden',_0xbe3cd1),_0x343a09['classList'][_0x3132b3(0x242)](_0x3132b3(0x40a),!_0xbe3cd1);}if(editingPreset==='A'){$(_0x3132b3(0x344))['value']=_0x15dd1d['A_work'];if($('#set_winddown'))$(_0x3132b3(0x315))[_0x3132b3(0x2e8)]=_0x15dd1d[_0x3132b3(0x4ab)]??0x0;$(_0x3132b3(0x1d5))[_0x3132b3(0x2e8)]=_0x15dd1d[_0x3132b3(0x4be)],$(_0x3132b3(0x1e1))[_0x3132b3(0x2e8)]=_0x15dd1d[_0x3132b3(0x37f)],$('#set_cycles')['value']=_0x13b01d[_0x3132b3(0x3f7)],$(_0x3132b3(0x1f7))['value']=_0x13b01d[_0x3132b3(0x3d2)];}else{if(editingPreset==='B'){$(_0x3132b3(0x344))[_0x3132b3(0x2e8)]=_0x15dd1d[_0x3132b3(0x340)];if($(_0x3132b3(0x315)))$(_0x3132b3(0x315))['value']=_0x15dd1d[_0x3132b3(0x386)]??0x0;$(_0x3132b3(0x1d5))[_0x3132b3(0x2e8)]=_0x15dd1d[_0x3132b3(0x446)],$(_0x3132b3(0x1e1))[_0x3132b3(0x2e8)]=_0x15dd1d['B_long'],$(_0x3132b3(0x1f9))[_0x3132b3(0x2e8)]=_0x13b01d['cyclesB'],$(_0x3132b3(0x1f7))[_0x3132b3(0x2e8)]=_0x13b01d['longBreakIntervalB'];}else{if(editingPreset==='C'){const _0x43e35e=$('#set_flowRatio');if(_0x43e35e)_0x43e35e['value']=_0x13b01d[_0x3132b3(0x439)]??0x5;}}}}function highlightPresetSelector(){const _0x5bae31=_0x58e2db;$$(_0x5bae31(0x2bf))[_0x5bae31(0x345)](_0x3fb90d=>{const _0x28d2de=_0x5bae31,_0x199b79=_0x3fb90d['dataset']['presetTarget']===editingPreset;_0x3fb90d[_0x28d2de(0x2e9)][_0x28d2de(0x242)](_0x28d2de(0x359),_0x199b79),_0x3fb90d['classList']['toggle'](_0x28d2de(0x400),!_0x199b79);});}function _0x5eb1(_0x40fef8,_0x4e9ab1){const _0x35f36e=_0x35f3();return _0x5eb1=function(_0x5eb1d5,_0x3fba36){_0x5eb1d5=_0x5eb1d5-0x1d5;let _0x110822=_0x35f36e[_0x5eb1d5];return _0x110822;},_0x5eb1(_0x40fef8,_0x4e9ab1);}function openSettings(){const _0x16fd3d=_0x58e2db,_0x26430d=data[_0x16fd3d(0x314)];editingPreset=_0x26430d[_0x16fd3d(0x335)],$(_0x16fd3d(0x3d6))[_0x16fd3d(0x2e8)]=_0x26430d[_0x16fd3d(0x463)]||'',loadEditingPresetFields(),highlightPresetSelector(),$('#set_volume')[_0x16fd3d(0x2e8)]=_0x26430d[_0x16fd3d(0x2b2)]??0.8,$(_0x16fd3d(0x3ab))[_0x16fd3d(0x2e8)]=_0x26430d[_0x16fd3d(0x221)]||_0x16fd3d(0x352),$(_0x16fd3d(0x1dd))[_0x16fd3d(0x2e8)]=_0x26430d[_0x16fd3d(0x1f6)]||_0x16fd3d(0x4de);const _0xac4578=getActiveYoutubeUrl();$(_0x16fd3d(0x4d2))[_0x16fd3d(0x2e8)]=_0xac4578||'';const _0x9abebd=extractYouTubeID(_0xac4578);$(_0x16fd3d(0x47e))[_0x16fd3d(0x3fb)]=!_0x9abebd;$(_0x16fd3d(0x402))&&($(_0x16fd3d(0x402))[_0x16fd3d(0x351)]='');$(_0x16fd3d(0x4f5))[_0x16fd3d(0x2e8)]=_0x26430d['youtubeVolume']||0x50,$(_0x16fd3d(0x43c))[_0x16fd3d(0x1fa)]=!!_0x26430d['useYtThumbnailAsBg'],$(_0x16fd3d(0x4cf))['value']=_0x26430d['panelOpacity']||0.85;$(_0x16fd3d(0x4f3))&&($(_0x16fd3d(0x4f3))[_0x16fd3d(0x2e8)]=_0x26430d[_0x16fd3d(0x367)]||_0x16fd3d(0x1db));$(_0x16fd3d(0x220))&&($(_0x16fd3d(0x220))['checked']=!!_0x26430d['autoStartNext']);$(_0x16fd3d(0x3ae))&&($(_0x16fd3d(0x3ae))[_0x16fd3d(0x1fa)]=_0x26430d['enableWinddown']!==![]);$('#set_enableSessionNotes')&&($('#set_enableSessionNotes')[_0x16fd3d(0x1fa)]=!!_0x26430d['enableSessionNotes']);$('#set_backupDays')&&($(_0x16fd3d(0x447))['value']=_0x26430d[_0x16fd3d(0x1ec)]||0x7);const _0x3c20ce=$(_0x16fd3d(0x376));_0x3c20ce&&storageManager[_0x16fd3d(0x269)]()[_0x16fd3d(0x25b)](_0x4226ca=>{const _0x1b6313=_0x16fd3d;_0x3c20ce[_0x1b6313(0x373)]='<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>',_0x4226ca&&_0x4226ca[_0x1b6313(0x326)]>0x0?_0x4226ca[_0x1b6313(0x345)](_0x10bdd5=>{const _0x51afc4=_0x1b6313,_0x11dafa=document['createElement'](_0x51afc4(0x3f6));_0x11dafa[_0x51afc4(0x2e8)]=_0x10bdd5[_0x51afc4(0x3cf)],_0x11dafa[_0x51afc4(0x351)]=_0x51afc4(0x305)+new Date(_0x10bdd5[_0x51afc4(0x3cf)])['toLocaleDateString'](_0x51afc4(0x2da)),_0x3c20ce[_0x51afc4(0x4cb)](_0x11dafa);}):_0x3c20ce[_0x1b6313(0x373)]=_0x1b6313(0x2ed);});$(_0x16fd3d(0x30a))[_0x16fd3d(0x2e9)]['add']('show');try{trapFocus($('#modalSettings'));}catch(_0x3e5274){}}function _0x35f3(){const _0x1fb02c=['Gemini\x20error:\x20','result','To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','removeChild','function','--panel-opacity','importData','status','add','length','menu-active','onclick','item','#subtopicTasksList','durationMinutes','11306416nTDeje','Tab','btn\x20small\x20ghost\x20method-edit','Loosen\x20your\x20finger\x20joints\x20after\x20typing.','WIND-DOWN','selectionEnd','12eCTIHn','display','setVolume','preset','#uploadSoundLong','documentElement','segmentTotal','#genericTitle','dateISO','cyclesTarget','formatBlock','#importFile','pomodoro_backup_','Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.','B_work','Background\x20music\x20stopped.','topic-actions','<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>','#set_work','forEach','model','Please\x20select\x20a\x20Subtopic\x20first','contentWindow','badge\x20state\x20long','Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.','#welcomePanel','Switched\x20to\x20Style\x20','revokeObjectURL','#btnAddMethod','#modalDashboard','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>','textContent','beep','backgroundSize','objectStoreNames','contains','.color-picker-wrapper','note-item','_startTick','acc','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','objectStore','get','PLAYING','Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.','set_youtubeUrl','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.','.modal','warn','error','55IOLpcQ','pointerdown','&quot;','backgroundMode','.color-swatch','<p>The\x20core\x20idea:\x20\x22If\x20you\x20can’t\x20explain\x20a\x20topic\x20simply,\x20you\x20don’t\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can’t\x20explain\x20smoothly,\x20you’ve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it’s\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool—pinpointing\x20exactly\x20where\x20you’re\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>','💡\x20Suggestion:\x20','reduce','#noteText','.app-content','blob:','Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a','<input\x20type=\x22checkbox\x22\x20id=\x22','#statTasks','yt-fallback','innerHTML','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>','beginWindDown','#backupList','foreColor','.aux-panel,\x20.modal-card','addEventListener','#stateBadge','#modalNote','random','log','Summary\x20deleted.','A_long','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203–5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20“Force\x20Multiplier”:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','pause','blockReason','createElement','aria-pressed','wind_down','B_winddown','Delete\x20Subtopic','autoplay;\x20encrypted-media;\x20picture-in-picture','selectedSubtopicId','#btnSaveNote','Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.','tasks','click','expanded','#btnEnableSound','right','getFullYear','activeElement','getBoundingClientRect','Notice\x20the\x20room’s\x20temperature\x20and\x20lighting.','resume','errorCode','.timer-circle-progress','mousemove','AudioContext','topic','presetTarget','OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...','location','<div>','24UBwBKk','origin','Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.','getSettings','?\x20Current\x20data\x20will\x20be\x20overwritten.','Gently\x20massage\x20your\x20temples.','createdAt','#btnPresetC','<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>','user','#breakSuggestionDisplay','div','#set_theme','Backup\x20not\x20found.','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>','#set_enableWinddown','strokeDashoffset','ArrowRight','tagName','Custom\x20background\x20removed.','<span\x20class=\x22ico\x22>▾</span>','actions','offsetHeight','closest','badge\x20state\x20work','https://img.youtube.com/vi/','16HCTKKB','replace','Summarize','#btnHelpCreateTopic','File\x20save\x20error.','Playing\x20background\x20music...','<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20','data','pastel','stopPropagation','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>','var(--acc-2)','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>','Player','shiftKey','reload','Untitled','title','finishFlowSession','ArrowLeft','.topic-item.menu-active','date','promptFeedback','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.','longBreakIntervalA','finished','message','<ul>','#set_apiKey','Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22','min','#milestoneMessage','sum','match','summary_','No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.','1449900OgpSHC','#btnAddTopic','https:','parse','summaries','Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.','<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>','isCompleted','autoBackup','chat-msg\x20','.sub-row','sessionsCompleted','map','localeCompare','durations','fullscreenElement','totalMinutes','.method-item\x20.method-content','lofi','\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22','Tidy\x20or\x20rearrange\x20your\x20workspace.','.subtopics','To\x20You,\x20250\x20Hours\x20(Perseverance)','tickHandle','option','cyclesA','#settings-flowtime','preventDefault','json','disabled','btnToggleYtSound','B_long','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','sine','ghost','removing','#ytUrlFeedback','toLowerCase','values','\x0a-\x20','floor','key','enableSessionNotes','<div\x20class=\x22spinner\x22></div>','hidden','Use\x20AI\x20to\x20auto-format\x20text','restoreBackup','show','#btnClearChat','.method-delete','onload','#set_volume','destination','paused','No\x20Subtopic\x20Selected','<li>','ENDED','API\x20response\x20structure\x20is\x20unexpected:','cancel','https://www.youtube.com','remove','clientY','actions-menu','Creating\x20backup\x20for\x20','newIndex','.nav-btn[data-view]','isConnected','</div>','AutoBackup\x20error:','Check\x20and\x20correct\x20your\x20sitting\x20posture.','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?','createGain','#btnStart','Enter','backgroundRepeat','</td></tr>','<i>$1</i>','6876405UfZPyU','cleanupOldBackups','#btnSummarizeNote','/hqdefault.jpg','#summariesList','color','Rename\x20Topic','auto','#btnSkip','height','substring','Add\x20subtopic','mouseup','autoStartNext','flowtimeBreakRatio','useYtThumbnailAsBg','#cycleInfo','#set_ytThumbAsBg','#view-timer','Content\x20blocked\x20for:\x20','sessions','stringify','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','modalMethodEditor','#toolColor','method-item','bg-view-mode','B_short','#set_backupDays','__ytApiWatchdog','var(--acc)','timerState','prevState','getMonth','createIndex','mousedown','img.youtube.com/vi/','#btnClearBg','collapsedTopics','Error\x20calling\x20Gemini\x20API:','statusText','var(--warn)','isNaN','beforeunload','Settings\x20saved','open','none','...','#statSessions','parts','youtubeVolume','execCommand','#btnSummarize','youtube-player-container','about:blank','Count\x20down\x20slowly\x20from\x2020\x20to\x200.','apiKey','https://www.youtube.com/iframe_api','.color-palette','unshift','width','round','#btnGenericOk','http:','</li>','cyclesB','text','No\x20notes\x20to\x20summarize.','note-meta','9921930sHJxJO','Gemini\x20API\x20Error:','setValueAtTime','.actions-menu','Sortable','<div\x20class=\x22hist-meta\x22>','727962huyBbu','Daily\x20backup\x20successful.','Confirm\x20Restore','onsuccess','sess','postMessage','#toolBullet','#currentSubtopicNameChat','#btnToggleYtSound','position','#toolBold','#chatMessages','tid','PomodoroAppDB','Space','end','fullscreenchange','#set_flowRatio','&#39;','More\x20options','onerror','\x27\x20·\x20Mode\x20','destroy','<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>','_sortable','topics','frequency','splice','Delete\x20knowledge\x20\x22','#btnPause','http','toISOString','createObjectURL','PlayerState','startsWith','#btnToggleBg','Defaults\x20restored','input,select,textarea','breathing','focus','getAllKeys','remaining','url(','#toasts','exponentialRampToValueAtTime','Initialization\x20error:','To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','requestFullscreen','repeat','push','DB_VERSION','indexOf','files','A_winddown','sort','badge','menu-item','from','✨\x20Auto-format','.method-edit','long_end','space','sound_unlocked','subtopics','#btnSkipNote','lang','#settings-pomodoro','New\x20Topic\x20name?','getAll','\x20hidden','getElementById','findIndex','A_short','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','light','clear','<p>','find','Saved\x20alert\x20for\x20FOCUS.','Ask\x20yourself:\x20‘How\x20do\x20I\x20feel\x20right\x20now?’','download','Audio\x20playback\x20error:','.\x20Please\x20try\x20again\x20with\x20different\x20content.','0\x20min','oncomplete','appendChild','ytUrlFeedback','stop','baseVal','#set_panelOpacity','innerWidth','note-content','#set_youtubeUrl','#selectedContext','?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.','offsetWidth','Background\x20updated.','</label>','break','#btnResume','loadLanguage','DB_NAME','code','</ul>','default','Data\x20imported\x20successfully!','opacity','#topicsList','New\x20Subtopic\x20name?','Check\x20your\x20breathing—if\x20rushed,\x20slow\x20it\x20down.','A_work','note-content-wrapper','toLocaleString','<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20🧠</h4><p>Based\x20on\x20the\x20“Forgetting\x20Curve,”\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you’re\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you’ll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20📱</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20❌</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>—creating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010–20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory’s\x20“sweet\x20spot.”\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>','play','enableWinddown','\x20(A)','setItem','Initialization\x20error:\x20','#windDownChecklist','toast','protocol','generalNotes','Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.','version','#set_backgroundMode','Deleted\x20old\x20backup:\x20','#ytSoundVolume','LONG\x20BREAK','_onFinishSegment','dataset','winddown','#btnAddGeneralNote','name','src','fixed','Stand\x20up\x20and\x20take\x20a\x20few\x20steps.','#draggableTimer','left','Benjamin\x20Franklin’s\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','#set_short','allow','btn\x20small','role','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22','POST','cover','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','#set_theme_color','mode','ArrowUp','Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.','#set_long','backups','<ol>','#chatInput','Show\x20interface','test','</h4>','btn\x20subtopic-btn','btn\x20small\x20danger','idle','btn\x20small\x20danger\x20method-delete','backupDaysToKeep','/maxresdefault.jpg','To\x20You,\x201,000\x20Hours\x20(Transformation)','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','#modalMethodEditor','chime','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','timer.selectSubtopicPrompt','type','FOCUS','theme','#set_interval','triangle','#set_cycles','checked','#btnMilestoneClose','Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.','createObjectStore','setProperty','\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.','main_settings','pauseVideo','topic-header','Unable\x20to\x20save\x20changes.','_getStore','topic-item','reloading','filter','#editorPreview','scroll','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>','stats','.method-item','<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively—rather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later—once\x20you’ve\x20forgotten\x20the\x20original\x20style—use\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn’t\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses—turning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don’t\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>','createOscillator','#aiPromptSuggestions\x20button','defer','#methodEditorTitleInput','Add\x20note','Chat\x20history\x20cleared.','workMinutes','__ytApiPromise','#view-methods','parentElement','--bg-image','work','data:','updateSettings','achievedMilestones','selectionStart','state','getDate','#set_autoStartNext','soundTheme','altKey','onkeydown','string','#btnFinishFlow','#btnCloseSettings','by_topic','readonly','SHORT\x20BREAK','trim','.tab-btn','style','updateUI','gain','cueVideoById','Confirm\x20Deletion','#statTotal','abs','save','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','Failed\x20to\x20save\x20data:','Loading\x20YouTube\x20API...','Invalid\x20file\x20format','#btnSendMessage','backgroundImage','Look\x20at\x20something\x20cute\x20or\x20uplifting.','Delete','#btnRestoreBackup','max','lastPersist','Stand\x20up\x20and\x20stretch.','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','Failed\x20to\x20delete\x20summary:','toggle','file:','slice','button','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>','playVideo','Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.','var(--sub)','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','methods','scrollHeight','menu-item\x20danger','Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','unMute','transaction','customBg','btn\x20small\x20ghost\x20actions-menu-btn','IndexedDB\x20error:','persistTimerState','#methodEditorContentInput','note','querySelectorAll','stopVideo','badge\x20state\x20break','bottom','then','toLocaleDateString','join','italic','#audioLongEnd','change','.nav-btn','Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You’ve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.','Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren’t\x20just\x20time—they’re\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You’re\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.','absolute','#btnToggleCustomSounds','#btnSettings','#uploadSoundWork','Great!\x20Time\x20for\x20a\x20long\x20break.','getBackupList','IndexedDB\x20initialized\x20successfully.','100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment—it’s\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.','#milestoneTitle','head','cycleIndex','var(--muted)','span','timer.cycleInfo','undefined','#btnAutoFormat','timer','hist-item','querySelector','selectedTopicId','Rename\x20Subtopic','keydown','reset','Backup\x20failed:','.topic-item','exportData','pomodoro_files','iframe','HTTP\x20error:\x20','href','onupgradeneeded','Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time—it\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‘superpower’\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.','#audioWorkEnd','customSounds','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','Edit','chev\x20btn\x20small\x20ghost','getPlayerState','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','-9999px','To\x20You,\x205,000+\x20Hours\x20(Legacy)','topicsList','sub-row','.actions-menu.show','break_end','input','soundPermissionBar','update','styleWithCSS','.tab-content','Data\x20restored\x20successfully!\x20Reloading...','oldIndex','Sound\x20has\x20been\x20enabled!','mute','<strong>$1</strong>','.method-content','currentDurations','work_end','#btnTestSound','select','Summary\x20failed.','setPreset','command','long','body','#modalMilestone','pomodoroData_v11','aria-expanded','longBreakIntervalB','Escape','target','toString','text/plain','no-subtopic-selected','readwrite','setAttribute','cycles','hours','volume','object','file','#currentSubtopicName','removeEventListener','Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22','className','Import\x20failed:\x20','</td><td>','Saved\x20alert\x20for\x20LONG\x20BREAK.','beginBreak','padStart','Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.','#timerPresetSelector\x20button','innerHeight','🌊\x20Flow','&gt;','long_break','.actions-menu-btn','\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.','&amp;','Edit\x20Knowledge','exitFullscreen','</tbody></table>','(Could\x20not\x20generate\x20summary)','#modalGeneric','stroke','#btnExport','removeProperty','<h4>','getIframe','start','1535842dZlkQm','#btnCloseDashboard','.view','tab','var(--danger)','####\x20','content','#welcomePanel\x20p','en-US','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','#btnBreakEarly','chatHistory','initDB','put','#uploadBg','Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20','#genericInput','top','#genericMessage','async','application/json','interval','value','classList','includes','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','sid','<option\x20value=\x22\x22>No\x20backups\x20available</option>','Open\x20a\x20window\x20for\x20some\x20fresh\x20air.','Cycle\x20','Five\x20focused\x20hours!\x20You’ve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','currentView','Hide\x20interface','task','catch','\x20(B)','.timer-circle-container','#btnSaveSettings','script','delete','bold','#view-','#newSubtopicTaskInput','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20its\x20Knowledge\x20Base.</p>','topicId','active','<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>','#uploadSoundBreak','Break\x20','#btnCancelMethodEditor','transition','Backup\x20from:\x20','resolve','getItem','tasksCompleted','lastBackupDate','#modalSettings','textarea','30woIhJq','#customSoundsContainer','append','Please\x20select\x20a\x20subtopic\x20first.','#audioBreakEnd','Failed\x20to\x20load\x20YouTube\x20API','#btnGenericCancel','setRangeText','settings','#set_winddown','isArray','(none\x20selected)','connect','panelOpacity','candidates','113461mWGvRX','.subtopic-btn'];_0x35f3=function(){return _0x1fb02c;};return _0x35f3();}function closeSettings(){const _0x23095e=_0x58e2db;$('#modalSettings')[_0x23095e(0x2e9)]['remove'](_0x23095e(0x40d));try{releaseFocus();}catch(_0x527add){}}async function setDefaults(){const _0x33513d=_0x58e2db;data[_0x33513d(0x314)][_0x33513d(0x3ec)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x33513d(0x314)][_0x33513d(0x3f7)]=0x4,data[_0x33513d(0x314)][_0x33513d(0x3d2)]=0x4,data[_0x33513d(0x314)][_0x33513d(0x46c)]=0x4,data[_0x33513d(0x314)][_0x33513d(0x2a8)]=0x4,data[_0x33513d(0x314)][_0x33513d(0x439)]=0x5,data[_0x33513d(0x314)][_0x33513d(0x335)]='A',data[_0x33513d(0x314)][_0x33513d(0x2b2)]=0.8,data[_0x33513d(0x314)][_0x33513d(0x221)]=_0x33513d(0x352),await saveData(),openSettings(),toast(_0x33513d(0x49a));}async function saveSettings(){const _0x41abe3=_0x58e2db,_0x20b5b6=data['settings'];_0x20b5b6['apiKey']=$(_0x41abe3(0x3d6))['value'][_0x41abe3(0x22a)]();const _0x5226fa=_0x20b5b6[_0x41abe3(0x3ec)];if(editingPreset==='A')_0x5226fa['A_work']=clampInt($(_0x41abe3(0x344))[_0x41abe3(0x2e8)],0x1,0x3e7),_0x5226fa[_0x41abe3(0x4ab)]=clampInt($(_0x41abe3(0x315))['value'],0x0,0x3e7),_0x5226fa[_0x41abe3(0x4be)]=clampInt($(_0x41abe3(0x1d5))[_0x41abe3(0x2e8)],0x1,0x3e7),_0x5226fa[_0x41abe3(0x37f)]=clampInt($('#set_long')[_0x41abe3(0x2e8)],0x1,0x3e7),_0x20b5b6[_0x41abe3(0x3f7)]=clampInt($(_0x41abe3(0x1f9))[_0x41abe3(0x2e8)],0x1,0xc),_0x20b5b6[_0x41abe3(0x3d2)]=clampInt($(_0x41abe3(0x1f7))['value'],0x2,0xc);else{if(editingPreset==='B')_0x5226fa['B_work']=clampInt($('#set_work')[_0x41abe3(0x2e8)],0x1,0x3e7),_0x5226fa[_0x41abe3(0x386)]=clampInt($('#set_winddown')[_0x41abe3(0x2e8)],0x0,0x3e7),_0x5226fa['B_short']=clampInt($('#set_short')[_0x41abe3(0x2e8)],0x1,0x3e7),_0x5226fa[_0x41abe3(0x3fd)]=clampInt($('#set_long')[_0x41abe3(0x2e8)],0x1,0x3e7),_0x20b5b6['cyclesB']=clampInt($(_0x41abe3(0x1f9))[_0x41abe3(0x2e8)],0x1,0xc),_0x20b5b6['longBreakIntervalB']=clampInt($(_0x41abe3(0x1f7))['value'],0x2,0xc);else{if(editingPreset==='C'){const _0x453009=$(_0x41abe3(0x487));if(_0x453009)_0x20b5b6[_0x41abe3(0x439)]=clampInt(_0x453009['value'],0x1,0x14);}}}_0x20b5b6[_0x41abe3(0x2b2)]=clampFloat($(_0x41abe3(0x411))[_0x41abe3(0x2e8)],0x0,0x1,0.8),_0x20b5b6[_0x41abe3(0x221)]=$('#set_theme')[_0x41abe3(0x2e8)]===_0x41abe3(0x1f1)?_0x41abe3(0x1f1):_0x41abe3(0x352),_0x20b5b6['theme']=$(_0x41abe3(0x1dd))[_0x41abe3(0x2e8)],_0x20b5b6[_0x41abe3(0x319)]=parseFloat($(_0x41abe3(0x4cf))[_0x41abe3(0x2e8)])||0.85;$(_0x41abe3(0x4f3))&&(_0x20b5b6[_0x41abe3(0x367)]=$('#set_backgroundMode')[_0x41abe3(0x2e8)]);_0x20b5b6[_0x41abe3(0x438)]=!!($(_0x41abe3(0x220))&&$(_0x41abe3(0x220))[_0x41abe3(0x1fa)]),_0x20b5b6['enableWinddown']=!!($(_0x41abe3(0x3ae))&&$('#set_enableWinddown')['checked']),_0x20b5b6[_0x41abe3(0x408)]=!!($('#set_enableSessionNotes')&&$('#set_enableSessionNotes')[_0x41abe3(0x1fa)]);$(_0x41abe3(0x447))&&(_0x20b5b6[_0x41abe3(0x1ec)]=clampInt($('#set_backupDays')[_0x41abe3(0x2e8)],0x1,0x1e));_0x20b5b6[_0x41abe3(0x1f6)]===_0x41abe3(0x4c0)||_0x20b5b6[_0x41abe3(0x1f6)]===_0x41abe3(0x3c1)?(_0x20b5b6[_0x41abe3(0x43a)]=![],typeof _0x20b5b6[_0x41abe3(0x251)]===_0x41abe3(0x224)&&_0x20b5b6[_0x41abe3(0x251)]['includes'](_0x41abe3(0x44f))&&(_0x20b5b6['customBg']='')):_0x20b5b6['useYtThumbnailAsBg']=!![];const _0x1c0c00=$('#set_youtubeUrl')[_0x41abe3(0x2e8)][_0x41abe3(0x22a)]();_0x20b5b6[_0x41abe3(0x43a)]=$(_0x41abe3(0x43c))[_0x41abe3(0x1fa)],_0x20b5b6[_0x41abe3(0x45d)]=parseInt($(_0x41abe3(0x4f5))[_0x41abe3(0x2e8)],0xa),sessionYoutubeUrl=_0x1c0c00;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x41abe3(0x334)](_0x20b5b6[_0x41abe3(0x45d)]);}else try{fallbackPostMessage(_0x41abe3(0x334),[_0x20b5b6[_0x41abe3(0x45d)]]);}catch(_0xe0b2a){}}catch(_0x38e67e){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x41abe3(0x2a1)](_0x20b5b6[_0x41abe3(0x335)],{'silent':!![]}),closeSettings(),toast(_0x41abe3(0x457));}function clampInt(_0x18ced8,_0x45c2da,_0x5071be){const _0x4dddad=_0x58e2db;_0x18ced8=parseInt(_0x18ced8||0x0,0xa);if(isNaN(_0x18ced8))_0x18ced8=_0x45c2da;return Math[_0x4dddad(0x23d)](_0x45c2da,Math['min'](_0x5071be,_0x18ced8));}function clampFloat(_0x1f5d69,_0x58026a,_0x5ac5d0,_0x386448){const _0x19c637=_0x58e2db;_0x1f5d69=parseFloat(_0x1f5d69);if(Number[_0x19c637(0x455)](_0x1f5d69))_0x1f5d69=_0x386448;return Math[_0x19c637(0x23d)](_0x58026a,Math[_0x19c637(0x3d8)](_0x5ac5d0,_0x1f5d69));}const dbPromise=new Promise((_0x50bde1,_0x1cd557)=>{const _0x596282=_0x58e2db,_0x35fc57=indexedDB[_0x596282(0x458)](_0x596282(0x27e),0x1);_0x35fc57[_0x596282(0x282)]=_0x17ae97=>_0x17ae97[_0x596282(0x2aa)]['result'][_0x596282(0x1fd)](_0x596282(0x4aa)),_0x35fc57[_0x596282(0x479)]=_0x44bad3=>_0x50bde1(_0x44bad3['target'][_0x596282(0x31e)]),_0x35fc57[_0x596282(0x48a)]=_0x2d591e=>_0x1cd557(_0x2d591e);}),fileCache={};function handleFileUpload(_0x17aa3f,_0x38d4fe){const _0x4fe160=_0x58e2db;if(!_0x17aa3f)return;dbPromise[_0x4fe160(0x25b)](_0x1a74af=>{const _0x408963=_0x4fe160,_0x11f8e3=uid(_0x408963(0x2b4)),_0x17f793=_0x1a74af[_0x408963(0x250)]('files',_0x408963(0x2ae));_0x17f793[_0x408963(0x35b)]('files')['put'](_0x17aa3f,_0x11f8e3),_0x17f793[_0x408963(0x4ca)]=()=>_0x38d4fe(_0x11f8e3),_0x17f793[_0x408963(0x48a)]=()=>toast(_0x408963(0x3bd));});}function getStoredFileUrl(_0x297408){const _0x4d5b07=_0x58e2db;if(!_0x297408)return Promise[_0x4d5b07(0x306)]('');if(fileCache[_0x297408])return Promise[_0x4d5b07(0x306)](fileCache[_0x297408]);return dbPromise[_0x4d5b07(0x25b)](_0x40c842=>new Promise(_0x2bc062=>{const _0x870438=_0x4d5b07,_0x1a2223=_0x40c842[_0x870438(0x250)](_0x870438(0x4aa),_0x870438(0x228)),_0x265b4c=_0x1a2223[_0x870438(0x35b)]('files')[_0x870438(0x35c)](_0x297408);_0x265b4c[_0x870438(0x479)]=_0x521258=>{const _0x47cbd8=_0x870438,_0x1e25c2=_0x521258['target'][_0x47cbd8(0x31e)];if(_0x1e25c2){const _0x2e7782=URL[_0x47cbd8(0x496)](_0x1e25c2);fileCache[_0x297408]=_0x2e7782,_0x2bc062(_0x2e7782);}else _0x2bc062('');},_0x265b4c[_0x870438(0x48a)]=()=>_0x2bc062('');}));}function applyCustomBg(){const _0x309fcb=_0x58e2db,_0x23f2e4=data[_0x309fcb(0x314)],_0x1b1c16=_0x23f2e4[_0x309fcb(0x251)],_0x4f0a31=_0x23f2e4[_0x309fcb(0x1f6)],_0x18126c=[_0x309fcb(0x3f0),_0x309fcb(0x4b3)][_0x309fcb(0x2ea)](_0x4f0a31),_0x437c08=_0x4f0a31==='light'||_0x4f0a31===_0x309fcb(0x3c1),_0x2cf4f9=_0x23f2e4[_0x309fcb(0x367)]||'cover';document[_0x309fcb(0x2a4)][_0x309fcb(0x22c)][_0x309fcb(0x353)]=_0x2cf4f9,document[_0x309fcb(0x2a4)][_0x309fcb(0x22c)][_0x309fcb(0x428)]=_0x2cf4f9===_0x309fcb(0x432)?_0x309fcb(0x4a6):'no-repeat';const _0x14dfc7=()=>{const _0x345eaf=_0x309fcb;try{document[_0x345eaf(0x2a4)][_0x345eaf(0x22c)][_0x345eaf(0x239)]='';}catch(_0x11882c){}};if(_0x1b1c16){const _0x2f7280=_0x1b1c16[_0x309fcb(0x498)](_0x309fcb(0x21a))||_0x1b1c16[_0x309fcb(0x498)]('http')||_0x1b1c16[_0x309fcb(0x498)](_0x309fcb(0x36e))?Promise['resolve'](_0x1b1c16):getStoredFileUrl(_0x1b1c16);_0x2f7280['then'](_0x1c79b0=>{const _0x13d4c2=_0x309fcb;_0x1c79b0?document[_0x13d4c2(0x2a4)][_0x13d4c2(0x22c)][_0x13d4c2(0x1fe)](_0x13d4c2(0x218),_0x13d4c2(0x4a0)+_0x1c79b0+')'):document['body']['style']['setProperty'](_0x13d4c2(0x218),_0x437c08?_0x13d4c2(0x459):''),_0x14dfc7();});}else!_0x18126c?_0x437c08?(document[_0x309fcb(0x2a4)][_0x309fcb(0x22c)][_0x309fcb(0x1fe)](_0x309fcb(0x218),_0x309fcb(0x459)),_0x14dfc7()):document[_0x309fcb(0x2a4)][_0x309fcb(0x22c)]['setProperty']('--bg-image',_0x309fcb(0x3c5)):(document[_0x309fcb(0x2a4)][_0x309fcb(0x22c)][_0x309fcb(0x2ce)](_0x309fcb(0x218)),_0x14dfc7());}function applyPanelOpacity(){const _0x352f90=_0x58e2db;document[_0x352f90(0x337)]['style'][_0x352f90(0x1fe)](_0x352f90(0x322),data[_0x352f90(0x314)][_0x352f90(0x319)]);}function renderDashboard(){const _0x1c847=_0x58e2db,_0x4ce14f=data[_0x1c847(0x48f)]['flatMap'](_0x2cfbc8=>_0x2cfbc8['subtopics'][_0x1c847(0x3ea)](_0x34511a=>({'topic':_0x2cfbc8[_0x1c847(0x4fb)],'subtopic':_0x34511a['name'],'m':_0x34511a[_0x1c847(0x20b)][_0x1c847(0x3ee)]||0x0,'c':_0x34511a[_0x1c847(0x20b)][_0x1c847(0x3e9)]||0x0,'t':_0x34511a['stats'][_0x1c847(0x308)]||0x0}))),_0x3da4a6=_0x4ce14f[_0x1c847(0x36b)]((_0x3d9435,_0x17a33f)=>_0x3d9435+_0x17a33f['m'],0x0),_0x1680da=_0x4ce14f[_0x1c847(0x36b)]((_0x4a28ba,_0x4b306f)=>_0x4a28ba+_0x4b306f['c'],0x0),_0x99ec48=_0x4ce14f[_0x1c847(0x36b)]((_0x26a44b,_0x21bfe3)=>_0x26a44b+_0x21bfe3['t'],0x0);let _0x18f3c1=_0x1c847(0x3bf)+formatDaysHoursMinutes(_0x3da4a6)+'\x20|\x20<strong>Total\x20sessions:</strong>\x20'+_0x1680da+'\x20|\x20<strong>Total\x20tasks:</strong>\x20'+_0x99ec48+_0x1c847(0x240);_0x4ce14f['forEach'](_0x4d2e94=>{const _0x3c8e1c=_0x1c847;_0x18f3c1+='<tr><td>'+escapeHTML(_0x4d2e94[_0x3c8e1c(0x39a)])+_0x3c8e1c(0x2ba)+escapeHTML(_0x4d2e94['subtopic'])+_0x3c8e1c(0x2ba)+formatDaysHoursMinutes(_0x4d2e94['m'])+_0x3c8e1c(0x2ba)+_0x4d2e94['c']+'</td><td>'+_0x4d2e94['t']+_0x3c8e1c(0x429);}),_0x18f3c1+=_0x1c847(0x2c9);const _0x81aced=$('#dashboardContent');if(_0x81aced)_0x81aced[_0x1c847(0x373)]=_0x18f3c1;}function getMilestones(){const _0xa29983=_0x58e2db;return[{'hours':0x5,'title':_0xa29983(0x31f),'message':_0xa29983(0x2f0)},{'hours':0x14,'title':'To\x20You,\x2020\x20Hours\x20(Foundation)','message':_0xa29983(0x263)},{'hours':0x32,'title':'To\x20You,\x2050\x20Hours\x20(Momentum)','message':'50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You’re\x20on\x20the\x20right\x20path—keep\x20going.'},{'hours':0x64,'title':'To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','message':_0xa29983(0x26b)},{'hours':0xfa,'title':_0xa29983(0x3f4),'message':'250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You’ve\x20met\x20hard\x20days\x20and\x20distractions—and\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.'},{'hours':0x1f4,'title':_0xa29983(0x4a4),'message':_0xa29983(0x262)},{'hours':0x3e8,'title':_0xa29983(0x1ee),'message':_0xa29983(0x283)},{'hours':0x1388,'title':_0xa29983(0x28c),'message':'5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‘How\x20do\x20I\x20focus?’\x20to\x20‘What\x20value\x20will\x20this\x20focus\x20create?’.\x20You’re\x20not\x20just\x20working—you’re\x20building\x20a\x20legacy.'}][_0xa29983(0x4ac)]((_0x312fc4,_0x11a7b4)=>_0x11a7b4[_0xa29983(0x2b1)]-_0x312fc4[_0xa29983(0x2b1)]);}async function checkAndShowMilestones(){const _0x115fee=_0x58e2db;if(!data||!data[_0x115fee(0x314)])return;if(!Array[_0x115fee(0x316)](data[_0x115fee(0x314)][_0x115fee(0x21c)]))data[_0x115fee(0x314)]['achievedMilestones']=[];const _0x100dd1=data[_0x115fee(0x48f)][_0x115fee(0x36b)]((_0x2f6466,_0x175eb7)=>{const _0x46702a=_0x115fee;return _0x2f6466+_0x175eb7[_0x46702a(0x4b5)]['reduce']((_0x4b379c,_0x4a4e0a)=>{const _0x135859=_0x46702a;return _0x4b379c+(_0x4a4e0a[_0x135859(0x20b)][_0x135859(0x3ee)]||0x0);},0x0);},0x0),_0x29ae26=_0x100dd1/0x3c,_0xc84417=getMilestones(),_0x130844=Array[_0x115fee(0x316)](data['settings']['achievedMilestones'])?data[_0x115fee(0x314)][_0x115fee(0x21c)]:[],_0xda2974=_0xc84417['filter'](_0x51f03a=>_0x29ae26>=_0x51f03a['hours']&&!_0x130844[_0x115fee(0x2ea)](_0x51f03a[_0x115fee(0x2b1)]));if(_0xda2974['length']===0x0)return![];const _0x185da2=_0xda2974[_0x115fee(0x36b)]((_0x2865ee,_0x322b73)=>_0x2865ee&&_0x2865ee[_0x115fee(0x2b1)]>_0x322b73['hours']?_0x2865ee:_0x322b73,null);if(!_0x185da2)return![];$(_0x115fee(0x26c))['textContent']=_0x185da2[_0x115fee(0x3cb)],$(_0x115fee(0x3d9))['textContent']=_0x185da2['message'],$('#modalMilestone')[_0x115fee(0x2e9)][_0x115fee(0x325)]('show');try{trapFocus($(_0x115fee(0x2a5)));}catch(_0x44a740){}return data['settings'][_0x115fee(0x21c)][_0x115fee(0x4a7)](_0x185da2['hours']),await saveData(),!![];}async function seedAchievedMilestones(){const _0x508919=_0x58e2db;if(!data||!data['settings'])return;!Array[_0x508919(0x316)](data[_0x508919(0x314)][_0x508919(0x21c)])&&(data[_0x508919(0x314)][_0x508919(0x21c)]=[],await saveData());}async function handleSendMessage(){const _0x26e447=_0x58e2db,_0x5ddcdb=$('#btnSendMessage'),_0x51cb6e=$(_0x26e447(0x1e4)),_0xfa5fca=_0x51cb6e[_0x26e447(0x2e8)][_0x26e447(0x22a)](),_0x25a44d=getCurrentSubtopic();if(!_0xfa5fca)return;if(!_0x25a44d){toast(t(_0x26e447(0x1f3)));return;}_0x51cb6e[_0x26e447(0x2e8)]='',_0x5ddcdb[_0x26e447(0x3fb)]=!![],_0x5ddcdb['innerHTML']='<div\x20class=\x22spinner\x22></div>',_0x25a44d[_0x26e447(0x2dd)]['push']({'role':_0x26e447(0x3a8),'text':_0xfa5fca}),renderChat();const _0x4d3183=await callGeminiAPI(_0xfa5fca);_0x4d3183&&(_0x25a44d['chatHistory'][_0x26e447(0x4a7)]({'role':_0x26e447(0x346),'text':_0x4d3183}),await saveData(),renderChat()),_0x5ddcdb[_0x26e447(0x3fb)]=![],_0x5ddcdb[_0x26e447(0x373)]='Send';}function renderChat(){const _0x2761cb=_0x58e2db,_0x47b21c=getCurrentSubtopic(),_0x5bc684=$(_0x2761cb(0x481)),_0x209864=$(_0x2761cb(0x1e4)),_0xd8a863=$(_0x2761cb(0x238));if(!_0x5bc684||!_0x209864||!_0xd8a863)return;if(!_0x47b21c){_0x5bc684['innerHTML']=_0x2761cb(0x3e4),_0x209864[_0x2761cb(0x3fb)]=!![],_0xd8a863[_0x2761cb(0x3fb)]=!![];return;}_0x209864[_0x2761cb(0x3fb)]=![],_0xd8a863['disabled']=![],_0x5bc684[_0x2761cb(0x373)]='';if(!_0x47b21c['chatHistory']||_0x47b21c[_0x2761cb(0x2dd)][_0x2761cb(0x326)]===0x0){_0x5bc684[_0x2761cb(0x373)]=_0x2761cb(0x3c6);return;}_0x47b21c[_0x2761cb(0x2dd)][_0x2761cb(0x345)](_0x34c176=>{const _0x24545d=_0x2761cb,_0xc0c57f=document[_0x24545d(0x383)]('div');_0xc0c57f[_0x24545d(0x2b8)]=_0x24545d(0x3e7)+_0x34c176[_0x24545d(0x1d8)],_0xc0c57f[_0x24545d(0x351)]=_0x34c176[_0x24545d(0x46d)],_0x5bc684[_0x24545d(0x4cb)](_0xc0c57f);}),_0x5bc684['scrollTop']=_0x5bc684[_0x2761cb(0x24c)];}async function handleSummarizeNote(){const _0x1da9c3=_0x58e2db,_0x363fa4=$(_0x1da9c3(0x42d)),_0x25fed1=$('#noteText'),_0x22b823=_0x25fed1[_0x1da9c3(0x2e8)]['trim'](),_0x2cbf36=getCurrentSubtopic();if(!_0x22b823){toast('Please\x20enter\x20a\x20note\x20before\x20summarizing.');return;}const _0x1a667c=_0x363fa4[_0x1da9c3(0x373)];_0x363fa4[_0x1da9c3(0x373)]=_0x1da9c3(0x409),_0x363fa4['disabled']=!![];const _0x16c0b9=_0x1da9c3(0x2b7)+(_0x2cbf36?.[_0x1da9c3(0x4fb)]||'unknown')+'\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22'+_0x22b823+'\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**✨\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**🚀\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]',_0x2d7483=await callGeminiAPI(_0x16c0b9);_0x2d7483&&(_0x25fed1[_0x1da9c3(0x2e8)]+='\x0a\x0a'+_0x2d7483),_0x363fa4[_0x1da9c3(0x373)]=_0x1a667c,_0x363fa4[_0x1da9c3(0x3fb)]=![];}function clearChat(){const _0xc70c17=_0x58e2db,_0x2e7bf2=getCurrentSubtopic();if(!_0x2e7bf2){toast(t(_0xc70c17(0x1f3)));return;}showConfirmModal('Confirm\x20Deletion',_0xc70c17(0x424),async _0x445c30=>{const _0x182c9d=_0xc70c17;_0x445c30&&(_0x2e7bf2[_0x182c9d(0x2dd)]=[],await saveData(),renderChat(),toast(_0x182c9d(0x213)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0xc0bd62,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x34825f=_0x58e2db,_0x2d47e0=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0xc0bd62,'enablejsapi':'1','origin':'https://www.youtube.com'})[_0x34825f(0x2ab)]();return'https://www.youtube.com/embed/'+_0xc0bd62+'?'+_0x2d47e0;}function ensureFallbackFrame(){const _0x1f00a0=_0x58e2db,_0x2391ea=document['getElementById']('youtube-player-container');if(!_0x2391ea)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x1f00a0(0x420)])return ytFallbackFrame;const _0x52d995=document[_0x1f00a0(0x383)]('iframe');return _0x52d995['id']=_0x1f00a0(0x372),_0x52d995[_0x1f00a0(0x467)]='1',_0x52d995[_0x1f00a0(0x434)]='1',_0x52d995['style']['position']=_0x1f00a0(0x264),_0x52d995['style'][_0x1f00a0(0x2e3)]=_0x1f00a0(0x28b),_0x52d995[_0x1f00a0(0x22c)][_0x1f00a0(0x500)]='-9999px',_0x52d995[_0x1f00a0(0x1d6)]=_0x1f00a0(0x388),_0x2391ea['innerHTML']='',_0x2391ea['appendChild'](_0x52d995),ytFallbackFrame=_0x52d995,_0x52d995;}function fallbackLoadVideo(_0x3839a3,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x4280fb=_0x58e2db,_0x43da36=document[_0x4280fb(0x4bc)](_0x4280fb(0x460));if(!_0x43da36)return;_0x43da36[_0x4280fb(0x373)]='';const _0x22ff0a=document[_0x4280fb(0x383)](_0x4280fb(0x27f));_0x22ff0a['id']='yt-fallback',_0x22ff0a[_0x4280fb(0x467)]='1',_0x22ff0a[_0x4280fb(0x434)]='1',_0x22ff0a[_0x4280fb(0x22c)][_0x4280fb(0x47f)]=_0x4280fb(0x264),_0x22ff0a['style'][_0x4280fb(0x2e3)]=_0x4280fb(0x28b),_0x22ff0a[_0x4280fb(0x22c)]['left']=_0x4280fb(0x28b),_0x22ff0a[_0x4280fb(0x1d6)]=_0x4280fb(0x388),_0x22ff0a['src']=buildFallbackSrc(_0x3839a3,{'autoplay':autoplay,'mute':mute}),_0x43da36[_0x4280fb(0x4cb)](_0x22ff0a),ytFallbackFrame=_0x22ff0a,ytFallbackIsPlaying=!!autoplay;try{const _0x319ac4=document[_0x4280fb(0x4bc)](_0x4280fb(0x3fc));if(_0x319ac4)_0x319ac4[_0x4280fb(0x351)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x3a5e3b){}}function fallbackPostMessage(_0x78dca8,_0x4c02e0=[]){const _0x392e74=_0x58e2db;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x392e74(0x348)])return;ytFallbackFrame[_0x392e74(0x348)][_0x392e74(0x47b)](JSON[_0x392e74(0x440)]({'event':_0x392e74(0x2a2),'func':_0x78dca8,'args':_0x4c02e0}),'https://www.youtube.com');}catch(_0x5c1b9d){}}function fallbackPlay(){const _0xcb1541=_0x58e2db;fallbackPostMessage(_0xcb1541(0x247));}function fallbackStop(){const _0x2b72ee=_0x58e2db;try{ytFallbackFrame&&(ytFallbackFrame[_0x2b72ee(0x4fc)]=_0x2b72ee(0x461),ytFallbackIsPlaying=![]);}catch(_0x161715){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0xfbbb31=_0x58e2db;fallbackPostMessage(_0xfbbb31(0x24f));}function fallbackMute(){const _0x1930cb=_0x58e2db;fallbackPostMessage(_0x1930cb(0x299));}window['onYouTubeIframeAPIReady']=function(){const _0x1d1aa3=_0x58e2db;if(IS_FILE_PROTOCOL){try{window['__ytApiWatchdog']&&window[_0x1d1aa3(0x448)][_0x1d1aa3(0x418)]();}catch(_0x29cee4){}return;}const _0x4c8804={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x1d1aa3(0x419)};(window[_0x1d1aa3(0x39d)][_0x1d1aa3(0x4ef)]===_0x1d1aa3(0x46a)||window[_0x1d1aa3(0x39d)][_0x1d1aa3(0x4ef)]===_0x1d1aa3(0x3e0))&&(_0x4c8804[_0x1d1aa3(0x3a0)]=window[_0x1d1aa3(0x39d)]['origin']);ytPlayer=new YT[(_0x1d1aa3(0x3c7))](_0x1d1aa3(0x460),_0x4c8804);try{window['__ytApiWatchdog']&&window['__ytApiWatchdog'][_0x1d1aa3(0x418)]();const _0x5ceac1=document[_0x1d1aa3(0x4bc)]('ytUrlFeedback');_0x5ceac1&&(_0x5ceac1[_0x1d1aa3(0x351)]='');}catch(_0xe2394a){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage[_0x58e2db(0x307)](_0x58e2db(0x4b4))==='1';}catch(_0x39a17a){}function showSoundPermission(){const _0x4e142c=_0x58e2db,_0x5c4ea8=document[_0x4e142c(0x4bc)](_0x4e142c(0x292));if(!_0x5c4ea8)return;if(_ytUnlocked){_0x5c4ea8[_0x4e142c(0x2e9)][_0x4e142c(0x41a)](_0x4e142c(0x40d));return;}_0x5c4ea8[_0x4e142c(0x2e9)][_0x4e142c(0x325)]('show');}function hideSoundPermission(){const _0x6ae6ca=_0x58e2db,_0x31615c=document['getElementById'](_0x6ae6ca(0x292));if(!_0x31615c)return;_0x31615c[_0x6ae6ca(0x2e9)][_0x6ae6ca(0x41a)](_0x6ae6ca(0x40d));}function unlockAudioChain(){const _0x5dcb65=_0x58e2db;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x5dcb65(0x395)]===_0x5dcb65(0x321))AUDIO_CTX[_0x5dcb65(0x395)]();}catch(_0x1e93bb){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x5dcb65(0x24f)]&&(ytPlayer['unMute'](),ytPlayer[_0x5dcb65(0x247)]());}catch(_0x14f93e){}_ytUnlocked=!![];try{localStorage[_0x5dcb65(0x4eb)]('sound_unlocked','1');}catch(_0x5ab249){}hideSoundPermission(),toast(_0x5dcb65(0x298));}function onPlayerReady(_0x292d08){const _0x1f5966=_0x58e2db;try{const _0x47f42c=ytPlayer&&ytPlayer['getIframe']?ytPlayer[_0x1f5966(0x2d0)]():null;_0x47f42c&&_0x47f42c[_0x1f5966(0x2af)](_0x1f5966(0x1d6),_0x1f5966(0x388));}catch(_0x46bb56){}try{if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x1f5966(0x334)](data&&data[_0x1f5966(0x314)]&&data['settings'][_0x1f5966(0x45d)]||0x50);}catch(_0x4c6426){}try{const _0x205a57=getActiveVideoId&&getActiveVideoId();if(_0x205a57&&ytPlayer&&ytPlayer['mute']&&ytPlayer[_0x1f5966(0x247)]){ytPlayer[_0x1f5966(0x299)](),ytPlayer[_0x1f5966(0x247)](),_ytPrimed=!![];const _0x36e391=()=>{const _0x3ad856=_0x1f5966;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x5377d0){}window['removeEventListener'](_0x3ad856(0x365),_0x36e391,!![]),window[_0x3ad856(0x2b6)](_0x3ad856(0x279),_0x36e391,!![]);};window[_0x1f5966(0x379)](_0x1f5966(0x365),_0x36e391,!![]),window[_0x1f5966(0x379)](_0x1f5966(0x279),_0x36e391,!![]),showSoundPermission();}}catch(_0x513af5){}updateYouTubePlayer();}function onPlayerStateChange(_0x34988a){const _0x349035=_0x58e2db,_0x1f9439=$(_0x349035(0x47e));_0x34988a[_0x349035(0x3c0)]==YT[_0x349035(0x497)][_0x349035(0x35d)]?(_0x1f9439[_0x349035(0x351)]='⏸️',hideSoundPermission()):_0x1f9439[_0x349035(0x351)]='▶';if(_0x34988a[_0x349035(0x3c0)]===YT[_0x349035(0x497)][_0x349035(0x416)]){if(!ytUserPaused)ytPlayer[_0x349035(0x247)]();}}async function ytFadeTo(_0x19af30,_0x3528c0=0xfa){const _0x236fa6=_0x58e2db;try{if(!ytPlayer||!ytPlayer['getVolume']||!ytPlayer[_0x236fa6(0x334)])return;ytPlayer['unMute']();const _0x1aba99=ytPlayer['getVolume'](),_0xc8224a=_0x19af30-_0x1aba99;if(Math[_0x236fa6(0x232)](_0xc8224a)<0x1||_0x3528c0<=0x0){ytPlayer[_0x236fa6(0x334)](_0x19af30);return;}const _0x27753a=performance['now']();await new Promise(_0x4d82d3=>{const _0x56f3ee=_0xba5838=>{const _0x295c04=_0x5eb1,_0x2833dc=Math[_0x295c04(0x3d8)](0x1,(_0xba5838-_0x27753a)/_0x3528c0),_0x430793=Math['round'](_0x1aba99+_0xc8224a*_0x2833dc);ytPlayer[_0x295c04(0x334)](_0x430793);if(_0x2833dc<0x1)requestAnimationFrame(_0x56f3ee);else _0x4d82d3();};requestAnimationFrame(_0x56f3ee);});}catch(_0x1bbf48){}}async function ytFadeInPlay(_0x53c319=0xdc){const _0x4f6545=_0x58e2db;try{const _0x105091=Math['max'](0x0,Math['min'](0x64,data&&data[_0x4f6545(0x314)]&&data[_0x4f6545(0x314)][_0x4f6545(0x45d)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer[_0x4f6545(0x24f)](),ytPlayer['playVideo']();try{ytPlayer[_0x4f6545(0x334)](0x0);}catch(_0x297cda){}await ytFadeTo(_0x105091,_0x53c319);}else{const _0x301c24=getActiveVideoId();_0x301c24&&fallbackLoadVideo(_0x301c24,{'autoplay':0x1,'mute':0x0});}}catch(_0x18502c){}}async function ytFadeOutPause(_0x56ec39=0xb4){const _0x5c7a88=_0x58e2db;try{const _0x22a6d5=Math['max'](0x0,Math['min'](0x64,data&&data[_0x5c7a88(0x314)]&&data[_0x5c7a88(0x314)]['youtubeVolume']||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x56ec39);try{ytPlayer[_0x5c7a88(0x201)](),ytPlayer['setVolume'](_0x22a6d5);}catch(_0x4a368c){}}else try{fallbackPause();}catch(_0x154b44){}}catch(_0x43719b){}}async function updateYouTubePlayer(){const _0x544ba0=_0x58e2db,_0x19a92e=getActiveVideoId();if(data[_0x544ba0(0x314)][_0x544ba0(0x43a)]&&_0x19a92e){const _0x3d1eee=_0x544ba0(0x3b8)+_0x19a92e+_0x544ba0(0x1ed),_0x489591=new Image();_0x489591[_0x544ba0(0x410)]=async()=>{const _0x43f510=_0x544ba0;data[_0x43f510(0x314)][_0x43f510(0x251)]=_0x3d1eee,await saveData(),applyCustomBg();},_0x489591['onerror']=async()=>{const _0x2afecc=_0x544ba0,_0x48b983=_0x2afecc(0x3b8)+_0x19a92e+'/hqdefault.jpg';data[_0x2afecc(0x314)]['customBg']=_0x48b983,await saveData(),applyCustomBg();},_0x489591[_0x544ba0(0x4fc)]=_0x3d1eee;}else!_0x19a92e&&(data['settings'][_0x544ba0(0x251)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x19a92e){fallbackStop(),hideSoundPermission();return;}const _0x5d421=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x19a92e,{'autoplay':0x1,'mute':_0x5d421});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0x544ba0(0x22f)]){try{ensureYouTubeAPI();}catch(_0x32986a){}return;}if(!_0x19a92e){if(ytPlayer[_0x544ba0(0x258)])ytPlayer[_0x544ba0(0x258)]();hideSoundPermission();return;}ytPlayer[_0x544ba0(0x22f)](_0x19a92e),ytPlayer['setVolume'](data[_0x544ba0(0x314)][_0x544ba0(0x45d)]);}function toggleYtSound(){const _0xd3b374=_0x58e2db;if(!_ytUnlocked){try{ensureAudio();}catch(_0x1eb99d){}try{unlockAudioChain();}catch(_0x53e88b){}return;}if(IS_FILE_PROTOCOL){const _0x15dc25=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0xd3b374(0x420)]){if(!_0x15dc25){toast(_0xd3b374(0x3dd));return;}fallbackLoadVideo(_0x15dc25,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0xadb34d=document[_0xd3b374(0x4bc)](_0xd3b374(0x3fc));if(_0xadb34d)_0xadb34d[_0xd3b374(0x351)]='⏸️';}catch(_0x4d559e){}toast(_0xd3b374(0x3be));return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0xd3b374(0x201)),ytFallbackIsPlaying=![],toast(_0xd3b374(0x341));else{if(!_0x15dc25){toast(_0xd3b374(0x3dd));return;}fallbackPostMessage('playVideo'),ytFallbackIsPlaying=!![],toast(_0xd3b374(0x3be));}try{const _0x5a80b2=document[_0xd3b374(0x4bc)](_0xd3b374(0x3fc));if(_0x5a80b2)_0x5a80b2[_0xd3b374(0x351)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x2b7fba){}return;}if(!ytPlayer||typeof ytPlayer[_0xd3b374(0x289)]!==_0xd3b374(0x321)){try{ensureYouTubeAPI();}catch(_0x7a744f){}return;}const _0x4addfe=ytPlayer[_0xd3b374(0x289)]();_0x4addfe===YT['PlayerState']['PLAYING']||_0x4addfe===YT[_0xd3b374(0x497)]['BUFFERING']?(ytFadeOutPause(),ytUserPaused=!![],toast(_0xd3b374(0x341))):(ytFadeInPlay(),ytUserPaused=![],toast(_0xd3b374(0x3be)));}function bindEvents(){const _0x3918b3=_0x58e2db;try{const _0x335b0e=document[_0x3918b3(0x276)](_0x3918b3(0x2d9));_0x335b0e&&(_0x335b0e['innerHTML']=_0x3918b3(0x3a1));}catch(_0x392b47){}on($(_0x3918b3(0x499)),'click',toggleBackgroundView),on($(_0x3918b3(0x1fb)),_0x3918b3(0x38d),()=>{const _0x9af903=_0x3918b3;$(_0x9af903(0x2a5))[_0x9af903(0x2e9)][_0x9af903(0x41a)](_0x9af903(0x40d));try{releaseFocus();}catch(_0xce703e){}}),on($('#btnAddTopic'),_0x3918b3(0x38d),()=>showInputModal(_0x3918b3(0x4b9),async _0x522859=>{const _0x1c2775=_0x3918b3;if(!_0x522859)return;data[_0x1c2775(0x48f)][_0x1c2775(0x4a7)]({'id':uid('t'),'name':_0x522859,'subtopics':[]}),await saveData(),renderTopics();})),on($(_0x3918b3(0x2cd)),'click',()=>storageManager[_0x3918b3(0x27d)](data)),on($(_0x3918b3(0x33d)),'change',_0x24420c=>{const _0x561cbc=_0x3918b3,_0x58aa70=_0x24420c[_0x561cbc(0x2aa)][_0x561cbc(0x4aa)][0x0];if(!_0x58aa70)return;storageManager[_0x561cbc(0x323)](_0x58aa70)['then'](async _0x22bb02=>{const _0x9757c6=_0x561cbc;data=_0x22bb02,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x9757c6(0x4df)),renderAll();})[_0x561cbc(0x2f4)](_0x20fadb=>toast(_0x561cbc(0x2b9)+_0x20fadb[_0x561cbc(0x3d4)])),_0x24420c['target'][_0x561cbc(0x2e8)]=null;}),on($(_0x3918b3(0x23c)),_0x3918b3(0x38d),()=>{const _0x14bd5a=_0x3918b3,_0x45b190=$('#backupList'),_0x2e9083=_0x45b190?_0x45b190[_0x14bd5a(0x2e8)]:'';if(!_0x2e9083){toast('Please\x20select\x20a\x20backup.');return;}showConfirmModal(_0x14bd5a(0x478),_0x14bd5a(0x2e1)+new Date(_0x2e9083)[_0x14bd5a(0x25c)]()+_0x14bd5a(0x3a3),_0x50d1e3=>{const _0x3e591c=_0x14bd5a;_0x50d1e3&&storageManager[_0x3e591c(0x40c)](_0x2e9083)[_0x3e591c(0x25b)](_0xad7f1c=>{const _0x5e67eb=_0x3e591c;data=_0xad7f1c,toast(_0x5e67eb(0x296)),setTimeout(()=>window[_0x5e67eb(0x39d)][_0x5e67eb(0x3c9)](),0x5dc);})['catch'](_0x59fb09=>{const _0x3ff72d=_0x3e591c;toast('Error:\x20'+_0x59fb09[_0x3ff72d(0x3d4)]);});});}),on($('#set_theme_color'),_0x3918b3(0x291),_0x441c34=>{const _0x3a2bb6=_0x3918b3,_0x40c281=_0x441c34[_0x3a2bb6(0x2aa)]['value'];applyTheme(_0x40c281);if(_0x40c281===_0x3a2bb6(0x4c0)||_0x40c281===_0x3a2bb6(0x3c1)){const _0x1172b4=$(_0x3a2bb6(0x43c));_0x1172b4&&(_0x1172b4[_0x3a2bb6(0x1fa)]=![],toast('Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.',0x7d0));try{document['body'][_0x3a2bb6(0x22c)]['setProperty'](_0x3a2bb6(0x218),_0x3a2bb6(0x459));}catch(_0x2dffe9){}}else{const _0x1e287d=$('#set_ytThumbAsBg');_0x1e287d&&(_0x1e287d[_0x3a2bb6(0x1fa)]=!![]);try{updateYouTubePlayer();}catch(_0x43af6a){}}}),on($(_0x3918b3(0x266)),_0x3918b3(0x38d),openSettings),on($(_0x3918b3(0x3bc)),_0x3918b3(0x38d),()=>{const _0x4fc5ec=_0x3918b3;switchView(_0x4fc5ec(0x48f)),$(_0x4fc5ec(0x3df))[_0x4fc5ec(0x38d)]();}),on($('#btnDashboard'),_0x3918b3(0x38d),()=>{const _0x18449e=_0x3918b3;renderDashboard(),$(_0x18449e(0x34f))[_0x18449e(0x2e9)][_0x18449e(0x325)](_0x18449e(0x40d));}),on($(_0x3918b3(0x2d3)),'click',()=>{const _0x251539=_0x3918b3;$(_0x251539(0x34f))['classList'][_0x251539(0x41a)](_0x251539(0x40d));}),on($(_0x3918b3(0x226)),_0x3918b3(0x38d),closeSettings),on($(_0x3918b3(0x2f7)),_0x3918b3(0x38d),saveSettings),on($('#btnDefaults'),_0x3918b3(0x38d),setDefaults),on($(_0x3918b3(0x29e)),'click',()=>{const _0x373107=_0x3918b3;ensureAudio(),playSound(_0x373107(0x29d));}),on($(_0x3918b3(0x265)),_0x3918b3(0x38d),_0x121af8=>{const _0x3f071f=_0x3918b3;_0x121af8[_0x3f071f(0x3f9)]();const _0x50e14c=$(_0x3f071f(0x30d));if(_0x50e14c)_0x50e14c[_0x3f071f(0x2e9)]['toggle'](_0x3f071f(0x40a));}),on($(_0x3918b3(0x38a)),_0x3918b3(0x38d),async()=>{const _0x514a3b=_0x3918b3,_0x446782=getCurrentSubtopic();if(!_0x446782)return;const _0x2eb101=pendingNoteSessionId,_0x1394dd=_0x446782[_0x514a3b(0x43f)]['find'](_0x3309af=>_0x3309af['id']===_0x2eb101);_0x1394dd&&(_0x1394dd[_0x514a3b(0x256)]=$(_0x514a3b(0x36c))['value'][_0x514a3b(0x22a)](),await saveData(),renderStatsHistory(),toast('Note\x20saved')),closeNoteModal();}),on($(_0x3918b3(0x4b6)),_0x3918b3(0x38d),()=>closeNoteModal()),on($(_0x3918b3(0x4fa)),_0x3918b3(0x38d),addGeneralNote),on($(_0x3918b3(0x42d)),'click',handleSummarizeNote),on($(_0x3918b3(0x238)),_0x3918b3(0x38d),handleSendMessage),on($('#chatInput'),_0x3918b3(0x279),_0x4e7c34=>{const _0x1714a6=_0x3918b3;if(_0x4e7c34[_0x1714a6(0x407)]===_0x1714a6(0x427))handleSendMessage();}),$$(_0x3918b3(0x20f))['forEach'](_0x3b9fb4=>{on(_0x3b9fb4,'click',()=>{const _0x387736=_0x5eb1,_0x57f2eb=_0x3b9fb4[_0x387736(0x4f8)]['prompt'];$(_0x387736(0x1e4))[_0x387736(0x2e8)]=_0x57f2eb,$(_0x387736(0x1e4))[_0x387736(0x49d)]();});}),on($(_0x3918b3(0x40e)),_0x3918b3(0x38d),clearChat),on($('#btnAddSubtopicTask'),'click',addSubtopicTask),on($(_0x3918b3(0x2fc)),_0x3918b3(0x279),_0x63b36a=>{const _0x346f23=_0x3918b3;if(_0x63b36a['key']===_0x346f23(0x427))addSubtopicTask();}),on($('#btnToggleYtSound'),'click',toggleYtSound),on($(_0x3918b3(0x38f)),_0x3918b3(0x38d),()=>{ensureAudio(),unlockAudioChain();}),on($(_0x3918b3(0x4f5)),'input',_0x30150c=>{const _0xa7f761=_0x3918b3,_0x230dc3=parseInt(_0x30150c[_0xa7f761(0x2aa)][_0xa7f761(0x2e8)],0xa);ytPlayer&&ytPlayer[_0xa7f761(0x334)]&&ytPlayer[_0xa7f761(0x334)](_0x230dc3);}),on($(_0x3918b3(0x4d2)),_0x3918b3(0x291),handleYoutubeUrlInput),$$(_0x3918b3(0x41f))[_0x3918b3(0x345)](_0x4fe5e9=>{const _0x78d3e9=_0x3918b3;_0x4fe5e9['addEventListener'](_0x78d3e9(0x38d),()=>{const _0x3f0ce3=_0x78d3e9,_0x396306=_0x4fe5e9['dataset']['view'],_0x44046d=data?.[_0x3f0ce3(0x314)]?.[_0x3f0ce3(0x2f1)]||_0x3f0ce3(0x274);if(_0x44046d===_0x396306&&_0x396306!==_0x3f0ce3(0x274))switchView(_0x3f0ce3(0x274));else switchView(_0x396306);});}),$$(_0x3918b3(0x22b))['forEach'](_0x18a4d7=>{const _0x1ab4e3=_0x3918b3;_0x18a4d7[_0x1ab4e3(0x379)]('click',()=>{const _0x43cb17=_0x1ab4e3,_0x131265=_0x18a4d7['dataset'][_0x43cb17(0x2d5)],_0x643145=_0x18a4d7[_0x43cb17(0x3b6)](_0x43cb17(0x378));if(!_0x643145)return;_0x643145[_0x43cb17(0x257)](_0x43cb17(0x22b))[_0x43cb17(0x345)](_0x132af1=>_0x132af1[_0x43cb17(0x2e9)]['remove']('active')),_0x18a4d7['classList'][_0x43cb17(0x325)](_0x43cb17(0x2ff)),_0x643145[_0x43cb17(0x257)](_0x43cb17(0x295))[_0x43cb17(0x345)](_0x3be72d=>{const _0x294b3f=_0x43cb17;_0x3be72d[_0x294b3f(0x2e9)]['remove'](_0x294b3f(0x2ff)),_0x3be72d[_0x294b3f(0x22c)][_0x294b3f(0x333)]=_0x294b3f(0x459);});const _0x27606a=_0x643145[_0x43cb17(0x276)]('#'+_0x131265);_0x27606a&&(_0x27606a[_0x43cb17(0x2e9)][_0x43cb17(0x325)](_0x43cb17(0x2ff)),_0x27606a['style'][_0x43cb17(0x333)]='block',_0x643145[_0x43cb17(0x3b6)]('#modalSettings')&&(_0x27606a[_0x43cb17(0x22c)][_0x43cb17(0x333)]='flex'));});});const _0x57b628=$(_0x3918b3(0x255));function _0xce28ad(_0xe75aa6,_0x48ee51=null){const _0x552739=_0x3918b3;try{document[_0x552739(0x45e)](_0x552739(0x294),![],!![]);}catch(_0xa2cc8e){}try{document[_0x552739(0x45e)](_0xe75aa6,![],_0x48ee51);}catch(_0x39e9f1){}if(_0x57b628)_0x57b628[_0x552739(0x49d)]();}on($(_0x3918b3(0x480)),_0x3918b3(0x38d),()=>_0xce28ad(_0x3918b3(0x2fa))),on($('#toolItalic'),'click',()=>_0xce28ad(_0x3918b3(0x25e))),on($('#toolH4'),_0x3918b3(0x38d),()=>_0xce28ad(_0x3918b3(0x33c),_0x3918b3(0x2cf))),on($('#toolList'),_0x3918b3(0x38d),()=>_0xce28ad('insertOrderedList')),on($(_0x3918b3(0x47c)),'click',()=>_0xce28ad('insertUnorderedList'));const _0x5dd6ec=$('.color-picker-wrapper'),_0x32c5ca=$(_0x3918b3(0x465));on($(_0x3918b3(0x443)),_0x3918b3(0x38d),_0x342577=>{const _0x2f4073=_0x3918b3;if(!_0x32c5ca)return;_0x342577[_0x2f4073(0x3c2)](),_0x32c5ca['classList'][_0x2f4073(0x242)](_0x2f4073(0x40a));}),$$(_0x3918b3(0x368))[_0x3918b3(0x345)](_0x575dee=>{const _0x784443=_0x3918b3;on(_0x575dee,_0x784443(0x38d),_0x53d4ac=>{const _0x1ceb80=_0x784443;_0x53d4ac[_0x1ceb80(0x3f9)]();const _0x2bdf55=_0x575dee[_0x1ceb80(0x4f8)][_0x1ceb80(0x430)]||'';let _0x5b9415=_0x2bdf55;try{const _0x3c6104=_0x2bdf55[_0x1ceb80(0x3db)](/--[a-zA-Z0-9_-]+/);if(_0x3c6104)_0x5b9415=getComputedStyle(document[_0x1ceb80(0x2a4)])['getPropertyValue'](_0x3c6104[0x0])[_0x1ceb80(0x22a)]();}catch(_0x569a8d){}_0xce28ad(_0x1ceb80(0x377),_0x5b9415);if(_0x32c5ca)_0x32c5ca[_0x1ceb80(0x2e9)][_0x1ceb80(0x325)](_0x1ceb80(0x40a));});}),on(document,'click',_0x3a2e9e=>{const _0x58d93e=_0x3918b3;if(!_0x5dd6ec||!_0x32c5ca)return;!_0x5dd6ec[_0x58d93e(0x355)](_0x3a2e9e[_0x58d93e(0x2aa)])&&!_0x32c5ca[_0x58d93e(0x2e9)][_0x58d93e(0x355)](_0x58d93e(0x40a))&&_0x32c5ca[_0x58d93e(0x2e9)][_0x58d93e(0x325)]('hidden');});function _0x5f5b1f(_0xa9d979){const _0x3f9777=_0x3918b3,_0x98e763=getCurrentSubtopic();if(!_0x98e763){toast(_0x3f9777(0x30f));return;}const _0x5d2a1c=Array[_0x3f9777(0x316)](_0x98e763[_0x3f9777(0x24b)])?_0x98e763[_0x3f9777(0x24b)]:[],_0x281724=_0xa9d979?_0x5d2a1c[_0x3f9777(0x4c3)](_0x3c9965=>_0x3c9965['id']===_0xa9d979):null;$('#methodEditorId')[_0x3f9777(0x2e8)]=_0x281724&&_0x281724['id']||'',$('#methodEditorTitle')[_0x3f9777(0x351)]=_0x281724?_0x3f9777(0x2c7):'Add\x20New\x20Knowledge',$(_0x3f9777(0x211))[_0x3f9777(0x2e8)]=_0x281724&&_0x281724[_0x3f9777(0x3cb)]||'';const _0x24d01d=$(_0x3f9777(0x255));if(_0x24d01d)_0x24d01d[_0x3f9777(0x373)]=_0x281724&&_0x281724[_0x3f9777(0x2d8)]||'';$('#modalMethodEditor')[_0x3f9777(0x2e9)][_0x3f9777(0x325)](_0x3f9777(0x40d));try{trapFocus($('#modalMethodEditor'));}catch(_0x1fa155){}try{const _0x42ae89=$('#btnAutoFormat');if(_0x42ae89){const _0x24b14f=!!(data?.[_0x3f9777(0x314)]?.['apiKey']&&data[_0x3f9777(0x314)][_0x3f9777(0x463)][_0x3f9777(0x22a)]());_0x42ae89['disabled']=!_0x24b14f,_0x42ae89[_0x3f9777(0x3cb)]=_0x24b14f?_0x3f9777(0x40b):_0x3f9777(0x1fc);}}catch(_0x161cb9){}}on($(_0x3918b3(0x303)),_0x3918b3(0x38d),()=>{const _0x322043=_0x3918b3;$(_0x322043(0x1f0))['classList'][_0x322043(0x41a)]('show');try{releaseFocus();}catch(_0x4d804d){}}),on($('#btnSaveMethod'),_0x3918b3(0x38d),async()=>{const _0x3893f5=_0x3918b3,_0x11e859=$('#methodEditorId')[_0x3893f5(0x2e8)]||uid('m'),_0x52e9e8=($('#methodEditorTitleInput')['value']||'')[_0x3893f5(0x22a)](),_0x4381a3=$(_0x3893f5(0x255)),_0x1541cc=_0x4381a3?_0x4381a3['innerHTML']||'':'',_0x3aba13=getCurrentSubtopic();if(!_0x3aba13){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}if(!Array[_0x3893f5(0x316)](_0x3aba13[_0x3893f5(0x24b)]))_0x3aba13[_0x3893f5(0x24b)]=[];const _0x202148=_0x3aba13[_0x3893f5(0x24b)][_0x3893f5(0x4bd)](_0x328e76=>_0x328e76['id']===_0x11e859),_0x120e21={'id':_0x11e859,'title':_0x52e9e8,'content':_0x1541cc};if(_0x202148>=0x0)_0x3aba13[_0x3893f5(0x24b)][_0x202148]=_0x120e21;else _0x3aba13[_0x3893f5(0x24b)][_0x3893f5(0x466)](_0x120e21);await saveData(),renderMethods(),$(_0x3893f5(0x1f0))[_0x3893f5(0x2e9)][_0x3893f5(0x41a)](_0x3893f5(0x40d));try{releaseFocus();}catch(_0xc23a6c){}}),on($('#btnAutoFormat'),_0x3918b3(0x38d),async()=>{const _0x3ebc50=_0x3918b3,_0x5acd2b=$('#methodEditorContentInput');if(!_0x5acd2b)return;const _0x5c7ee6=(_0x5acd2b['textContent']||'')[_0x3ebc50(0x22a)]();if(!_0x5c7ee6||_0x5c7ee6['length']<0x14){toast('Content\x20required\x20for\x20AI\x20formatting.');return;}const _0x290797=$(_0x3ebc50(0x273));_0x290797&&(_0x290797[_0x3ebc50(0x3fb)]=!![],_0x290797[_0x3ebc50(0x373)]=_0x3ebc50(0x409));const _0x590d9b=_0x3ebc50(0x3d7)+_0x5c7ee6+'\x22',_0x13c01b=await callGeminiAPI(_0x590d9b);_0x13c01b?(_0x5acd2b[_0x3ebc50(0x373)]=_0x13c01b,toast('AI\x20finished\x20formatting!')):toast('AI\x20cannot\x20format\x20at\x20the\x20moment.'),_0x290797&&(_0x290797[_0x3ebc50(0x3fb)]=![],_0x290797[_0x3ebc50(0x373)]=_0x3ebc50(0x4b0));}),on($(_0x3918b3(0x34e)),_0x3918b3(0x38d),()=>_0x5f5b1f());const _0x1a8244=document['querySelector'](_0x3918b3(0x216));_0x1a8244&&_0x1a8244[_0x3918b3(0x379)](_0x3918b3(0x38d),_0x5626e2=>{const _0x45d3d3=_0x3918b3,_0x20e917=_0x5626e2['target']['closest']&&_0x5626e2['target'][_0x45d3d3(0x3b6)](_0x45d3d3(0x4b1)),_0xcdd56b=!_0x20e917&&_0x5626e2[_0x45d3d3(0x2aa)]['closest']&&_0x5626e2[_0x45d3d3(0x2aa)][_0x45d3d3(0x3b6)](_0x45d3d3(0x40f));if(_0x20e917){_0x5626e2[_0x45d3d3(0x3f9)](),_0x5626e2[_0x45d3d3(0x3c2)]();const _0x1d4a8e=_0x20e917[_0x45d3d3(0x4f8)]['id'];if(_0x1d4a8e)_0x5f5b1f(_0x1d4a8e);return;}if(_0xcdd56b){_0x5626e2[_0x45d3d3(0x3f9)](),_0x5626e2['stopPropagation']();const _0x49d328=_0xcdd56b[_0x45d3d3(0x4f8)]['id'];if(!_0x49d328)return;const _0x4bb118=getCurrentSubtopic();if(!_0x4bb118){toast(_0x45d3d3(0x30f));return;}const _0x110d5c=Array['isArray'](_0x4bb118['methods'])?_0x4bb118[_0x45d3d3(0x24b)]:[],_0x2c2f71=_0x110d5c[_0x45d3d3(0x4c3)](_0x3fab98=>_0x3fab98['id']===_0x49d328);if(!_0x2c2f71)return;showConfirmModal(_0x45d3d3(0x230),_0x45d3d3(0x492)+(_0x2c2f71[_0x45d3d3(0x3cb)]||'')+'\x22?',async _0xc54af2=>{if(!_0xc54af2)return;_0x4bb118['methods']=_0x110d5c['filter'](_0x434a9d=>_0x434a9d['id']!==_0x49d328),await saveData(),renderMethods();});}});$$(_0x3918b3(0x2bf))[_0x3918b3(0x345)](_0x2caf36=>{const _0x3408d6=_0x3918b3;_0x2caf36['addEventListener'](_0x3408d6(0x38d),()=>{const _0x70c8f5=_0x3408d6;editingPreset=_0x2caf36['dataset'][_0x70c8f5(0x39b)],highlightPresetSelector(),loadEditingPresetFields();});}),$$('.presets\x20button')['forEach'](_0x12a049=>{const _0x2fa607=_0x3918b3;_0x12a049[_0x2fa607(0x379)](_0x2fa607(0x38d),_0x1a62bc=>{const _0x18e611=_0x2fa607,_0x16e293=_0x1a62bc['target'][_0x18e611(0x4f8)][_0x18e611(0x335)],_0x26d811=data['settings'][_0x18e611(0x335)];if(_0x16e293===_0x26d811)return;timer['state']!==_0x18e611(0x1ea)?showConfirmModal('Confirm\x20Switch','Switch\x20to\x20Style\x20'+_0x16e293+_0x18e611(0x4d4),_0x1dc322=>{const _0xa4dc9f=_0x18e611;_0x1dc322&&(timer['reset'](),timer[_0xa4dc9f(0x2a1)](_0x16e293),renderAll(),toast(_0xa4dc9f(0x34c)+_0x16e293+'.'));}):(timer[_0x18e611(0x2a1)](_0x16e293),renderAll(),toast(_0x18e611(0x34c)+_0x16e293+'.'));});}),on($(_0x3918b3(0x426)),'click',()=>timer[_0x3918b3(0x2d1)]()),on($(_0x3918b3(0x225)),_0x3918b3(0x38d),()=>timer[_0x3918b3(0x3cc)]()),on($(_0x3918b3(0x493)),'click',()=>timer[_0x3918b3(0x381)]()),on($('#btnResume'),'click',()=>timer['resume']()),on($(_0x3918b3(0x433)),'click',()=>timer['skip']()),on($('#btnReset'),'click',()=>timer['reset']()),on($(_0x3918b3(0x2dc)),_0x3918b3(0x38d),()=>timer['beginBreak']()),on($(_0x3918b3(0x2e0)),'change',_0x8a1229=>{const _0x5b9148=_0x3918b3;handleFileUpload(_0x8a1229[_0x5b9148(0x2aa)][_0x5b9148(0x4aa)][0x0],async _0xa5d940=>{const _0x51a5bf=_0x5b9148;data[_0x51a5bf(0x314)][_0x51a5bf(0x251)]=_0xa5d940,await saveData(),applyCustomBg(),toast(_0x51a5bf(0x4d6));}),_0x8a1229[_0x5b9148(0x2aa)][_0x5b9148(0x2e8)]=null;}),on($(_0x3918b3(0x450)),'click',async()=>{const _0x449a6c=_0x3918b3;data[_0x449a6c(0x314)]['customBg']='',data[_0x449a6c(0x314)][_0x449a6c(0x43a)]=![],await saveData(),applyCustomBg(),toast(_0x449a6c(0x3b2)),$('#modalSettings')['classList']['contains'](_0x449a6c(0x40d))&&openSettings();}),on($(_0x3918b3(0x267)),_0x3918b3(0x260),_0x166d42=>{const _0x2c69e2=_0x3918b3;handleFileUpload(_0x166d42[_0x2c69e2(0x2aa)]['files'][0x0],async _0x3444e4=>{const _0x8e234d=_0x2c69e2;data['settings'][_0x8e234d(0x285)][_0x8e234d(0x29d)]=_0x3444e4,await saveData(),toast(_0x8e234d(0x4c4));}),_0x166d42['target'][_0x2c69e2(0x2e8)]=null;}),on($(_0x3918b3(0x301)),_0x3918b3(0x260),_0x42f67a=>{const _0x4b79b6=_0x3918b3;handleFileUpload(_0x42f67a['target'][_0x4b79b6(0x4aa)][0x0],async _0x1aa5bd=>{const _0x3d42b8=_0x4b79b6;data[_0x3d42b8(0x314)][_0x3d42b8(0x285)][_0x3d42b8(0x290)]=_0x1aa5bd,await saveData(),toast('Saved\x20alert\x20for\x20SHORT\x20BREAK.');}),_0x42f67a[_0x4b79b6(0x2aa)][_0x4b79b6(0x2e8)]=null;}),on($(_0x3918b3(0x336)),_0x3918b3(0x260),_0x74ea3d=>{const _0x3ceac7=_0x3918b3;handleFileUpload(_0x74ea3d[_0x3ceac7(0x2aa)][_0x3ceac7(0x4aa)][0x0],async _0x42194c=>{const _0x1aaa94=_0x3ceac7;data[_0x1aaa94(0x314)][_0x1aaa94(0x285)]['long_end']=_0x42194c,await saveData(),toast(_0x1aaa94(0x2bb));}),_0x74ea3d[_0x3ceac7(0x2aa)]['value']=null;}),on($('#btnFullscreen'),_0x3918b3(0x38d),toggleFullScreen),document[_0x3918b3(0x379)](_0x3918b3(0x486),updateFullscreenButton),window['addEventListener'](_0x3918b3(0x279),_0x4508de=>{const _0x4ff79d=_0x3918b3,_0x364fef=_0x4508de['target'],_0x3e9e60=(_0x364fef[_0x4ff79d(0x3b1)]||'')[_0x4ff79d(0x403)](),_0x258664=[_0x4ff79d(0x291),_0x4ff79d(0x30b),_0x4ff79d(0x29f)][_0x4ff79d(0x2ea)](_0x3e9e60)||_0x364fef['isContentEditable'];if(_0x4508de[_0x4ff79d(0x4dc)]===_0x4ff79d(0x484)&&!_0x258664){_0x4508de[_0x4ff79d(0x3f9)]();if(timer[_0x4ff79d(0x21e)]==='idle'||timer[_0x4ff79d(0x21e)]===_0x4ff79d(0x413))timer['start']();else timer[_0x4ff79d(0x381)]();}(_0x4508de[_0x4ff79d(0x407)]==='n'||_0x4508de[_0x4ff79d(0x407)]==='N')&&(!_0x258664&&(_0x4508de[_0x4ff79d(0x3f9)](),timer['skip']()));if(_0x4508de[_0x4ff79d(0x407)]===_0x4ff79d(0x2a9)){$$(_0x4ff79d(0x361))[_0x4ff79d(0x345)](_0x38bd07=>_0x38bd07[_0x4ff79d(0x2e9)][_0x4ff79d(0x41a)](_0x4ff79d(0x40d)));try{releaseFocus();}catch(_0x12795a){}}if(_0x4508de[_0x4ff79d(0x222)]&&!_0x258664){if(_0x4508de['key']===_0x4ff79d(0x1df))_0x4508de[_0x4ff79d(0x3f9)](),_0x40207e(0x0,-0xa);else{if(_0x4508de['key']==='ArrowDown')_0x4508de[_0x4ff79d(0x3f9)](),_0x40207e(0x0,0xa);else{if(_0x4508de['key']===_0x4ff79d(0x3cd))_0x4508de['preventDefault'](),_0x40207e(-0xa,0x0);else _0x4508de[_0x4ff79d(0x407)]===_0x4ff79d(0x3b0)&&(_0x4508de['preventDefault'](),_0x40207e(0xa,0x0));}}}}),$$(_0x3918b3(0x361))[_0x3918b3(0x345)](_0x371587=>_0x371587[_0x3918b3(0x379)]('click',_0x3f2529=>{const _0xfcae29=_0x3918b3;if(_0x3f2529&&_0x3f2529[_0xfcae29(0x2aa)]&&_0x3f2529[_0xfcae29(0x2aa)]['id']===_0xfcae29(0x442))return;if(_0x3f2529['target']===_0x371587){_0x371587[_0xfcae29(0x2e9)][_0xfcae29(0x41a)](_0xfcae29(0x40d));try{releaseFocus();}catch(_0x55f6dd){}}})),window['addEventListener'](_0x3918b3(0x38d),_0x13723f=>{const _0x3eba91=_0x3918b3;!_0x13723f[_0x3eba91(0x2aa)][_0x3eba91(0x3b6)](_0x3eba91(0x2c4))&&!_0x13723f[_0x3eba91(0x2aa)][_0x3eba91(0x3b6)](_0x3eba91(0x473))&&closeAllMenus();});try{const _0xe580ad=document[_0x3918b3(0x276)](_0x3918b3(0x36d));if(_0xe580ad)_0xe580ad[_0x3918b3(0x379)]('scroll',closeAllMenus);}catch(_0x47cb90){}try{window[_0x3918b3(0x379)](_0x3918b3(0x209),closeAllMenus,!![]);}catch(_0x117bec){}window['addEventListener'](_0x3918b3(0x456),()=>timer[_0x3918b3(0x254)](!![]));try{const _0x10d640=Array[_0x3918b3(0x4af)](document[_0x3918b3(0x257)]('#view-methods\x20.method-item'));_0x10d640[_0x3918b3(0x326)]&&_0x10d640['forEach'](_0x59aeaf=>{const _0x2f97e5=_0x3918b3;_0x59aeaf[_0x2f97e5(0x379)](_0x2f97e5(0x242),()=>{const _0x3e5ad0=_0x2f97e5;_0x59aeaf[_0x3e5ad0(0x458)]&&_0x10d640[_0x3e5ad0(0x345)](_0x49be38=>{const _0x3032e0=_0x3e5ad0;if(_0x49be38!==_0x59aeaf)_0x49be38[_0x3032e0(0x458)]=![];});});});}catch(_0x227853){}const _0x4127f2=$(_0x3918b3(0x4ff));let _0x89aeeb=![],_0x32c2bf,_0x1ae27f;_0x4127f2&&(_0x4127f2[_0x3918b3(0x379)](_0x3918b3(0x44e),_0x12ab4e=>{const _0x14db09=_0x3918b3;_0x89aeeb=!![];const _0x3834c9=_0x4127f2[_0x14db09(0x393)]();_0x32c2bf=_0x12ab4e['clientX']-_0x3834c9[_0x14db09(0x500)],_0x1ae27f=_0x12ab4e['clientY']-_0x3834c9[_0x14db09(0x2e3)],_0x4127f2['style'][_0x14db09(0x304)]=_0x14db09(0x459);}),document['addEventListener'](_0x3918b3(0x398),_0x34e33f=>{const _0x223b84=_0x3918b3;if(!_0x89aeeb)return;let _0x2e5d3c=_0x34e33f['clientX']-_0x32c2bf,_0xae524b=_0x34e33f[_0x223b84(0x41b)]-_0x1ae27f;const _0x47ecc6=window[_0x223b84(0x4d0)]-_0x4127f2[_0x223b84(0x4d5)],_0x28928b=window[_0x223b84(0x2c0)]-_0x4127f2[_0x223b84(0x3b5)];_0x2e5d3c=Math['max'](0x0,Math['min'](_0x2e5d3c,_0x47ecc6)),_0xae524b=Math['max'](0x0,Math[_0x223b84(0x3d8)](_0xae524b,_0x28928b)),_0x4127f2[_0x223b84(0x22c)]['left']=_0x2e5d3c+'px',_0x4127f2[_0x223b84(0x22c)][_0x223b84(0x2e3)]=_0xae524b+'px',_0x4127f2[_0x223b84(0x22c)][_0x223b84(0x25a)]=_0x223b84(0x432),_0x4127f2['style'][_0x223b84(0x390)]=_0x223b84(0x432);}),document[_0x3918b3(0x379)](_0x3918b3(0x437),()=>{const _0x98c07d=_0x3918b3;if(!_0x89aeeb)return;_0x89aeeb=![],_0x4127f2[_0x98c07d(0x22c)][_0x98c07d(0x304)]='';}));function _0x402174(_0x3118ec){const _0x381343=_0x3918b3,_0x12c1ea=$(_0x381343(0x4ff));if(!_0x12c1ea)return;_0x12c1ea[_0x381343(0x22c)][_0x381343(0x47f)]=_0x381343(0x4fd),_0x12c1ea[_0x381343(0x22c)][_0x381343(0x304)]='',_0x12c1ea[_0x381343(0x22c)]['left']=_0x381343(0x432),_0x12c1ea[_0x381343(0x22c)][_0x381343(0x2e3)]=_0x381343(0x432),_0x12c1ea[_0x381343(0x22c)][_0x381343(0x390)]=_0x381343(0x432),_0x12c1ea[_0x381343(0x22c)]['bottom']=_0x381343(0x432);const _0x3da91d=0x10;_0x3118ec==='tl'&&(_0x12c1ea[_0x381343(0x22c)][_0x381343(0x500)]=_0x3da91d+'px',_0x12c1ea[_0x381343(0x22c)][_0x381343(0x2e3)]=_0x3da91d+'px'),_0x3118ec==='tr'&&(_0x12c1ea[_0x381343(0x22c)]['right']=_0x3da91d+'px',_0x12c1ea['style'][_0x381343(0x2e3)]=_0x3da91d+'px'),_0x3118ec==='bl'&&(_0x12c1ea[_0x381343(0x22c)][_0x381343(0x500)]=_0x3da91d+'px',_0x12c1ea[_0x381343(0x22c)]['bottom']=_0x3da91d+'px'),_0x3118ec==='br'&&(_0x12c1ea[_0x381343(0x22c)]['right']=_0x3da91d+'px',_0x12c1ea[_0x381343(0x22c)][_0x381343(0x25a)]=_0x3da91d+'px');}function _0x40207e(_0x5544ec,_0x2e9122){const _0x1c2eb2=_0x3918b3,_0x3ef395=$(_0x1c2eb2(0x4ff));if(!_0x3ef395)return;const _0xb5aee2=_0x3ef395['getBoundingClientRect'](),_0x1de2d0=Math[_0x1c2eb2(0x23d)](0x0,Math[_0x1c2eb2(0x3d8)](_0xb5aee2['left']+_0x5544ec,window[_0x1c2eb2(0x4d0)]-_0x3ef395[_0x1c2eb2(0x4d5)])),_0x2e57cc=Math[_0x1c2eb2(0x23d)](0x0,Math[_0x1c2eb2(0x3d8)](_0xb5aee2['top']+_0x2e9122,window[_0x1c2eb2(0x2c0)]-_0x3ef395['offsetHeight']));_0x3ef395[_0x1c2eb2(0x22c)][_0x1c2eb2(0x500)]=_0x1de2d0+'px',_0x3ef395['style'][_0x1c2eb2(0x2e3)]=_0x2e57cc+'px',_0x3ef395[_0x1c2eb2(0x22c)][_0x1c2eb2(0x390)]=_0x1c2eb2(0x432),_0x3ef395['style'][_0x1c2eb2(0x25a)]=_0x1c2eb2(0x432);}}function toggleBackgroundView(){const _0x33d5c3=_0x58e2db,_0x440947=document[_0x33d5c3(0x2a4)];_0x440947[_0x33d5c3(0x2e9)][_0x33d5c3(0x242)](_0x33d5c3(0x445));const _0x47b9de=_0x440947[_0x33d5c3(0x2e9)][_0x33d5c3(0x355)]('bg-view-mode'),_0x3d0612=$(_0x33d5c3(0x499));if(!_0x3d0612)return;_0x47b9de?(_0x3d0612['title']=_0x33d5c3(0x1e5),_0x3d0612['innerHTML']=_0x33d5c3(0x374)):(_0x3d0612['title']=_0x33d5c3(0x2f2),_0x3d0612[_0x33d5c3(0x373)]=_0x33d5c3(0x28a));}function updateMainViewVisibility(){const _0x27368e=_0x58e2db,_0x1da741=!!getCurrentSubtopic(),_0x212fd7=$(_0x27368e(0x43d)),_0x4b82a0=$(_0x27368e(0x34b));_0x4b82a0&&_0x4b82a0[_0x27368e(0x2e9)]['toggle']('hidden',_0x1da741),_0x212fd7&&(_0x1da741?_0x212fd7[_0x27368e(0x2e9)][_0x27368e(0x41a)](_0x27368e(0x2ad)):_0x212fd7['classList'][_0x27368e(0x325)]('no-subtopic-selected'));}function updatePresetButtonsText(){const _0x5cd2c7=_0x58e2db,_0x589bed=data[_0x5cd2c7(0x314)],_0x1c66ee=_0x589bed[_0x5cd2c7(0x3f7)],_0x483f38=_0x589bed[_0x5cd2c7(0x46c)],_0x46f107=_0x589bed[_0x5cd2c7(0x3ec)]['A_work'],_0x2a6a41=_0x589bed[_0x5cd2c7(0x3ec)][_0x5cd2c7(0x340)],_0x1000f8=$('#btnPresetA'),_0x2bb104=$('#btnPresetB'),_0x1edea4=$(_0x5cd2c7(0x3a6));_0x1000f8&&(_0x1000f8['textContent']=_0x1c66ee+'×'+_0x46f107+_0x5cd2c7(0x4ea)),_0x2bb104&&(_0x2bb104['textContent']=_0x483f38+'×'+_0x2a6a41+_0x5cd2c7(0x2f5)),_0x1edea4&&(_0x1edea4[_0x5cd2c7(0x351)]=_0x5cd2c7(0x2c1));}function renderAll(){const _0x294f63=_0x58e2db;updatePresetButtonsText();const _0x4c9b8e=data['settings'][_0x294f63(0x335)];$$('.presets\x20button')[_0x294f63(0x345)](_0xc734bc=>{const _0x4dcc53=_0x294f63,_0x12ac04=_0xc734bc[_0x4dcc53(0x4f8)][_0x4dcc53(0x335)]===_0x4c9b8e;_0xc734bc[_0x4dcc53(0x2e9)]['toggle'](_0x4dcc53(0x359),_0x12ac04),_0xc734bc[_0x4dcc53(0x2e9)][_0x4dcc53(0x242)](_0x4dcc53(0x400),!_0x12ac04),_0xc734bc[_0x4dcc53(0x2af)](_0x4dcc53(0x384),_0x12ac04);}),updateMainViewVisibility(),timer[_0x294f63(0x2a1)](data[_0x294f63(0x314)][_0x294f63(0x335)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x294f63(0x314)][_0x294f63(0x2f1)]);}function toggleFullScreen(){const _0x145e30=_0x58e2db;!document[_0x145e30(0x3ed)]?document[_0x145e30(0x337)][_0x145e30(0x4a5)]()[_0x145e30(0x2f4)](_0x5ebf10=>{toast('Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20'+_0x5ebf10['message']);}):document[_0x145e30(0x2c8)]&&document['exitFullscreen']();}function updateFullscreenButton(){const _0xaeec1d=_0x58e2db,_0x6fd3ff=$('#btnFullscreen');document[_0xaeec1d(0x3ed)]?(_0x6fd3ff[_0xaeec1d(0x373)]='↙',_0x6fd3ff[_0xaeec1d(0x3cb)]='Exit\x20fullscreen'):(_0x6fd3ff[_0xaeec1d(0x373)]='↗',_0x6fd3ff[_0xaeec1d(0x3cb)]='Fullscreen');}async function initializeApp(){const _0x54dab2=_0x58e2db;try{await storageManager['initDB']();const [_0x2abf9c,_0x29bd38,_0x1606a3]=await Promise['all']([storageManager[_0x54dab2(0x3a2)](),storageManager[_0x54dab2(0x4ba)](_0x54dab2(0x48f)),storageManager[_0x54dab2(0x4ba)](_0x54dab2(0x4b5))]);let _0x5ead21;if(!_0x2abf9c){const _0xc39add=JSON[_0x54dab2(0x3e1)](JSON['stringify'](defaults));await storageManager['updateSettings'](_0xc39add[_0x54dab2(0x314)]);for(const _0x10ed93 of _0xc39add[_0x54dab2(0x48f)]){const {subtopics:_0x364fd3,..._0x45f57b}=_0x10ed93;await storageManager[_0x54dab2(0x325)](_0x54dab2(0x48f),_0x45f57b);for(const _0x3d6f8a of _0x364fd3){await storageManager[_0x54dab2(0x325)](_0x54dab2(0x4b5),{..._0x3d6f8a,'topicId':_0x10ed93['id']});}}_0x5ead21=_0xc39add;}else{const _0x28ae78={};for(const _0x161299 of _0x29bd38)_0x28ae78[_0x161299['id']]={..._0x161299,'subtopics':[]};for(const _0x128b57 of _0x1606a3)_0x28ae78[_0x128b57[_0x54dab2(0x2fe)]]?.['subtopics'][_0x54dab2(0x4a7)](_0x128b57);_0x5ead21={'version':defaults[_0x54dab2(0x4f2)],'settings':_0x2abf9c,'topics':Object[_0x54dab2(0x404)](_0x28ae78)};}data=window['data']=_0x5ead21,normalizeDataStructure(data),await ensureValidSelection(),await migrateSharedMethodsToCurrentSubtopic(),await seedAchievedMilestones(),renderAll();try{storageManager[_0x54dab2(0x3e6)](data);}catch(_0x181805){console[_0x54dab2(0x362)](_0x54dab2(0x422),_0x181805);}bindEvents(),applyTheme();}catch(_0x44b82b){console[_0x54dab2(0x363)](_0x54dab2(0x4a3),_0x44b82b),toast(_0x54dab2(0x4ec)+_0x44b82b[_0x54dab2(0x3d4)]);}}callGeminiAPI=async function(_0x425df9,_0x10e2c3=0x3,_0x49471c=0x3e8){const _0x271628=_0x58e2db,_0x348e79=data?.['settings']?.[_0x271628(0x463)]||'';if(!_0x348e79)return toast(_0x271628(0x38b)),null;const _0x5493b2=_0x271628(0x1ef)+_0x348e79,_0x3f5250={'contents':[{'role':_0x271628(0x3a8),'parts':[{'text':_0x425df9}]}]};try{const _0xcbc15f=await fetch(_0x5493b2,{'method':_0x271628(0x1da),'headers':{'Content-Type':_0x271628(0x2e6)},'body':JSON[_0x271628(0x440)](_0x3f5250)});if(!_0xcbc15f['ok']){if(_0xcbc15f[_0x271628(0x324)]===0x1ad&&_0x10e2c3>0x0)return await new Promise(_0x3b5784=>setTimeout(_0x3b5784,_0x49471c)),callGeminiAPI(_0x425df9,_0x10e2c3-0x1,_0x49471c*0x2);let _0x308d65=null;try{_0x308d65=await _0xcbc15f[_0x271628(0x3fa)]();}catch(_0x33f62e){}let _0x50ed2c=_0x271628(0x280)+_0xcbc15f[_0x271628(0x324)];if(_0xcbc15f[_0x271628(0x324)]===0x190)_0x50ed2c=_0x271628(0x34a);else{if(_0xcbc15f[_0x271628(0x324)]===0x1ad)_0x50ed2c=_0x271628(0x35e);else _0x308d65?.[_0x271628(0x363)]?.['message']&&(_0x50ed2c=_0x271628(0x31d)+_0x308d65[_0x271628(0x363)][_0x271628(0x3d4)]);}return toast(_0x50ed2c,0xfa0),console[_0x271628(0x363)](_0x271628(0x471),_0x308d65||_0xcbc15f[_0x271628(0x453)]),null;}const _0xd49683=await _0xcbc15f[_0x271628(0x3fa)]();if(_0xd49683['candidates']&&_0xd49683['candidates'][0x0]?.[_0x271628(0x2d8)]?.['parts']?.[0x0]?.[_0x271628(0x46d)])return formatGeminiResponse(_0xd49683[_0x271628(0x31a)][0x0][_0x271628(0x2d8)][_0x271628(0x45c)][0x0][_0x271628(0x46d)]);else{console[_0x271628(0x363)](_0x271628(0x417),_0xd49683);if(_0xd49683[_0x271628(0x3d0)]?.[_0x271628(0x382)])return _0x271628(0x43e)+_0xd49683[_0x271628(0x3d0)][_0x271628(0x382)]+_0x271628(0x4c8);return _0x271628(0x1dc);}}catch(_0x120057){return console[_0x271628(0x363)](_0x271628(0x452),_0x120057),toast(_0x271628(0x1e0),0xfa0),null;}},loadLanguage(localStorage[_0x58e2db(0x307)](_0x58e2db(0x4b7))||'en')[_0x58e2db(0x25b)](initializeApp);
    </script>
</body>
</html>
