<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="A Pomodoro application for studying, featuring Gemini AI integration and a modern interface." />
    <title>Pomodoro Study App — Gemini AI Integration (New UI)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — FOCUSED UI VERSION (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Default) - Updated from file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Add RGB variable for panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: ADD NEW THEMES === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: ADD NEW THEMES === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Add border rules for light/pastel themes */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Modified: remove default border */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: UPDATE TOPIC MANAGEMENT UI === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Modified */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Raise the open menu block above others */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: UPDATE TOPIC MANAGEMENT UI === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Modified */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Keep background transparent on hover */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Color tweak */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Color tweak */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: SOFTER DIVIDER CUSTOMIZATION === */
    #view-timer .panel-bg hr {
        border: none; /* Remove default border */
        height: 1px;  /* Set divider height */
        background-color: var(--muted); /* Use theme's secondary color */
        opacity: 0.3; /* Make it subtle to blend with background */
        margin-top: 0; /* Adjust spacing */
    }
    /* === END: SOFTER DIVIDER CUSTOMIZATION === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Modified */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Modified */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Modified */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Raise z-index to sit above header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Modified */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Modified */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Modified */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Modified */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Modified */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Modified: switched to translucent white background */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Faint white border */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Fine-tune: closer to spec */
        border-color: var(--acc);
    }
    /* === START: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Use translucent black instead of white on light theme */
        border-color: rgba(0, 0, 0, 0.1); /* Faint black border on light themes */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Increase density on focus */
    }
    /* === END: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */

    /* Improve option background and text color per current theme */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Tweak */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Reduce/remove text shadow on light themes to avoid blur/glare */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Timer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Timer</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Topics">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Topics</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Stats">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Stats</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Knowledge Base">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Knowledge Base</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Settings">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Settings</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Guide</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">No Subtopic Selected</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard">📊 Dashboard </button>
          <a href="https://forms.gle/61hYjvwAkR328EaC9" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Send your feedback">💬 Feedback</a>
          <button class="btn ghost small" id="btnExport" title="Export JSON">⬇️ Export File</button>
          <label class="btn ghost small" for="importFile" title="Import JSON">⬆️ Import File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Show/Hide Interface">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Fullscreen">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Welcome to the Pomodoro Study App!</h3>
                <p>Get started by selecting a <strong>Subtopic</strong> or creating a new Topic/Subtopic.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Create New Topic</button>
            </div>
            <div class="presets" role="group" aria-label="Choose preset mode">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">STATUS</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Wind-down Checklist</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Save your current work (Save/Commit).</li>
                <li>Jot down the "Next step".</li>
                <li>Tidy up your workspace.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Start (Space)">▶️ Start</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="End focus session">🧘 Start Break</button>
              <button class="btn" id="btnPause" aria-label="Pause (Space)">⏸️ Pause</button>
              <button class="btn" id="btnResume" aria-label="Resume (Space)">⏵ Resume</button>
              <button class="btn warn" id="btnSkip" aria-label="Skip (N)">⏭️ Skip</button>
              <button class="btn danger" id="btnReset">↺ Reset</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Break Early</button>
            </div>
            <div class="tiny">Shortcuts: <strong>Space</strong> = Start/Pause/Resume, <strong>N</strong> = Next/Skip</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Tasks</button>
                <button class="tab-btn" data-tab="notes">Notes</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-dos for this subtopic:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Add a new task..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Add</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Add a new note..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Add Note</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini for: <span id="currentSubtopicNameChat">(none selected)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Clear History">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Explain the key concepts of this topic">Explain Concept</button>
                  <button class="btn small ghost" data-prompt="Create a detailed outline for this topic">Create Outline</button>
                  <button class="btn small ghost" data-prompt="List 5 important review questions for this topic">Create Review Questions</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Ask Gemini something..." />
                  <button id="btnSendMessage" class="btn acc">Send</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Topic Management</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Add Topic</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Click the arrow to expand/collapse the subtopic list.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Statistics & History — <span id="currentSubtopicName">(none selected)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Total Time</h4><div class="stat-value" id="statTotal">0 min</div></div>
              <div class="stat-card"><h4>Sessions</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Tasks Completed</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">History (FOCUS)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Knowledge Base per Subtopic</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Add Knowledge</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Click on an item to see details.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Discover the Pomodoro Study App</h3>
              <p>
                  Welcome to a study space designed for focus and efficiency. Explore the features that support your learning journey.
              </p>

              <h4>🚀 Quick Start in 4 Steps</h4>
              <p>To keep your journey organized, the app uses a <strong>Main Topic → Subtopic</strong> structure.</p>
              <ol>
                  <li>Open <strong>📚 Topics</strong> from the side navigation.</li>
                  <li>Click <strong>＋ Add Topic</strong> to create a main area (e.g., "Conversational English").</li>
                  <li>Next to the topic, click <strong>＋ Add</strong> to create a more specific subtopic (e.g., "Lesson 1: Practice IPA").</li>
                  <li>Select that subtopic. You’re now ready to start your first focus session!</li>
              </ol>

              <hr />
              <h4>✨ Notable Features</h4>

              <h4>Flexible Timer Modes ⏱️</h4>
              <p>The app offers more than Pomodoro. Pick what fits your work:</p>
              <ul>
                  <li><strong>Classic Pomodoro (Style A/B):</strong> Focus in fixed sessions (e.g., 25 min work, 5 min break) to build discipline and cadence.</li>
                  <li><strong>Flowtime Mode (Style 🌊 Flow):</strong> Ideal for deep work. The timer counts up; end when it feels right. Break time is suggested based on your focus time.</li>
                  <li><strong>Wind-down Buffer:</strong> A customizable buffer between focus and break to wrap up, jot the next step, and switch smoothly—without abrupt cutoffs.</li>
              </ul>

              <h4>Knowledge Base Per Subtopic 💡</h4>
              <p>
                  Each <strong>Subtopic</strong> now has its own dedicated Knowledge Base. This lets you build a focused library of methods and notes that only relate to what you’re studying in that subtopic.
              </p>
              <p>
                  For example, notes and methods for “Conversational English” will only appear when that subtopic is selected and won’t mix with formulas from a subtopic like “Calculus”.
              </p>
              <p>
                  The rich editor still lets you format headings, bold key points, create lists, and highlight important information for each subject.
              </p>

              <h4>Visual Topic Management</h4>
              <p>Easily organize your study goals. Use <strong>drag and drop</strong> to reorder Topics or move Subtopics across topics intuitively.</p>

              <h4>Integrated Tasks & Notes 📝</h4>
              <p>Right within the timer view, create to-dos for each subtopic and jot quick notes without breaking your flow.</p>

              <h4>Zen Mode 🧘</h4>
              <p>When you need absolute focus, click the eye icon (👁️). The interface hides, leaving only the background and timer. You can <strong>drag the timer</strong> anywhere for a clean workspace.</p>

              <h4>Statistics & Milestones 🏆</h4>
              <p>Track your journey through meaningful numbers. The app records and celebrates important focus-time milestones—turning effort into achievements.</p>

              <hr />
              <h4>⌨️ Smart Shortcuts</h4>
              <ul>
                  <li><kbd>Space</kbd>: Start / Pause / Resume the session.</li>
                  <li><kbd>N</kbd>: Skip the current focus or break session.</li>
                  <li><kbd>Esc</kbd>: Close open dialogs (e.g., Settings).</li>
              </ul>

              <hr />
              <h4>🛠️ Advanced Settings & Integrations</h4>

              <h4>Gemini AI Assistant 🧠</h4>
              <p>Turn the app into a smart study companion. Beyond Q&A, you can:</p>
              <ul>
                  <li><strong>Smart Auto-formatting:</strong> While writing under "Methods", let AI analyze and format your raw text—detect headings, bold key ideas, and lists.</li>
                  <li><strong>Setup:</strong> Visit Google AI Studio to create a free API Key and paste it into "Gemini API Key" in Settings.</li>
              </ul>

              <h4>Customize Interface & Sound 🎨</h4>
              <p>Make the workspace yours:</p>
              <ul>
                  <li><strong>Multiple Themes & Backgrounds:</strong> Choose from built-in themes (Light, Dark, Pastel...) or <strong>upload your own background</strong> for inspiration.</li>
                  <li><strong>Custom Alerts:</strong> <strong>Upload your own audio files (.mp3, .wav...)</strong> as alert sounds for focus and breaks.</li>
              </ul>

              <h4>YouTube Background Music 🎶</h4>
              <p>Create the perfect study ambiance by playing a YouTube video or playlist as background music. Paste the URL into the "YouTube Background Music" field in Settings.</p>

              <h4>Data Safety: Backup & Restore 🛡️</h4>
              <p>The app automatically backs up your progress daily. Customize how many days to keep and restore data from a previous day if needed. ⚠️ <strong>Warning:</strong> Restore will overwrite your current data.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Congratulations!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Continue the journey!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Settings</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Timer</button>
              <button class="tab-btn" data-tab="settings-ui">Interface & Sound</button>
              <button class="tab-btn" data-tab="settings-integrations">Integrations</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Style A </button>
                      <button class="btn ghost" data-preset-target="B"> Style B </button>
                      <button class="btn ghost" data-preset-target="C"> Style C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Pomodoro Durations</h4>
                      <div class="row">
                          <label>FOCUS (minutes)<input type="number" id="set_work" min="1" /></label>
                          <label>WIND-DOWN (minutes)<input type="number" id="set_winddown" min="0" /></label>
                          <label>SHORT BREAK (minutes)<input type="number" id="set_short" min="1" /></label>
                          <label>LONG BREAK (minutes)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Pomodoro Cycles<input type="number" id="set_cycles" min="1" /></label>
                          <label>Long Break Interval<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Break Ratio (Work / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Tip: Break time = total focus time / X. Default is 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Automatically start next session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Enable Wind-down after focus session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Prompt for note after each session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Interface</h4>
                      <div class="row">
                          <label>UI Theme
                                <select id="set_theme_color">
                                    <option value="default">Default (Dark Blue)</option>
                                    <option value="light">Light - Milk Tea</option>
                                    <option value="pastel">Pastel - Soft</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Background Display Mode
                              <select id="set_backgroundMode">
                                  <option value="cover">Cover (Default)</option>
                                  <option value="contain">Contain (Sharp)</option>
                                  <option value="auto">Original Size (Repeat)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Background Image
                              <label class="btn small ghost" for="uploadBg">Upload New Image</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Clear Background</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Panel Opacity</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Sound</h4>
                      <div class="row">
                          <label>Volume (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Alert Style
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Customize Alerts</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Alert at end of FOCUS</small>
                              <label title="Alert at end of FOCUS" class="btn small ghost" for="uploadSoundWork">FOCUS</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of SHORT BREAK</small>
                              <label title="Alert at end of SHORT BREAK" class="btn small ghost" for="uploadSoundBreak">SHORT BREAK</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of LONG BREAK</small>
                              <label title="Alert at end of LONG BREAK" class="btn small ghost" for="uploadSoundLong">LONG BREAK</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>AI Integration</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Paste your API Key here..." />
                      </label>
                      <div class="tiny">Required to use AI features. Get a free key at <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 YouTube Background Music</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Paste YouTube link here..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Use video thumbnail as background</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Stopping will not auto-play again until you press ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Volume</div>
                  </div>
                  <div>
                      <h4>🛡️ Backup Settings</h4>
                      <div class="row">
                          <label>Number of backup days to keep
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Restore Data</h4>
                      <p class="tiny">Restore from an automatic daily backup. This action will overwrite your current data.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Restore</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Defaults</button>
              <button class="btn acc" id="btnSaveSettings">Save</button>
              <button class="btn" id="btnCloseSettings">Close</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Note for the completed session</h3>
      <div class="row"><textarea id="noteText" placeholder="What did you learn? Any difficulties? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Summarize & Suggest</button>
        <button class="btn" id="btnSkipNote">Skip</button>
        <button class="btn acc" id="btnSaveNote">Save Note</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Title</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Cancel</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Dashboard</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Close</button>
        </div>
        <p class="tiny">Summary of time and sessions completed across all topics.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Edit Method</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Title<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Content</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Small heading">H</button>
          <button id="toolBold" class="btn small ghost" title="Bold">B</button>
          <button id="toolItalic" class="btn small ghost" title="Italic">I</button>
          <button id="toolList" class="btn small ghost" title="Numbered list">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Bulleted list">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Text color">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Default text color"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Accent color"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Positive color"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Warning color"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Danger color"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Purple"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="This feature requires a Gemini API Key">✨ Auto-format</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Cancel</button>
          <button class="btn acc" id="btnSaveMethod">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Press "Enable Sound" to allow background audio.</span>
    <button id="btnEnableSound" class="btn small acc">Enable Sound</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
   const _0x174741=_0x3fc1;(function(_0x486ec0,_0x1c727){const _0x1ee04e=_0x3fc1,_0x5e0036=_0x486ec0();while(!![]){try{const _0x334f49=parseInt(_0x1ee04e(0x45a))/0x1*(-parseInt(_0x1ee04e(0x3f7))/0x2)+-parseInt(_0x1ee04e(0x1f8))/0x3+parseInt(_0x1ee04e(0x2b0))/0x4+-parseInt(_0x1ee04e(0x347))/0x5*(-parseInt(_0x1ee04e(0x179))/0x6)+parseInt(_0x1ee04e(0x35b))/0x7+-parseInt(_0x1ee04e(0x40a))/0x8+-parseInt(_0x1ee04e(0x1be))/0x9*(-parseInt(_0x1ee04e(0x398))/0xa);if(_0x334f49===_0x1c727)break;else _0x5e0036['push'](_0x5e0036['shift']());}catch(_0x2c6a63){_0x5e0036['push'](_0x5e0036['shift']());}}}(_0x38e1,0x7ed98),window[_0x174741(0x26f)](_0x174741(0x14c),()=>{try{updateFullscreenButton();}catch(_0x524035){}}));const IS_FILE_PROTOCOL=window[_0x174741(0x39b)][_0x174741(0x364)]===_0x174741(0x2f9);function startYtApiWatchdog(){const _0x69e695=_0x174741,_0x3fd7f5=document[_0x69e695(0x329)]('ytUrlFeedback');if(!_0x3fd7f5)return;const _0x213630=setTimeout(()=>{const _0x83e074=_0x69e695;try{(!window['YT']||!window['YT']['Player'])&&(_0x3fd7f5[_0x83e074(0x38e)]='Loading\x20YouTube\x20API...',_0x3fd7f5[_0x83e074(0x385)][_0x83e074(0x195)]=_0x83e074(0x1d5));}catch(_0x5d4341){}},0x5dc),_0x39b034=setTimeout(()=>{const _0x1571ab=_0x69e695;try{(!window['YT']||!window['YT'][_0x1571ab(0x1a2)])&&(_0x3fd7f5['textContent']='Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.',_0x3fd7f5[_0x1571ab(0x385)]['color']=_0x1571ab(0x27e));}catch(_0x334b0e){}},0x1b58);window[_0x69e695(0x3ad)]={'cancel'(){clearTimeout(_0x213630),clearTimeout(_0x39b034);}};}(function(){const _0x4f3a4f=_0x174741,_0x361de9={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x4f3a4f(0x155)+current+'/'+target,'timer.selectSubtopicPrompt':_0x4f3a4f(0x438)};window['t']=function _0x5c9dba(_0x4ecbb2,_0x568009){const _0x1b0be1=_0x4f3a4f;try{const _0x4463ee=_0x361de9[_0x4ecbb2];if(typeof _0x4463ee===_0x1b0be1(0x29f))return _0x4463ee(_0x568009||{});if(typeof _0x4463ee===_0x1b0be1(0x413))return _0x4463ee;}catch(_0x1971e5){}return _0x4ecbb2;},window[_0x4f3a4f(0x230)]=function _0x41bd6d(_0x540778){const _0x2f1b21=_0x4f3a4f;try{localStorage[_0x2f1b21(0x450)]('lang',_0x540778||'en');}catch(_0x459c3a){}return Promise['resolve']();};}());function ensureYouTubeAPI(){const _0x3262ac=_0x174741;if(IS_FILE_PROTOCOL)return Promise[_0x3262ac(0x2a7)](![]);try{if(window['YT']&&window['YT'][_0x3262ac(0x1a2)])return Promise['resolve'](!![]);}catch(_0x535076){}if(window['__ytApiPromise'])return window[_0x3262ac(0x35c)];return startYtApiWatchdog(),window[_0x3262ac(0x35c)]=new Promise((_0x1f0fe9,_0x34ee8a)=>{const _0x33a884=_0x3262ac;try{const _0x43f613=document['createElement'](_0x33a884(0x19e));_0x43f613['src']=_0x33a884(0x355),_0x43f613[_0x33a884(0x26b)]=!![],_0x43f613[_0x33a884(0x282)]=!![],_0x43f613[_0x33a884(0x41c)]=()=>_0x1f0fe9(!![]),_0x43f613['onerror']=()=>_0x34ee8a(new Error(_0x33a884(0x19d))),document[_0x33a884(0x285)][_0x33a884(0x3d6)](_0x43f613);}catch(_0x21bde9){_0x34ee8a(_0x21bde9);}}),window[_0x3262ac(0x35c)];}const storageManager={'DB_NAME':'PomodoroAppDB','DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x14a8fa,_0xc01b6d)=>{const _0x27b1c5=_0x3fc1;if(this['db'])return _0x14a8fa(this['db']);const _0x5a6fb9=indexedDB[_0x27b1c5(0x2c8)](this['DB_NAME'],this[_0x27b1c5(0x436)]);_0x5a6fb9[_0x27b1c5(0x349)]=_0x574097=>{const _0x2cb792=_0x27b1c5,_0x197af1=_0x574097[_0x2cb792(0x1cb)][_0x2cb792(0x33a)];!_0x197af1[_0x2cb792(0x2fc)][_0x2cb792(0x42e)]('settings')&&_0x197af1[_0x2cb792(0x437)]('settings');!_0x197af1[_0x2cb792(0x2fc)][_0x2cb792(0x42e)](_0x2cb792(0x254))&&_0x197af1[_0x2cb792(0x437)](_0x2cb792(0x254),{'keyPath':'id'});if(!_0x197af1['objectStoreNames'][_0x2cb792(0x42e)](_0x2cb792(0x25a))){const _0x553470=_0x197af1['createObjectStore'](_0x2cb792(0x25a),{'keyPath':'id'});_0x553470['createIndex'](_0x2cb792(0x343),'topicId');}!_0x197af1[_0x2cb792(0x2fc)][_0x2cb792(0x42e)](_0x2cb792(0x456))&&_0x197af1[_0x2cb792(0x437)](_0x2cb792(0x456),{'keyPath':'date'});},_0x5a6fb9[_0x27b1c5(0x1eb)]=_0x147dfa=>{const _0x495b66=_0x27b1c5;this['db']=_0x147dfa['target'][_0x495b66(0x33a)],console[_0x495b66(0x1e7)](_0x495b66(0x3ef)),_0x14a8fa(this['db']);},_0x5a6fb9['onerror']=_0x35cd84=>{const _0x55352a=_0x27b1c5;console[_0x55352a(0x3ce)]('IndexedDB\x20error:',_0x35cd84[_0x55352a(0x1cb)][_0x55352a(0x1a6)]),_0xc01b6d(_0x35cd84['target'][_0x55352a(0x3ce)]);};});},async '_getStore'(_0x1845fe,_0x46df09='readonly'){const _0x4d79ad=_0x174741;await this['initDB']();const _0x4c2a29=this['db'][_0x4d79ad(0x2a2)]([_0x1845fe],_0x46df09);return _0x4c2a29[_0x4d79ad(0x38c)](_0x1845fe);},async 'getSettings'(){const _0xd16e3a=_0x174741,_0x5c0166=await this['_getStore'](_0xd16e3a(0x42f));return new Promise((_0x4b83c2,_0x2aad55)=>{const _0x357337=_0xd16e3a,_0x308f64=_0x5c0166[_0x357337(0x37e)](_0x357337(0x1ee));_0x308f64[_0x357337(0x1eb)]=()=>_0x4b83c2(_0x308f64[_0x357337(0x33a)]),_0x308f64[_0x357337(0x2da)]=()=>_0x2aad55(_0x308f64[_0x357337(0x3ce)]);});},async 'updateSettings'(_0x2d985c){const _0x2eb3f1=_0x174741,_0x1dc598=await this[_0x2eb3f1(0x21e)](_0x2eb3f1(0x42f),_0x2eb3f1(0x3fa));return new Promise((_0x568a91,_0x219ec3)=>{const _0x2e139e=_0x2eb3f1,_0x246c51=_0x1dc598[_0x2e139e(0x459)](_0x2d985c,_0x2e139e(0x1ee));_0x246c51[_0x2e139e(0x1eb)]=()=>_0x568a91(_0x246c51[_0x2e139e(0x33a)]),_0x246c51[_0x2e139e(0x2da)]=()=>_0x219ec3(_0x246c51[_0x2e139e(0x3ce)]);});},async 'getAll'(_0x1ddf96){const _0x47c71c=_0x174741,_0x2ed605=await this[_0x47c71c(0x21e)](_0x1ddf96);return new Promise((_0x3e60b9,_0x4a4da6)=>{const _0xdb7076=_0x47c71c,_0x115e85=_0x2ed605[_0xdb7076(0x19c)]();_0x115e85[_0xdb7076(0x1eb)]=()=>_0x3e60b9(_0x115e85[_0xdb7076(0x33a)]),_0x115e85[_0xdb7076(0x2da)]=()=>_0x4a4da6(_0x115e85['error']);});},async 'update'(_0x255de1,_0x4729fc){const _0x5582b7=_0x174741,_0x2e4140=await this[_0x5582b7(0x21e)](_0x255de1,_0x5582b7(0x3fa));return new Promise((_0x1c9877,_0x1223cf)=>{const _0x544da8=_0x5582b7,_0x4e771a=_0x2e4140[_0x544da8(0x459)](_0x4729fc);_0x4e771a[_0x544da8(0x1eb)]=()=>_0x1c9877(_0x4e771a[_0x544da8(0x33a)]),_0x4e771a[_0x544da8(0x2da)]=()=>_0x1223cf(_0x4e771a[_0x544da8(0x3ce)]);});},async 'add'(_0x20f450,_0x9e0160){const _0x40a926=_0x174741,_0x231c67=await this[_0x40a926(0x21e)](_0x20f450,_0x40a926(0x3fa));return new Promise((_0x149244,_0xcd028f)=>{const _0x537ab0=_0x40a926,_0x4db92a=_0x231c67[_0x537ab0(0x2be)](_0x9e0160);_0x4db92a[_0x537ab0(0x1eb)]=()=>_0x149244(_0x4db92a[_0x537ab0(0x33a)]),_0x4db92a[_0x537ab0(0x2da)]=()=>_0xcd028f(_0x4db92a['error']);});},async 'delete'(_0x31898e,_0x389b48){const _0x5ae829=await this['_getStore'](_0x31898e,'readwrite');return new Promise((_0x489a13,_0x3c7ea9)=>{const _0x587e5c=_0x3fc1,_0x387312=_0x5ae829[_0x587e5c(0x261)](_0x389b48);_0x387312['onsuccess']=()=>_0x489a13(_0x387312['result']),_0x387312[_0x587e5c(0x2da)]=()=>_0x3c7ea9(_0x387312[_0x587e5c(0x3ce)]);});},async 'save'(_0x4498cb){const _0x2485a9=_0x174741;return await this[_0x2485a9(0x258)](),new Promise((_0x2fe79d,_0x18e715)=>{const _0x3bdfcf=_0x2485a9,_0x2eb9f7=this['db'][_0x3bdfcf(0x2a2)](['settings','topics',_0x3bdfcf(0x25a)],_0x3bdfcf(0x3fa)),_0x23359b=_0x2eb9f7['objectStore'](_0x3bdfcf(0x42f)),_0x280934=_0x2eb9f7[_0x3bdfcf(0x38c)](_0x3bdfcf(0x254)),_0x14b9d4=_0x2eb9f7[_0x3bdfcf(0x38c)](_0x3bdfcf(0x25a));_0x23359b[_0x3bdfcf(0x459)](_0x4498cb[_0x3bdfcf(0x42f)],_0x3bdfcf(0x1ee)),_0x280934[_0x3bdfcf(0x298)](),_0x14b9d4[_0x3bdfcf(0x298)](),_0x4498cb[_0x3bdfcf(0x254)]['forEach'](_0x4bddb4=>{const _0x59b485=_0x3bdfcf,{subtopics:_0x1ab167,..._0x3d6fce}=_0x4bddb4;_0x280934[_0x59b485(0x459)](_0x3d6fce),(_0x1ab167||[])[_0x59b485(0x14e)](_0x29b73b=>_0x14b9d4[_0x59b485(0x459)](_0x29b73b));}),_0x2eb9f7['oncomplete']=()=>_0x2fe79d(),_0x2eb9f7[_0x3bdfcf(0x2da)]=_0x531d31=>_0x18e715(_0x531d31['target']['error']);});},async 'autoBackup'(_0x460233){const _0xf58306=_0x174741;await this['initDB']();const _0x173e32=new Date()[_0xf58306(0x302)]()[_0xf58306(0x2fe)](0x0,0xa),_0x4e8ceb=localStorage['getItem'](_0xf58306(0x41b));if(_0x173e32!==_0x4e8ceb){console[_0xf58306(0x1e7)](_0xf58306(0x255)+_0x173e32+'...');const _0x2026fa={'date':_0x173e32,'data':JSON['parse'](JSON[_0xf58306(0x2ac)](_0x460233))},_0x49061b=this['db'][_0xf58306(0x2a2)]([_0xf58306(0x456)],_0xf58306(0x3fa)),_0x3c59bb=_0x49061b['objectStore'](_0xf58306(0x456)),_0x11d63f=_0x3c59bb[_0xf58306(0x459)](_0x2026fa);_0x11d63f[_0xf58306(0x1eb)]=()=>{const _0x491de0=_0xf58306;localStorage[_0x491de0(0x450)](_0x491de0(0x41b),_0x173e32),console['log'](_0x491de0(0x36f)),this[_0x491de0(0x158)](_0x460233?.[_0x491de0(0x42f)]?.['backupDaysToKeep']||0x7);},_0x11d63f[_0xf58306(0x2da)]=_0x333edd=>{const _0x337b91=_0xf58306;console['error'](_0x337b91(0x190),_0x333edd[_0x337b91(0x1cb)][_0x337b91(0x3ce)]);};}},async 'cleanupOldBackups'(_0x2c9e72){const _0x25f28=_0x174741;await this['initDB']();const _0x103fa7=this['db'][_0x25f28(0x2a2)]([_0x25f28(0x456)],_0x25f28(0x3fa)),_0x1165de=_0x103fa7[_0x25f28(0x38c)](_0x25f28(0x456)),_0x8b35db=_0x1165de['getAllKeys']();_0x8b35db[_0x25f28(0x1eb)]=()=>{const _0x15d315=_0x25f28,_0xd0be2e=_0x8b35db[_0x15d315(0x33a)][_0x15d315(0x2f0)]()[_0x15d315(0x401)]();if(_0xd0be2e[_0x15d315(0x26c)]>_0x2c9e72){const _0x30ad0a=_0xd0be2e[_0x15d315(0x2fe)](_0x2c9e72);_0x30ad0a[_0x15d315(0x14e)](_0x2f397e=>{const _0x5ac98f=_0x15d315;_0x1165de[_0x5ac98f(0x261)](_0x2f397e),console[_0x5ac98f(0x1e7)](_0x5ac98f(0x242)+_0x2f397e);});}};},async 'getBackupList'(){const _0x55c9d2=_0x174741;return await this[_0x55c9d2(0x258)](),new Promise((_0x3e0cd0,_0x4a2377)=>{const _0x4a3e78=_0x55c9d2,_0x3f3c7c=this['db'][_0x4a3e78(0x2a2)]([_0x4a3e78(0x456)],_0x4a3e78(0x20e)),_0x34f51f=_0x3f3c7c[_0x4a3e78(0x38c)]('backups'),_0x7a478b=_0x34f51f[_0x4a3e78(0x19c)]();_0x7a478b[_0x4a3e78(0x1eb)]=()=>_0x3e0cd0(_0x7a478b[_0x4a3e78(0x33a)][_0x4a3e78(0x2f0)]((_0x4e5e82,_0x12c7cb)=>_0x12c7cb['date'][_0x4a3e78(0x435)](_0x4e5e82[_0x4a3e78(0x23e)]))),_0x7a478b['onerror']=_0x4213bc=>_0x4a2377(_0x4213bc[_0x4a3e78(0x1cb)]['error']);});},async 'restoreBackup'(_0x1e6d04){const _0x78fdf6=_0x174741;return await this[_0x78fdf6(0x258)](),new Promise((_0xb3e7aa,_0x3e7b1c)=>{const _0x43ad19=_0x78fdf6,_0x442263=this['db'][_0x43ad19(0x2a2)]([_0x43ad19(0x456)],_0x43ad19(0x20e)),_0x8a95bd=_0x442263[_0x43ad19(0x38c)](_0x43ad19(0x456)),_0x2b136e=_0x8a95bd[_0x43ad19(0x37e)](_0x1e6d04);_0x2b136e[_0x43ad19(0x1eb)]=()=>{const _0x181d25=_0x43ad19;_0x2b136e[_0x181d25(0x33a)]&&_0x2b136e[_0x181d25(0x33a)][_0x181d25(0x2cb)]?(localStorage[_0x181d25(0x450)](_0x181d25(0x336),JSON['stringify'](_0x2b136e['result'][_0x181d25(0x2cb)])),_0xb3e7aa(_0x2b136e['result']['data'])):_0x3e7b1c(new Error(_0x181d25(0x344)));},_0x2b136e[_0x43ad19(0x2da)]=_0x53f75a=>_0x3e7b1c(_0x53f75a['target'][_0x43ad19(0x3ce)]);});},'exportData'(_0x530f3e){const _0x348b24=_0x174741;let _0x41dc99={};try{_0x41dc99=JSON[_0x348b24(0x37c)](JSON[_0x348b24(0x2ac)](_0x530f3e||{}));}catch(_0x483d88){_0x41dc99=_0x530f3e;}try{if(_0x41dc99&&_0x41dc99[_0x348b24(0x42f)])_0x41dc99[_0x348b24(0x42f)][_0x348b24(0x1b9)]='';}catch(_0x58831c){}const _0x3d288a=new Blob([JSON[_0x348b24(0x2ac)](_0x41dc99,null,0x2)],{'type':_0x348b24(0x197)}),_0x2b3a21=document[_0x348b24(0x39d)]('a'),_0x42d50b=new Date(),_0x240e11=_0x212776=>(''+_0x212776)[_0x348b24(0x20a)](0x2,'0');_0x2b3a21[_0x348b24(0x1c6)]=URL[_0x348b24(0x141)](_0x3d288a),_0x2b3a21[_0x348b24(0x3dc)]=_0x348b24(0x1e4)+_0x42d50b['getFullYear']()+_0x240e11(_0x42d50b[_0x348b24(0x199)]()+0x1)+_0x240e11(_0x42d50b[_0x348b24(0x181)]())+_0x348b24(0x3e4),_0x2b3a21['click'](),URL[_0x348b24(0x25e)](_0x2b3a21[_0x348b24(0x1c6)]);},async 'importData'(_0x31becc){const _0x5a95f2=_0x174741,_0xf0a11=await _0x31becc[_0x5a95f2(0x2aa)](),_0x373b6e=JSON[_0x5a95f2(0x37c)](_0xf0a11);if(!_0x373b6e['version']||!_0x373b6e['settings']||!Array[_0x5a95f2(0x1f4)](_0x373b6e['topics']))throw new Error(_0x5a95f2(0x19f));try{const _0x1d8c1c=window[_0x5a95f2(0x2cb)]&&window['data'][_0x5a95f2(0x42f)]&&window[_0x5a95f2(0x2cb)]['settings'][_0x5a95f2(0x1b9)]||'';(!(_0x5a95f2(0x1b9)in _0x373b6e[_0x5a95f2(0x42f)])||_0x373b6e['settings']['apiKey']==='')&&(_0x373b6e[_0x5a95f2(0x42f)]['apiKey']=_0x1d8c1c);}catch(_0x580f0f){}return localStorage[_0x5a95f2(0x450)](_0x5a95f2(0x336),JSON[_0x5a95f2(0x2ac)](_0x373b6e)),_0x373b6e;}},$=(_0x5df079,_0xcdb253=document)=>_0xcdb253[_0x174741(0x331)](_0x5df079),breakSuggestions=[_0x174741(0x165),_0x174741(0x167),_0x174741(0x1a4),'Take\x20a\x20short\x20walk\x20around\x20the\x20room.',_0x174741(0x43d),_0x174741(0x2d5),'Play\x20a\x20favorite\x20song\x20briefly.',_0x174741(0x403),_0x174741(0x151),'Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.',_0x174741(0x160),_0x174741(0x361),'Gently\x20massage\x20your\x20temples.',_0x174741(0x2bd),_0x174741(0x14d),'Ask\x20yourself:\x20‘How\x20do\x20I\x20feel\x20right\x20now?’',_0x174741(0x276),'Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.',_0x174741(0x3b6),_0x174741(0x1dd),_0x174741(0x34c),_0x174741(0x27c),_0x174741(0x268),_0x174741(0x16f),'Stand\x20up\x20and\x20take\x20a\x20few\x20steps.',_0x174741(0x1c8),_0x174741(0x45d),_0x174741(0x30c),'Refuel\x20with\x20a\x20healthy\x20snack.',_0x174741(0x31b),_0x174741(0x1d4),_0x174741(0x2e6)],$$=(_0x5a04eb,_0x5dc419=document)=>Array['from'](_0x5dc419[_0x174741(0x145)](_0x5a04eb));function on(_0x50a413,_0x36d313,_0x50e18d){const _0x5cceed=_0x174741;if(!_0x50a413){console[_0x5cceed(0x136)]('Missing\x20element',_0x36d313);return;}_0x50a413[_0x5cceed(0x26f)](_0x36d313,_0x50e18d);}const formatMMSS=_0x414670=>{const _0x28e0c3=_0x174741,_0x34b5b2=Math['floor'](_0x414670/0x3c)['toString']()['padStart'](0x2,'0'),_0x2ee9f9=Math['floor'](_0x414670%0x3c)['toString']()[_0x28e0c3(0x20a)](0x2,'0');return _0x34b5b2+':'+_0x2ee9f9;},uid=(_0x53f628='id')=>_0x53f628+'_'+Date[_0x174741(0x2ce)]()+'_'+Math[_0x174741(0x1fd)]()[_0x174741(0x297)](0x24)[_0x174741(0x2fe)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x403b1e){const _0x6f0f46=_0x174741;try{const _0x2d9974=_0x403b1e['querySelectorAll'](_0x6f0f46(0x3e8));if(!_0x2d9974['length'])return;const _0x21975f=_0x2d9974[0x0],_0x442d15=_0x2d9974[_0x2d9974[_0x6f0f46(0x26c)]-0x1],_0x48475b=_0x3045ec=>{const _0x358f55=_0x6f0f46;if(_0x3045ec['key']===_0x358f55(0x1a1)){if(_0x3045ec[_0x358f55(0x157)]&&document[_0x358f55(0x40f)]===_0x21975f)_0x3045ec['preventDefault'](),_0x442d15[_0x358f55(0x2db)]();else!_0x3045ec[_0x358f55(0x157)]&&document[_0x358f55(0x40f)]===_0x442d15&&(_0x3045ec['preventDefault'](),_0x21975f[_0x358f55(0x2db)]());}};_0x403b1e['addEventListener'](_0x6f0f46(0x359),_0x48475b),_0x21975f['focus'](),__releaseFocusTrap=()=>{const _0x1d48d5=_0x6f0f46;try{_0x403b1e[_0x1d48d5(0x2ea)](_0x1d48d5(0x359),_0x48475b);}catch(_0x2798a6){}};}catch(_0x89918b){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x5e6f67){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x174741(0x302)]();function toast(_0x4b24ec,_0x27f1c0=0xa28){const _0xd8a6b2=_0x174741,_0x10ddec=$(_0xd8a6b2(0x27b)),_0x530b60=document[_0xd8a6b2(0x39d)](_0xd8a6b2(0x2d1));_0x530b60[_0xd8a6b2(0x3bc)]=_0xd8a6b2(0x3d5),_0x530b60['textContent']=_0x4b24ec,_0x10ddec[_0xd8a6b2(0x3d6)](_0x530b60),setTimeout(()=>{const _0x47cbbe=_0xd8a6b2;_0x530b60['style'][_0x47cbbe(0x149)]='0';},_0x27f1c0-0x12c),setTimeout(()=>_0x10ddec['removeChild'](_0x530b60),_0x27f1c0);}function escapeHTML(_0x4a1dac){const _0x1617de=_0x174741;return _0x4a1dac['replace'](/[&<>"']/g,_0x92917d=>({'&':_0x1617de(0x214),'<':_0x1617de(0x20d),'>':_0x1617de(0x394),'\x22':_0x1617de(0x314),'\x27':'&#39;'}[_0x92917d]));}function formatDaysHoursMinutes(_0x31b38c){const _0x4ba784=_0x174741;if(!_0x31b38c||_0x31b38c<0x1)return _0x4ba784(0x3cc);const _0xcdc6c5=Math[_0x4ba784(0x340)](_0x31b38c/0x3c),_0x509830=_0x31b38c%0x3c,_0x4cab63=_0x509830[_0x4ba784(0x297)]()[_0x4ba784(0x20a)](0x2,'0');return _0xcdc6c5+_0x4ba784(0x1fe)+_0x4cab63+'\x20min';}function formatGeminiResponse(_0x5681b7){return _0x5681b7['replace'](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0xc0f225){const _0x34777a=_0x174741,_0x32fc2d=(_0xc0f225||'')[_0x34777a(0x219)]('\x0a');let _0x58ff4e='',_0x5d4cc8=null;const _0x459e5a=()=>{const _0x20edee=_0x34777a;_0x5d4cc8&&(_0x58ff4e+=_0x5d4cc8==='ol'?_0x20edee(0x2f4):'</ul>',_0x5d4cc8=null);};for(let _0x463278 of _0x32fc2d){let _0x58c3f9=(_0x463278||'')['trim']();if(!_0x58c3f9){_0x459e5a();continue;}if(_0x58c3f9['startsWith'](_0x34777a(0x433)))_0x459e5a(),_0x58ff4e+=_0x34777a(0x2d3)+escapeHTML(_0x58c3f9[_0x34777a(0x2e7)](0x5))+'</h4>';else{if(/^\d+\.\s/[_0x34777a(0x13e)](_0x58c3f9)){_0x5d4cc8!=='ol'&&(_0x459e5a(),_0x58ff4e+=_0x34777a(0x3e6),_0x5d4cc8='ol');const _0x5ce8da=_0x58c3f9['substring'](_0x58c3f9[_0x34777a(0x43f)]('\x20')+0x1);_0x58ff4e+=_0x34777a(0x180)+escapeHTML(_0x5ce8da)+_0x34777a(0x448);}else _0x58c3f9[_0x34777a(0x33d)]('-\x20')?(_0x5d4cc8!=='ul'&&(_0x459e5a(),_0x58ff4e+='<ul>',_0x5d4cc8='ul'),_0x58ff4e+=_0x34777a(0x180)+escapeHTML(_0x58c3f9[_0x34777a(0x2e7)](0x2))+_0x34777a(0x448)):(_0x459e5a(),_0x58c3f9=escapeHTML(_0x58c3f9)[_0x34777a(0x454)](/\*\*(.*?)\*\*/g,_0x34777a(0x147))[_0x34777a(0x454)](/_(.*?)_/g,_0x34777a(0x372)),_0x58ff4e+=_0x34777a(0x303)+_0x58c3f9+'</p>');}}return _0x459e5a(),_0x58ff4e;}function wrapTextInMarkdown(_0x4c3757,_0x549614,_0x24385a=''){const _0x3277b5=_0x174741;if(!_0x4c3757)return;const _0x295938=_0x4c3757[_0x3277b5(0x41f)]||0x0,_0x33fb4c=_0x4c3757[_0x3277b5(0x335)]||0x0,_0x160ef6=_0x4c3757[_0x3277b5(0x262)][_0x3277b5(0x2e7)](_0x295938,_0x33fb4c),_0x4dd8c4=_0x549614+_0x160ef6+(_0x24385a||_0x549614);_0x4c3757[_0x3277b5(0x17a)](_0x4dd8c4,_0x295938,_0x33fb4c,'end'),_0x4c3757[_0x3277b5(0x2db)]();}function updateEditorPreview(){const _0x4c5ecc=_0x174741,_0x2630a8=$(_0x4c5ecc(0x2fd)),_0x462334=$(_0x4c5ecc(0x229));if(!_0x2630a8||!_0x462334)return;const _0x3381af=_0x2630a8['value']||'';_0x462334['innerHTML']=parseSimpleMarkdown(_0x3381af);}function normalizeDataStructure(_0x32f97a){const _0x284465=_0x174741;if(!_0x32f97a||typeof _0x32f97a!=='object')return;const _0x3dda8b=_0x32f97a[_0x284465(0x42f)]||{},_0x5e67cc={...defaults[_0x284465(0x42f)],..._0x3dda8b,'durations':{...defaults[_0x284465(0x42f)][_0x284465(0x1b2)],..._0x3dda8b['durations']||{}}};if(!Array[_0x284465(0x1f4)](_0x5e67cc[_0x284465(0x446)]))_0x5e67cc['achievedMilestones']=[];_0x32f97a[_0x284465(0x42f)]=_0x5e67cc,_0x32f97a[_0x284465(0x254)]=Array['isArray'](_0x32f97a[_0x284465(0x254)])?_0x32f97a[_0x284465(0x254)]:[],_0x32f97a[_0x284465(0x254)][_0x284465(0x14e)](_0x1425cb=>{const _0x429d57=_0x284465;_0x1425cb[_0x429d57(0x25a)]=Array[_0x429d57(0x1f4)](_0x1425cb[_0x429d57(0x25a)])?_0x1425cb[_0x429d57(0x25a)]:[],_0x1425cb['subtopics']['forEach'](_0x251ddf=>{const _0x4fb81a=_0x429d57;_0x251ddf[_0x4fb81a(0x2ee)]=_0x251ddf[_0x4fb81a(0x2ee)]||[],_0x251ddf['generalNotes']=_0x251ddf[_0x4fb81a(0x3c1)]||[],_0x251ddf[_0x4fb81a(0x3bb)]=_0x251ddf[_0x4fb81a(0x3bb)]||[],_0x251ddf[_0x4fb81a(0x1b7)]=_0x251ddf[_0x4fb81a(0x1b7)]||[],_0x251ddf['methods']=Array[_0x4fb81a(0x1f4)](_0x251ddf[_0x4fb81a(0x36a)])?_0x251ddf[_0x4fb81a(0x36a)]:[],_0x251ddf[_0x4fb81a(0x2d6)]=_0x251ddf[_0x4fb81a(0x2d6)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x251ddf['sessions']=_0x251ddf[_0x4fb81a(0x2f8)]||[],_0x251ddf['timerState']=_0x251ddf['timerState']||{'state':_0x4fb81a(0x23b),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0xc33ab7){const _0x525fa6=_0x174741;if(!_0xc33ab7)return null;const _0x3b6741=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x54b1b7=_0xc33ab7[_0x525fa6(0x34a)](_0x3b6741);return _0x54b1b7?_0x54b1b7[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0xa14bbc=_0x174741;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x12de9c=document[_0xa14bbc(0x329)](_0xa14bbc(0x45e)),_0x371d51=(_0x12de9c&&_0x12de9c[_0xa14bbc(0x262)]?_0x12de9c[_0xa14bbc(0x262)]:'')[_0xa14bbc(0x2ba)]();return _0x371d51;}catch(_0x5736d9){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}async function migrateSharedMethodsToCurrentSubtopic(){const _0x108983=_0x174741;try{const _0x32d673=data?.['settings']?.[_0x108983(0x36a)]||[];if(!Array[_0x108983(0x1f4)](_0x32d673)||_0x32d673[_0x108983(0x26c)]===0x0)return;const _0xb0cf6d=getCurrentSubtopic();if(!_0xb0cf6d)return;(!Array[_0x108983(0x1f4)](_0xb0cf6d[_0x108983(0x36a)])||_0xb0cf6d[_0x108983(0x36a)][_0x108983(0x26c)]===0x0)&&(_0xb0cf6d['methods']=_0x32d673,data[_0x108983(0x42f)]['methods']=[],await saveData());}catch(_0x410298){}}function handleYoutubeUrlInput(){const _0x4e1636=_0x174741,_0x367473=$(_0x4e1636(0x18f)),_0x1e0efd=$(_0x4e1636(0x16b)),_0x31e688=$(_0x4e1636(0x3b7)),_0x5da51c=_0x367473[_0x4e1636(0x262)]['trim'](),_0x22d858=extractYouTubeID(_0x5da51c);if(_0x22d858){_0x1e0efd[_0x4e1636(0x38e)]=_0x4e1636(0x288),_0x1e0efd['style'][_0x4e1636(0x195)]=_0x4e1636(0x1b4),_0x31e688[_0x4e1636(0x28c)]=![],sessionYoutubeUrl=_0x5da51c;try{ytUserPaused=![];}catch(_0x380d55){}try{const _0x3044a5=_0x4e1636(0x1d6)+_0x22d858+'/maxresdefault.jpg',_0x1c8bd0=new Image();_0x1c8bd0[_0x4e1636(0x41c)]=async()=>{const _0x3422fd=_0x4e1636;data[_0x3422fd(0x42f)]['customBg']=_0x3044a5;try{await saveData();}catch(_0x1cbde7){}applyCustomBg();},_0x1c8bd0[_0x4e1636(0x2da)]=async()=>{const _0xb03c07=_0x4e1636,_0x843a7a=_0xb03c07(0x1d6)+_0x22d858+_0xb03c07(0x139);data['settings']['customBg']=_0x843a7a;try{await saveData();}catch(_0x44874e){}applyCustomBg();},_0x1c8bd0[_0x4e1636(0x393)]=_0x3044a5;}catch(_0x38d795){}try{if(IS_FILE_PROTOCOL){const _0x2acd09=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x22d858,{'autoplay':0x1,'mute':_0x2acd09});try{setTimeout(()=>{const _0xa0e970=_0x4e1636;try{fallbackPostMessage(_0xa0e970(0x28b));}catch(_0x1639a4){}},0xfa);}catch(_0x4bf343){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x6aa674=_0x4e1636,_0x409199=document['getElementById'](_0x6aa674(0x3c7));if(_0x409199)_0x409199[_0x6aa674(0x38e)]=_0x6aa674(0x442);},0x1f4);}catch(_0x541fe6){}}else ensureYouTubeAPI()[_0x4e1636(0x26d)](()=>{const _0x12ac70=_0x4e1636;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x12ac70(0x281)]&&ytPlayer[_0x12ac70(0x28b)]&&(ytPlayer['mute'](),ytPlayer['playVideo'](),_ytPrimed=!![],showSoundPermission());}catch(_0x2f2f50){}})['catch'](()=>{});}catch(_0x19ba9e){}}else{if(_0x5da51c===''){_0x1e0efd[_0x4e1636(0x38e)]='',_0x31e688['disabled']=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x19377d){}else ytPlayer&&ytPlayer[_0x4e1636(0x247)]&&ytPlayer[_0x4e1636(0x247)]();}else _0x1e0efd['textContent']=_0x4e1636(0x194),_0x1e0efd[_0x4e1636(0x385)][_0x4e1636(0x195)]=_0x4e1636(0x27e),_0x31e688[_0x4e1636(0x28c)]=!![];}}function applyTheme(_0xac6d9f){const _0x10a0d6=_0x174741,_0x1480f1=_0xac6d9f||data[_0x10a0d6(0x42f)][_0x10a0d6(0x439)]||_0x10a0d6(0x3de);document[_0x10a0d6(0x1d2)][_0x10a0d6(0x31c)][_0x10a0d6(0x439)]=_0x1480f1;const _0x30b0c2=[_0x10a0d6(0x3fd),_0x10a0d6(0x3d2)][_0x10a0d6(0x1ce)](_0x1480f1),_0x2b4a8a=_0x1480f1===_0x10a0d6(0x2c5)||_0x1480f1===_0x10a0d6(0x2cc),_0x5d119c=data['settings'][_0x10a0d6(0x3ee)],_0x204730=()=>{const _0x210d75=_0x10a0d6;try{document[_0x210d75(0x1d2)][_0x210d75(0x385)]['backgroundImage']='';}catch(_0x284fb7){}};if(_0x5d119c&&!data[_0x10a0d6(0x42f)][_0x10a0d6(0x206)])document[_0x10a0d6(0x1d2)][_0x10a0d6(0x385)]['setProperty']('--bg-image','url('+_0x5d119c+')'),_0x204730();else{if(_0x5d119c&&data[_0x10a0d6(0x42f)]['useYtThumbnailAsBg'])document[_0x10a0d6(0x1d2)][_0x10a0d6(0x385)][_0x10a0d6(0x338)](_0x10a0d6(0x381),_0x10a0d6(0x38d)+_0x5d119c+')'),_0x204730();else{if(_0x30b0c2)document[_0x10a0d6(0x1d2)][_0x10a0d6(0x385)][_0x10a0d6(0x24f)](_0x10a0d6(0x381)),_0x204730();else _0x2b4a8a?(document['body'][_0x10a0d6(0x385)][_0x10a0d6(0x338)](_0x10a0d6(0x381),_0x10a0d6(0x2e8)),_0x204730()):(document[_0x10a0d6(0x1d2)][_0x10a0d6(0x385)][_0x10a0d6(0x338)](_0x10a0d6(0x381),''),document['body'][_0x10a0d6(0x385)][_0x10a0d6(0x2bb)]=_0x10a0d6(0x440));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x174741(0x295),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':'beep','theme':_0x174741(0x3de),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':'cover','backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x174741(0x2e1),'content':_0x174741(0x164)},{'id':uid('m'),'title':'Benjamin\x20Franklin’s\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','content':_0x174741(0x34b)},{'id':uid('m'),'title':_0x174741(0x15c),'content':_0x174741(0x330)},{'id':uid('m'),'title':_0x174741(0x25d),'content':'<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you’re\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don’t\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>'},{'id':uid('m'),'title':_0x174741(0x430),'content':_0x174741(0x211)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x2f6e34=_0x174741;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x2f6e34(0x1f0))]||window[(_0x2f6e34(0x387))])();}function tone(_0xd20cc1=0x370,_0x2f212d=0xc8,_0x32f43e=0.2,_0x104d76='sine',_0x15ed39=0x0){const _0x36f7be=_0x174741;ensureAudio();const _0x3428ca=AUDIO_CTX,_0xb1711b=_0x3428ca[_0x36f7be(0x322)](),_0xa3168d=_0x3428ca[_0x36f7be(0x1a8)]();_0xb1711b[_0x36f7be(0x291)]=_0x104d76,_0xb1711b[_0x36f7be(0x370)][_0x36f7be(0x262)]=_0xd20cc1,_0xb1711b[_0x36f7be(0x150)](_0xa3168d),_0xa3168d['connect'](_0x3428ca[_0x36f7be(0x2a5)]);const _0x319812=_0x3428ca[_0x36f7be(0x2d7)]+_0x15ed39;_0xa3168d[_0x36f7be(0x22d)]['setValueAtTime'](0x0,_0x319812),_0xa3168d[_0x36f7be(0x22d)][_0x36f7be(0x3d7)](_0x32f43e,_0x319812+0.01),_0xa3168d[_0x36f7be(0x22d)][_0x36f7be(0x42a)](0.0001,_0x319812+_0x2f212d/0x3e8),_0xb1711b[_0x36f7be(0x1db)](_0x319812),_0xb1711b[_0x36f7be(0x3a1)](_0x319812+_0x2f212d/0x3e8+0.05);}function playSound(_0x3422b1){const _0x120147=_0x174741;if(!data[_0x120147(0x42f)][_0x120147(0x40b)])return;const _0x22d348=Math[_0x120147(0x200)](0x0,Math['min'](0x1,data['settings'][_0x120147(0x3df)]??0.8)),_0xf92ea4=data[_0x120147(0x42f)][_0x120147(0x390)]?.[_0x3422b1];let _0x114b92;if(_0x3422b1===_0x120147(0x1dc))_0x114b92=$(_0x120147(0x377));else{if(_0x3422b1===_0x120147(0x27a))_0x114b92=$('#audioBreakEnd');else{if(_0x3422b1===_0x120147(0x1d8))_0x114b92=$(_0x120147(0x341));}}if(_0xf92ea4&&_0x114b92){_0xf92ea4[_0x120147(0x33d)](_0x120147(0x215))||_0xf92ea4[_0x120147(0x33d)](_0x120147(0x3c3))||_0xf92ea4['startsWith'](_0x120147(0x227))?(_0x114b92[_0x120147(0x393)]=_0xf92ea4,_0x114b92['volume']=_0x22d348,_0x114b92[_0x120147(0x1a7)]()[_0x120147(0x3d3)](_0x4a50af=>console[_0x120147(0x3ce)](_0x120147(0x328),_0x4a50af))):getStoredFileUrl(_0xf92ea4)[_0x120147(0x26d)](_0x5d1a7b=>{const _0x1c6100=_0x120147;_0x5d1a7b&&(_0x114b92[_0x1c6100(0x393)]=_0x5d1a7b,_0x114b92[_0x1c6100(0x3df)]=_0x22d348,_0x114b92[_0x1c6100(0x1a7)]()[_0x1c6100(0x3d3)](_0x30191f=>console['error']('Audio\x20playback\x20error:',_0x30191f)));});return;}const _0x5c5f25=data[_0x120147(0x42f)]['soundTheme']||_0x120147(0x201);if(_0x5c5f25===_0x120147(0x201)){if(_0x3422b1===_0x120147(0x1dc))tone(0x370,0xfa,_0x22d348),tone(0x294,0xb4,_0x22d348*0.8,_0x120147(0x3aa),0.22);else{if(_0x3422b1==='break_end')tone(0x294,0xdc,_0x22d348*0.9);else _0x3422b1===_0x120147(0x1d8)&&(tone(0x208,0xc8,_0x22d348),tone(0x30c,0xc8,_0x22d348,_0x120147(0x3aa),0.22),tone(0x410,0xdc,_0x22d348,_0x120147(0x3aa),0.44));}}else{if(_0x3422b1==='work_end')tone(0x4b0,0xa0,_0x22d348*0.9,_0x120147(0x251)),tone(0x384,0xdc,_0x22d348*0.8,_0x120147(0x251),0.18);else{if(_0x3422b1===_0x120147(0x27a))tone(0x370,0xf0,_0x22d348*0.8,'triangle');else _0x3422b1===_0x120147(0x1d8)&&(tone(0x258,0xdc,_0x22d348*0.9,_0x120147(0x251)),tone(0x3b6,0xf0,_0x22d348*0.9,_0x120147(0x251),0.22),tone(0x4b0,0xf0,_0x22d348,_0x120147(0x251),0.44));}}}async function saveData(){const _0x5a544e=_0x174741;try{await storageManager[_0x5a544e(0x23c)](data);}catch(_0x1a12b4){console[_0x5a544e(0x3ce)](_0x5a544e(0x1d9),_0x1a12b4),toast(_0x5a544e(0x30f)+_0x1a12b4[_0x5a544e(0x2f2)]);}}async function ensureValidSelection(){const _0xcaf426=_0x174741,_0x2838f9=data[_0xcaf426(0x42f)];if(!data[_0xcaf426(0x254)]||data['topics']['length']===0x0){_0x2838f9['selectedTopicId']='',_0x2838f9[_0xcaf426(0x325)]='',await saveData();return;}const _0xd36c34=data[_0xcaf426(0x254)][_0xcaf426(0x1ab)](_0x20f23e=>_0x20f23e['id']===_0x2838f9[_0xcaf426(0x209)]),_0xb636df=_0xd36c34?.['subtopics'][_0xcaf426(0x1ab)](_0x2408a3=>_0x2408a3['id']===_0x2838f9[_0xcaf426(0x325)]);if(!_0xd36c34||!_0xb636df){const _0x2a3260=data[_0xcaf426(0x254)][0x0],_0x3fd784=_0x2a3260?.['subtopics']?.[0x0];_0x2838f9[_0xcaf426(0x209)]=_0x2a3260?.['id']||'',_0x2838f9['selectedSubtopicId']=_0x3fd784?.['id']||'',await saveData();}}function showInputModal(_0x26f432,_0x325984,_0x21f777=''){const _0x5a86d0=_0x174741;$(_0x5a86d0(0x2a9))['textContent']=_0x26f432,$(_0x5a86d0(0x41a))['classList'][_0x5a86d0(0x2be)](_0x5a86d0(0x17f));const _0x36635d=$(_0x5a86d0(0x184));_0x36635d[_0x5a86d0(0x262)]=_0x21f777,_0x36635d[_0x5a86d0(0x218)][_0x5a86d0(0x1b5)](_0x5a86d0(0x17f)),$(_0x5a86d0(0x3ae))[_0x5a86d0(0x218)]['add'](_0x5a86d0(0x252));try{trapFocus($('#modalGeneric'));}catch(_0x5696de){}_0x36635d['focus'](),_0x36635d['select']();const _0xb8f39b=()=>{const _0x479218=_0x5a86d0;_0x325984(_0x36635d[_0x479218(0x262)]),_0x2f8077();},_0x496062=()=>_0x2f8077(),_0x497c0c=_0x42118f=>{const _0x2c0476=_0x5a86d0;if(_0x42118f[_0x2c0476(0x366)]==='Enter')_0xb8f39b();if(_0x42118f[_0x2c0476(0x366)]===_0x2c0476(0x13f))_0x496062();};$('#btnGenericOk')[_0x5a86d0(0x152)]=_0xb8f39b,$(_0x5a86d0(0x414))[_0x5a86d0(0x152)]=_0x496062,_0x36635d['onkeydown']=_0x497c0c;function _0x2f8077(){const _0x28d70b=_0x5a86d0;$(_0x28d70b(0x3ae))[_0x28d70b(0x218)][_0x28d70b(0x1b5)]('show'),$(_0x28d70b(0x17c))[_0x28d70b(0x152)]=null,$(_0x28d70b(0x414))[_0x28d70b(0x152)]=null,_0x36635d[_0x28d70b(0x43a)]=null;try{releaseFocus();}catch(_0x29fc9a){}}}function showConfirmModal(_0x47c053,_0x12fd47,_0x4f333b){const _0x3dc08c=_0x174741;$(_0x3dc08c(0x2a9))[_0x3dc08c(0x38e)]=_0x47c053;const _0x4c86ad=$('#genericMessage');_0x4c86ad[_0x3dc08c(0x38e)]=_0x12fd47,_0x4c86ad[_0x3dc08c(0x218)][_0x3dc08c(0x1b5)](_0x3dc08c(0x17f)),$('#genericInput')[_0x3dc08c(0x218)][_0x3dc08c(0x2be)](_0x3dc08c(0x17f)),$(_0x3dc08c(0x3ae))[_0x3dc08c(0x218)][_0x3dc08c(0x2be)]('show');try{trapFocus($('#modalGeneric'));}catch(_0x58fe06){}const _0x110d0f=()=>{_0x4f333b(!![]),_0x528a4c();},_0x231f02=()=>{_0x4f333b(![]),_0x528a4c();};$('#btnGenericOk')['onclick']=_0x110d0f,$(_0x3dc08c(0x414))[_0x3dc08c(0x152)]=_0x231f02;function _0x528a4c(){const _0x1f478e=_0x3dc08c;$('#modalGeneric')[_0x1f478e(0x218)][_0x1f478e(0x1b5)]('show'),$('#btnGenericOk')[_0x1f478e(0x152)]=null,$(_0x1f478e(0x414))['onclick']=null;try{releaseFocus();}catch(_0x212851){}}}let pendingNoteSessionId=null;function openNoteModal(_0x1067de){const _0x14ea22=_0x174741;pendingNoteSessionId=_0x1067de||null;const _0x451367=$(_0x14ea22(0x3da));if(!_0x451367)return;const _0x4ae1af=$('#noteText');if(_0x4ae1af)try{_0x4ae1af[_0x14ea22(0x262)]='';}catch(_0x31d875){}_0x451367[_0x14ea22(0x218)][_0x14ea22(0x2be)](_0x14ea22(0x252));try{trapFocus(_0x451367);}catch(_0x3b9fcc){}}function closeNoteModal(){const _0x2979ee=_0x174741,_0x24a864=$(_0x2979ee(0x3da));if(!_0x24a864)return;_0x24a864['classList'][_0x2979ee(0x1b5)](_0x2979ee(0x252)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x3034a5){}}async function switchView(_0x3447be){const _0x4eba34=_0x174741;$$('.view')[_0x4eba34(0x14e)](_0x53d4e0=>_0x53d4e0[_0x4eba34(0x218)][_0x4eba34(0x1b5)](_0x4eba34(0x175))),$('#view-'+_0x3447be)['classList'][_0x4eba34(0x2be)](_0x4eba34(0x175)),$$(_0x4eba34(0x369))[_0x4eba34(0x14e)](_0x5c75fa=>_0x5c75fa[_0x4eba34(0x218)]['remove'](_0x4eba34(0x175)));const _0x1de40c=$(_0x4eba34(0x1ff)+_0x3447be+'\x22]');if(_0x1de40c)_0x1de40c['classList'][_0x4eba34(0x2be)](_0x4eba34(0x175));data[_0x4eba34(0x42f)][_0x4eba34(0x334)]=_0x3447be,await saveData(),_0x3447be===_0x4eba34(0x2d6)&&renderDashboard();}function closeAllMenus(){const _0x58fc1a=_0x174741;$$(_0x58fc1a(0x210))[_0x58fc1a(0x14e)](_0x38e1bb=>_0x38e1bb[_0x58fc1a(0x218)]['remove'](_0x58fc1a(0x252))),$$('.topic-item.menu-active')[_0x58fc1a(0x14e)](_0x5553d8=>_0x5553d8[_0x58fc1a(0x218)][_0x58fc1a(0x1b5)](_0x58fc1a(0x41d)));}function renderTopics(){const _0x26e179=_0x174741,_0x3ebe7c=$(_0x26e179(0x452));if(!_0x3ebe7c)return;_0x3ebe7c[_0x26e179(0x299)]='';const _0x356e25=data[_0x26e179(0x42f)]['collapsedTopics']||{};data[_0x26e179(0x254)][_0x26e179(0x14e)](_0x4f0507=>{const _0x3e4738=_0x26e179,_0xa606e2=document['createElement'](_0x3e4738(0x2d1));_0xa606e2[_0x3e4738(0x3bc)]=_0x3e4738(0x1ec),_0xa606e2[_0x3e4738(0x31c)]['tid']=_0x4f0507['id'];const _0x46bbdc=document[_0x3e4738(0x39d)]('div');_0x46bbdc[_0x3e4738(0x3bc)]=_0x3e4738(0x346);const _0x452b2a=!!_0x356e25[_0x4f0507['id']],_0x457ee8=document[_0x3e4738(0x39d)](_0x3e4738(0x453));_0x457ee8[_0x3e4738(0x3bc)]=_0x3e4738(0x3fb),_0x457ee8[_0x3e4738(0x2a4)]('aria-expanded',String(!_0x452b2a)),_0x457ee8['innerHTML']=_0x3e4738(0x423);const _0x221661=document[_0x3e4738(0x39d)](_0x3e4738(0x2d1));_0x221661[_0x3e4738(0x3bc)]=_0x3e4738(0x304),_0x221661[_0x3e4738(0x38e)]=_0x4f0507[_0x3e4738(0x3dd)];const _0x12afd6=document['createElement'](_0x3e4738(0x2d1));_0x12afd6[_0x3e4738(0x3bc)]='topic-actions';const _0x34b05f=document[_0x3e4738(0x39d)](_0x3e4738(0x453));_0x34b05f['className']=_0x3e4738(0x441),_0x34b05f[_0x3e4738(0x299)]='＋\x20Add',_0x34b05f['title']=_0x3e4738(0x42c);const _0x45986c=document[_0x3e4738(0x39d)](_0x3e4738(0x2d1));_0x45986c[_0x3e4738(0x385)][_0x3e4738(0x1de)]='relative';const _0x24a6aa=document[_0x3e4738(0x39d)]('button');_0x24a6aa[_0x3e4738(0x3bc)]=_0x3e4738(0x2f1),_0x24a6aa[_0x3e4738(0x299)]=_0x3e4738(0x300),_0x24a6aa[_0x3e4738(0x420)]='More\x20options';const _0x402a13=document[_0x3e4738(0x39d)]('div');_0x402a13['className']='actions-menu';const _0x2adb83=document['createElement'](_0x3e4738(0x453));_0x2adb83['className']='menu-item',_0x2adb83[_0x3e4738(0x299)]=_0x3e4738(0x399);const _0x52ae68=document[_0x3e4738(0x39d)](_0x3e4738(0x453));_0x52ae68[_0x3e4738(0x3bc)]=_0x3e4738(0x1e5),_0x52ae68[_0x3e4738(0x299)]=_0x3e4738(0x1a5),_0x402a13[_0x3e4738(0x29b)](_0x2adb83,_0x52ae68),_0x45986c[_0x3e4738(0x29b)](_0x24a6aa,_0x402a13),_0x12afd6[_0x3e4738(0x29b)](_0x34b05f,_0x45986c),_0x46bbdc['append'](_0x457ee8,_0x221661,_0x12afd6),_0x457ee8[_0x3e4738(0x26f)](_0x3e4738(0x26a),async _0x40984a=>{const _0x360e3b=_0x3e4738;_0x40984a[_0x360e3b(0x391)]();const _0x3fbcc8=!!_0x356e25[_0x4f0507['id']];_0x3fbcc8?delete _0x356e25[_0x4f0507['id']]:_0x356e25[_0x4f0507['id']]=!![],data[_0x360e3b(0x42f)]['collapsedTopics']=_0x356e25,await storageManager[_0x360e3b(0x3d0)](data[_0x360e3b(0x42f)]),renderTopics();});const _0x54aaf=async()=>{const _0x495a84=_0x3e4738,_0x4c4b46=!!_0x356e25[_0x4f0507['id']];_0x4c4b46?delete _0x356e25[_0x4f0507['id']]:_0x356e25[_0x4f0507['id']]=!![],data[_0x495a84(0x42f)]['collapsedTopics']=_0x356e25,await storageManager[_0x495a84(0x3d0)](data[_0x495a84(0x42f)]),renderTopics();};_0x46bbdc[_0x3e4738(0x26f)](_0x3e4738(0x26a),async _0x55203b=>{const _0x520d82=_0x3e4738,_0xedfbd5=_0x55203b[_0x520d82(0x1cb)];if(_0xedfbd5&&_0xedfbd5[_0x520d82(0x25b)]){if(_0xedfbd5[_0x520d82(0x25b)](_0x520d82(0x386))||_0xedfbd5[_0x520d82(0x25b)](_0x520d82(0x3cb))||_0xedfbd5['closest'](_0x520d82(0x453))||_0xedfbd5[_0x520d82(0x25b)](_0x520d82(0x367)))return;}_0x55203b[_0x520d82(0x391)](),await _0x54aaf();}),_0x221661[_0x3e4738(0x26f)]('click',async _0x51ae05=>{const _0x1ddbff=_0x3e4738;_0x51ae05[_0x1ddbff(0x391)](),await _0x54aaf();}),_0xa606e2[_0x3e4738(0x26f)](_0x3e4738(0x26a),async _0x405106=>{const _0x431592=_0x3e4738,_0x24a954=_0x405106['target'];if(_0x24a954&&_0x24a954[_0x431592(0x25b)]){if(_0x24a954[_0x431592(0x25b)](_0x431592(0x2f3)))return;if(_0x24a954['closest'](_0x431592(0x386))||_0x24a954[_0x431592(0x25b)](_0x431592(0x3cb))||_0x24a954['closest'](_0x431592(0x453))||_0x24a954[_0x431592(0x25b)](_0x431592(0x367)))return;}await _0x54aaf();});const _0x31eb77=document['createElement'](_0x3e4738(0x2d1));_0x31eb77[_0x3e4738(0x3bc)]=_0x3e4738(0x25a)+(_0x452b2a?'\x20hidden':''),_0x31eb77[_0x3e4738(0x31c)][_0x3e4738(0x3b2)]=_0x4f0507['id'],_0x4f0507[_0x3e4738(0x25a)][_0x3e4738(0x14e)](_0x1dbee1=>{const _0x80957d=_0x3e4738,_0x15b4b0=document['createElement']('div');_0x15b4b0[_0x80957d(0x3bc)]=_0x80957d(0x18b),_0x15b4b0['dataset'][_0x80957d(0x3b1)]=_0x1dbee1['id'];const _0x12db7a=document[_0x80957d(0x39d)](_0x80957d(0x453));_0x12db7a[_0x80957d(0x3bc)]=_0x80957d(0x3bd),_0x12db7a[_0x80957d(0x38e)]='•\x20'+_0x1dbee1[_0x80957d(0x3dd)],_0x12db7a[_0x80957d(0x31c)][_0x80957d(0x3b1)]=_0x1dbee1['id'],_0x12db7a[_0x80957d(0x31c)]['tid']=_0x4f0507['id'];if(data[_0x80957d(0x42f)][_0x80957d(0x325)]===_0x1dbee1['id'])_0x12db7a[_0x80957d(0x218)][_0x80957d(0x2be)]('active');const _0x6c4ace=document[_0x80957d(0x39d)]('div');_0x6c4ace['className']=_0x80957d(0x324);const _0x1bd246=document['createElement'](_0x80957d(0x2d1));_0x1bd246[_0x80957d(0x385)][_0x80957d(0x1de)]=_0x80957d(0x277);const _0x15aedb=document[_0x80957d(0x39d)](_0x80957d(0x453));_0x15aedb[_0x80957d(0x3bc)]=_0x80957d(0x2f1),_0x15aedb[_0x80957d(0x299)]='...',_0x15aedb[_0x80957d(0x420)]='More\x20options';const _0x19dc05=document['createElement'](_0x80957d(0x2d1));_0x19dc05[_0x80957d(0x3bc)]=_0x80957d(0x1bd);const _0x2e0859=document[_0x80957d(0x39d)](_0x80957d(0x453));_0x2e0859['className']=_0x80957d(0x2b6),_0x2e0859['innerHTML']=_0x80957d(0x182);const _0xfbd6cb=document[_0x80957d(0x39d)](_0x80957d(0x453));_0xfbd6cb[_0x80957d(0x3bc)]=_0x80957d(0x1e5),_0xfbd6cb[_0x80957d(0x299)]=_0x80957d(0x41e),_0x19dc05['append'](_0x2e0859,_0xfbd6cb),_0x1bd246[_0x80957d(0x29b)](_0x15aedb,_0x19dc05),_0x6c4ace[_0x80957d(0x29b)](_0x1bd246),_0x15b4b0['append'](_0x12db7a,_0x6c4ace),_0x31eb77[_0x80957d(0x3d6)](_0x15b4b0),_0x12db7a[_0x80957d(0x26f)](_0x80957d(0x26a),()=>selectSubtopic(_0x4f0507['id'],_0x1dbee1['id'])),_0x15aedb['addEventListener'](_0x80957d(0x26a),_0x3ce83b=>{const _0x80705f=_0x80957d;_0x3ce83b['stopPropagation']();const _0x4ed8dd=_0x19dc05[_0x80705f(0x218)][_0x80705f(0x42e)](_0x80705f(0x252));closeAllMenus(),_0x4ed8dd?_0xa606e2[_0x80705f(0x218)]['remove'](_0x80705f(0x41d)):(_0x19dc05[_0x80705f(0x218)]['add']('show'),_0xa606e2['classList']['add'](_0x80705f(0x41d)));}),_0x2e0859[_0x80957d(0x26f)]('click',()=>showInputModal(_0x80957d(0x182),async _0x2be267=>{const _0x206b9b=_0x80957d;if(!_0x2be267)return;_0x1dbee1[_0x206b9b(0x3dd)]=_0x2be267,await storageManager['update'](_0x206b9b(0x25a),_0x1dbee1),renderAll();},_0x1dbee1[_0x80957d(0x3dd)])),_0xfbd6cb['addEventListener'](_0x80957d(0x26a),()=>showConfirmModal('Confirm\x20Deletion','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22'+_0x1dbee1[_0x80957d(0x3dd)]+'\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.',async _0x5c4b55=>{const _0x8a7a59=_0x80957d;if(!_0x5c4b55)return;_0x4f0507['subtopics']=_0x4f0507[_0x8a7a59(0x25a)][_0x8a7a59(0x283)](_0x15f4fd=>_0x15f4fd['id']!==_0x1dbee1['id']);const _0x1b1918=data[_0x8a7a59(0x42f)];_0x1b1918['selectedSubtopicId']===_0x1dbee1['id']&&(_0x1b1918['selectedSubtopicId']='',_0x1b1918['selectedTopicId']='',ensureValidSelection()),await storageManager[_0x8a7a59(0x261)](_0x8a7a59(0x25a),_0x1dbee1['id']),renderAll();}));}),_0x24a6aa[_0x3e4738(0x26f)](_0x3e4738(0x26a),_0x5d151c=>{const _0x21d4b2=_0x3e4738;_0x5d151c[_0x21d4b2(0x391)]();const _0x1f576e=_0x402a13[_0x21d4b2(0x218)][_0x21d4b2(0x42e)]('show');closeAllMenus(),_0x1f576e?_0xa606e2[_0x21d4b2(0x218)]['remove'](_0x21d4b2(0x41d)):(_0x402a13[_0x21d4b2(0x218)][_0x21d4b2(0x2be)]('show'),_0xa606e2[_0x21d4b2(0x218)]['add'](_0x21d4b2(0x41d)));}),_0x34b05f[_0x3e4738(0x26f)](_0x3e4738(0x26a),()=>showInputModal(_0x3e4738(0x45b),async _0x5c8564=>{const _0x37e76d=_0x3e4738;if(!_0x5c8564)return;const _0x59d2ea={'id':uid('s'),'topicId':_0x4f0507['id'],'name':_0x5c8564,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'methods':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x37e76d(0x23b),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};try{const _0x4e6044=data?.[_0x37e76d(0x42f)]?.[_0x37e76d(0x36a)]||[];Array[_0x37e76d(0x1f4)](_0x4e6044)&&_0x4e6044[_0x37e76d(0x26c)]>0x0&&(_0x59d2ea['methods']=_0x4e6044,data[_0x37e76d(0x42f)][_0x37e76d(0x36a)]=[],await storageManager[_0x37e76d(0x3d0)](data[_0x37e76d(0x42f)]));}catch(_0x449bdf){}_0x4f0507[_0x37e76d(0x25a)][_0x37e76d(0x137)](_0x59d2ea),await storageManager[_0x37e76d(0x2be)]('subtopics',_0x59d2ea),renderTopics();})),_0x2adb83[_0x3e4738(0x26f)](_0x3e4738(0x26a),()=>showInputModal(_0x3e4738(0x399),async _0x59393b=>{const _0x489700=_0x3e4738;if(!_0x59393b)return;_0x4f0507[_0x489700(0x3dd)]=_0x59393b,await storageManager[_0x489700(0x198)](_0x489700(0x254),_0x4f0507),renderTopics();},_0x4f0507['name'])),_0x52ae68['addEventListener']('click',()=>showConfirmModal('Confirm\x20Deletion','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22'+_0x4f0507[_0x3e4738(0x3dd)]+_0x3e4738(0x1f6),async _0xb21b89=>{const _0xdcb408=_0x3e4738;if(!_0xb21b89)return;data[_0xdcb408(0x254)]=data['topics'][_0xdcb408(0x283)](_0x138308=>_0x138308['id']!==_0x4f0507['id']),delete _0x356e25[_0x4f0507['id']];data[_0xdcb408(0x42f)][_0xdcb408(0x209)]===_0x4f0507['id']&&(data[_0xdcb408(0x42f)]['selectedTopicId']='',data['settings'][_0xdcb408(0x325)]='',ensureValidSelection());await storageManager[_0xdcb408(0x261)](_0xdcb408(0x254),_0x4f0507['id']);for(const _0x35d36d of _0x4f0507[_0xdcb408(0x25a)]){await storageManager[_0xdcb408(0x261)](_0xdcb408(0x25a),_0x35d36d['id']);}renderAll();})),_0x34b05f[_0x3e4738(0x26f)](_0x3e4738(0x26a),_0xc8b136=>_0xc8b136[_0x3e4738(0x391)]()),_0x2adb83[_0x3e4738(0x26f)](_0x3e4738(0x26a),_0x54fd03=>_0x54fd03[_0x3e4738(0x391)]()),_0x52ae68['addEventListener'](_0x3e4738(0x26a),_0x4c5ab9=>_0x4c5ab9[_0x3e4738(0x391)]()),_0xa606e2[_0x3e4738(0x29b)](_0x46bbdc,_0x31eb77),_0x3ebe7c[_0x3e4738(0x3d6)](_0xa606e2);});if(window[_0x26e179(0x37d)]){const _0x4a3c50=document[_0x26e179(0x329)]('topicsList');if(_0x4a3c50){if(_0x4a3c50['_sortable'])try{_0x4a3c50[_0x26e179(0x30a)][_0x26e179(0x326)]();}catch(_0x556351){}_0x4a3c50[_0x26e179(0x30a)]=new Sortable(_0x4a3c50,{'animation':0x96,'draggable':_0x26e179(0x342),'onEnd':async function(_0x4b896d){const _0x1c86d3=_0x26e179;if(_0x4b896d[_0x1c86d3(0x3f6)]===_0x4b896d[_0x1c86d3(0x2e9)])return;const _0x5e7341=data[_0x1c86d3(0x254)]['splice'](_0x4b896d[_0x1c86d3(0x3f6)],0x1)[0x0];data['topics'][_0x1c86d3(0x1df)](_0x4b896d[_0x1c86d3(0x2e9)],0x0,_0x5e7341),await saveData(),renderTopics();}}),_0x4a3c50['querySelectorAll'](_0x26e179(0x2f3))['forEach'](_0x5ccc13=>{new Sortable(_0x5ccc13,{'group':'subtopics-group','animation':0x96,'draggable':'.sub-row','onEnd':async function(_0x134b66){const _0x4d6828=_0x3fc1,_0x597a5d=_0x134b66['from']?.[_0x4d6828(0x31c)]?.['tid']||_0x134b66[_0x4d6828(0x21a)]?.[_0x4d6828(0x25b)](_0x4d6828(0x342))?.[_0x4d6828(0x31c)]?.[_0x4d6828(0x3b2)],_0x239ce5=_0x134b66['to']?.[_0x4d6828(0x31c)]?.[_0x4d6828(0x3b2)]||_0x134b66['to']?.[_0x4d6828(0x25b)](_0x4d6828(0x342))?.[_0x4d6828(0x31c)]?.[_0x4d6828(0x3b2)],_0x3d14fb=data[_0x4d6828(0x254)][_0x4d6828(0x1ab)](_0x2d8fc2=>_0x2d8fc2['id']===_0x597a5d),_0x2bfcf5=data['topics'][_0x4d6828(0x1ab)](_0x47b481=>_0x47b481['id']===_0x239ce5);if(!_0x3d14fb||!_0x2bfcf5)return;let _0x4dd2db=null;const _0x45a2c7=_0x134b66['item']?.[_0x4d6828(0x31c)]?.['sid']||_0x134b66[_0x4d6828(0x411)]?.['querySelector'](_0x4d6828(0x22b))?.[_0x4d6828(0x31c)]?.[_0x4d6828(0x3b1)];if(_0x45a2c7){const _0x19bc4c=_0x3d14fb[_0x4d6828(0x25a)][_0x4d6828(0x2c0)](_0x1c7027=>_0x1c7027['id']===_0x45a2c7);if(_0x19bc4c>=0x0)_0x4dd2db=_0x3d14fb[_0x4d6828(0x25a)]['splice'](_0x19bc4c,0x1)[0x0];}!_0x4dd2db&&(_0x4dd2db=_0x3d14fb[_0x4d6828(0x25a)][_0x4d6828(0x1df)](_0x134b66['oldIndex'],0x1)[0x0]);if(!_0x4dd2db)return;_0x4dd2db[_0x4d6828(0x142)]=_0x2bfcf5['id'],_0x2bfcf5[_0x4d6828(0x25a)]['splice'](_0x134b66[_0x4d6828(0x2e9)],0x0,_0x4dd2db),data[_0x4d6828(0x42f)][_0x4d6828(0x325)]===_0x4dd2db['id']&&(data['settings'][_0x4d6828(0x209)]=_0x2bfcf5['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x105db6,_0x3be8da){const _0x48974c=_0x174741,_0x281997=$(_0x48974c(0x14b)),_0x4bcdad=getCurrentSubtopic();_0x4bcdad&&timer[_0x48974c(0x460)]!=='idle'&&(_0x4bcdad[_0x48974c(0x2a6)]={'state':timer[_0x48974c(0x460)],'prevState':timer['prevState'],'remaining':timer[_0x48974c(0x186)],'segmentTotal':timer[_0x48974c(0x253)],'cycleIndex':timer[_0x48974c(0x2a0)]}),_0x281997[_0x48974c(0x218)]['add'](_0x48974c(0x148)),setTimeout(async()=>{const _0x252cbd=_0x48974c;data[_0x252cbd(0x42f)][_0x252cbd(0x209)]=_0x105db6,data[_0x252cbd(0x42f)][_0x252cbd(0x325)]=_0x3be8da;const _0x7ee6ae=getCurrentSubtopic();_0x7ee6ae[_0x252cbd(0x2a6)]?(timer[_0x252cbd(0x460)]=_0x7ee6ae[_0x252cbd(0x2a6)][_0x252cbd(0x460)],timer['prevState']=_0x7ee6ae[_0x252cbd(0x2a6)][_0x252cbd(0x2e4)]||null,timer[_0x252cbd(0x186)]=_0x7ee6ae['timerState'][_0x252cbd(0x186)],timer['segmentTotal']=_0x7ee6ae['timerState'][_0x252cbd(0x253)],timer[_0x252cbd(0x2a0)]=_0x7ee6ae[_0x252cbd(0x2a6)][_0x252cbd(0x2a0)]):timer[_0x252cbd(0x208)](),await saveData(),timer[_0x252cbd(0x293)](),renderAll(),switchView('timer'),_0x281997['classList'][_0x252cbd(0x1b5)](_0x252cbd(0x148));},0xc8);}function getCurrentSubtopic(){const _0x4c107c=_0x174741,_0x1424b9=data['settings'][_0x4c107c(0x209)],_0x5ca661=data[_0x4c107c(0x42f)]['selectedSubtopicId'];if(!_0x1424b9||!_0x5ca661)return null;const _0x2b2c10=data[_0x4c107c(0x254)]['find'](_0x5f2d28=>_0x5f2d28['id']===_0x1424b9);if(!_0x2b2c10)return null;return _0x2b2c10['subtopics'][_0x4c107c(0x1ab)](_0x54be68=>_0x54be68['id']===_0x5ca661)||null;}function renderContextBadge(){const _0x506baf=_0x174741,_0x48c3d7=getCurrentSubtopic(),_0x348dc6=_0x48c3d7?_0x48c3d7[_0x506baf(0x3dd)]:_0x506baf(0x3b0),_0x1b1f17=$(_0x506baf(0x2b8)),_0xb5c5df=$(_0x506baf(0x395)),_0x49d780=$('#currentSubtopicNameChat');if(_0x1b1f17)_0x1b1f17['textContent']=_0x48c3d7?_0x506baf(0x2eb)+_0x48c3d7[_0x506baf(0x3dd)]:_0x506baf(0x39c);if(_0xb5c5df)_0xb5c5df[_0x506baf(0x38e)]=_0x348dc6;if(_0x49d780)_0x49d780['textContent']=_0x348dc6;}function renderSubtopicTasks(){const _0x138975=_0x174741,_0x14bae3=getCurrentSubtopic(),_0x30a5c8=$('#subtopicTasksList'),_0xfbbd64=$(_0x138975(0x327));if(!_0x30a5c8||!_0xfbbd64)return;const _0x3389a9=_0xfbbd64[_0x138975(0x321)];if(!_0x14bae3){_0x30a5c8[_0x138975(0x299)]=_0x138975(0x24a),_0x3389a9[_0x138975(0x218)]['add']('hidden');return;}_0x3389a9['classList'][_0x138975(0x1b5)](_0x138975(0x17f)),_0x30a5c8[_0x138975(0x299)]='';const _0x3ba19b=_0x14bae3['tasks']?_0x14bae3[_0x138975(0x2ee)][_0x138975(0x283)](_0x361469=>!_0x361469[_0x138975(0x378)]):[];_0x3ba19b[_0x138975(0x26c)]===0x0&&(_0x30a5c8[_0x138975(0x299)]=_0x138975(0x1c5)),_0x3ba19b[_0x138975(0x14e)](_0x353582=>{const _0x1f6682=_0x138975,_0x22123c=document[_0x1f6682(0x39d)]('li');_0x22123c[_0x1f6682(0x299)]=_0x1f6682(0x309)+_0x353582['id']+_0x1f6682(0x35e)+_0x353582['id']+'\x22>'+escapeHTML(_0x353582[_0x1f6682(0x2aa)])+_0x1f6682(0x263),_0x22123c[_0x1f6682(0x331)](_0x1f6682(0x365))['addEventListener'](_0x1f6682(0x44e),_0x54aeb3=>toggleSubtopicTask(_0x54aeb3[_0x1f6682(0x1cb)]['id'],_0x22123c)),_0x30a5c8[_0x1f6682(0x3d6)](_0x22123c);});}async function addSubtopicTask(){const _0x54f08f=_0x174741,_0x57cb54=getCurrentSubtopic();if(!_0x57cb54){toast(t(_0x54f08f(0x169)));return;}const _0x855b1f=$(_0x54f08f(0x327)),_0x5a90c3=_0x855b1f[_0x54f08f(0x262)][_0x54f08f(0x2ba)]();if(_0x5a90c3){if(!_0x57cb54[_0x54f08f(0x2ee)])_0x57cb54[_0x54f08f(0x2ee)]=[];_0x57cb54[_0x54f08f(0x2ee)]['push']({'id':uid(_0x54f08f(0x3c8)),'text':_0x5a90c3,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x855b1f[_0x54f08f(0x262)]='';}_0x855b1f['focus']();}async function toggleSubtopicTask(_0x45d66b,_0x1017cc){const _0x58875a=_0x174741,_0x327f78=getCurrentSubtopic();if(!_0x327f78||!_0x327f78['tasks'])return;const _0xc31ea6=_0x327f78['tasks'][_0x58875a(0x1ab)](_0x166763=>_0x166763['id']===_0x45d66b);_0xc31ea6&&(_0xc31ea6['isCompleted']=!![],_0x327f78[_0x58875a(0x2d6)][_0x58875a(0x221)]=(_0x327f78[_0x58875a(0x2d6)][_0x58875a(0x221)]||0x0)+0x1,await saveData(),_0x1017cc[_0x58875a(0x218)][_0x58875a(0x2be)](_0x58875a(0x3a4)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':'idle','prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x5dbdac,{silent:silent=![]}={}){const _0xbb4231=_0x174741,_0x2be34e=data[_0xbb4231(0x42f)];this['mode']=_0x5dbdac,this['cyclesTarget']=_0x5dbdac==='A'?_0x2be34e[_0xbb4231(0x232)]:_0x5dbdac==='B'?_0x2be34e[_0xbb4231(0x1a3)]:0x0,_0x2be34e[_0xbb4231(0x231)]=_0x5dbdac,await saveData(),this[_0xbb4231(0x460)]===_0xbb4231(0x23b)&&this[_0xbb4231(0x208)]();},'currentDurations'(){const _0x27a460=_0x174741,_0x19d296=data[_0x27a460(0x42f)][_0x27a460(0x1b2)];if(this['mode']==='A')return{'work':_0x19d296[_0x27a460(0x159)],'short':_0x19d296['A_short'],'long':_0x19d296[_0x27a460(0x37f)],'winddown':_0x19d296[_0x27a460(0x1fa)]??0x0};if(this[_0x27a460(0x383)]==='B')return{'work':_0x19d296[_0x27a460(0x17e)],'short':_0x19d296[_0x27a460(0x362)],'long':_0x19d296[_0x27a460(0x290)],'winddown':_0x19d296[_0x27a460(0x425)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x38becb=_0x174741,_0x5c99c9=data['settings'];if(this[_0x38becb(0x383)]==='A')return{'cycles':_0x5c99c9[_0x38becb(0x232)],'interval':_0x5c99c9[_0x38becb(0x2c6)]};if(this['mode']==='B')return{'cycles':_0x5c99c9['cyclesB'],'interval':_0x5c99c9['longBreakIntervalB']};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x129002=_0x174741,_0x2fa00e=$('#stateBadge'),_0x36ea17=$(_0x129002(0x39f)),_0x3912ee=$(_0x129002(0x44d));if(!_0x2fa00e||!_0x36ea17||!_0x3912ee)return;const _0x179689=this[_0x129002(0x383)]==='C';$(_0x129002(0x133))[_0x129002(0x218)][_0x129002(0x18d)]('hidden',this['state']!==_0x129002(0x23b)||_0x179689&&this[_0x129002(0x460)]==='work'),$('#btnFinishFlow')['classList'][_0x129002(0x18d)](_0x129002(0x17f),!(_0x179689&&this[_0x129002(0x460)]==='work')),$(_0x129002(0x13a))[_0x129002(0x218)][_0x129002(0x18d)](_0x129002(0x17f),!['work',_0x129002(0x3bf),_0x129002(0x183)][_0x129002(0x1ce)](this['state'])),$('#btnResume')[_0x129002(0x218)][_0x129002(0x18d)]('hidden',this['state']!==_0x129002(0x2b5));let _0xdb1d1f=_0x129002(0x315);if(this[_0x129002(0x460)]===_0x129002(0x27f))_0x2fa00e['textContent']=_0x179689?_0x129002(0x418):_0x129002(0x15b),_0x2fa00e['className']=_0x129002(0x2d9),_0xdb1d1f=_0x129002(0x188);else{if(this[_0x129002(0x460)]==='break')_0x2fa00e[_0x129002(0x38e)]=_0x129002(0x239),_0x2fa00e[_0x129002(0x3bc)]=_0x129002(0x1af),_0xdb1d1f=_0x129002(0x1fb);else{if(this[_0x129002(0x460)]===_0x129002(0x183))_0x2fa00e['textContent']='LONG\x20BREAK',_0x2fa00e[_0x129002(0x3bc)]=_0x129002(0x319),_0xdb1d1f='var(--danger)';else{if(this[_0x129002(0x460)]===_0x129002(0x292)){_0x2fa00e['textContent']=_0x129002(0x1c1),_0x2fa00e[_0x129002(0x3bc)]=_0x129002(0x2d9),_0xdb1d1f='var(--acc-2)';try{$(_0x129002(0x3c2))[_0x129002(0x218)][_0x129002(0x1b5)](_0x129002(0x17f)),$(_0x129002(0x308))[_0x129002(0x218)]['remove'](_0x129002(0x17f));}catch(_0x1f93bd){}}else this['state']===_0x129002(0x2b5)?(_0x2fa00e['textContent']=_0x129002(0x2b2),_0x2fa00e['className']=_0x129002(0x189)):(_0x2fa00e[_0x129002(0x38e)]=_0x129002(0x166),_0x2fa00e['className']=_0x129002(0x189));}}}[_0x129002(0x27f),_0x129002(0x3bf),'long_break',_0x129002(0x292)]['includes'](this['state'])?_0x3912ee[_0x129002(0x218)][_0x129002(0x2be)]('breathing'):_0x3912ee['classList'][_0x129002(0x1b5)](_0x129002(0x2ca));_0x36ea17[_0x129002(0x385)][_0x129002(0x2f5)]=_0xdb1d1f,_0x3912ee['classList'][_0x129002(0x1b5)]('finished');const _0xba0773=$(_0x129002(0x3e3));if(_0xba0773)_0xba0773[_0x129002(0x38e)]=formatMMSS(this[_0x129002(0x186)]);const _0x505ea2=_0x36ea17['r'][_0x129002(0x34f)][_0x129002(0x262)],_0x200679=0x2*Math['PI']*_0x505ea2,_0x249c1d=this[_0x129002(0x253)]>0x0?_0x200679-this['remaining']/this['segmentTotal']*_0x200679:_0x200679;_0x36ea17['style'][_0x129002(0x354)]=_0x200679,_0x36ea17[_0x129002(0x385)][_0x129002(0x1e9)]=isNaN(_0x249c1d)?_0x200679:_0x249c1d;const _0x484578=$(_0x129002(0x1e2));if(_0x484578){const _0x294ed0=this['currentConfig']();_0x484578[_0x129002(0x38e)]=t(_0x129002(0x1b1),{'current':this[_0x129002(0x2a0)],'target':_0x294ed0[_0x129002(0x33b)]}),_0x484578[_0x129002(0x218)][_0x129002(0x18d)](_0x129002(0x17f),_0x179689);}const _0x7d8f4=$(_0x129002(0x360));_0x7d8f4&&_0x7d8f4[_0x129002(0x218)][_0x129002(0x18d)](_0x129002(0x17f),_0x179689&&this[_0x129002(0x460)]===_0x129002(0x27f));const _0x52c188=$(_0x129002(0x265));if(_0x52c188)_0x52c188[_0x129002(0x38e)]=formatMMSS(this[_0x129002(0x186)]);if(this[_0x129002(0x460)]!=='wind_down')try{$('#windDownChecklist')[_0x129002(0x218)][_0x129002(0x2be)](_0x129002(0x17f)),$(_0x129002(0x308))[_0x129002(0x218)][_0x129002(0x2be)](_0x129002(0x17f));}catch(_0x41e3ec){}},'persistTimerState'(_0x1a76e6=![]){const _0x52d3b3=_0x174741;try{const _0x1c6e6c=getCurrentSubtopic();if(!_0x1c6e6c)return;const _0x5f24bf={'state':this[_0x52d3b3(0x460)],'prevState':this['prevState'],'remaining':this[_0x52d3b3(0x186)],'segmentTotal':this[_0x52d3b3(0x253)],'cycleIndex':this['cycleIndex']};_0x1c6e6c[_0x52d3b3(0x2a6)]=_0x5f24bf;try{localStorage[_0x52d3b3(0x450)](_0x52d3b3(0x2d8)+_0x1c6e6c['id'],JSON[_0x52d3b3(0x2ac)](_0x5f24bf));}catch(_0x205d0b){}this[_0x52d3b3(0x204)]=Date[_0x52d3b3(0x2ce)]();}catch(_0xa12d34){}},'_startTick'(){const _0x2cb746=_0x174741;if(this[_0x2cb746(0x16c)])clearInterval(this['tickHandle']);if(this[_0x2cb746(0x383)]==='C'&&this[_0x2cb746(0x460)]===_0x2cb746(0x27f)){this[_0x2cb746(0x16c)]=setInterval(()=>{const _0x52f643=_0x2cb746;this[_0x52f643(0x186)]+=0x1,this['updateUI'](),this[_0x52f643(0x3a9)]();},0x3e8);return;}this[_0x2cb746(0x16c)]=setInterval(()=>{const _0xdeb804=_0x2cb746;this[_0xdeb804(0x186)]>0x0&&(this[_0xdeb804(0x186)]-=0x1,this[_0xdeb804(0x293)](),this[_0xdeb804(0x3a9)]()),this[_0xdeb804(0x186)]<=0x0&&(clearInterval(this['tickHandle']),this[_0xdeb804(0x16c)]=null,this['_onFinishSegment']());},0x3e8);},'_onFinishSegment'(){const _0x202b4d=_0x174741;if(this[_0x202b4d(0x460)]==='work'){const _0x28fabd=getCurrentSubtopic();if(_0x28fabd){const _0x4a585b=this[_0x202b4d(0x429)]()['work'];_0x28fabd[_0x202b4d(0x2d6)][_0x202b4d(0x22c)]=(_0x28fabd[_0x202b4d(0x2d6)]['totalMinutes']||0x0)+_0x4a585b,_0x28fabd[_0x202b4d(0x2d6)]['sessionsCompleted']=(_0x28fabd[_0x202b4d(0x2d6)][_0x202b4d(0x278)]||0x0)+0x1;const _0x1a634a={'id':uid(_0x202b4d(0x1c2)),'dateISO':todayISO(),'durationMinutes':_0x4a585b,'mode':this[_0x202b4d(0x383)],'note':''};if(!_0x28fabd['sessions'])_0x28fabd[_0x202b4d(0x2f8)]=[];_0x28fabd[_0x202b4d(0x2f8)][_0x202b4d(0x163)](_0x1a634a);if(data?.[_0x202b4d(0x42f)]?.[_0x202b4d(0x3f8)])try{openNoteModal(_0x1a634a['id']);}catch(_0x4ae735){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this['cycleIndex']++;}if(typeof data!==_0x202b4d(0x270)&&data&&data[_0x202b4d(0x42f)]&&data[_0x202b4d(0x42f)]['enableWinddown']===![]&&this['state']===_0x202b4d(0x27f))playSound(_0x202b4d(0x1dc));else(this[_0x202b4d(0x460)]===_0x202b4d(0x292)||this[_0x202b4d(0x460)]===_0x202b4d(0x3bf)||this[_0x202b4d(0x460)]===_0x202b4d(0x183))&&playSound(_0x202b4d(0x27a));const _0x2d0477=$(_0x202b4d(0x44d));if(_0x2d0477)_0x2d0477[_0x202b4d(0x218)][_0x202b4d(0x2be)](_0x202b4d(0x2ff));if(data[_0x202b4d(0x42f)]['autoStartNext']){if(this['state']===_0x202b4d(0x27f))data[_0x202b4d(0x42f)][_0x202b4d(0x156)]===![]?this[_0x202b4d(0x279)]():this[_0x202b4d(0x30d)]();else this[_0x202b4d(0x460)]===_0x202b4d(0x292)?this[_0x202b4d(0x279)]():this[_0x202b4d(0x1ac)]();}else this[_0x202b4d(0x16c)]&&(clearInterval(this['tickHandle']),this['tickHandle']=null),this[_0x202b4d(0x460)]=_0x202b4d(0x23b),this[_0x202b4d(0x2e4)]=null,this[_0x202b4d(0x293)](),toast(_0x202b4d(0x294));},'beginWindDown'(){const _0x2c9665=_0x174741;if(data?.[_0x2c9665(0x42f)]?.['enableWinddown']===![]){this[_0x2c9665(0x279)]();return;}this[_0x2c9665(0x2e4)]=this[_0x2c9665(0x460)],this[_0x2c9665(0x460)]=_0x2c9665(0x292);const _0x91f40a=(this[_0x2c9665(0x429)]()[_0x2c9665(0x3b8)]||0x0)*0x3c;if(_0x91f40a<=0x0){this[_0x2c9665(0x279)]();return;}this[_0x2c9665(0x253)]=_0x91f40a,this['remaining']=_0x91f40a;try{playSound(_0x2c9665(0x27a));}catch(_0x552168){}try{toast('Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.');}catch(_0x3f5c9f){}this[_0x2c9665(0x18e)](),this['updateUI']();},'beginWork'(){const _0x36b694=_0x174741;this[_0x36b694(0x2e4)]=this[_0x36b694(0x460)],this[_0x36b694(0x460)]='work';if(this['mode']==='C'){this['segmentTotal']=0x0;if(this['prevState']!==_0x36b694(0x2b5))this[_0x36b694(0x186)]=0x0;}else{const _0x4ee715=this['currentDurations']()[_0x36b694(0x27f)]*0x3c;this[_0x36b694(0x253)]=_0x4ee715;if(this[_0x36b694(0x2e4)]!==_0x36b694(0x2b5))this[_0x36b694(0x186)]=_0x4ee715;}const _0x3b971a=$(_0x36b694(0x360));_0x3b971a&&(_0x3b971a[_0x36b694(0x38e)]=''),this[_0x36b694(0x18e)](),this[_0x36b694(0x293)]();},'finishFlowSession'(){const _0xba258c=_0x174741;if(this[_0xba258c(0x383)]!=='C'||this[_0xba258c(0x460)]!==_0xba258c(0x27f))return;this['tickHandle']&&(clearInterval(this[_0xba258c(0x16c)]),this[_0xba258c(0x16c)]=null);const _0x583233=Math[_0xba258c(0x200)](0x1,parseInt(data[_0xba258c(0x42f)][_0xba258c(0x13b)]??0x5,0xa)),_0x2941f4=Math[_0xba258c(0x200)](0x0,this[_0xba258c(0x186)]|0x0),_0xb8dd64=Math[_0xba258c(0x200)](0x3c,Math[_0xba258c(0x340)](_0x2941f4/_0x583233));try{const _0x104e11=getCurrentSubtopic();if(_0x104e11){const _0x14dc6e=Math[_0xba258c(0x200)](0x1,Math[_0xba258c(0x416)](_0x2941f4/0x3c));_0x104e11[_0xba258c(0x2d6)][_0xba258c(0x22c)]=(_0x104e11[_0xba258c(0x2d6)]['totalMinutes']||0x0)+_0x14dc6e,_0x104e11[_0xba258c(0x2d6)][_0xba258c(0x278)]=(_0x104e11[_0xba258c(0x2d6)][_0xba258c(0x278)]||0x0)+0x1;const _0x27fb6a={'id':uid('sess'),'dateISO':todayISO(),'durationMinutes':_0x14dc6e,'mode':this[_0xba258c(0x383)],'note':''};if(!_0x104e11[_0xba258c(0x2f8)])_0x104e11[_0xba258c(0x2f8)]=[];_0x104e11['sessions'][_0xba258c(0x163)](_0x27fb6a),saveData(),renderStatsHistory(),data?.['settings']?.[_0xba258c(0x3f8)]&&openNoteModal(_0x27fb6a['id']);}}catch(_0x5e98fc){}this[_0xba258c(0x460)]=_0xba258c(0x3bf),this[_0xba258c(0x253)]=_0xb8dd64,this[_0xba258c(0x186)]=_0xb8dd64,this[_0xba258c(0x18e)](),this[_0xba258c(0x293)](),this[_0xba258c(0x3a9)](!![]);try{toast(_0xba258c(0x33e)+Math[_0xba258c(0x416)](_0xb8dd64/0x3c)+_0xba258c(0x35d)+_0x583233+').');}catch(_0x31c602){}},'beginBreak'(){const _0x548de9=_0x174741;this[_0x548de9(0x2e4)]=this[_0x548de9(0x460)];const _0x3ee25f=this[_0x548de9(0x3b5)](),_0x163d2c=this[_0x548de9(0x429)]();if(this[_0x548de9(0x2a0)]>0x0&&this[_0x548de9(0x2a0)]%_0x3ee25f[_0x548de9(0x2cf)]===0x0){this[_0x548de9(0x460)]=_0x548de9(0x183);const _0x2ba3a5=_0x163d2c[_0x548de9(0x196)]*0x3c;this[_0x548de9(0x253)]=_0x2ba3a5;if(this['prevState']!==_0x548de9(0x2b5))this[_0x548de9(0x186)]=_0x2ba3a5;toast('Great!\x20Time\x20for\x20a\x20long\x20break.');}else{this[_0x548de9(0x460)]='break';const _0xbc6b33=_0x163d2c['short']*0x3c;this[_0x548de9(0x253)]=_0xbc6b33;if(this[_0x548de9(0x2e4)]!==_0x548de9(0x2b5))this[_0x548de9(0x186)]=_0xbc6b33;}const _0x23d9a2=$(_0x548de9(0x360));if(_0x23d9a2){const _0x3f5517=Math[_0x548de9(0x340)](Math['random']()*breakSuggestions[_0x548de9(0x26c)]);_0x23d9a2['textContent']=_0x548de9(0x3f9)+breakSuggestions[_0x3f5517];}this[_0x548de9(0x18e)](),this[_0x548de9(0x293)]();},async 'start'(){const _0x36a061=_0x174741;if(!getCurrentSubtopic()){toast('Please\x20select\x20a\x20Subtopic\x20first');return;}ensureAudio();if(this[_0x36a061(0x383)]==='C'&&this[_0x36a061(0x460)]===_0x36a061(0x23b))this[_0x36a061(0x460)]=_0x36a061(0x27f),this[_0x36a061(0x186)]=0x0,this[_0x36a061(0x253)]=0x0,this[_0x36a061(0x2a0)]=0x0,this[_0x36a061(0x18e)](),this[_0x36a061(0x293)]();else{if(this[_0x36a061(0x460)]==='idle')this[_0x36a061(0x2a0)]=this['cycleIndex']||0x0,this[_0x36a061(0x1ac)]();else this[_0x36a061(0x460)]===_0x36a061(0x2b5)&&this['resume']();}await this['persistTimerState'](!![]);},async 'pause'(){const _0x59d4a6=_0x174741;this[_0x59d4a6(0x16c)]&&(clearInterval(this['tickHandle']),this[_0x59d4a6(0x16c)]=null),this[_0x59d4a6(0x2e4)]=this[_0x59d4a6(0x460)],this['state']=_0x59d4a6(0x2b5),this['updateUI'](),await this[_0x59d4a6(0x3a9)](!![]);},async 'resume'(){const _0x40e2ff=_0x174741;if(this['state']!=='paused')return;this[_0x40e2ff(0x460)]=this[_0x40e2ff(0x2e4)]||_0x40e2ff(0x27f),this[_0x40e2ff(0x18e)](),this['updateUI'](),await this['persistTimerState'](!![]);},async 'skip'(){const _0x435ac9=_0x174741;if(this[_0x435ac9(0x383)]==='C'&&this[_0x435ac9(0x460)]===_0x435ac9(0x27f)){this[_0x435ac9(0x3b3)](),await this[_0x435ac9(0x3a9)](!![]);return;}this[_0x435ac9(0x460)]==='work'?(this['tickHandle']&&(clearInterval(this[_0x435ac9(0x16c)]),this[_0x435ac9(0x16c)]=null),this[_0x435ac9(0x186)]=0x0,this[_0x435ac9(0x1b3)]()):(this[_0x435ac9(0x186)]=0x0,this[_0x435ac9(0x16c)]&&(clearInterval(this[_0x435ac9(0x16c)]),this[_0x435ac9(0x16c)]=null),this[_0x435ac9(0x1b3)]()),await this[_0x435ac9(0x3a9)](!![]);},async 'reset'(){const _0xd8ee9f=_0x174741;this['tickHandle']&&(clearInterval(this[_0xd8ee9f(0x16c)]),this[_0xd8ee9f(0x16c)]=null);this[_0xd8ee9f(0x460)]=_0xd8ee9f(0x23b),this['prevState']=null,this['remaining']=0x0,this[_0xd8ee9f(0x253)]=0x0,this[_0xd8ee9f(0x2a0)]=0x0;const _0x42c9fb=$(_0xd8ee9f(0x360));_0x42c9fb&&(_0x42c9fb[_0xd8ee9f(0x38e)]=''),this[_0xd8ee9f(0x293)](),await this[_0xd8ee9f(0x3a9)](!![]);}};async function deleteSummary(_0x3d76e7){const _0x1560d9=_0x174741;showConfirmModal('Confirm\x20Deletion',_0x1560d9(0x29d),async _0x20a1ed=>{const _0x4b8c37=_0x1560d9;if(!_0x20a1ed)return;const _0x487c70=getCurrentSubtopic();if(!_0x487c70||!_0x487c70[_0x4b8c37(0x3bb)])return;const _0x515f18=[..._0x487c70[_0x4b8c37(0x3bb)]];_0x487c70['summaries']=_0x487c70['summaries']['filter'](_0x4d3b22=>_0x4d3b22['id']!==_0x3d76e7);try{await storageManager['update'](_0x4b8c37(0x25a),_0x487c70),renderSummaries(),toast('Summary\x20deleted.');}catch(_0x4d1265){console[_0x4b8c37(0x3ce)](_0x4b8c37(0x205),_0x4d1265),_0x487c70[_0x4b8c37(0x3bb)]=_0x515f18,toast('Unable\x20to\x20save\x20changes.');}});}function exportSummary(_0x2b031f){const _0x3db208=_0x174741,_0x1b836b=new Blob([_0x2b031f[_0x3db208(0x238)]],{'type':_0x3db208(0x1da)}),_0x55bc8d=document['createElement']('a'),_0x42611e=new Date(_0x2b031f[_0x3db208(0x2a3)]),_0xbed4fa=_0x13c928=>(''+_0x13c928)[_0x3db208(0x20a)](0x2,'0');_0x55bc8d[_0x3db208(0x1c6)]=URL[_0x3db208(0x141)](_0x1b836b),_0x55bc8d[_0x3db208(0x3dc)]=_0x3db208(0x269)+_0x42611e[_0x3db208(0x22f)]()+_0xbed4fa(_0x42611e[_0x3db208(0x199)]()+0x1)+_0xbed4fa(_0x42611e[_0x3db208(0x181)]())+_0x3db208(0x222),_0x55bc8d[_0x3db208(0x26a)](),URL[_0x3db208(0x25e)](_0x55bc8d[_0x3db208(0x1c6)]);}function renderStatsHistory(){const _0x7c910a=_0x174741,_0x225f2d=getCurrentSubtopic(),_0x3ec4ef=$(_0x7c910a(0x21f)),_0x320bbe=$(_0x7c910a(0x1f3)),_0x547870=$(_0x7c910a(0x246)),_0x309177=$(_0x7c910a(0x2c3));if(!_0x3ec4ef||!_0x320bbe||!_0x547870||!_0x309177)return;if(!_0x225f2d){_0x3ec4ef[_0x7c910a(0x38e)]='0\x20min',_0x320bbe[_0x7c910a(0x38e)]='0',_0x547870[_0x7c910a(0x38e)]='0',_0x309177[_0x7c910a(0x299)]=_0x7c910a(0x1ae);return;}const _0x239ea4=_0x225f2d[_0x7c910a(0x2d6)]&&_0x225f2d[_0x7c910a(0x2d6)][_0x7c910a(0x22c)]?_0x225f2d[_0x7c910a(0x2d6)][_0x7c910a(0x22c)]:0x0,_0x32fcaf=_0x225f2d[_0x7c910a(0x2d6)]&&_0x225f2d[_0x7c910a(0x2d6)][_0x7c910a(0x278)]?_0x225f2d[_0x7c910a(0x2d6)][_0x7c910a(0x278)]:0x0,_0x426d06=_0x225f2d[_0x7c910a(0x2ee)]?_0x225f2d[_0x7c910a(0x2ee)][_0x7c910a(0x283)](_0x48feec=>_0x48feec[_0x7c910a(0x378)])['length']:0x0;_0x3ec4ef[_0x7c910a(0x38e)]=formatDaysHoursMinutes(_0x239ea4),_0x320bbe[_0x7c910a(0x38e)]=String(_0x32fcaf),_0x547870['textContent']=String(_0x426d06),_0x309177[_0x7c910a(0x299)]='';const _0x35e471=Array[_0x7c910a(0x1f4)](_0x225f2d[_0x7c910a(0x2f8)])?_0x225f2d['sessions']:[];if(_0x35e471[_0x7c910a(0x26c)]===0x0){_0x309177[_0x7c910a(0x299)]=_0x7c910a(0x1f7);return;}_0x35e471[_0x7c910a(0x14e)](_0x49d5db=>{const _0x542f3b=_0x7c910a,_0x4bf05a=document[_0x542f3b(0x39d)](_0x542f3b(0x2d1));_0x4bf05a[_0x542f3b(0x3bc)]=_0x542f3b(0x2af);const _0x20131c=document[_0x542f3b(0x39d)](_0x542f3b(0x2d1)),_0x19c5b5=_0x49d5db['dateISO']?new Date(_0x49d5db[_0x542f3b(0x24b)]):new Date(),_0x1e5b26=_0x49d5db[_0x542f3b(0x2f6)]!=null?_0x49d5db[_0x542f3b(0x2f6)]:_0x49d5db[_0x542f3b(0x3e1)]||0x0,_0x113d49=_0x542f3b(0x3e7)+_0x19c5b5[_0x542f3b(0x3a3)]()+_0x542f3b(0x380)+_0x1e5b26+_0x542f3b(0x3ab)+(_0x49d5db[_0x542f3b(0x383)]||'')+'</div>';let _0x2ff3c0='';if(_0x49d5db[_0x542f3b(0x16a)])_0x2ff3c0=_0x542f3b(0x2fb)+escapeHTML(_0x49d5db[_0x542f3b(0x16a)])+'</div>';else data?.['settings']?.[_0x542f3b(0x3f8)]&&(_0x2ff3c0=_0x542f3b(0x32b));_0x20131c['innerHTML']=_0x113d49+_0x2ff3c0,_0x4bf05a[_0x542f3b(0x3d6)](_0x20131c),_0x309177[_0x542f3b(0x3d6)](_0x4bf05a);});}function renderGeneralNotes(){const _0x4d5b8a=_0x174741,_0x471ed2=$('#generalNotesList');if(!_0x471ed2)return;const _0x2581f2=getCurrentSubtopic();if(!_0x2581f2){_0x471ed2[_0x4d5b8a(0x299)]=_0x4d5b8a(0x2b1);return;}_0x2581f2[_0x4d5b8a(0x3c1)]=_0x2581f2[_0x4d5b8a(0x3c1)]||[];if(_0x2581f2['generalNotes'][_0x4d5b8a(0x26c)]===0x0){_0x471ed2[_0x4d5b8a(0x299)]=_0x4d5b8a(0x22e);return;}_0x471ed2['innerHTML']='',_0x2581f2[_0x4d5b8a(0x3c1)][_0x4d5b8a(0x14e)](_0x522899=>{const _0x1bdc19=_0x4d5b8a,_0x14ffe2=document[_0x1bdc19(0x39d)]('div');_0x14ffe2['className']=_0x1bdc19(0x138);const _0x574ad8=document[_0x1bdc19(0x39d)]('div');_0x574ad8[_0x1bdc19(0x3bc)]=_0x1bdc19(0x14a),_0x574ad8[_0x1bdc19(0x38e)]=typeof _0x522899===_0x1bdc19(0x413)?_0x522899:_0x522899[_0x1bdc19(0x2aa)]||'';const _0x1b25d5=document['createElement'](_0x1bdc19(0x2d1));_0x1b25d5['className']='note-meta',_0x1b25d5[_0x1bdc19(0x38e)]=_0x522899[_0x1bdc19(0x2a3)]?new Date(_0x522899['createdAt'])[_0x1bdc19(0x3a3)]():'';const _0x2283e8=document[_0x1bdc19(0x39d)](_0x1bdc19(0x2d1)),_0xab025c=document['createElement'](_0x1bdc19(0x453));_0xab025c[_0x1bdc19(0x3bc)]=_0x1bdc19(0x352),_0xab025c[_0x1bdc19(0x38e)]='Delete',_0xab025c[_0x1bdc19(0x152)]=async _0x383740=>{const _0x72b8bb=_0x1bdc19;_0x383740[_0x72b8bb(0x391)]();const _0xc3db86=getCurrentSubtopic();if(!_0xc3db86)return;_0xc3db86[_0x72b8bb(0x3c1)]=(_0xc3db86[_0x72b8bb(0x3c1)]||[])[_0x72b8bb(0x283)](_0x2ed23d=>(_0x2ed23d['id']||_0x2ed23d)!==(_0x522899['id']||_0x522899)),await saveData(),renderGeneralNotes();},_0x2283e8[_0x1bdc19(0x3d6)](_0xab025c);const _0x5efa1d=document[_0x1bdc19(0x39d)](_0x1bdc19(0x2d1));_0x5efa1d[_0x1bdc19(0x3bc)]=_0x1bdc19(0x17d),_0x5efa1d[_0x1bdc19(0x29b)](_0x574ad8,_0x1b25d5),_0x14ffe2[_0x1bdc19(0x29b)](_0x5efa1d,_0x2283e8),_0x471ed2[_0x1bdc19(0x3d6)](_0x14ffe2);});}function renderMethods(){const _0x355a6f=_0x174741,_0x816f4a=document[_0x355a6f(0x331)](_0x355a6f(0x38b));if(!_0x816f4a)return;_0x816f4a[_0x355a6f(0x299)]='';const _0x4f9218=getCurrentSubtopic();if(!_0x4f9218){_0x816f4a['innerHTML']='<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20its\x20Knowledge\x20Base.</p>';return;}const _0x461073=Array[_0x355a6f(0x1f4)](_0x4f9218[_0x355a6f(0x36a)])?_0x4f9218[_0x355a6f(0x36a)]:[];if(_0x461073['length']===0x0){_0x816f4a[_0x355a6f(0x299)]='<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>';return;}_0x461073['forEach'](_0x64c606=>{const _0x4756e9=_0x355a6f,_0x150153=document[_0x4756e9(0x39d)](_0x4756e9(0x274));_0x150153[_0x4756e9(0x3bc)]=_0x4756e9(0x32a),_0x150153['dataset'][_0x4756e9(0x225)]=_0x64c606['id'];const _0x4d5254=document[_0x4756e9(0x39d)](_0x4756e9(0x38f)),_0x57012c=document[_0x4756e9(0x39d)](_0x4756e9(0x31d));_0x57012c[_0x4756e9(0x3bc)]=_0x4756e9(0x28a),_0x57012c['textContent']=_0x64c606[_0x4756e9(0x420)]||_0x4756e9(0x192),_0x57012c[_0x4756e9(0x26f)](_0x4756e9(0x26a),_0x4176a8=>{const _0x20a8d8=_0x4756e9;_0x4176a8[_0x20a8d8(0x2e0)](),_0x4176a8[_0x20a8d8(0x391)](),_0x150153['open']=!_0x150153[_0x20a8d8(0x2c8)];});const _0x5ea190=document[_0x4756e9(0x39d)]('div');_0x5ea190[_0x4756e9(0x3bc)]=_0x4756e9(0x38a);const _0x382804=document[_0x4756e9(0x39d)]('button');_0x382804[_0x4756e9(0x3bc)]='btn\x20small\x20ghost\x20method-edit',_0x382804[_0x4756e9(0x38e)]=_0x4756e9(0x307),_0x382804[_0x4756e9(0x31c)]['id']=_0x64c606['id'];const _0x4466=document[_0x4756e9(0x39d)](_0x4756e9(0x453));_0x4466['className']=_0x4756e9(0x1c0),_0x4466[_0x4756e9(0x38e)]=_0x4756e9(0x273),_0x4466[_0x4756e9(0x31c)]['id']=_0x64c606['id'],_0x5ea190[_0x4756e9(0x29b)](_0x382804,_0x4466),_0x4d5254[_0x4756e9(0x29b)](_0x57012c,_0x5ea190);const _0x1056b9=document[_0x4756e9(0x39d)](_0x4756e9(0x2d1));_0x1056b9[_0x4756e9(0x3bc)]=_0x4756e9(0x333),_0x1056b9[_0x4756e9(0x299)]=_0x64c606[_0x4756e9(0x238)]||'',_0x150153[_0x4756e9(0x29b)](_0x4d5254,_0x1056b9),_0x816f4a[_0x4756e9(0x3d6)](_0x150153),_0x150153[_0x4756e9(0x26f)]('click',_0x23050c=>{const _0x5152f0=_0x4756e9,_0x4f12b3=_0x23050c[_0x5152f0(0x1cb)];if(!_0x4f12b3)return;if(_0x4f12b3['closest'](_0x5152f0(0x453))||_0x4f12b3['closest']('a')||_0x4f12b3[_0x5152f0(0x25b)]('.color-picker-wrapper')||_0x4f12b3[_0x5152f0(0x25b)](_0x5152f0(0x3eb)))return;if(!_0x150153[_0x5152f0(0x2c8)])_0x150153['open']=!![];});});const _0x385f73=_0x816f4a[_0x355a6f(0x145)](_0x355a6f(0x14f));_0x385f73['forEach'](_0x51d234=>{const _0x58aeac=_0x355a6f;_0x51d234[_0x58aeac(0x26f)](_0x58aeac(0x18d),()=>{const _0xc0586f=_0x58aeac;_0x51d234[_0xc0586f(0x2c8)]&&_0x385f73[_0xc0586f(0x14e)](_0x886322=>{if(_0x886322!==_0x51d234)_0x886322['open']=![];});});});}function addGeneralNote(){const _0x5a5254=_0x174741;showInputModal(_0x5a5254(0x1bc),async _0x41cb7d=>{const _0x346b41=_0x5a5254;if(!_0x41cb7d)return;const _0x214859=getCurrentSubtopic();if(!_0x214859){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}_0x214859[_0x346b41(0x3c1)]=_0x214859[_0x346b41(0x3c1)]||[],_0x214859[_0x346b41(0x3c1)][_0x346b41(0x163)]({'id':uid('gn'),'text':_0x41cb7d,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x34aa27=_0x174741,_0x13aac8=getCurrentSubtopic();if(!_0x13aac8){toast(_0x34aa27(0x249));return;}const _0x1885f2=(_0x13aac8['generalNotes']||[])[_0x34aa27(0x3cf)](_0x448297=>typeof _0x448297===_0x34aa27(0x413)?_0x448297:_0x448297[_0x34aa27(0x2aa)]||'')[_0x34aa27(0x283)](Boolean);if(_0x1885f2['length']===0x0){toast(_0x34aa27(0x43e));return;}const _0xd5681e=$(_0x34aa27(0x213));_0xd5681e&&(_0xd5681e['disabled']=!![],_0xd5681e[_0x34aa27(0x299)]=_0x34aa27(0x357));try{const _0x306bb7=_0x34aa27(0x1aa)+_0x1885f2[_0x34aa27(0x21c)](_0x34aa27(0x23a)),_0x3dec68=await callGeminiAPI(_0x306bb7);if(!_0x13aac8[_0x34aa27(0x3bb)])_0x13aac8['summaries']=[];_0x13aac8[_0x34aa27(0x3bb)][_0x34aa27(0x163)]({'id':uid(_0x34aa27(0x44b)),'content':_0x3dec68||_0x34aa27(0x17b),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x256e18){console[_0x34aa27(0x3ce)](_0x256e18),toast('Summary\x20failed.');}finally{_0xd5681e&&(_0xd5681e['disabled']=![],_0xd5681e[_0x34aa27(0x38e)]=_0x34aa27(0x445));}}function renderSummaries(){const _0x2582a6=_0x174741,_0x1ded94=$(_0x2582a6(0x37a));if(!_0x1ded94)return;const _0x162000=getCurrentSubtopic();if(!_0x162000){_0x1ded94[_0x2582a6(0x299)]=_0x2582a6(0x171);return;}_0x1ded94['innerHTML']='';if(!_0x162000[_0x2582a6(0x3bb)]||_0x162000[_0x2582a6(0x3bb)][_0x2582a6(0x26c)]===0x0){_0x1ded94[_0x2582a6(0x299)]=_0x2582a6(0x371);return;}_0x162000[_0x2582a6(0x3bb)][_0x2582a6(0x14e)](_0x3ff4c3=>{const _0x7584f7=_0x2582a6,_0x271020=document[_0x7584f7(0x39d)]('div');_0x271020[_0x7584f7(0x3bc)]=_0x7584f7(0x138);const _0x359897=document['createElement']('div');_0x359897[_0x7584f7(0x3bc)]=_0x7584f7(0x17d);const _0x3636ae=document[_0x7584f7(0x39d)](_0x7584f7(0x2d1));_0x3636ae[_0x7584f7(0x3bc)]=_0x7584f7(0x14a),_0x3636ae['textContent']=_0x3ff4c3[_0x7584f7(0x238)];const _0x30b940=document[_0x7584f7(0x39d)]('div');_0x30b940[_0x7584f7(0x3bc)]=_0x7584f7(0x24d),_0x30b940['textContent']=new Date(_0x3ff4c3[_0x7584f7(0x2a3)])[_0x7584f7(0x3a3)](),_0x359897[_0x7584f7(0x29b)](_0x3636ae,_0x30b940);const _0x5031d4=document[_0x7584f7(0x39d)](_0x7584f7(0x2d1)),_0x3578eb=document[_0x7584f7(0x39d)]('button');_0x3578eb[_0x7584f7(0x3bc)]=_0x7584f7(0x441),_0x3578eb['textContent']='Export',_0x3578eb['onclick']=_0x3dfc47=>{const _0x5da791=_0x7584f7;_0x3dfc47[_0x5da791(0x391)](),exportSummary(_0x3ff4c3);};const _0x220244=document[_0x7584f7(0x39d)](_0x7584f7(0x453));_0x220244['className']=_0x7584f7(0x352),_0x220244[_0x7584f7(0x38e)]=_0x7584f7(0x273),_0x220244[_0x7584f7(0x152)]=_0x11e030=>{_0x11e030['stopPropagation'](),deleteSummary(_0x3ff4c3['id']);},_0x5031d4[_0x7584f7(0x29b)](_0x3578eb,_0x220244),_0x271020[_0x7584f7(0x29b)](_0x359897,_0x5031d4),_0x271020[_0x7584f7(0x26f)](_0x7584f7(0x26a),()=>_0x3636ae[_0x7584f7(0x218)][_0x7584f7(0x18d)](_0x7584f7(0x31f))),_0x1ded94[_0x7584f7(0x3d6)](_0x271020);});}function loadEditingPresetFields(){const _0x5f366b=_0x174741,_0x53d80d=data[_0x5f366b(0x42f)],_0x1b74ae=_0x53d80d[_0x5f366b(0x1b2)],_0x375399=$(_0x5f366b(0x400)),_0x3271f9=$(_0x5f366b(0x35f));if(_0x375399&&_0x3271f9){const _0x3b280e=editingPreset==='C';_0x375399[_0x5f366b(0x218)][_0x5f366b(0x18d)](_0x5f366b(0x17f),_0x3b280e),_0x3271f9[_0x5f366b(0x218)][_0x5f366b(0x18d)](_0x5f366b(0x17f),!_0x3b280e);}if(editingPreset==='A'){$('#set_work')[_0x5f366b(0x262)]=_0x1b74ae[_0x5f366b(0x159)];if($('#set_winddown'))$('#set_winddown')[_0x5f366b(0x262)]=_0x1b74ae[_0x5f366b(0x1fa)]??0x0;$('#set_short')[_0x5f366b(0x262)]=_0x1b74ae['A_short'],$(_0x5f366b(0x350))['value']=_0x1b74ae[_0x5f366b(0x37f)],$(_0x5f366b(0x1ca))['value']=_0x53d80d['cyclesA'],$(_0x5f366b(0x1d7))[_0x5f366b(0x262)]=_0x53d80d[_0x5f366b(0x2c6)];}else{if(editingPreset==='B'){$(_0x5f366b(0x1c9))[_0x5f366b(0x262)]=_0x1b74ae[_0x5f366b(0x17e)];if($(_0x5f366b(0x3b4)))$('#set_winddown')['value']=_0x1b74ae['B_winddown']??0x0;$(_0x5f366b(0x404))[_0x5f366b(0x262)]=_0x1b74ae[_0x5f366b(0x362)],$(_0x5f366b(0x350))['value']=_0x1b74ae[_0x5f366b(0x290)],$(_0x5f366b(0x1ca))['value']=_0x53d80d[_0x5f366b(0x1a3)],$('#set_interval')[_0x5f366b(0x262)]=_0x53d80d[_0x5f366b(0x389)];}else{if(editingPreset==='C'){const _0x1845ab=$('#set_flowRatio');if(_0x1845ab)_0x1845ab['value']=_0x53d80d[_0x5f366b(0x13b)]??0x5;}}}}function highlightPresetSelector(){const _0x5bdc03=_0x174741;$$(_0x5bdc03(0x3f2))[_0x5bdc03(0x14e)](_0xece454=>{const _0x283cfe=_0x5bdc03,_0x8b54e=_0xece454[_0x283cfe(0x31c)][_0x283cfe(0x267)]===editingPreset;_0xece454[_0x283cfe(0x218)]['toggle'](_0x283cfe(0x260),_0x8b54e),_0xece454[_0x283cfe(0x218)][_0x283cfe(0x18d)](_0x283cfe(0x317),!_0x8b54e);});}function openSettings(){const _0x5bf1bc=_0x174741,_0x3b8079=data[_0x5bf1bc(0x42f)];editingPreset=_0x3b8079[_0x5bf1bc(0x231)],$(_0x5bf1bc(0x374))['value']=_0x3b8079[_0x5bf1bc(0x1b9)]||'',loadEditingPresetFields(),highlightPresetSelector(),$(_0x5bf1bc(0x434))['value']=_0x3b8079[_0x5bf1bc(0x3df)]??0.8,$(_0x5bf1bc(0x1f2))[_0x5bf1bc(0x262)]=_0x3b8079[_0x5bf1bc(0x3f5)]||_0x5bf1bc(0x201),$('#set_theme_color')[_0x5bf1bc(0x262)]=_0x3b8079[_0x5bf1bc(0x439)]||_0x5bf1bc(0x3de);const _0x587993=getActiveYoutubeUrl();$(_0x5bf1bc(0x18f))[_0x5bf1bc(0x262)]=_0x587993||'';const _0x32a5ce=extractYouTubeID(_0x587993);$(_0x5bf1bc(0x3b7))[_0x5bf1bc(0x28c)]=!_0x32a5ce;$(_0x5bf1bc(0x16b))&&($(_0x5bf1bc(0x16b))[_0x5bf1bc(0x38e)]='');$(_0x5bf1bc(0x36d))[_0x5bf1bc(0x262)]=_0x3b8079[_0x5bf1bc(0x234)]||0x50,$('#set_ytThumbAsBg')[_0x5bf1bc(0x3be)]=!!_0x3b8079[_0x5bf1bc(0x206)],$(_0x5bf1bc(0x34d))[_0x5bf1bc(0x262)]=_0x3b8079[_0x5bf1bc(0x39a)]||0.85;$('#set_backgroundMode')&&($(_0x5bf1bc(0x3c5))['value']=_0x3b8079[_0x5bf1bc(0x3af)]||_0x5bf1bc(0x312));$('#set_autoStartNext')&&($(_0x5bf1bc(0x275))[_0x5bf1bc(0x3be)]=!!_0x3b8079['autoStartNext']);$(_0x5bf1bc(0x3c9))&&($('#set_enableWinddown')[_0x5bf1bc(0x3be)]=_0x3b8079[_0x5bf1bc(0x156)]!==![]);$(_0x5bf1bc(0x405))&&($('#set_enableSessionNotes')['checked']=!!_0x3b8079[_0x5bf1bc(0x3f8)]);$(_0x5bf1bc(0x424))&&($(_0x5bf1bc(0x424))[_0x5bf1bc(0x262)]=_0x3b8079[_0x5bf1bc(0x3ca)]||0x7);const _0x3e2de7=$(_0x5bf1bc(0x3a6));_0x3e2de7&&storageManager['getBackupList']()[_0x5bf1bc(0x26d)](_0x3ee749=>{const _0x31b68a=_0x5bf1bc;_0x3e2de7[_0x31b68a(0x299)]='<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>',_0x3ee749&&_0x3ee749[_0x31b68a(0x26c)]>0x0?_0x3ee749[_0x31b68a(0x14e)](_0x377a9c=>{const _0x54728b=_0x31b68a,_0x3a6b11=document['createElement'](_0x54728b(0x37b));_0x3a6b11[_0x54728b(0x262)]=_0x377a9c[_0x54728b(0x23e)],_0x3a6b11[_0x54728b(0x38e)]='Backup\x20from:\x20'+new Date(_0x377a9c[_0x54728b(0x23e)])[_0x54728b(0x36b)]('en-US'),_0x3e2de7[_0x54728b(0x3d6)](_0x3a6b11);}):_0x3e2de7[_0x31b68a(0x299)]=_0x31b68a(0x2c2);});$(_0x5bf1bc(0x1ba))['classList'][_0x5bf1bc(0x2be)]('show');try{trapFocus($(_0x5bf1bc(0x1ba)));}catch(_0x7baabb){}}function closeSettings(){const _0x295439=_0x174741;$(_0x295439(0x1ba))['classList'][_0x295439(0x1b5)]('show');try{releaseFocus();}catch(_0x246c7d){}}function _0x38e1(){const _0x4d1d76=['#btnHelpCreateTopic','src','&gt;','#currentSubtopicName','#dashboardContent','To\x20You,\x2020\x20Hours\x20(Foundation)','3700JnmcyN','Rename\x20Topic','panelOpacity','location','No\x20Subtopic\x20Selected','createElement','Content\x20blocked\x20for:\x20','.timer-circle-progress','#btnClearBg','stop','parts','toLocaleString','removing','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','#backupList','.modal','subtopic','persistTimerState','sine','\x27\x20·\x20Mode\x20','Show\x20interface','__ytApiWatchdog','#modalGeneric','backgroundMode','(none\x20selected)','sid','tid','finishFlowSession','#set_winddown','currentConfig','Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.','#btnToggleYtSound','winddown','<tr><td>','</td><td>','summaries','className','btn\x20subtopic-btn','checked','break','contentWindow','generalNotes','#windDownChecklist','http','AI\x20finished\x20formatting!','#set_backgroundMode','Confirm\x20Deletion','ytUrlFeedback','task','#set_enableWinddown','backupDaysToKeep','.actions-menu-btn','0\x20min','No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.','error','map','updateSettings','#aiPromptSuggestions\x20button','space','catch','BUFFERING','toast','appendChild','linearRampToValueAtTime','Add\x20New\x20Knowledge','Please\x20select\x20a\x20backup.','#modalNote','reduce','download','name','default','volume','btnToggleYtSound','workMinutes','Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.','#timeDisplay','.json','unMute','<ol>','<div\x20class=\x22hist-meta\x22>','button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])','cueVideoById','#methodEditorId','.color-palette','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?','#uploadSoundLong','customBg','IndexedDB\x20initialized\x20successfully.','isContentEditable','Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.','#timerPresetSelector\x20button','.method-edit','no-repeat','soundTheme','oldIndex','27442CTkDuJ','enableSessionNotes','💡\x20Suggestion:\x20','readwrite','chev\x20btn\x20small\x20ghost','Initialization\x20error:','lofi','#btnSummarizeNote','\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**✨\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**🚀\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]','#settings-pomodoro','reverse','left','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','#set_short','#set_enableSessionNotes','skip','Switch\x20to\x20Style\x20','#btnPresetC','Enter','6268088xahzDk','soundOn','getSettings','?\x20Current\x20data\x20will\x20be\x20overwritten.','insertUnorderedList','activeElement','prompt','item','absolute','string','#btnGenericCancel','pointerdown','round','Delete\x20knowledge\x20\x22','FOCUS\x20(FLOW)','documentElement','#genericMessage','lastBackupDate','onload','menu-active','Delete\x20Subtopic','selectionStart','title','modalMethodEditor','command','<span\x20class=\x22ico\x22>▾</span>','#set_backupDays','B_winddown','all','top','#btnRestoreBackup','currentDurations','exponentialRampToValueAtTime','aria-pressed','Add\x20subtopic','autoplay;\x20encrypted-media;\x20picture-in-picture','contains','settings','Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','bottom','Chat\x20history\x20cleared.','####\x20','#set_volume','localeCompare','DB_VERSION','createObjectStore','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','theme','onkeydown','autoStartNext','#customSoundsContainer','Do\x20a\x20few\x20deep-breathing\x20cycles.','No\x20notes\x20to\x20summarize.','indexOf','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','btn\x20small','Playing','setPreset','Saved\x20alert\x20for\x20SHORT\x20BREAK.','Summarize','achievedMilestones','#toolList','</li>','unknown','#btnMilestoneClose','sum','altKey','.timer-circle-container','change','Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time—it\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‘superpower’\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.','setItem','\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22','#topicsList','button','replace','#btnSaveNote','backups','#btnSendMessage','Error\x20calling\x20Gemini\x20API:','put','7XPEjBM','New\x20Subtopic\x20name?','Gemini\x20API\x20Error:','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','set_youtubeUrl','onYouTubeIframeAPIReady','state','#btnStart','status','#view-methods\x20.method-item','warn','push','note-item','/hqdefault.jpg','#btnPause','flowtimeBreakRatio','Background\x20updated.','offsetHeight','test','Escape','tagName','createObjectURL','topicId','#toolBold','.nav-btn[data-view]','querySelectorAll','#btnAddGeneralNote','<strong>$1</strong>','reloading','opacity','note-content','.app-content','load','Count\x20down\x20slowly\x20from\x2020\x20to\x200.','forEach','.method-item','connect','Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.','onclick','topic','scroll','Cycle\x20','enableWinddown','shiftKey','cleanupOldBackups','A_work','backgroundRepeat','FOCUS','The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','#uploadBg','Five\x20focused\x20hours!\x20You’ve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','textarea','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.','offsetWidth','#btnToggleBg','unshift','<p>The\x20core\x20idea:\x20\x22If\x20you\x20can’t\x20explain\x20a\x20topic\x20simply,\x20you\x20don’t\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can’t\x20explain\x20smoothly,\x20you’ve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it’s\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool—pinpointing\x20exactly\x20where\x20you’re\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>','Stand\x20up\x20and\x20stretch.','READY','Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.','Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22','timer.selectSubtopicPrompt','note','#ytUrlFeedback','tickHandle','#btnAddMethod','insertOrderedList','Have\x20a\x20sip\x20of\x20water.','scrollTop','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>','view','fullscreenchange','getPlayerState','active','#btnSaveMethod','#btnAutoFormat','statusText','5169942dojlOY','setRangeText','(Could\x20not\x20generate\x20summary)','#btnGenericOk','note-content-wrapper','B_work','hidden','<li>','getDate','Rename\x20Subtopic','long_break','#genericInput','https:','remaining','#toolItalic','var(--acc)','badge','#btnExport','sub-row','getIframe','toggle','_startTick','#set_youtubeUrl','Backup\x20failed:','innerWidth','Untitled','-9999px','❌\x20Invalid\x20or\x20unsupported\x20link.','color','long','application/json','update','getMonth','100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment—it’s\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.','mouseup','getAll','Failed\x20to\x20load\x20YouTube\x20API','script','Invalid\x20file\x20format','http:','Tab','Player','cyclesB','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.','Delete\x20Topic','errorCode','play','createGain','toLowerCase','Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a','find','beginWork','display','<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>','badge\x20state\x20break','right','timer.cycleInfo','durations','_onFinishSegment','var(--acc-2)','remove','getPropertyValue','chatHistory','version','apiKey','#modalSettings','exitFullscreen','Add\x20note','actions-menu','1854nIoTqJ','.color-swatch','btn\x20small\x20danger\x20method-delete','WIND-DOWN','sess','importData','A_short','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>','href','AutoBackup\x20error:','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','#set_work','#set_cycles','target','#btnFinishFlow','#btnClearChat','includes','Initialization\x20error:\x20','flatMap','pauseVideo','body','.color-picker-wrapper','Check\x20your\x20breathing—if\x20rushed,\x20slow\x20it\x20down.','var(--sub)','https://img.youtube.com/vi/','#set_interval','long_end','Failed\x20to\x20save\x20data:','text/plain','start','work_end','Notice\x20the\x20room’s\x20temperature\x20and\x20lighting.','position','splice','ArrowUp','soundPermissionBar','#cycleInfo','auto','pomodoro_backup_','menu-item\x20danger','#btnReset','log','#btnDefaults','strokeDashoffset','repeat','onsuccess','topic-item','Gemini\x20error:\x20','main_settings','bold','AudioContext','ArrowLeft','#set_theme','#statSessions','isArray','exportData','\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.','<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>','2825442DRrraJ','clientY','A_winddown','var(--warn)','file','random','\x20hours\x20','.nav-btn[data-view=\x22','max','beep','Settings\x20saved','user','lastPersist','Failed\x20to\x20delete\x20summary:','useYtThumbnailAsBg','\x20|\x20<strong>Total\x20sessions:</strong>\x20','reset','selectedTopicId','padStart','blockReason','origin','&lt;','readonly','To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','.actions-menu.show','<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20🧠</h4><p>Based\x20on\x20the\x20“Forgetting\x20Curve,”\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you’re\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you’ll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20📱</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20❌</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>—creating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010–20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory’s\x20“sweet\x20spot.”\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>','PLAYING','#btnSummarize','&amp;','data:','#btnCloseDashboard','#btnCancelMethodEditor','classList','split','from','#btnSaveSettings','join','.method-delete','_getStore','#statTotal','<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>','tasksCompleted','.txt','🌊\x20Flow','#noteText','methodId','width','blob:','pause','#editorPreview','--panel-opacity','.subtopic-btn','totalMinutes','gain','<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>','getFullYear','loadLanguage','preset','cyclesA','hours','youtubeVolume','requestFullscreen','min','no-subtopic-selected','content','SHORT\x20BREAK','\x0a-\x20','idle','save','sound_unlocked','date','files','Background\x20music\x20stopped.','isNaN','Deleted\x20old\x20backup:\x20','\x20(B)','block','#toolColor','#statTasks','stopVideo','#btnSettings','Please\x20select\x20a\x20subtopic\x20first.','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>','dateISO','isConnected','note-meta','styleWithCSS','removeProperty','Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.','triangle','show','segmentTotal','topics','Creating\x20backup\x20for\x20','Saved\x20alert\x20for\x20LONG\x20BREAK.','https://www.youtube.com/embed/','initDB','abs','subtopics','closest','about:blank','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','revokeObjectURL','Switched\x20to\x20Style\x20','acc','delete','value','</label>','Space','#draggableTimer','promptFeedback','presetTarget','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.','summary_','click','async','length','then','innerHeight','addEventListener','undefined','getBoundingClientRect','API\x20response\x20structure\x20is\x20unexpected:','Delete','details','#set_autoStartNext','Check\x20and\x20correct\x20your\x20sitting\x20posture.','relative','sessionsCompleted','beginBreak','break_end','#toasts','Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.','Note\x20saved','var(--danger)','work','#btnToggleCustomSounds','mute','defer','filter','#chatInput','head','#modalMethodEditor','#view-timer','OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...','resume','method-title','playVideo','disabled','#milestoneTitle','#methodEditorTitleInput','code','B_long','type','wind_down','updateUI','Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.','timer','Content\x20required\x20for\x20AI\x20formatting.','toString','clear','innerHTML','#btnDashboard','append','Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?','ENDED','function','cycleIndex','Playing\x20background\x20music...','transaction','createdAt','setAttribute','destination','timerState','resolve','candidates','#genericTitle','text','<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20','stringify','#modalMilestone','clientX','hist-item','1480068kcbKsd','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>','PAUSED','#btnPresetA','#set_ytThumbAsBg','paused','menu-item','#welcomePanel','#selectedContext','getItem','trim','backgroundImage','To\x20You,\x205,000+\x20Hours\x20(Legacy)','Look\x20at\x20something\x20cute\x20or\x20uplifting.','add','https://www.youtube.com','findIndex','yt-fallback','<option\x20value=\x22\x22>No\x20backups\x20available</option>','#historyList','Use\x20AI\x20to\x20auto-format\x20text','light','longBreakIntervalA','setVolume','open','Custom\x20background\x20removed.','breathing','data','pastel','flex','now','interval','foreColor','div','#btnPresetB','<h4>','250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You’ve\x20met\x20hard\x20days\x20and\x20distractions—and\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.','Tidy\x20or\x20rearrange\x20your\x20workspace.','stats','currentTime','timerState_','badge\x20state\x20work','onerror','focus','bg-view-mode','#btnEnableSound','#set_flowRatio','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','preventDefault','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','#btnResume','reload','prevState','PlayerState','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','substring','none','newIndex','removeEventListener','Subtopic:\x20','#btnSkip','POST','tasks','#btnSkipNote','sort','btn\x20small\x20ghost\x20actions-menu-btn','message','.subtopics','</ol>','stroke','durationMinutes','\x20(A)','sessions','file:','Defaults\x20restored','<div>','objectStoreNames','#methodEditorContentInput','slice','finished','...','backgroundSize','toISOString','<p>','topic-title','values','oncomplete','Edit','#btnBreakEarly','<input\x20type=\x22checkbox\x22\x20id=\x22','_sortable','getVolume','Loosen\x20your\x20finger\x20joints\x20after\x20typing.','beginWindDown','ArrowDown','Error\x20saving\x20data:\x20','#welcomePanel\x20p','italic','cover','beforeunload','&quot;','var(--muted)','Confirm\x20Restore','ghost','/maxresdefault.jpg','badge\x20state\x20long','Edit\x20Knowledge','Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','dataset','span','youtube-player-container','expanded','#btnFullscreen','parentElement','createOscillator','json','actions','selectedSubtopicId','destroy','#newSubtopicTaskInput','Audio\x20playback\x20error:','getElementById','method-item','<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>','autoBackup','</tbody></table>','chime','<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203–5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20“Force\x20Multiplier”:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','querySelector','To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','method-content','currentView','selectionEnd','pomodoroData_v11','#set_theme_color','setProperty','Please\x20enter\x20a\x20note\x20before\x20summarizing.','result','cycles','New\x20Topic\x20name?','startsWith','Break\x20','#uploadSoundBreak','floor','#audioLongEnd','.topic-item','by_topic','Backup\x20not\x20found.','#btnAddTopic','topic-header','5DOKugD','iframe','onupgradeneeded','match','<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively—rather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later—once\x20you’ve\x20forgotten\x20the\x20original\x20style—use\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn’t\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses—turning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don’t\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','#set_panelOpacity','5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‘How\x20do\x20I\x20focus?’\x20to\x20‘What\x20value\x20will\x20this\x20focus\x20create?’.\x20You’re\x20not\x20just\x20working—you’re\x20building\x20a\x20legacy.','baseVal','#set_long','cancel','btn\x20small\x20danger','To\x20You,\x201,000\x20Hours\x20(Transformation)','strokeDasharray','https://www.youtube.com/iframe_api','select','<div\x20class=\x22spinner\x22></div>','#methodEditorTitle','keydown','Import\x20failed:\x20','7231378VLHhQg','__ytApiPromise','\x20min\x20via\x20Flowtime\x20(','\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22','#settings-flowtime','#breakSuggestionDisplay','Open\x20a\x20window\x20for\x20some\x20fresh\x20air.','B_short','height','protocol','input','key','input,select,textarea','.presets\x20button','.nav-btn','methods','toLocaleDateString','fullscreenElement','#ytSoundVolume','mousedown','Daily\x20backup\x20successful.','frequency','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','<i>$1</i>','.tab-btn','#set_apiKey','model','tab','#audioWorkEnd','isCompleted','pomodoro_files','#summariesList','option','parse','Sortable','get','A_long','\x20·\x20','--bg-image','\x20|\x20<strong>Total\x20tasks:</strong>\x20','mode','transition','style','.actions-menu','webkitAudioContext','#btnCloseSettings','longBreakIntervalB','topic-actions','#view-methods\x20.methods-container','objectStore','url(','textContent','summary','customSounds','stopPropagation'];_0x38e1=function(){return _0x4d1d76;};return _0x38e1();}async function setDefaults(){const _0x3349a8=_0x174741;data[_0x3349a8(0x42f)][_0x3349a8(0x1b2)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data['settings'][_0x3349a8(0x232)]=0x4,data[_0x3349a8(0x42f)][_0x3349a8(0x2c6)]=0x4,data[_0x3349a8(0x42f)][_0x3349a8(0x1a3)]=0x4,data[_0x3349a8(0x42f)]['longBreakIntervalB']=0x4,data['settings'][_0x3349a8(0x13b)]=0x5,data[_0x3349a8(0x42f)][_0x3349a8(0x231)]='A',data[_0x3349a8(0x42f)]['volume']=0.8,data[_0x3349a8(0x42f)][_0x3349a8(0x3f5)]=_0x3349a8(0x201),await saveData(),openSettings(),toast(_0x3349a8(0x2fa));}async function saveSettings(){const _0x1b11da=_0x174741,_0x5f4238=data['settings'];_0x5f4238[_0x1b11da(0x1b9)]=$('#set_apiKey')[_0x1b11da(0x262)][_0x1b11da(0x2ba)]();const _0x55e639=_0x5f4238[_0x1b11da(0x1b2)];if(editingPreset==='A')_0x55e639[_0x1b11da(0x159)]=clampInt($('#set_work')[_0x1b11da(0x262)],0x1,0x3e7),_0x55e639[_0x1b11da(0x1fa)]=clampInt($('#set_winddown')[_0x1b11da(0x262)],0x0,0x3e7),_0x55e639[_0x1b11da(0x1c4)]=clampInt($('#set_short')[_0x1b11da(0x262)],0x1,0x3e7),_0x55e639[_0x1b11da(0x37f)]=clampInt($(_0x1b11da(0x350))[_0x1b11da(0x262)],0x1,0x3e7),_0x5f4238[_0x1b11da(0x232)]=clampInt($(_0x1b11da(0x1ca))[_0x1b11da(0x262)],0x1,0xc),_0x5f4238[_0x1b11da(0x2c6)]=clampInt($(_0x1b11da(0x1d7))['value'],0x2,0xc);else{if(editingPreset==='B')_0x55e639['B_work']=clampInt($(_0x1b11da(0x1c9))[_0x1b11da(0x262)],0x1,0x3e7),_0x55e639[_0x1b11da(0x425)]=clampInt($('#set_winddown')[_0x1b11da(0x262)],0x0,0x3e7),_0x55e639[_0x1b11da(0x362)]=clampInt($('#set_short')[_0x1b11da(0x262)],0x1,0x3e7),_0x55e639['B_long']=clampInt($('#set_long')[_0x1b11da(0x262)],0x1,0x3e7),_0x5f4238[_0x1b11da(0x1a3)]=clampInt($(_0x1b11da(0x1ca))[_0x1b11da(0x262)],0x1,0xc),_0x5f4238[_0x1b11da(0x389)]=clampInt($(_0x1b11da(0x1d7))['value'],0x2,0xc);else{if(editingPreset==='C'){const _0x2d214c=$(_0x1b11da(0x2de));if(_0x2d214c)_0x5f4238[_0x1b11da(0x13b)]=clampInt(_0x2d214c[_0x1b11da(0x262)],0x1,0x14);}}}_0x5f4238['volume']=clampFloat($(_0x1b11da(0x434))['value'],0x0,0x1,0.8),_0x5f4238[_0x1b11da(0x3f5)]=$(_0x1b11da(0x1f2))[_0x1b11da(0x262)]==='chime'?_0x1b11da(0x32e):'beep',_0x5f4238[_0x1b11da(0x439)]=$(_0x1b11da(0x337))[_0x1b11da(0x262)],_0x5f4238[_0x1b11da(0x39a)]=parseFloat($(_0x1b11da(0x34d))[_0x1b11da(0x262)])||0.85;$(_0x1b11da(0x3c5))&&(_0x5f4238['backgroundMode']=$(_0x1b11da(0x3c5))[_0x1b11da(0x262)]);_0x5f4238[_0x1b11da(0x43b)]=!!($(_0x1b11da(0x275))&&$(_0x1b11da(0x275))[_0x1b11da(0x3be)]),_0x5f4238['enableWinddown']=!!($(_0x1b11da(0x3c9))&&$(_0x1b11da(0x3c9))[_0x1b11da(0x3be)]),_0x5f4238[_0x1b11da(0x3f8)]=!!($(_0x1b11da(0x405))&&$('#set_enableSessionNotes')[_0x1b11da(0x3be)]);$(_0x1b11da(0x424))&&(_0x5f4238[_0x1b11da(0x3ca)]=clampInt($('#set_backupDays')[_0x1b11da(0x262)],0x1,0x1e));_0x5f4238[_0x1b11da(0x439)]===_0x1b11da(0x2c5)||_0x5f4238[_0x1b11da(0x439)]===_0x1b11da(0x2cc)?(_0x5f4238['useYtThumbnailAsBg']=![],typeof _0x5f4238[_0x1b11da(0x3ee)]===_0x1b11da(0x413)&&_0x5f4238['customBg'][_0x1b11da(0x1ce)]('img.youtube.com/vi/')&&(_0x5f4238[_0x1b11da(0x3ee)]='')):_0x5f4238[_0x1b11da(0x206)]=!![];const _0x1e3802=$('#set_youtubeUrl')[_0x1b11da(0x262)]['trim']();_0x5f4238[_0x1b11da(0x206)]=$(_0x1b11da(0x2b4))['checked'],_0x5f4238[_0x1b11da(0x234)]=parseInt($(_0x1b11da(0x36d))[_0x1b11da(0x262)],0xa),sessionYoutubeUrl=_0x1e3802;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x1b11da(0x2c7)](_0x5f4238[_0x1b11da(0x234)]);}else try{fallbackPostMessage('setVolume',[_0x5f4238[_0x1b11da(0x234)]]);}catch(_0x1650c1){}}catch(_0x5f39e0){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x1b11da(0x443)](_0x5f4238[_0x1b11da(0x231)],{'silent':!![]}),closeSettings(),toast(_0x1b11da(0x202));}function clampInt(_0x23933a,_0x34e80c,_0x19aa17){const _0x1f6673=_0x174741;_0x23933a=parseInt(_0x23933a||0x0,0xa);if(isNaN(_0x23933a))_0x23933a=_0x34e80c;return Math[_0x1f6673(0x200)](_0x34e80c,Math[_0x1f6673(0x236)](_0x19aa17,_0x23933a));}function clampFloat(_0x34a9a5,_0x20a7d7,_0x27e3bb,_0x42fd69){const _0xbf8dac=_0x174741;_0x34a9a5=parseFloat(_0x34a9a5);if(Number[_0xbf8dac(0x241)](_0x34a9a5))_0x34a9a5=_0x42fd69;return Math[_0xbf8dac(0x200)](_0x20a7d7,Math[_0xbf8dac(0x236)](_0x27e3bb,_0x34a9a5));}const dbPromise=new Promise((_0x4f697e,_0x22cae5)=>{const _0x2492f9=_0x174741,_0x47a77a=indexedDB['open'](_0x2492f9(0x379),0x1);_0x47a77a[_0x2492f9(0x349)]=_0x438253=>_0x438253['target'][_0x2492f9(0x33a)][_0x2492f9(0x437)](_0x2492f9(0x23f)),_0x47a77a[_0x2492f9(0x1eb)]=_0x29f7e5=>_0x4f697e(_0x29f7e5[_0x2492f9(0x1cb)][_0x2492f9(0x33a)]),_0x47a77a['onerror']=_0x3ae602=>_0x22cae5(_0x3ae602);}),fileCache={};function handleFileUpload(_0x26a297,_0x3d22b5){const _0x172359=_0x174741;if(!_0x26a297)return;dbPromise[_0x172359(0x26d)](_0x808cfb=>{const _0x191070=_0x172359,_0x3fd825=uid(_0x191070(0x1fc)),_0x4453d1=_0x808cfb[_0x191070(0x2a2)]('files',_0x191070(0x3fa));_0x4453d1['objectStore']('files')[_0x191070(0x459)](_0x26a297,_0x3fd825),_0x4453d1[_0x191070(0x306)]=()=>_0x3d22b5(_0x3fd825),_0x4453d1[_0x191070(0x2da)]=()=>toast('File\x20save\x20error.');});}function getStoredFileUrl(_0x18c3b7){const _0x5c8f25=_0x174741;if(!_0x18c3b7)return Promise[_0x5c8f25(0x2a7)]('');if(fileCache[_0x18c3b7])return Promise[_0x5c8f25(0x2a7)](fileCache[_0x18c3b7]);return dbPromise[_0x5c8f25(0x26d)](_0x588021=>new Promise(_0x3e5b64=>{const _0x1c9008=_0x5c8f25,_0x39afca=_0x588021[_0x1c9008(0x2a2)](_0x1c9008(0x23f),'readonly'),_0x35cbd3=_0x39afca['objectStore'](_0x1c9008(0x23f))[_0x1c9008(0x37e)](_0x18c3b7);_0x35cbd3[_0x1c9008(0x1eb)]=_0x28c40d=>{const _0x3e6f32=_0x1c9008,_0x168fb1=_0x28c40d[_0x3e6f32(0x1cb)][_0x3e6f32(0x33a)];if(_0x168fb1){const _0x51c0b4=URL['createObjectURL'](_0x168fb1);fileCache[_0x18c3b7]=_0x51c0b4,_0x3e5b64(_0x51c0b4);}else _0x3e5b64('');},_0x35cbd3['onerror']=()=>_0x3e5b64('');}));}function applyCustomBg(){const _0x2849e2=_0x174741,_0x155342=data['settings'],_0x891725=_0x155342[_0x2849e2(0x3ee)],_0x23be95=_0x155342[_0x2849e2(0x439)],_0x55c768=['lofi',_0x2849e2(0x3d2)][_0x2849e2(0x1ce)](_0x23be95),_0x231589=_0x23be95===_0x2849e2(0x2c5)||_0x23be95===_0x2849e2(0x2cc),_0x4532d5=_0x155342[_0x2849e2(0x3af)]||_0x2849e2(0x312);document[_0x2849e2(0x1d2)][_0x2849e2(0x385)][_0x2849e2(0x301)]=_0x4532d5,document[_0x2849e2(0x1d2)]['style'][_0x2849e2(0x15a)]=_0x4532d5===_0x2849e2(0x1e3)?_0x2849e2(0x1ea):_0x2849e2(0x3f4);const _0x549eb8=()=>{const _0x44574a=_0x2849e2;try{document[_0x44574a(0x1d2)][_0x44574a(0x385)][_0x44574a(0x2bb)]='';}catch(_0x193351){}};if(_0x891725){const _0x249be3=_0x891725['startsWith'](_0x2849e2(0x215))||_0x891725[_0x2849e2(0x33d)](_0x2849e2(0x3c3))||_0x891725[_0x2849e2(0x33d)](_0x2849e2(0x227))?Promise[_0x2849e2(0x2a7)](_0x891725):getStoredFileUrl(_0x891725);_0x249be3[_0x2849e2(0x26d)](_0x52f3b4=>{const _0x405b17=_0x2849e2;_0x52f3b4?document['body'][_0x405b17(0x385)][_0x405b17(0x338)](_0x405b17(0x381),_0x405b17(0x38d)+_0x52f3b4+')'):document[_0x405b17(0x1d2)][_0x405b17(0x385)][_0x405b17(0x338)]('--bg-image',_0x231589?_0x405b17(0x2e8):''),_0x549eb8();});}else!_0x55c768?_0x231589?(document[_0x2849e2(0x1d2)]['style'][_0x2849e2(0x338)]('--bg-image','none'),_0x549eb8()):document[_0x2849e2(0x1d2)][_0x2849e2(0x385)][_0x2849e2(0x338)]('--bg-image',_0x2849e2(0x440)):(document['body'][_0x2849e2(0x385)][_0x2849e2(0x24f)](_0x2849e2(0x381)),_0x549eb8());}function applyPanelOpacity(){const _0x48208e=_0x174741;document['documentElement'][_0x48208e(0x385)][_0x48208e(0x338)](_0x48208e(0x22a),data['settings']['panelOpacity']);}function renderDashboard(){const _0x2eae55=_0x174741,_0x32be0a=data[_0x2eae55(0x254)][_0x2eae55(0x1d0)](_0x23f22a=>_0x23f22a[_0x2eae55(0x25a)][_0x2eae55(0x3cf)](_0x238a9a=>({'topic':_0x23f22a[_0x2eae55(0x3dd)],'subtopic':_0x238a9a[_0x2eae55(0x3dd)],'m':_0x238a9a[_0x2eae55(0x2d6)]['totalMinutes']||0x0,'c':_0x238a9a[_0x2eae55(0x2d6)][_0x2eae55(0x278)]||0x0,'t':_0x238a9a[_0x2eae55(0x2d6)][_0x2eae55(0x221)]||0x0}))),_0x557959=_0x32be0a['reduce']((_0x29dfef,_0x5c4a0d)=>_0x29dfef+_0x5c4a0d['m'],0x0),_0x3b566e=_0x32be0a[_0x2eae55(0x3db)]((_0x32e1a7,_0x1e0544)=>_0x32e1a7+_0x1e0544['c'],0x0),_0xadac57=_0x32be0a[_0x2eae55(0x3db)]((_0x29a25f,_0x41f9f3)=>_0x29a25f+_0x41f9f3['t'],0x0);let _0x43eee0=_0x2eae55(0x2ab)+formatDaysHoursMinutes(_0x557959)+_0x2eae55(0x207)+_0x3b566e+_0x2eae55(0x382)+_0xadac57+_0x2eae55(0x2df);_0x32be0a[_0x2eae55(0x14e)](_0x36db81=>{const _0x50e21a=_0x2eae55;_0x43eee0+=_0x50e21a(0x3b9)+escapeHTML(_0x36db81[_0x50e21a(0x153)])+_0x50e21a(0x3ba)+escapeHTML(_0x36db81[_0x50e21a(0x3a8)])+_0x50e21a(0x3ba)+formatDaysHoursMinutes(_0x36db81['m'])+_0x50e21a(0x3ba)+_0x36db81['c']+_0x50e21a(0x3ba)+_0x36db81['t']+'</td></tr>';}),_0x43eee0+=_0x2eae55(0x32d);const _0x3f6a3f=$(_0x2eae55(0x396));if(_0x3f6a3f)_0x3f6a3f[_0x2eae55(0x299)]=_0x43eee0;}function getMilestones(){const _0xf2fa1=_0x174741;return[{'hours':0x5,'title':'To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','message':_0xf2fa1(0x15e)},{'hours':0x14,'title':_0xf2fa1(0x397),'message':'Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren’t\x20just\x20time—they’re\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You’re\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.'},{'hours':0x32,'title':'To\x20You,\x2050\x20Hours\x20(Momentum)','message':'50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You’re\x20on\x20the\x20right\x20path—keep\x20going.'},{'hours':0x64,'title':_0xf2fa1(0x20f),'message':_0xf2fa1(0x19a)},{'hours':0xfa,'title':'To\x20You,\x20250\x20Hours\x20(Perseverance)','message':_0xf2fa1(0x2d4)},{'hours':0x1f4,'title':_0xf2fa1(0x332),'message':'Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You’ve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.'},{'hours':0x3e8,'title':_0xf2fa1(0x353),'message':_0xf2fa1(0x44f)},{'hours':0x1388,'title':_0xf2fa1(0x2bc),'message':_0xf2fa1(0x34e)}][_0xf2fa1(0x2f0)]((_0x1c0887,_0x8004ac)=>_0x8004ac[_0xf2fa1(0x233)]-_0x1c0887[_0xf2fa1(0x233)]);}async function checkAndShowMilestones(){const _0x36de73=_0x174741;if(!data||!data['settings'])return;if(!Array['isArray'](data['settings']['achievedMilestones']))data[_0x36de73(0x42f)][_0x36de73(0x446)]=[];const _0x47223c=data[_0x36de73(0x254)][_0x36de73(0x3db)]((_0x29f969,_0x310ada)=>{const _0x1e6b17=_0x36de73;return _0x29f969+_0x310ada['subtopics'][_0x1e6b17(0x3db)]((_0x370a3e,_0x4578cd)=>{const _0xb3dd91=_0x1e6b17;return _0x370a3e+(_0x4578cd[_0xb3dd91(0x2d6)]['totalMinutes']||0x0);},0x0);},0x0),_0x5d1f92=_0x47223c/0x3c,_0x5c0906=getMilestones(),_0x1a3f69=Array['isArray'](data[_0x36de73(0x42f)]['achievedMilestones'])?data[_0x36de73(0x42f)][_0x36de73(0x446)]:[],_0x46fe77=_0x5c0906[_0x36de73(0x283)](_0x1f0b88=>_0x5d1f92>=_0x1f0b88[_0x36de73(0x233)]&&!_0x1a3f69[_0x36de73(0x1ce)](_0x1f0b88['hours']));if(_0x46fe77[_0x36de73(0x26c)]===0x0)return![];const _0xb1bc85=_0x46fe77['reduce']((_0x304fc5,_0xe5735d)=>_0x304fc5&&_0x304fc5['hours']>_0xe5735d[_0x36de73(0x233)]?_0x304fc5:_0xe5735d,null);if(!_0xb1bc85)return![];$(_0x36de73(0x28d))[_0x36de73(0x38e)]=_0xb1bc85[_0x36de73(0x420)],$('#milestoneMessage')[_0x36de73(0x38e)]=_0xb1bc85[_0x36de73(0x2f2)],$('#modalMilestone')[_0x36de73(0x218)][_0x36de73(0x2be)](_0x36de73(0x252));try{trapFocus($(_0x36de73(0x2ad)));}catch(_0x37353f){}return data[_0x36de73(0x42f)]['achievedMilestones'][_0x36de73(0x137)](_0xb1bc85['hours']),await saveData(),!![];}async function seedAchievedMilestones(){const _0x596660=_0x174741;if(!data||!data[_0x596660(0x42f)])return;!Array[_0x596660(0x1f4)](data[_0x596660(0x42f)][_0x596660(0x446)])&&(data[_0x596660(0x42f)][_0x596660(0x446)]=[],await saveData());}async function handleSendMessage(){const _0x65a1df=_0x174741,_0x322e6e=$(_0x65a1df(0x457)),_0x17af23=$('#chatInput'),_0x52e86a=_0x17af23['value'][_0x65a1df(0x2ba)](),_0x2e3e86=getCurrentSubtopic();if(!_0x52e86a)return;if(!_0x2e3e86){toast(t(_0x65a1df(0x169)));return;}_0x17af23['value']='',_0x322e6e[_0x65a1df(0x28c)]=!![],_0x322e6e[_0x65a1df(0x299)]='<div\x20class=\x22spinner\x22></div>',_0x2e3e86['chatHistory'][_0x65a1df(0x137)]({'role':_0x65a1df(0x203),'text':_0x52e86a}),renderChat();const _0x2b2382=await callGeminiAPI(_0x52e86a);_0x2b2382&&(_0x2e3e86['chatHistory'][_0x65a1df(0x137)]({'role':_0x65a1df(0x375),'text':_0x2b2382}),await saveData(),renderChat()),_0x322e6e[_0x65a1df(0x28c)]=![],_0x322e6e['innerHTML']='Send';}function renderChat(){const _0x41d649=_0x174741,_0x166c92=getCurrentSubtopic(),_0x464aca=$('#chatMessages'),_0x4d5417=$(_0x41d649(0x284)),_0x26eccf=$(_0x41d649(0x457));if(!_0x464aca||!_0x4d5417||!_0x26eccf)return;if(!_0x166c92){_0x464aca[_0x41d649(0x299)]=_0x41d649(0x220),_0x4d5417[_0x41d649(0x28c)]=!![],_0x26eccf[_0x41d649(0x28c)]=!![];return;}_0x4d5417['disabled']=![],_0x26eccf[_0x41d649(0x28c)]=![],_0x464aca['innerHTML']='';if(!_0x166c92[_0x41d649(0x1b7)]||_0x166c92[_0x41d649(0x1b7)][_0x41d649(0x26c)]===0x0){_0x464aca[_0x41d649(0x299)]=_0x41d649(0x32f);return;}_0x166c92[_0x41d649(0x1b7)][_0x41d649(0x14e)](_0x24d52b=>{const _0x5ee455=_0x41d649,_0x3e46be=document[_0x5ee455(0x39d)](_0x5ee455(0x2d1));_0x3e46be[_0x5ee455(0x3bc)]='chat-msg\x20'+_0x24d52b['role'],_0x3e46be[_0x5ee455(0x38e)]=_0x24d52b[_0x5ee455(0x2aa)],_0x464aca['appendChild'](_0x3e46be);}),_0x464aca[_0x41d649(0x170)]=_0x464aca['scrollHeight'];}async function handleSummarizeNote(){const _0x48c50d=_0x174741,_0x588663=$('#btnSummarizeNote'),_0x3c097c=$('#noteText'),_0x98080=_0x3c097c[_0x48c50d(0x262)][_0x48c50d(0x2ba)](),_0x2359a4=getCurrentSubtopic();if(!_0x98080){toast(_0x48c50d(0x339));return;}const _0x527c03=_0x588663[_0x48c50d(0x299)];_0x588663[_0x48c50d(0x299)]=_0x48c50d(0x357),_0x588663['disabled']=!![];const _0x49dafb=_0x48c50d(0x168)+(_0x2359a4?.[_0x48c50d(0x3dd)]||_0x48c50d(0x449))+_0x48c50d(0x451)+_0x98080+_0x48c50d(0x3ff),_0x5a8d11=await callGeminiAPI(_0x49dafb);_0x5a8d11&&(_0x3c097c[_0x48c50d(0x262)]+='\x0a\x0a'+_0x5a8d11),_0x588663['innerHTML']=_0x527c03,_0x588663['disabled']=![];}function clearChat(){const _0x4fc11b=_0x174741,_0x2340f7=getCurrentSubtopic();if(!_0x2340f7){toast(t(_0x4fc11b(0x169)));return;}showConfirmModal('Confirm\x20Deletion',_0x4fc11b(0x3ec),async _0x3c0fa0=>{const _0x6e4e5c=_0x4fc11b;_0x3c0fa0&&(_0x2340f7[_0x6e4e5c(0x1b7)]=[],await saveData(),renderChat(),toast(_0x6e4e5c(0x432)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x3002cf,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x142e2b=_0x174741,_0x15ff74=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x3002cf,'enablejsapi':'1','origin':_0x142e2b(0x2bf)})['toString']();return _0x142e2b(0x257)+_0x3002cf+'?'+_0x15ff74;}function ensureFallbackFrame(){const _0x4a0025=_0x174741,_0x5036da=document[_0x4a0025(0x329)](_0x4a0025(0x31e));if(!_0x5036da)return null;if(ytFallbackFrame&&ytFallbackFrame[_0x4a0025(0x24c)])return ytFallbackFrame;const _0x135874=document['createElement'](_0x4a0025(0x348));return _0x135874['id']='yt-fallback',_0x135874[_0x4a0025(0x226)]='1',_0x135874[_0x4a0025(0x363)]='1',_0x135874[_0x4a0025(0x385)][_0x4a0025(0x1de)]=_0x4a0025(0x412),_0x135874[_0x4a0025(0x385)][_0x4a0025(0x427)]=_0x4a0025(0x193),_0x135874[_0x4a0025(0x385)][_0x4a0025(0x402)]=_0x4a0025(0x193),_0x135874['allow']=_0x4a0025(0x42d),_0x5036da[_0x4a0025(0x299)]='',_0x5036da[_0x4a0025(0x3d6)](_0x135874),ytFallbackFrame=_0x135874,_0x135874;}function fallbackLoadVideo(_0x2e5a00,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x406c13=_0x174741,_0x40cf4d=document[_0x406c13(0x329)](_0x406c13(0x31e));if(!_0x40cf4d)return;_0x40cf4d[_0x406c13(0x299)]='';const _0x1d0484=document[_0x406c13(0x39d)](_0x406c13(0x348));_0x1d0484['id']=_0x406c13(0x2c1),_0x1d0484[_0x406c13(0x226)]='1',_0x1d0484[_0x406c13(0x363)]='1',_0x1d0484['style']['position']=_0x406c13(0x412),_0x1d0484[_0x406c13(0x385)][_0x406c13(0x427)]=_0x406c13(0x193),_0x1d0484[_0x406c13(0x385)][_0x406c13(0x402)]=_0x406c13(0x193),_0x1d0484['allow']=_0x406c13(0x42d),_0x1d0484[_0x406c13(0x393)]=buildFallbackSrc(_0x2e5a00,{'autoplay':autoplay,'mute':mute}),_0x40cf4d['appendChild'](_0x1d0484),ytFallbackFrame=_0x1d0484,ytFallbackIsPlaying=!!autoplay;try{const _0x180072=document['getElementById']('btnToggleYtSound');if(_0x180072)_0x180072[_0x406c13(0x38e)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0xd5308a){}}function _0x3fc1(_0xaaa7c0,_0x22255c){const _0x38e1e0=_0x38e1();return _0x3fc1=function(_0x3fc1f9,_0x3743b2){_0x3fc1f9=_0x3fc1f9-0x133;let _0x181f4d=_0x38e1e0[_0x3fc1f9];return _0x181f4d;},_0x3fc1(_0xaaa7c0,_0x22255c);}function fallbackPostMessage(_0x1cd3e6,_0x23929b=[]){const _0x909452=_0x174741;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x909452(0x3c0)])return;ytFallbackFrame[_0x909452(0x3c0)]['postMessage'](JSON[_0x909452(0x2ac)]({'event':_0x909452(0x422),'func':_0x1cd3e6,'args':_0x23929b}),_0x909452(0x2bf));}catch(_0x44fffd){}}function fallbackPlay(){const _0x577ee0=_0x174741;fallbackPostMessage(_0x577ee0(0x28b));}function fallbackStop(){const _0x488dd4=_0x174741;try{ytFallbackFrame&&(ytFallbackFrame[_0x488dd4(0x393)]=_0x488dd4(0x25c),ytFallbackIsPlaying=![]);}catch(_0x43be18){}}function fallbackPause(){fallbackStop();}function fallbackUnMute(){fallbackPostMessage('unMute');}function fallbackMute(){const _0x5553c8=_0x174741;fallbackPostMessage(_0x5553c8(0x281));}window[_0x174741(0x45f)]=function(){const _0x1d22e8=_0x174741;if(IS_FILE_PROTOCOL){try{window[_0x1d22e8(0x3ad)]&&window[_0x1d22e8(0x3ad)][_0x1d22e8(0x351)]();}catch(_0x57b0be){}return;}const _0x542c47={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x1d22e8(0x2bf)};(window[_0x1d22e8(0x39b)]['protocol']===_0x1d22e8(0x1a0)||window[_0x1d22e8(0x39b)]['protocol']===_0x1d22e8(0x185))&&(_0x542c47[_0x1d22e8(0x20c)]=window[_0x1d22e8(0x39b)][_0x1d22e8(0x20c)]);ytPlayer=new YT['Player'](_0x1d22e8(0x31e),_0x542c47);try{window[_0x1d22e8(0x3ad)]&&window[_0x1d22e8(0x3ad)][_0x1d22e8(0x351)]();const _0x47d0d5=document[_0x1d22e8(0x329)](_0x1d22e8(0x3c7));_0x47d0d5&&(_0x47d0d5['textContent']='');}catch(_0x3f13b7){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage[_0x174741(0x2b9)](_0x174741(0x23d))==='1';}catch(_0x46ce0d){}function showSoundPermission(){const _0x25351a=_0x174741,_0x4b07b7=document['getElementById'](_0x25351a(0x1e1));if(!_0x4b07b7)return;if(_ytUnlocked){_0x4b07b7[_0x25351a(0x218)][_0x25351a(0x1b5)](_0x25351a(0x252));return;}_0x4b07b7[_0x25351a(0x218)]['add'](_0x25351a(0x252));}function hideSoundPermission(){const _0x4209bb=_0x174741,_0x1cb302=document['getElementById'](_0x4209bb(0x1e1));if(!_0x1cb302)return;_0x1cb302['classList'][_0x4209bb(0x1b5)]('show');}function unlockAudioChain(){const _0x4be6ee=_0x174741;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x4be6ee(0x289)]===_0x4be6ee(0x29f))AUDIO_CTX[_0x4be6ee(0x289)]();}catch(_0x4ce345){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer['unMute']&&(ytPlayer[_0x4be6ee(0x3e5)](),ytPlayer[_0x4be6ee(0x28b)]());}catch(_0x1aa114){}_ytUnlocked=!![];try{localStorage['setItem'](_0x4be6ee(0x23d),'1');}catch(_0x3d54bd){}hideSoundPermission(),toast('Sound\x20has\x20been\x20enabled!');}function onPlayerReady(_0x307e2b){const _0x2890ed=_0x174741;try{const _0x4ab286=ytPlayer&&ytPlayer[_0x2890ed(0x18c)]?ytPlayer['getIframe']():null;_0x4ab286&&_0x4ab286[_0x2890ed(0x2a4)]('allow',_0x2890ed(0x42d));}catch(_0x472559){}try{if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x2890ed(0x2c7)](data&&data['settings']&&data[_0x2890ed(0x42f)][_0x2890ed(0x234)]||0x50);}catch(_0x3b1946){}try{const _0x6d29a7=getActiveVideoId&&getActiveVideoId();if(_0x6d29a7&&ytPlayer&&ytPlayer[_0x2890ed(0x281)]&&ytPlayer[_0x2890ed(0x28b)]){ytPlayer['mute'](),ytPlayer[_0x2890ed(0x28b)](),_ytPrimed=!![];const _0x172fb8=()=>{const _0x45d2b1=_0x2890ed;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x488c0d){}window['removeEventListener'](_0x45d2b1(0x415),_0x172fb8,!![]),window[_0x45d2b1(0x2ea)](_0x45d2b1(0x359),_0x172fb8,!![]);};window['addEventListener'](_0x2890ed(0x415),_0x172fb8,!![]),window[_0x2890ed(0x26f)](_0x2890ed(0x359),_0x172fb8,!![]),showSoundPermission();}}catch(_0x7f1340){}updateYouTubePlayer();}function onPlayerStateChange(_0x3e4a76){const _0x428783=_0x174741,_0x37c383=$(_0x428783(0x3b7));_0x3e4a76['data']==YT[_0x428783(0x2e5)][_0x428783(0x212)]?(_0x37c383[_0x428783(0x38e)]='⏸️',hideSoundPermission()):_0x37c383[_0x428783(0x38e)]='▶';if(_0x3e4a76[_0x428783(0x2cb)]===YT[_0x428783(0x2e5)][_0x428783(0x29e)]){if(!ytUserPaused)ytPlayer[_0x428783(0x28b)]();}}async function ytFadeTo(_0x1d859b,_0x29e45e=0xfa){const _0xf807ce=_0x174741;try{if(!ytPlayer||!ytPlayer['getVolume']||!ytPlayer['setVolume'])return;ytPlayer[_0xf807ce(0x3e5)]();const _0x225cfd=ytPlayer[_0xf807ce(0x30b)](),_0x5d8b83=_0x1d859b-_0x225cfd;if(Math[_0xf807ce(0x259)](_0x5d8b83)<0x1||_0x29e45e<=0x0){ytPlayer[_0xf807ce(0x2c7)](_0x1d859b);return;}const _0x4c7e70=performance[_0xf807ce(0x2ce)]();await new Promise(_0x5c0e85=>{const _0xe816e4=_0x36c969=>{const _0x890219=_0x3fc1,_0x32c6f8=Math['min'](0x1,(_0x36c969-_0x4c7e70)/_0x29e45e),_0xd55cf0=Math[_0x890219(0x416)](_0x225cfd+_0x5d8b83*_0x32c6f8);ytPlayer[_0x890219(0x2c7)](_0xd55cf0);if(_0x32c6f8<0x1)requestAnimationFrame(_0xe816e4);else _0x5c0e85();};requestAnimationFrame(_0xe816e4);});}catch(_0x44f29e){}}async function ytFadeInPlay(_0x309ad8=0xdc){const _0x34abfe=_0x174741;try{const _0x27a04d=Math['max'](0x0,Math[_0x34abfe(0x236)](0x64,data&&data[_0x34abfe(0x42f)]&&data[_0x34abfe(0x42f)][_0x34abfe(0x234)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer[_0x34abfe(0x3e5)](),ytPlayer[_0x34abfe(0x28b)]();try{ytPlayer['setVolume'](0x0);}catch(_0x1ef56d){}await ytFadeTo(_0x27a04d,_0x309ad8);}else{const _0xe47844=getActiveVideoId();_0xe47844&&fallbackLoadVideo(_0xe47844,{'autoplay':0x1,'mute':0x0});}}catch(_0x4f9d5f){}}async function ytFadeOutPause(_0x3aa52d=0xb4){const _0x39bb75=_0x174741;try{const _0x56858a=Math['max'](0x0,Math[_0x39bb75(0x236)](0x64,data&&data[_0x39bb75(0x42f)]&&data[_0x39bb75(0x42f)][_0x39bb75(0x234)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0x3aa52d);try{ytPlayer[_0x39bb75(0x1d1)](),ytPlayer['setVolume'](_0x56858a);}catch(_0x4e52bb){}}else try{fallbackPause();}catch(_0x13ee1f){}}catch(_0x31b54d){}}async function updateYouTubePlayer(){const _0x451332=_0x174741,_0x105b37=getActiveVideoId();if(data['settings'][_0x451332(0x206)]&&_0x105b37){const _0x3808a8=_0x451332(0x1d6)+_0x105b37+_0x451332(0x318),_0x39abe9=new Image();_0x39abe9['onload']=async()=>{const _0xd74fb=_0x451332;data['settings'][_0xd74fb(0x3ee)]=_0x3808a8,await saveData(),applyCustomBg();},_0x39abe9['onerror']=async()=>{const _0x58f3e9=_0x451332,_0x27e345=_0x58f3e9(0x1d6)+_0x105b37+_0x58f3e9(0x139);data[_0x58f3e9(0x42f)][_0x58f3e9(0x3ee)]=_0x27e345,await saveData(),applyCustomBg();},_0x39abe9[_0x451332(0x393)]=_0x3808a8;}else!_0x105b37&&(data['settings'][_0x451332(0x3ee)]='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x105b37){fallbackStop(),hideSoundPermission();return;}const _0x20b393=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x105b37,{'autoplay':0x1,'mute':_0x20b393});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer[_0x451332(0x3e9)]){try{ensureYouTubeAPI();}catch(_0x40de75){}return;}if(!_0x105b37){if(ytPlayer['stopVideo'])ytPlayer[_0x451332(0x247)]();hideSoundPermission();return;}ytPlayer['cueVideoById'](_0x105b37),ytPlayer[_0x451332(0x2c7)](data[_0x451332(0x42f)][_0x451332(0x234)]);}function toggleYtSound(){const _0x5267d6=_0x174741;if(!_ytUnlocked){try{ensureAudio();}catch(_0x1e7f22){}try{unlockAudioChain();}catch(_0x44a515){}return;}if(IS_FILE_PROTOCOL){const _0x55e5a3=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0x5267d6(0x24c)]){if(!_0x55e5a3){toast('No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.');return;}fallbackLoadVideo(_0x55e5a3,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x2e4b01=document[_0x5267d6(0x329)](_0x5267d6(0x3e0));if(_0x2e4b01)_0x2e4b01[_0x5267d6(0x38e)]='⏸️';}catch(_0x59ac2a){}toast(_0x5267d6(0x2a1));return;}if(ytFallbackIsPlaying)fallbackPostMessage('pauseVideo'),ytFallbackIsPlaying=![],toast(_0x5267d6(0x240));else{if(!_0x55e5a3){toast(_0x5267d6(0x3cd));return;}fallbackPostMessage(_0x5267d6(0x28b)),ytFallbackIsPlaying=!![],toast('Playing\x20background\x20music...');}try{const _0x3c73ac=document[_0x5267d6(0x329)](_0x5267d6(0x3e0));if(_0x3c73ac)_0x3c73ac[_0x5267d6(0x38e)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x2e8cdf){}return;}if(!ytPlayer||typeof ytPlayer[_0x5267d6(0x174)]!==_0x5267d6(0x29f)){try{ensureYouTubeAPI();}catch(_0x59de12){}return;}const _0x91f5bc=ytPlayer[_0x5267d6(0x174)]();_0x91f5bc===YT[_0x5267d6(0x2e5)]['PLAYING']||_0x91f5bc===YT['PlayerState'][_0x5267d6(0x3d4)]?(ytFadeOutPause(),ytUserPaused=!![],toast(_0x5267d6(0x240))):(ytFadeInPlay(),ytUserPaused=![],toast(_0x5267d6(0x2a1)));}function bindEvents(){const _0x15c18d=_0x174741;try{const _0x4bba9d=document['querySelector'](_0x15c18d(0x310));_0x4bba9d&&(_0x4bba9d[_0x15c18d(0x299)]='Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.');}catch(_0x10f87e){}on($(_0x15c18d(0x162)),_0x15c18d(0x26a),toggleBackgroundView),on($(_0x15c18d(0x44a)),_0x15c18d(0x26a),()=>{const _0x5e4ea8=_0x15c18d;$(_0x5e4ea8(0x2ad))[_0x5e4ea8(0x218)][_0x5e4ea8(0x1b5)]('show');try{releaseFocus();}catch(_0x29e2b0){}}),on($(_0x15c18d(0x345)),_0x15c18d(0x26a),()=>showInputModal(_0x15c18d(0x33c),async _0x3c95a8=>{const _0x2077b1=_0x15c18d;if(!_0x3c95a8)return;data[_0x2077b1(0x254)][_0x2077b1(0x137)]({'id':uid('t'),'name':_0x3c95a8,'subtopics':[]}),await saveData(),renderTopics();})),on($(_0x15c18d(0x18a)),_0x15c18d(0x26a),()=>storageManager[_0x15c18d(0x1f5)](data)),on($('#importFile'),'change',_0x29e65d=>{const _0x4b1a2d=_0x15c18d,_0x45dbdf=_0x29e65d[_0x4b1a2d(0x1cb)][_0x4b1a2d(0x23f)][0x0];if(!_0x45dbdf)return;storageManager[_0x4b1a2d(0x1c3)](_0x45dbdf)[_0x4b1a2d(0x26d)](async _0x3a21f8=>{data=_0x3a21f8,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast('Data\x20imported\x20successfully!'),renderAll();})[_0x4b1a2d(0x3d3)](_0x3b7d3d=>toast(_0x4b1a2d(0x35a)+_0x3b7d3d[_0x4b1a2d(0x2f2)])),_0x29e65d['target'][_0x4b1a2d(0x262)]=null;}),on($(_0x15c18d(0x428)),_0x15c18d(0x26a),()=>{const _0x38a3f1=_0x15c18d,_0x5da6da=$(_0x38a3f1(0x3a6)),_0x40cd05=_0x5da6da?_0x5da6da['value']:'';if(!_0x40cd05){toast(_0x38a3f1(0x3d9));return;}showConfirmModal(_0x38a3f1(0x316),'Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20'+new Date(_0x40cd05)[_0x38a3f1(0x36b)]()+_0x38a3f1(0x40d),_0x23a4e9=>{const _0x16c1b8=_0x38a3f1;_0x23a4e9&&storageManager['restoreBackup'](_0x40cd05)[_0x16c1b8(0x26d)](_0x3c508e=>{const _0x533c3f=_0x16c1b8;data=_0x3c508e,toast('Data\x20restored\x20successfully!\x20Reloading...'),setTimeout(()=>window[_0x533c3f(0x39b)][_0x533c3f(0x2e3)](),0x5dc);})[_0x16c1b8(0x3d3)](_0x19733f=>{toast('Error:\x20'+_0x19733f['message']);});});}),on($(_0x15c18d(0x337)),_0x15c18d(0x365),_0x2dce7c=>{const _0x3e78de=_0x15c18d,_0x2d9d53=_0x2dce7c[_0x3e78de(0x1cb)]['value'];applyTheme(_0x2d9d53);if(_0x2d9d53===_0x3e78de(0x2c5)||_0x2d9d53===_0x3e78de(0x2cc)){const _0xa862e6=$(_0x3e78de(0x2b4));_0xa862e6&&(_0xa862e6[_0x3e78de(0x3be)]=![],toast(_0x3e78de(0x250),0x7d0));try{document['body']['style'][_0x3e78de(0x338)](_0x3e78de(0x381),'none');}catch(_0x1f226e){}}else{const _0x340f9a=$(_0x3e78de(0x2b4));_0x340f9a&&(_0x340f9a[_0x3e78de(0x3be)]=!![]);try{updateYouTubePlayer();}catch(_0x26f06f){}}}),on($(_0x15c18d(0x248)),_0x15c18d(0x26a),openSettings),on($(_0x15c18d(0x392)),'click',()=>{const _0x2bf873=_0x15c18d;switchView(_0x2bf873(0x254)),$(_0x2bf873(0x345))['click']();}),on($(_0x15c18d(0x29a)),_0x15c18d(0x26a),()=>{const _0x45708d=_0x15c18d;renderDashboard(),$('#modalDashboard')[_0x45708d(0x218)][_0x45708d(0x2be)](_0x45708d(0x252));}),on($(_0x15c18d(0x216)),_0x15c18d(0x26a),()=>{const _0x42bc95=_0x15c18d;$('#modalDashboard')['classList'][_0x42bc95(0x1b5)]('show');}),on($(_0x15c18d(0x388)),_0x15c18d(0x26a),closeSettings),on($(_0x15c18d(0x21b)),_0x15c18d(0x26a),saveSettings),on($(_0x15c18d(0x1e8)),_0x15c18d(0x26a),setDefaults),on($('#btnTestSound'),_0x15c18d(0x26a),()=>{const _0x2ccc0c=_0x15c18d;ensureAudio(),playSound(_0x2ccc0c(0x1dc));}),on($(_0x15c18d(0x280)),_0x15c18d(0x26a),_0x8150c0=>{const _0x50177e=_0x15c18d;_0x8150c0[_0x50177e(0x2e0)]();const _0x15cf89=$(_0x50177e(0x43c));if(_0x15cf89)_0x15cf89[_0x50177e(0x218)]['toggle'](_0x50177e(0x17f));}),on($(_0x15c18d(0x455)),'click',async()=>{const _0x328dbd=_0x15c18d,_0x200b37=getCurrentSubtopic();if(!_0x200b37)return;const _0x2be26e=pendingNoteSessionId,_0xdff9c1=_0x200b37[_0x328dbd(0x2f8)]['find'](_0x611e84=>_0x611e84['id']===_0x2be26e);_0xdff9c1&&(_0xdff9c1['note']=$(_0x328dbd(0x224))[_0x328dbd(0x262)][_0x328dbd(0x2ba)](),await saveData(),renderStatsHistory(),toast(_0x328dbd(0x27d))),closeNoteModal();}),on($(_0x15c18d(0x2ef)),_0x15c18d(0x26a),()=>closeNoteModal()),on($(_0x15c18d(0x146)),_0x15c18d(0x26a),addGeneralNote),on($(_0x15c18d(0x3fe)),'click',handleSummarizeNote),on($(_0x15c18d(0x457)),_0x15c18d(0x26a),handleSendMessage),on($(_0x15c18d(0x284)),_0x15c18d(0x359),_0x3e8f97=>{const _0x55fdcf=_0x15c18d;if(_0x3e8f97[_0x55fdcf(0x366)]===_0x55fdcf(0x409))handleSendMessage();}),$$(_0x15c18d(0x3d1))[_0x15c18d(0x14e)](_0x285913=>{on(_0x285913,'click',()=>{const _0x5ab557=_0x3fc1,_0x3c8af1=_0x285913[_0x5ab557(0x31c)][_0x5ab557(0x410)];$(_0x5ab557(0x284))[_0x5ab557(0x262)]=_0x3c8af1,$(_0x5ab557(0x284))[_0x5ab557(0x2db)]();});}),on($(_0x15c18d(0x1cd)),_0x15c18d(0x26a),clearChat),on($('#btnAddSubtopicTask'),_0x15c18d(0x26a),addSubtopicTask),on($(_0x15c18d(0x327)),_0x15c18d(0x359),_0x514b39=>{const _0x1f1d7a=_0x15c18d;if(_0x514b39[_0x1f1d7a(0x366)]===_0x1f1d7a(0x409))addSubtopicTask();}),on($(_0x15c18d(0x3b7)),_0x15c18d(0x26a),toggleYtSound),on($(_0x15c18d(0x2dd)),'click',()=>{ensureAudio(),unlockAudioChain();}),on($('#ytSoundVolume'),_0x15c18d(0x365),_0x1672b2=>{const _0x186829=_0x15c18d,_0x395d30=parseInt(_0x1672b2['target'][_0x186829(0x262)],0xa);ytPlayer&&ytPlayer[_0x186829(0x2c7)]&&ytPlayer[_0x186829(0x2c7)](_0x395d30);}),on($(_0x15c18d(0x18f)),'input',handleYoutubeUrlInput),$$(_0x15c18d(0x144))[_0x15c18d(0x14e)](_0x4866a5=>{const _0x28b470=_0x15c18d;_0x4866a5[_0x28b470(0x26f)](_0x28b470(0x26a),()=>{const _0x1c123d=_0x28b470,_0x1c1c4d=_0x4866a5[_0x1c123d(0x31c)][_0x1c123d(0x172)],_0x2b1040=data?.[_0x1c123d(0x42f)]?.['currentView']||'timer';if(_0x2b1040===_0x1c1c4d&&_0x1c1c4d!==_0x1c123d(0x295))switchView(_0x1c123d(0x295));else switchView(_0x1c1c4d);});}),$$('.tab-btn')[_0x15c18d(0x14e)](_0x15caa8=>{const _0x35ed2c=_0x15c18d;_0x15caa8[_0x35ed2c(0x26f)](_0x35ed2c(0x26a),()=>{const _0x702a7c=_0x35ed2c,_0x3b63ac=_0x15caa8['dataset'][_0x702a7c(0x376)],_0xc8b924=_0x15caa8[_0x702a7c(0x25b)]('.aux-panel,\x20.modal-card');if(!_0xc8b924)return;_0xc8b924[_0x702a7c(0x145)](_0x702a7c(0x373))[_0x702a7c(0x14e)](_0x112c3b=>_0x112c3b['classList'][_0x702a7c(0x1b5)](_0x702a7c(0x175))),_0x15caa8['classList'][_0x702a7c(0x2be)](_0x702a7c(0x175)),_0xc8b924['querySelectorAll']('.tab-content')[_0x702a7c(0x14e)](_0x433788=>{const _0x5d3b20=_0x702a7c;_0x433788[_0x5d3b20(0x218)][_0x5d3b20(0x1b5)](_0x5d3b20(0x175)),_0x433788[_0x5d3b20(0x385)][_0x5d3b20(0x1ad)]='none';});const _0x42a6ef=_0xc8b924[_0x702a7c(0x331)]('#'+_0x3b63ac);_0x42a6ef&&(_0x42a6ef[_0x702a7c(0x218)]['add'](_0x702a7c(0x175)),_0x42a6ef[_0x702a7c(0x385)][_0x702a7c(0x1ad)]=_0x702a7c(0x244),_0xc8b924[_0x702a7c(0x25b)](_0x702a7c(0x1ba))&&(_0x42a6ef[_0x702a7c(0x385)][_0x702a7c(0x1ad)]=_0x702a7c(0x2cd)));});});const _0x214c85=$(_0x15c18d(0x2fd));function _0x5265a2(_0x1202cd,_0x3d2bea=null){const _0x548dba=_0x15c18d;try{document['execCommand'](_0x548dba(0x24e),![],!![]);}catch(_0x454571){}try{document['execCommand'](_0x1202cd,![],_0x3d2bea);}catch(_0x2181be){}if(_0x214c85)_0x214c85[_0x548dba(0x2db)]();}on($(_0x15c18d(0x143)),_0x15c18d(0x26a),()=>_0x5265a2(_0x15c18d(0x1ef))),on($(_0x15c18d(0x187)),'click',()=>_0x5265a2(_0x15c18d(0x311))),on($('#toolH4'),_0x15c18d(0x26a),()=>_0x5265a2('formatBlock','<h4>')),on($(_0x15c18d(0x447)),_0x15c18d(0x26a),()=>_0x5265a2(_0x15c18d(0x16e))),on($('#toolBullet'),_0x15c18d(0x26a),()=>_0x5265a2(_0x15c18d(0x40e)));const _0x105b1b=$(_0x15c18d(0x1d3)),_0x445e95=$(_0x15c18d(0x3eb));on($(_0x15c18d(0x245)),'click',_0xde917f=>{const _0x24b616=_0x15c18d;if(!_0x445e95)return;_0xde917f[_0x24b616(0x391)](),_0x445e95[_0x24b616(0x218)]['toggle'](_0x24b616(0x17f));}),$$(_0x15c18d(0x1bf))[_0x15c18d(0x14e)](_0x1d6372=>{on(_0x1d6372,'click',_0x3f0192=>{const _0x4492c1=_0x3fc1;_0x3f0192[_0x4492c1(0x2e0)]();const _0x392a3d=_0x1d6372[_0x4492c1(0x31c)][_0x4492c1(0x195)]||'';let _0x2a54d0=_0x392a3d;try{const _0xb78bc7=_0x392a3d[_0x4492c1(0x34a)](/--[a-zA-Z0-9_-]+/);if(_0xb78bc7)_0x2a54d0=getComputedStyle(document['body'])[_0x4492c1(0x1b6)](_0xb78bc7[0x0])[_0x4492c1(0x2ba)]();}catch(_0x2ba668){}_0x5265a2(_0x4492c1(0x2d0),_0x2a54d0);if(_0x445e95)_0x445e95[_0x4492c1(0x218)][_0x4492c1(0x2be)](_0x4492c1(0x17f));});}),on(document,'click',_0x1bdd86=>{const _0x2eacb5=_0x15c18d;if(!_0x105b1b||!_0x445e95)return;!_0x105b1b[_0x2eacb5(0x42e)](_0x1bdd86[_0x2eacb5(0x1cb)])&&!_0x445e95[_0x2eacb5(0x218)][_0x2eacb5(0x42e)](_0x2eacb5(0x17f))&&_0x445e95[_0x2eacb5(0x218)][_0x2eacb5(0x2be)](_0x2eacb5(0x17f));});function _0x581c73(_0x41cbf9){const _0x36301a=_0x15c18d,_0x511d1e=getCurrentSubtopic();if(!_0x511d1e){toast(_0x36301a(0x249));return;}const _0x6a8295=Array[_0x36301a(0x1f4)](_0x511d1e[_0x36301a(0x36a)])?_0x511d1e['methods']:[],_0x172767=_0x41cbf9?_0x6a8295['find'](_0x4580a2=>_0x4580a2['id']===_0x41cbf9):null;$('#methodEditorId')[_0x36301a(0x262)]=_0x172767&&_0x172767['id']||'',$(_0x36301a(0x358))[_0x36301a(0x38e)]=_0x172767?_0x36301a(0x31a):_0x36301a(0x3d8),$(_0x36301a(0x28e))[_0x36301a(0x262)]=_0x172767&&_0x172767[_0x36301a(0x420)]||'';const _0x2afad8=$(_0x36301a(0x2fd));if(_0x2afad8)_0x2afad8[_0x36301a(0x299)]=_0x172767&&_0x172767[_0x36301a(0x238)]||'';$(_0x36301a(0x286))[_0x36301a(0x218)]['add'](_0x36301a(0x252));try{trapFocus($(_0x36301a(0x286)));}catch(_0x45d5cc){}try{const _0x89b064=$(_0x36301a(0x177));if(_0x89b064){const _0x47c27c=!!(data?.['settings']?.[_0x36301a(0x1b9)]&&data[_0x36301a(0x42f)][_0x36301a(0x1b9)]['trim']());_0x89b064['disabled']=!_0x47c27c,_0x89b064[_0x36301a(0x420)]=_0x47c27c?_0x36301a(0x2c4):'Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.';}}catch(_0x26b3d2){}}on($(_0x15c18d(0x217)),_0x15c18d(0x26a),()=>{const _0x380c5e=_0x15c18d;$(_0x380c5e(0x286))['classList']['remove']('show');try{releaseFocus();}catch(_0x1fdfc4){}}),on($(_0x15c18d(0x176)),'click',async()=>{const _0x41e8c4=_0x15c18d,_0x55d5d1=$(_0x41e8c4(0x3ea))['value']||uid('m'),_0x387441=($(_0x41e8c4(0x28e))[_0x41e8c4(0x262)]||'')['trim'](),_0x4ad873=$('#methodEditorContentInput'),_0xb74c71=_0x4ad873?_0x4ad873[_0x41e8c4(0x299)]||'':'',_0x2997b6=getCurrentSubtopic();if(!_0x2997b6){toast(_0x41e8c4(0x249));return;}if(!Array['isArray'](_0x2997b6[_0x41e8c4(0x36a)]))_0x2997b6['methods']=[];const _0x3b4e37=_0x2997b6['methods']['findIndex'](_0x1d73db=>_0x1d73db['id']===_0x55d5d1),_0x1e9730={'id':_0x55d5d1,'title':_0x387441,'content':_0xb74c71};if(_0x3b4e37>=0x0)_0x2997b6[_0x41e8c4(0x36a)][_0x3b4e37]=_0x1e9730;else _0x2997b6[_0x41e8c4(0x36a)]['unshift'](_0x1e9730);await saveData(),renderMethods(),$(_0x41e8c4(0x286))[_0x41e8c4(0x218)]['remove'](_0x41e8c4(0x252));try{releaseFocus();}catch(_0x387028){}}),on($(_0x15c18d(0x177)),_0x15c18d(0x26a),async()=>{const _0x5040ad=_0x15c18d,_0x5b1227=$(_0x5040ad(0x2fd));if(!_0x5b1227)return;const _0x4a57a2=(_0x5b1227['textContent']||'')[_0x5040ad(0x2ba)]();if(!_0x4a57a2||_0x4a57a2[_0x5040ad(0x26c)]<0x14){toast(_0x5040ad(0x296));return;}const _0x3a93c8=$('#btnAutoFormat');_0x3a93c8&&(_0x3a93c8[_0x5040ad(0x28c)]=!![],_0x3a93c8[_0x5040ad(0x299)]=_0x5040ad(0x357));const _0x55f096=_0x5040ad(0x29c)+_0x4a57a2+'\x22',_0x53d386=await callGeminiAPI(_0x55f096);_0x53d386?(_0x5b1227[_0x5040ad(0x299)]=_0x53d386,toast(_0x5040ad(0x3c4))):toast('AI\x20cannot\x20format\x20at\x20the\x20moment.'),_0x3a93c8&&(_0x3a93c8[_0x5040ad(0x28c)]=![],_0x3a93c8['innerHTML']='✨\x20Auto-format');}),on($(_0x15c18d(0x16d)),_0x15c18d(0x26a),()=>_0x581c73());const _0x128ea5=document['querySelector']('#view-methods');_0x128ea5&&_0x128ea5['addEventListener'](_0x15c18d(0x26a),_0x3e1d77=>{const _0x333225=_0x15c18d,_0x8a6f39=_0x3e1d77['target'][_0x333225(0x25b)]&&_0x3e1d77['target'][_0x333225(0x25b)](_0x333225(0x3f3)),_0x28b1ec=!_0x8a6f39&&_0x3e1d77[_0x333225(0x1cb)][_0x333225(0x25b)]&&_0x3e1d77[_0x333225(0x1cb)][_0x333225(0x25b)](_0x333225(0x21d));if(_0x8a6f39){_0x3e1d77[_0x333225(0x2e0)](),_0x3e1d77[_0x333225(0x391)]();const _0x1843ae=_0x8a6f39[_0x333225(0x31c)]['id'];if(_0x1843ae)_0x581c73(_0x1843ae);return;}if(_0x28b1ec){_0x3e1d77[_0x333225(0x2e0)](),_0x3e1d77[_0x333225(0x391)]();const _0x16399e=_0x28b1ec[_0x333225(0x31c)]['id'];if(!_0x16399e)return;const _0x12c105=getCurrentSubtopic();if(!_0x12c105){toast(_0x333225(0x249));return;}const _0x64baba=Array[_0x333225(0x1f4)](_0x12c105['methods'])?_0x12c105[_0x333225(0x36a)]:[],_0x25df68=_0x64baba[_0x333225(0x1ab)](_0xff9134=>_0xff9134['id']===_0x16399e);if(!_0x25df68)return;showConfirmModal(_0x333225(0x3c6),_0x333225(0x417)+(_0x25df68['title']||'')+'\x22?',async _0x4d5a10=>{const _0x54e0f7=_0x333225;if(!_0x4d5a10)return;_0x12c105[_0x54e0f7(0x36a)]=_0x64baba[_0x54e0f7(0x283)](_0x172ff4=>_0x172ff4['id']!==_0x16399e),await saveData(),renderMethods();});}});$$(_0x15c18d(0x3f2))[_0x15c18d(0x14e)](_0x1626fc=>{const _0x19f7f4=_0x15c18d;_0x1626fc[_0x19f7f4(0x26f)](_0x19f7f4(0x26a),()=>{const _0x133ac1=_0x19f7f4;editingPreset=_0x1626fc[_0x133ac1(0x31c)]['presetTarget'],highlightPresetSelector(),loadEditingPresetFields();});}),$$(_0x15c18d(0x368))[_0x15c18d(0x14e)](_0x2be8e3=>{_0x2be8e3['addEventListener']('click',_0xbf18f9=>{const _0x189f67=_0x3fc1,_0x194a02=_0xbf18f9[_0x189f67(0x1cb)]['dataset'][_0x189f67(0x231)],_0x1a3580=data[_0x189f67(0x42f)]['preset'];if(_0x194a02===_0x1a3580)return;timer[_0x189f67(0x460)]!==_0x189f67(0x23b)?showConfirmModal('Confirm\x20Switch',_0x189f67(0x407)+_0x194a02+'?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.',_0x56bcc7=>{const _0x1af1d6=_0x189f67;_0x56bcc7&&(timer[_0x1af1d6(0x208)](),timer[_0x1af1d6(0x443)](_0x194a02),renderAll(),toast(_0x1af1d6(0x25f)+_0x194a02+'.'));}):(timer[_0x189f67(0x443)](_0x194a02),renderAll(),toast(_0x189f67(0x25f)+_0x194a02+'.'));});}),on($(_0x15c18d(0x133)),_0x15c18d(0x26a),()=>timer[_0x15c18d(0x1db)]()),on($(_0x15c18d(0x1cc)),_0x15c18d(0x26a),()=>timer[_0x15c18d(0x3b3)]()),on($('#btnPause'),_0x15c18d(0x26a),()=>timer[_0x15c18d(0x228)]()),on($(_0x15c18d(0x2e2)),'click',()=>timer['resume']()),on($(_0x15c18d(0x2ec)),_0x15c18d(0x26a),()=>timer[_0x15c18d(0x406)]()),on($(_0x15c18d(0x1e6)),_0x15c18d(0x26a),()=>timer[_0x15c18d(0x208)]()),on($('#btnBreakEarly'),_0x15c18d(0x26a),()=>timer[_0x15c18d(0x279)]()),on($(_0x15c18d(0x15d)),_0x15c18d(0x44e),_0x3d5fd4=>{const _0x196220=_0x15c18d;handleFileUpload(_0x3d5fd4[_0x196220(0x1cb)][_0x196220(0x23f)][0x0],async _0x3377de=>{const _0x5b56fe=_0x196220;data['settings'][_0x5b56fe(0x3ee)]=_0x3377de,await saveData(),applyCustomBg(),toast(_0x5b56fe(0x13c));}),_0x3d5fd4[_0x196220(0x1cb)][_0x196220(0x262)]=null;}),on($(_0x15c18d(0x3a0)),_0x15c18d(0x26a),async()=>{const _0x14f9fc=_0x15c18d;data[_0x14f9fc(0x42f)]['customBg']='',data[_0x14f9fc(0x42f)][_0x14f9fc(0x206)]=![],await saveData(),applyCustomBg(),toast(_0x14f9fc(0x2c9)),$(_0x14f9fc(0x1ba))['classList'][_0x14f9fc(0x42e)](_0x14f9fc(0x252))&&openSettings();}),on($('#uploadSoundWork'),'change',_0x3003be=>{const _0xf2a672=_0x15c18d;handleFileUpload(_0x3003be['target'][_0xf2a672(0x23f)][0x0],async _0x10a234=>{const _0x2ffe3c=_0xf2a672;data[_0x2ffe3c(0x42f)][_0x2ffe3c(0x390)][_0x2ffe3c(0x1dc)]=_0x10a234,await saveData(),toast('Saved\x20alert\x20for\x20FOCUS.');}),_0x3003be['target'][_0xf2a672(0x262)]=null;}),on($(_0x15c18d(0x33f)),_0x15c18d(0x44e),_0x4ca21d=>{const _0x34bc6e=_0x15c18d;handleFileUpload(_0x4ca21d[_0x34bc6e(0x1cb)]['files'][0x0],async _0x306b59=>{const _0x461474=_0x34bc6e;data[_0x461474(0x42f)][_0x461474(0x390)][_0x461474(0x27a)]=_0x306b59,await saveData(),toast(_0x461474(0x444));}),_0x4ca21d[_0x34bc6e(0x1cb)]['value']=null;}),on($(_0x15c18d(0x3ed)),'change',_0x3a5ce3=>{const _0x35ab66=_0x15c18d;handleFileUpload(_0x3a5ce3[_0x35ab66(0x1cb)][_0x35ab66(0x23f)][0x0],async _0x527336=>{const _0x489027=_0x35ab66;data[_0x489027(0x42f)][_0x489027(0x390)][_0x489027(0x1d8)]=_0x527336,await saveData(),toast(_0x489027(0x256));}),_0x3a5ce3[_0x35ab66(0x1cb)][_0x35ab66(0x262)]=null;}),on($('#btnFullscreen'),_0x15c18d(0x26a),toggleFullScreen),document['addEventListener'](_0x15c18d(0x173),updateFullscreenButton),window[_0x15c18d(0x26f)](_0x15c18d(0x359),_0x39f448=>{const _0x458ae5=_0x15c18d,_0x1fcbcd=_0x39f448[_0x458ae5(0x1cb)],_0x2c4beb=(_0x1fcbcd[_0x458ae5(0x140)]||'')[_0x458ae5(0x1a9)](),_0x3001f2=[_0x458ae5(0x365),_0x458ae5(0x15f),_0x458ae5(0x356)][_0x458ae5(0x1ce)](_0x2c4beb)||_0x1fcbcd[_0x458ae5(0x3f0)];if(_0x39f448[_0x458ae5(0x28f)]===_0x458ae5(0x264)&&!_0x3001f2){_0x39f448[_0x458ae5(0x2e0)]();if(timer[_0x458ae5(0x460)]===_0x458ae5(0x23b)||timer[_0x458ae5(0x460)]==='paused')timer['start']();else timer[_0x458ae5(0x228)]();}(_0x39f448['key']==='n'||_0x39f448[_0x458ae5(0x366)]==='N')&&(!_0x3001f2&&(_0x39f448['preventDefault'](),timer[_0x458ae5(0x406)]()));if(_0x39f448[_0x458ae5(0x366)]===_0x458ae5(0x13f)){$$(_0x458ae5(0x3a7))['forEach'](_0x3e69e6=>_0x3e69e6['classList'][_0x458ae5(0x1b5)](_0x458ae5(0x252)));try{releaseFocus();}catch(_0x298996){}}if(_0x39f448[_0x458ae5(0x44c)]&&!_0x3001f2){if(_0x39f448[_0x458ae5(0x366)]===_0x458ae5(0x1e0))_0x39f448[_0x458ae5(0x2e0)](),_0x5dc771(0x0,-0xa);else{if(_0x39f448[_0x458ae5(0x366)]===_0x458ae5(0x30e))_0x39f448[_0x458ae5(0x2e0)](),_0x5dc771(0x0,0xa);else{if(_0x39f448[_0x458ae5(0x366)]===_0x458ae5(0x1f1))_0x39f448[_0x458ae5(0x2e0)](),_0x5dc771(-0xa,0x0);else _0x39f448[_0x458ae5(0x366)]==='ArrowRight'&&(_0x39f448[_0x458ae5(0x2e0)](),_0x5dc771(0xa,0x0));}}}}),$$(_0x15c18d(0x3a7))[_0x15c18d(0x14e)](_0x48ba4c=>_0x48ba4c[_0x15c18d(0x26f)](_0x15c18d(0x26a),_0x557595=>{const _0x1dc2b1=_0x15c18d;if(_0x557595&&_0x557595[_0x1dc2b1(0x1cb)]&&_0x557595['target']['id']===_0x1dc2b1(0x421))return;if(_0x557595[_0x1dc2b1(0x1cb)]===_0x48ba4c){_0x48ba4c[_0x1dc2b1(0x218)]['remove'](_0x1dc2b1(0x252));try{releaseFocus();}catch(_0x4410e8){}}})),window['addEventListener']('click',_0x536730=>{const _0x373b5f=_0x15c18d;!_0x536730[_0x373b5f(0x1cb)][_0x373b5f(0x25b)](_0x373b5f(0x3cb))&&!_0x536730[_0x373b5f(0x1cb)][_0x373b5f(0x25b)](_0x373b5f(0x386))&&closeAllMenus();});try{const _0x53b29e=document[_0x15c18d(0x331)](_0x15c18d(0x14b));if(_0x53b29e)_0x53b29e[_0x15c18d(0x26f)]('scroll',closeAllMenus);}catch(_0x548b9a){}try{window[_0x15c18d(0x26f)](_0x15c18d(0x154),closeAllMenus,!![]);}catch(_0x10977f){}window[_0x15c18d(0x26f)](_0x15c18d(0x313),()=>timer[_0x15c18d(0x3a9)](!![]));try{const _0x54d7fb=Array[_0x15c18d(0x21a)](document['querySelectorAll'](_0x15c18d(0x135)));_0x54d7fb['length']&&_0x54d7fb[_0x15c18d(0x14e)](_0x4ef09c=>{const _0x395a70=_0x15c18d;_0x4ef09c['addEventListener'](_0x395a70(0x18d),()=>{const _0x5bc88e=_0x395a70;_0x4ef09c['open']&&_0x54d7fb[_0x5bc88e(0x14e)](_0x916cca=>{const _0x1b944e=_0x5bc88e;if(_0x916cca!==_0x4ef09c)_0x916cca[_0x1b944e(0x2c8)]=![];});});});}catch(_0x138342){}const _0x139bbe=$(_0x15c18d(0x265));let _0x3b6a1e=![],_0x41141c,_0x59ca99;_0x139bbe&&(_0x139bbe[_0x15c18d(0x26f)](_0x15c18d(0x36e),_0x267b62=>{const _0x53fdac=_0x15c18d;_0x3b6a1e=!![];const _0x117b93=_0x139bbe[_0x53fdac(0x271)]();_0x41141c=_0x267b62[_0x53fdac(0x2ae)]-_0x117b93[_0x53fdac(0x402)],_0x59ca99=_0x267b62[_0x53fdac(0x1f9)]-_0x117b93[_0x53fdac(0x427)],_0x139bbe[_0x53fdac(0x385)][_0x53fdac(0x384)]=_0x53fdac(0x2e8);}),document['addEventListener']('mousemove',_0xa45942=>{const _0x38c56a=_0x15c18d;if(!_0x3b6a1e)return;let _0x285dad=_0xa45942[_0x38c56a(0x2ae)]-_0x41141c,_0x1ccae5=_0xa45942[_0x38c56a(0x1f9)]-_0x59ca99;const _0x3b8899=window[_0x38c56a(0x191)]-_0x139bbe[_0x38c56a(0x161)],_0x8097f3=window[_0x38c56a(0x26e)]-_0x139bbe[_0x38c56a(0x13d)];_0x285dad=Math[_0x38c56a(0x200)](0x0,Math[_0x38c56a(0x236)](_0x285dad,_0x3b8899)),_0x1ccae5=Math[_0x38c56a(0x200)](0x0,Math['min'](_0x1ccae5,_0x8097f3)),_0x139bbe[_0x38c56a(0x385)]['left']=_0x285dad+'px',_0x139bbe[_0x38c56a(0x385)][_0x38c56a(0x427)]=_0x1ccae5+'px',_0x139bbe[_0x38c56a(0x385)][_0x38c56a(0x431)]='auto',_0x139bbe[_0x38c56a(0x385)][_0x38c56a(0x1b0)]=_0x38c56a(0x1e3);}),document['addEventListener'](_0x15c18d(0x19b),()=>{const _0x52db29=_0x15c18d;if(!_0x3b6a1e)return;_0x3b6a1e=![],_0x139bbe[_0x52db29(0x385)][_0x52db29(0x384)]='';}));function _0xe8160a(_0x4b7382){const _0x114af5=_0x15c18d,_0x324475=$(_0x114af5(0x265));if(!_0x324475)return;_0x324475[_0x114af5(0x385)][_0x114af5(0x1de)]='fixed',_0x324475[_0x114af5(0x385)][_0x114af5(0x384)]='',_0x324475[_0x114af5(0x385)]['left']=_0x114af5(0x1e3),_0x324475['style'][_0x114af5(0x427)]=_0x114af5(0x1e3),_0x324475[_0x114af5(0x385)][_0x114af5(0x1b0)]=_0x114af5(0x1e3),_0x324475['style'][_0x114af5(0x431)]=_0x114af5(0x1e3);const _0x1ab508=0x10;_0x4b7382==='tl'&&(_0x324475[_0x114af5(0x385)][_0x114af5(0x402)]=_0x1ab508+'px',_0x324475[_0x114af5(0x385)][_0x114af5(0x427)]=_0x1ab508+'px'),_0x4b7382==='tr'&&(_0x324475[_0x114af5(0x385)]['right']=_0x1ab508+'px',_0x324475[_0x114af5(0x385)]['top']=_0x1ab508+'px'),_0x4b7382==='bl'&&(_0x324475[_0x114af5(0x385)]['left']=_0x1ab508+'px',_0x324475[_0x114af5(0x385)]['bottom']=_0x1ab508+'px'),_0x4b7382==='br'&&(_0x324475[_0x114af5(0x385)][_0x114af5(0x1b0)]=_0x1ab508+'px',_0x324475[_0x114af5(0x385)][_0x114af5(0x431)]=_0x1ab508+'px');}function _0x5dc771(_0x2b8394,_0x4e55a4){const _0x60c4b7=_0x15c18d,_0xcd25be=$(_0x60c4b7(0x265));if(!_0xcd25be)return;const _0x3f4c7d=_0xcd25be[_0x60c4b7(0x271)](),_0x4f0218=Math[_0x60c4b7(0x200)](0x0,Math['min'](_0x3f4c7d['left']+_0x2b8394,window['innerWidth']-_0xcd25be[_0x60c4b7(0x161)])),_0x464e2f=Math[_0x60c4b7(0x200)](0x0,Math[_0x60c4b7(0x236)](_0x3f4c7d[_0x60c4b7(0x427)]+_0x4e55a4,window[_0x60c4b7(0x26e)]-_0xcd25be['offsetHeight']));_0xcd25be[_0x60c4b7(0x385)][_0x60c4b7(0x402)]=_0x4f0218+'px',_0xcd25be['style'][_0x60c4b7(0x427)]=_0x464e2f+'px',_0xcd25be['style'][_0x60c4b7(0x1b0)]=_0x60c4b7(0x1e3),_0xcd25be[_0x60c4b7(0x385)][_0x60c4b7(0x431)]=_0x60c4b7(0x1e3);}}function toggleBackgroundView(){const _0x251be3=_0x174741,_0x3c9dba=document[_0x251be3(0x1d2)];_0x3c9dba[_0x251be3(0x218)]['toggle'](_0x251be3(0x2dc));const _0x106ff7=_0x3c9dba[_0x251be3(0x218)][_0x251be3(0x42e)](_0x251be3(0x2dc)),_0x535696=$('#btnToggleBg');if(!_0x535696)return;_0x106ff7?(_0x535696[_0x251be3(0x420)]=_0x251be3(0x3ac),_0x535696['innerHTML']='<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>'):(_0x535696[_0x251be3(0x420)]='Hide\x20interface',_0x535696[_0x251be3(0x299)]='<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>');}function updateMainViewVisibility(){const _0x30b585=_0x174741,_0x19b659=!!getCurrentSubtopic(),_0x4b195a=$(_0x30b585(0x287)),_0x16496e=$(_0x30b585(0x2b7));_0x16496e&&_0x16496e[_0x30b585(0x218)][_0x30b585(0x18d)](_0x30b585(0x17f),_0x19b659),_0x4b195a&&(_0x19b659?_0x4b195a[_0x30b585(0x218)][_0x30b585(0x1b5)](_0x30b585(0x237)):_0x4b195a['classList']['add'](_0x30b585(0x237)));}function updatePresetButtonsText(){const _0x36e422=_0x174741,_0x26385a=data[_0x36e422(0x42f)],_0x5c1f68=_0x26385a[_0x36e422(0x232)],_0x57b4db=_0x26385a[_0x36e422(0x1a3)],_0x2dcce4=_0x26385a[_0x36e422(0x1b2)]['A_work'],_0x39ed4b=_0x26385a[_0x36e422(0x1b2)][_0x36e422(0x17e)],_0x18c238=$(_0x36e422(0x2b3)),_0x4cc16a=$(_0x36e422(0x2d2)),_0x3e3c6c=$(_0x36e422(0x408));_0x18c238&&(_0x18c238[_0x36e422(0x38e)]=_0x5c1f68+'×'+_0x2dcce4+_0x36e422(0x2f7)),_0x4cc16a&&(_0x4cc16a[_0x36e422(0x38e)]=_0x57b4db+'×'+_0x39ed4b+_0x36e422(0x243)),_0x3e3c6c&&(_0x3e3c6c[_0x36e422(0x38e)]=_0x36e422(0x223));}function renderAll(){const _0x31219a=_0x174741;updatePresetButtonsText();const _0x214942=data['settings']['preset'];$$(_0x31219a(0x368))[_0x31219a(0x14e)](_0x5f59e1=>{const _0x3e50e5=_0x31219a,_0x4bf220=_0x5f59e1[_0x3e50e5(0x31c)]['preset']===_0x214942;_0x5f59e1[_0x3e50e5(0x218)][_0x3e50e5(0x18d)]('acc',_0x4bf220),_0x5f59e1[_0x3e50e5(0x218)][_0x3e50e5(0x18d)]('ghost',!_0x4bf220),_0x5f59e1[_0x3e50e5(0x2a4)](_0x3e50e5(0x42b),_0x4bf220);}),updateMainViewVisibility(),timer[_0x31219a(0x443)](data[_0x31219a(0x42f)][_0x31219a(0x231)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x31219a(0x42f)][_0x31219a(0x334)]);}function toggleFullScreen(){const _0x5baeb7=_0x174741;!document['fullscreenElement']?document[_0x5baeb7(0x419)][_0x5baeb7(0x235)]()[_0x5baeb7(0x3d3)](_0x1a4855=>{const _0x2f2366=_0x5baeb7;toast('Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20'+_0x1a4855[_0x2f2366(0x2f2)]);}):document[_0x5baeb7(0x1bb)]&&document[_0x5baeb7(0x1bb)]();}function updateFullscreenButton(){const _0x260df0=_0x174741,_0x29fe11=$(_0x260df0(0x320));document[_0x260df0(0x36c)]?(_0x29fe11['innerHTML']='↙',_0x29fe11[_0x260df0(0x420)]='Exit\x20fullscreen'):(_0x29fe11[_0x260df0(0x299)]='↗',_0x29fe11[_0x260df0(0x420)]='Fullscreen');}async function initializeApp(){const _0x3c92ce=_0x174741;try{await storageManager[_0x3c92ce(0x258)]();const [_0x4a08ac,_0x40395f,_0x3752e7]=await Promise[_0x3c92ce(0x426)]([storageManager[_0x3c92ce(0x40c)](),storageManager[_0x3c92ce(0x19c)](_0x3c92ce(0x254)),storageManager[_0x3c92ce(0x19c)](_0x3c92ce(0x25a))]);let _0x53afd2;if(!_0x4a08ac){const _0x185856=JSON[_0x3c92ce(0x37c)](JSON[_0x3c92ce(0x2ac)](defaults));await storageManager[_0x3c92ce(0x3d0)](_0x185856[_0x3c92ce(0x42f)]);for(const _0x345b77 of _0x185856[_0x3c92ce(0x254)]){const {subtopics:_0x2b5519,..._0x4f05ee}=_0x345b77;await storageManager[_0x3c92ce(0x2be)](_0x3c92ce(0x254),_0x4f05ee);for(const _0x1cb2e2 of _0x2b5519){await storageManager[_0x3c92ce(0x2be)](_0x3c92ce(0x25a),{..._0x1cb2e2,'topicId':_0x345b77['id']});}}_0x53afd2=_0x185856;}else{const _0x351502={};for(const _0x31e326 of _0x40395f)_0x351502[_0x31e326['id']]={..._0x31e326,'subtopics':[]};for(const _0x816de1 of _0x3752e7)_0x351502[_0x816de1[_0x3c92ce(0x142)]]?.['subtopics'][_0x3c92ce(0x137)](_0x816de1);_0x53afd2={'version':defaults[_0x3c92ce(0x1b8)],'settings':_0x4a08ac,'topics':Object[_0x3c92ce(0x305)](_0x351502)};}data=window[_0x3c92ce(0x2cb)]=_0x53afd2,normalizeDataStructure(data),await ensureValidSelection(),await migrateSharedMethodsToCurrentSubtopic(),await seedAchievedMilestones(),renderAll();try{storageManager[_0x3c92ce(0x32c)](data);}catch(_0x348b64){console[_0x3c92ce(0x136)](_0x3c92ce(0x1c7),_0x348b64);}bindEvents(),applyTheme();}catch(_0x3c6a96){console['error'](_0x3c92ce(0x3fc),_0x3c6a96),toast(_0x3c92ce(0x1cf)+_0x3c6a96[_0x3c92ce(0x2f2)]);}}callGeminiAPI=async function(_0x21fdec,_0x5a38e2=0x3,_0x120c83=0x3e8){const _0x319a1f=_0x174741,_0x2501d6=data?.['settings']?.[_0x319a1f(0x1b9)]||'';if(!_0x2501d6)return toast(_0x319a1f(0x3f1)),null;const _0x3b98f8='https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key='+_0x2501d6,_0x24482c={'contents':[{'role':'user','parts':[{'text':_0x21fdec}]}]};try{const _0x282d93=await fetch(_0x3b98f8,{'method':_0x319a1f(0x2ed),'headers':{'Content-Type':_0x319a1f(0x197)},'body':JSON[_0x319a1f(0x2ac)](_0x24482c)});if(!_0x282d93['ok']){if(_0x282d93['status']===0x1ad&&_0x5a38e2>0x0)return await new Promise(_0x2e30e8=>setTimeout(_0x2e30e8,_0x120c83)),callGeminiAPI(_0x21fdec,_0x5a38e2-0x1,_0x120c83*0x2);let _0x579f5d=null;try{_0x579f5d=await _0x282d93[_0x319a1f(0x323)]();}catch(_0x3b1390){}let _0x86cd4='HTTP\x20error:\x20'+_0x282d93[_0x319a1f(0x134)];if(_0x282d93[_0x319a1f(0x134)]===0x190)_0x86cd4='Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.';else{if(_0x282d93['status']===0x1ad)_0x86cd4=_0x319a1f(0x3e2);else _0x579f5d?.[_0x319a1f(0x3ce)]?.['message']&&(_0x86cd4=_0x319a1f(0x1ed)+_0x579f5d['error'][_0x319a1f(0x2f2)]);}return toast(_0x86cd4,0xfa0),console[_0x319a1f(0x3ce)](_0x319a1f(0x45c),_0x579f5d||_0x282d93[_0x319a1f(0x178)]),null;}const _0x143f79=await _0x282d93[_0x319a1f(0x323)]();if(_0x143f79[_0x319a1f(0x2a8)]&&_0x143f79[_0x319a1f(0x2a8)][0x0]?.[_0x319a1f(0x238)]?.[_0x319a1f(0x3a2)]?.[0x0]?.['text'])return formatGeminiResponse(_0x143f79[_0x319a1f(0x2a8)][0x0]['content'][_0x319a1f(0x3a2)][0x0][_0x319a1f(0x2aa)]);else{console[_0x319a1f(0x3ce)](_0x319a1f(0x272),_0x143f79);if(_0x143f79[_0x319a1f(0x266)]?.[_0x319a1f(0x20b)])return _0x319a1f(0x39e)+_0x143f79[_0x319a1f(0x266)][_0x319a1f(0x20b)]+'.\x20Please\x20try\x20again\x20with\x20different\x20content.';return _0x319a1f(0x3a5);}}catch(_0x300433){return console[_0x319a1f(0x3ce)](_0x319a1f(0x458),_0x300433),toast('Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.',0xfa0),null;}},loadLanguage(localStorage['getItem']('lang')||'en')[_0x174741(0x26d)](initializeApp);
    </script>
</body>
</html>
