<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="A Pomodoro application for studying, featuring Gemini AI integration and a modern interface." />
    <title>Pomodoro Study App — Gemini AI Integration (New UI)</title>
    <style>
    /*
    =============================================
    POMODORO STUDY APP — FOCUSED UI VERSION (v1.0)
    =============================================
    */

    :root {
      /* Theme Dark (Default) - Updated from file 2 */
      --bg: #0f1222;
      --panel: #171a2e;
      --panel-rgb: 23, 26, 46; /* Add RGB variable for panel */
      --muted: #212646;
      --text: #f4f6ff;
      --sub: #b7c1ff;
      --acc: #6c8cff;
      --acc-rgb: 108, 140, 255;
      --acc-2: #27d3a2;
      --purple: #a78bfa;
      --warn: #ffb020;
      --danger: #ff5c7a;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.054), 0px 4.3px 5.3px rgba(0, 0, 0, 0.077), 0px 8.1px 10px rgba(0, 0, 0, 0.095), 0px 14.5px 17.9px rgba(0, 0, 0, 0.113), 0px 27.2px 33.4px rgba(0, 0, 0, 0.136), 0px 65px 80px rgba(0, 0, 0, 0.19);
      --radius: 16px;
      --panel-opacity: 0.85;
      --gradient-border: linear-gradient(135deg, var(--acc), var(--acc-2));
    }
    
    /* === START: ADD NEW THEMES === */
    [data-theme='light'] {
      --bg: #f5f0e8; --panel: #ffffff; --panel-rgb: 255, 255, 255; --muted: #eaddcf; --text: #4a4a4a; --sub: #8a817c; --acc: #d4a373; --acc-rgb: 212, 163, 115; --acc-2: #a3b18a; --warn: #e76f51; --danger: #d00000;
      --shadow: 0px 1.8px 2.2px rgba(0, 0, 0, 0.024), 0px 4.3px 5.3px rgba(0, 0, 0, 0.037), 0px 8.1px 10px rgba(0, 0, 0, 0.045), 0px 14.5px 17.9px rgba(0, 0, 0, 0.053), 0px 27.2px 33.4px rgba(0, 0, 0, 0.066), 0px 65px 80px rgba(0, 0, 0, 0.09);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }

    [data-theme='pastel'] {
      --bg: #fde2e4; --panel: #fff1f2; --panel-rgb: 255, 241, 242; --muted: #fad2e1; --text: #595260; --sub: #8c7a8a; --acc: #c78283; --acc-rgb: 199, 130, 131; --acc-2: #7ec4cf; --warn: #f9bf45; --danger: #d7263d;
      --shadow: 0 5px 20px rgba(200,150,150,0.2);
      --panel-opacity: 0.9;
      /* Prevent default dark background when no image */
      --bg-image: none;
    }
    
    [data-theme='lofi'] {
      --bg: #2a2a3e; --panel: #3c3c52; --panel-rgb: 60, 60, 82; --muted: #4d4d66; --text: #e0e0ff; --sub: #a0a0c0; --acc: #ff8c69; --acc-rgb: 255, 140, 105; --acc-2: #69c6ff; --warn: #ffd700; --danger: #ff6961;
      /* === Replaced external GIF with inline data URI (offline-safe) === */
      --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9J2cnIHgxPScwJyB5MT0nMCcgeDI9JzEnIHkyPScxJz48c3RvcCBvZmZzZXQ9JzAlJyBzdG9wLWNvbG9yPScjMmEyYTNlJy8+PHN0b3Agb2Zmc2V0PScxMDAlJyBzdG9wLWNvbG9yPScjM2MzYzUyJy8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9JzEwMCUnIGhlaWdodD0nMTAwJScgZmlsbD0ndXJsKCNnKScvPjwvc3ZnPg==');
      --panel-opacity: 0.8;
    }
    
    [data-theme='space'] {
        --bg: #000000; --panel: #1a1a2e; --panel-rgb: 26, 26, 46; --muted: #2a2a4e; --text: #e0e0ff; --sub: #b0b0e0; --acc: #00aaff; --acc-rgb: 0, 170, 255; --acc-2: #aaff00; --warn: #ffaa00; --danger: #ff0055;
        /* === Replaced external GIF with inline data URI (offline-safe) === */
        --bg-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc4MDAnIGhlaWdodD0nNjAwJz48ZGVmcz48cmFkaWFsR3JhZGllbnQgaWQ9J2cnIGN4PSc1MCUnIGN5PSc0MCUnIHI9JzcwJSc+PHN0b3Agb2Zmc2V0PScwJScgc3RvcC1jb2xvcj0nIzBiMGIxYScvPjxzdG9wIG9mZnNldD0nMTAwJScgc3RvcC1jb2xvcj0nIzAwMDAwMCcvPjwvcmFkaWFsR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZpbGw9J3VybCgjZyknLz48L3N2Zz4=');
        --panel-opacity: 0.75;
    }
    /* === END: ADD NEW THEMES === */

    *:focus-visible {
      outline: 2px solid var(--acc); outline-offset: 2px; border-radius: 4px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin:0; 
      font-family: system-ui, -apple-system, 'Segoe UI Variable', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Inter', sans-serif; 
      
      background-color: var(--bg);
      background-image: var(--bg-image, radial-gradient(1200px 800px at 10% -10%, #20285b 0%, #0f1222 50%, #0b0e1a 100%));
      
      background-size: cover; 
      background-position: center; 
      color:var(--text); 
      transition: background 0.5s ease, color 0.5s ease, filter 0.5s ease;
      text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.5);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a{color:var(--acc)}

    .app{display:flex; min-height:100vh}
    
    .app-nav {
        width: 60px;
        padding: 16px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        z-index: 100;
    }
    .nav-btn {
        background: transparent;
        border: none;
        color: var(--sub);
        width: 44px;
        height: 44px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all .2s ease;
        position: relative;
    }
    .nav-btn:hover { background: var(--muted); color: var(--text); }
    .nav-btn.active { background: var(--acc); color: white; }
    .nav-btn svg { width: 24px; height: 24px; }
    .nav-btn .tooltip {
        position: absolute;
        left: 110%;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text);
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 12px;
        box-shadow: var(--shadow);
        white-space: nowrap;
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        pointer-events: none;
        z-index: 200;
    }
    .nav-btn:hover .tooltip { opacity: 1; visibility: visible; }

    .app-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        max-height: 100vh;
    }

    .view { display: none; }
    .view.active { display: grid; gap: 24px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .main.reloading { opacity: 0; transition: opacity 0.2s ease-out; }

    .panel-bg{
        background: rgba(23, 26, 46, var(--panel-opacity));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border:1px solid rgba(255,255,255,.08);
    }
    /* Add border rules for light/pastel themes */
    [data-theme='light'] .panel-bg, [data-theme='pastel'] .panel-bg { border:1px solid rgba(0,0,0,0.05); }
    [data-theme='lofi'] .panel-bg { border:1px solid rgba(255,255,255,0.1); }
    [data-theme='space'] .panel-bg { border:1px solid rgba(255,255,255,0.12); }


header.app-header{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-radius:var(--radius); box-shadow:var(--shadow); margin-bottom: 24px; position: relative; z-index: 2000;}
    header .actions{display:flex; gap:8px; align-items:center}
    
    .btn {
      background: rgba(255, 255, 255, 0.08);
      color: var(--text);
      border: none; /* Modified: remove default border */
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: inset 0 -2px 0 rgba(0,0,0,0.08);
      font-weight: 600;
      transition: all .15s ease;
      position: relative;
      overflow: hidden;
    }
    .btn::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        border: 2px solid transparent; border-radius: 12px; background: var(--gradient-border) border-box;
        -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: destination-out; mask-composite: exclude; opacity: 0; transition: opacity 0.3s ease;
    }
    .btn:hover::before { opacity: 1; }
    .btn:hover { background: rgba(255, 255, 255, 0.12); }
    .btn:active { transform: translateY(1px) scale(0.98); filter: brightness(1); }
    .btn:disabled { cursor: not-allowed; filter: brightness(0.8) saturate(0.5); }
    .btn.ghost { background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); }
    .btn.ghost:hover { background: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.3); }
    .btn.acc { background: var(--acc); color: white; }
    .btn.warn { background: var(--warn); color: white; }
    .btn.danger { background: var(--danger); color: white; }
    .btn.small { padding: 6px 10px; font-size: 14px; border-radius: 9px; }
    .btn.small::before { border-radius: 9px; }
    .btn > svg { width: 16px; height: 16px; stroke-width: 2.5px; }

    /* === START: UPDATE TOPIC MANAGEMENT UI === */
    #view-topics { grid-template-columns: 1fr; }
    .topic-item { background:rgba(255,255,255,.04); border:1px solid var(--muted); border-radius:12px; padding:8px; margin-bottom:8px; } /* Modified */
    .topic-header, .sub-row { display:flex; align-items:center; gap:8px; position: relative; }
    .topic-header { cursor: pointer; }
    .topic-header .topic-actions { cursor: default; }
    .topic-header .topic-actions * { cursor: pointer; }
    .topic-item { cursor: pointer; }
    .topic-item .topic-actions { cursor: default; }
    .topic-item .topic-actions * { cursor: pointer; }
    .topic-title { flex:1; font-weight:600; cursor: pointer; }
    .chev { width:28px; height:28px; border-radius:8px; display:inline-flex; align-items:center; justify-content:center; flex-shrink: 0; cursor: pointer; }
    .chev .ico { display:inline-block; transition: transform .18s ease; }
    .chev[aria-expanded="false"] .ico { transform: rotate(-90deg); }
    .subtopics { margin-top:8px; display:flex; flex-direction:column; gap:6px; }
    .subtopics.hidden { display:none; }
    
    .topic-actions, .sub-row .actions {
        opacity: 0;
        visibility: hidden;
        transition: opacity .2s ease, visibility .2s ease;
        display: flex;
        gap: 6px;
        align-items: center;
    }
    .topic-item:hover .topic-actions, .topic-item:focus-within .topic-actions,
    .sub-row:hover .actions, .sub-row:focus-within .actions {
      opacity: 1;
      visibility: visible;
    }
    .actions-menu-btn {
        padding: 0;
        width: 28px;
        height: 28px;
        font-size: 1.2em;
        line-height: 1;
    }
    .actions-menu {
        position: absolute;
        top: 100%;
        right: 0;
        border-radius: 8px;
        padding: 6px;
        box-shadow: var(--shadow);
        z-index: 10;
        min-width: 150px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }
    /* Raise the open menu block above others */
    .topic-item.menu-active { position: relative; z-index: 20; }
    
    .actions-menu.show { display: flex; }
    .menu-item {
        background: transparent; border: none; color: var(--text);
        padding: 8px 10px; border-radius: 6px; text-align: left;
        width: 100%; cursor: pointer; transition: background .2s ease;
        display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 500;
    }
    .menu-item:hover { background: var(--acc); color: white; }
    .menu-item.danger:hover { background: var(--danger); }
    /* === END: UPDATE TOPIC MANAGEMENT UI === */

    .subtopic-btn{
        flex:1; 
        text-align:left;
        background-color: rgba(0,0,0,0.02); /* Modified */
    }
    .subtopic-btn:hover {
        background-color: transparent; /* Hover transparent to avoid blue background */
    }
    .subtopic-btn.active{
        outline:2px solid var(--acc); 
    }
    .subtopic-btn.active:hover {
        background: transparent; /* Keep background transparent on hover */
    }
    
    .panel{border-radius:var(--radius); padding:24px; box-shadow:var(--shadow)}

    .timer-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .timer{display:grid; gap:16px; grid-template-columns: 1fr; align-items:center; text-align:center}
    .big-time{font-size: clamp(60px, 12vw, 96px); letter-spacing:1px; font-weight:700; color: var(--text)}
    .state{font-weight:700; letter-spacing:.6px}
    .state.work{color:var(--acc-2)} /* Color tweak */
    .state.break{color:var(--warn)}
    .state.long{color:var(--danger)} /* Color tweak */
    .controls{display:flex; flex-wrap:wrap; gap:12px; justify-content:center}    
    #btnStart { padding: 14px 28px; font-size: 1.2em; }
    #btnPause, #btnResume { padding: 12px 24px; font-size: 1.1em; }

    /* === START: SOFTER DIVIDER CUSTOMIZATION === */
    #view-timer .panel-bg hr {
        border: none; /* Remove default border */
        height: 1px;  /* Set divider height */
        background-color: var(--muted); /* Use theme's secondary color */
        opacity: 0.3; /* Make it subtle to blend with background */
        margin-top: 0; /* Adjust spacing */
    }
    /* === END: SOFTER DIVIDER CUSTOMIZATION === */

    .stats-grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px}
    .stat-card{background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:14px; padding:12px; text-align:center} /* Modified */
    .stat-card h4{margin:4px 0 8px; color:var(--sub); font-weight:600; font-size: 14px;}
    .stat-value{font-size: 20px; font-weight: 600;}
    .tiny{font-size:12px; color:var(--sub)}
    .history{display:grid; gap:8px; max-height:300px; overflow:auto; padding-right:6px}
    .hist-item{display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:start; background:rgba(255,255,255,0.04); border:1px solid var(--muted); border-radius:10px; padding:10px} /* Modified */

    .row{display:flex; gap:8px; align-items:center}
    .row > * {flex:1}
    input[type="text"], input[type="password"], input[type="number"], select, textarea{width:100%; background:rgba(255,255,255,0.04); color:var(--text); border:1px solid var(--muted); border-radius:10px; padding:10px; outline:none}
    textarea{min-height:80px; resize: vertical;}

    .toasts{position:fixed; right:16px; bottom:16px; display:flex; flex-direction:column; gap:8px; z-index:9999}
    .toast{
        background: var(--panel); /* Modified */
        border:1px solid var(--muted);
        color:var(--text);
        padding:10px 12px; border-radius:12px; box-shadow:var(--shadow);
        animation: toast-in .3s ease; transform-origin: bottom right;
    }
    @keyframes toast-in { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,var(--panel-opacity)); z-index:10000; backdrop-filter: blur(5px);} /* Raise z-index to sit above header */
    .modal.show{display:flex}
    .modal-card{
        position: relative;
        z-index: 10001;
        width:min(720px, 94vw);
        border-radius:16px;
        padding:16px;
        box-shadow:var(--shadow);
        animation: modal-in .25s ease-out;
        max-height: 90vh;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
    }
    body.modal-open { overflow: hidden; }
    @keyframes modal-in { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
    .modal-card h3{margin-top:0}
    .dashboard-table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    .dashboard-table th, .dashboard-table td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--muted); }
    .dashboard-table th { color: var(--sub); }

    .footer-note{font-size:12px; color:var(--sub)}
    .hidden{display:none !important}

    .notes-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; padding-right: 6px; }
    .note-item { background: rgba(255,255,255,0.04); border-radius: 10px; padding: 10px; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; cursor: pointer; } /* Modified */
    .note-content-wrapper { flex: 1; min-width: 0; }
    .note-content { white-space: pre-wrap; word-break: break-word; max-height: 60px; overflow: hidden; position: relative; transition: max-height 0.35s ease-in-out; }
    .note-content:not(.expanded)::after {
        content: ''; position: absolute; bottom: 0; right: 0; width: 100%; height: 20px; background: linear-gradient(to top, var(--panel) 20%, transparent);
    }
    .note-content.expanded { max-height: 500px; }
    .note-meta { font-size: 11px; color: var(--sub); margin-top: 4px; }
    
    .spinner { border: 2px solid var(--muted); border-top-color: var(--text); border-radius: 50%; width: 16px; height: 16px; animation: spin 1s linear infinite; } /* Modified */
    @keyframes spin { to { transform: rotate(360deg); } }

    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .panel-header h3 { margin: 0; }
    .panel-header .actions { display: flex; gap: 8px; }
    
    .aux-panel { margin-top: 24px; }
    .tab-nav { display: flex; gap: 4px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 16px; }
    .tab-btn { background: transparent; border: none; color: var(--sub); padding: 8px 16px; cursor: pointer; border-bottom: 2px solid transparent; transition: all .2s ease; font-weight: 600; }
    .tab-btn:hover { color: var(--text); }
    .tab-btn.active { color: var(--acc); border-bottom-color: var(--acc); }
    .tab-content {
      display: none;
      padding-top: 8px;
    }
    .tab-content.active {
      animation: fadeIn 0.25s ease-out;
    }
    #tasks.tab-content.active,
    #notes.tab-content.active,
    #ai.tab-content.active {
        display: block;
    }

    #settings-timer.tab-content.active,
    #settings-ui.tab-content.active,
    #settings-integrations.tab-content.active {
        display: flex;
    }

    .settings-row-toggle {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
    }
    .settings-row-toggle span {
      flex: 1;
      cursor: pointer;
    }
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .toggle-switch .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--muted);
      transition: .3s;
      border-radius: 24px;
    }
    .toggle-switch .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .3s;
      border-radius: 50%;
    }
    .toggle-switch input:checked + .slider {
      background-color: var(--acc-2);
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(20px);
    }
    
    .chat-messages { max-height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; padding: 4px; }
    .chat-msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; word-break: break-word; }
    .chat-msg.user { background: var(--acc); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
    .chat-msg.model { background: var(--muted); align-self: flex-start; border-bottom-left-radius: 4px; }
    .chat-input-area { display: flex; gap: 8px; }

    .methods-list { list-style: none; padding: 0; }
    .method-item { align-items: flex-start; padding: 12px; display: flex; gap: 10px; border-radius: 8px; }
    .method-item:hover { background: rgba(0,0,0,0.03); } /* Modified */
    .method-item input[type="checkbox"] { width: 18px; height: 18px; margin-top: 2px; flex-shrink: 0;}
    .method-item label { flex: 1; }
    .method-item label.completed { text-decoration: line-through; color: var(--sub); }
    .method-item .content-wrapper { flex: 1; cursor: pointer; }
    .method-item .concept { font-size: 14px; color: var(--sub); margin-top: 8px; border-left: 2px solid var(--muted); padding-left: 12px; white-space: pre-wrap; word-break: break-word; }
    /* Highlight section titles and bold text inside method content */
    .method-content h4 {
        color: var(--acc-2);
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
    }
    .method-content strong {
        color: var(--acc);
        font-weight: 600;
    }
    /* Apply the same highlight to the Guide view */
    #view-guide h4 { color: var(--acc-2); }
    #view-guide strong { color: var(--acc-2); }
    /* Show hand cursor to indicate clickability */
    .method-item, .method-item summary { cursor: pointer; }
    .subtopic-todo-list { list-style: none; padding: 0; margin: 0; max-height: 100px; overflow-y: auto; text-align: left; }
    .subtopic-todo-list li { display: flex; align-items: center; gap: 8px; padding: 4px; transition: all 0.2s ease-out; }
    .subtopic-todo-list li.removing { transform: translateX(100%); opacity: 0; }
    .subtopic-todo-list label { flex: 1; }

    #youtube-player-container { position: absolute; top: -9999px; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.1); border-radius: 10px; } /* Modified */
    ::-webkit-scrollbar-thumb { background: var(--muted); border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
    ::-webkit-scrollbar-thumb:hover { background: var(--sub); background-clip: content-box; }
    
    .timer-circle-container {
        position: relative; width: clamp(250px, 40vw, 320px); height: clamp(250px, 40vw, 320px); margin: 24px auto; display: flex; align-items: center; justify-content: center;
    }
    .timer-svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transform: rotate(-90deg); }
    .timer-circle-bg, .timer-circle-progress { fill: none; stroke-width: 8; }
    .timer-circle-bg { stroke: var(--muted); } /* Modified */
    .timer-circle-progress { stroke: var(--acc); stroke-linecap: round; transition: stroke-dashoffset 0.3s linear, stroke 0.5s ease; }
    @keyframes flash { 0%, 100% { box-shadow: 0 0 10px 2px transparent; } 50% { box-shadow: 0 0 20px 8px currentColor; } }
    .timer-circle-container.finished { color: var(--acc-2); animation: flash 1s ease-out; }
    @keyframes breathing-effect { 0% { transform: scale(1); } 50% { transform: scale(1.03); } 100% { transform: scale(1); } }
    .timer-circle-container.breathing { animation: breathing-effect 3s ease-in-out infinite; }
    
    
    
    @media (max-width: 1024px) {
      .app-content { padding: 20px; }
      .panel { padding: 20px; }
      .timer-circle-container { width: clamp(220px, 50vw, 300px); height: clamp(220px, 50vw, 300px); }
    }

    @media (max-width: 768px) {
      .app { flex-direction: column; }
      .app-nav { width: 100%; height: 60px; flex-direction: row; justify-content: center; border-right: none; border-top: 1px solid rgba(255,255,255,.08); order: 2; padding: 0 16px; }
      .app-content { padding: 16px; order: 1; }
      .panel { padding: 16px; }
      .modal-card .tab-nav { overflow-x: auto; }
    }

    @media (max-width: 480px) {
      .app-nav { height: 50px; }
      .nav-btn { flex: 1; }
      header.app-header { flex-direction: column; align-items: stretch; gap: 8px; }
      .btn { padding: 8px 12px; }
      .timer-circle-container { width: clamp(180px, 80vw, 220px); height: clamp(180px, 80vw, 220px); margin: 16px auto; }
      .panel { padding: 12px; }
      .app-content { padding: 12px; }
    }

    #view-timer.no-subtopic-selected > .panel-bg:not(:first-child) { display: none; }
    #view-timer.no-subtopic-selected .timer-header > .presets { display: none; }
    #view-timer.no-subtopic-selected .timer { display: none; }

    header.app-header .actions #btnFullscreen { background: transparent; border: none; box-shadow: none; }
    header.app-header .actions #btnFullscreen:hover { background: var(--muted); filter: none; }
    header.app-header .actions #btnFullscreen:hover::before { opacity: 0; }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
        background: rgba(255,255,255,0.04) !important; /* Modified: switched to translucent white background */
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.1); /* Faint white border */
        transition: background .2s ease, border-color .2s ease;
    }
    input[type="text"]:focus, input[type="password"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
        background: rgba(255,255,255,0.06) !important; /* Fine-tune: closer to spec */
        border-color: var(--acc);
    }
    /* === START: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */
    [data-theme='light'] input, [data-theme='light'] select, [data-theme='light'] textarea,
    [data-theme='pastel'] input, [data-theme='pastel'] select, [data-theme='pastel'] textarea {
        background: rgba(0, 0, 0, 0.05) !important; /* Use translucent black instead of white on light theme */
        border-color: rgba(0, 0, 0, 0.1); /* Faint black border on light themes */
    }

    [data-theme='light'] input:focus, [data-theme='light'] select:focus, [data-theme='light'] textarea:focus,
    [data-theme='pastel'] input:focus, [data-theme='pastel'] select:focus, [data-theme='pastel'] textarea:focus {
        background: rgba(0, 0, 0, 0.07) !important; /* Increase density on focus */
    }
    /* === END: FIX INPUT/SELECT BACKGROUND ON LIGHT THEMES === */

    /* Improve option background and text color per current theme */
    select option {
        background: var(--panel);
        color: var(--text);
    }
    
    ::placeholder { color: var(--sub); opacity: 0.7; } /* Tweak */
    ::-ms-input-placeholder { color: var(--sub); }
    :-ms-input-placeholder { color: var(--sub); }

    
    
    .draggable-timer {
        position: fixed;
        bottom: 20px;
        right: 20px;
        color: var(--text);
        padding: 8px 16px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        font-size: 2em;
        font-weight: 600;
        cursor: move;
        user-select: none;
        z-index: 9998;
        opacity: 0;
        transform: scale(0.9);
        pointer-events: none;
        transition: opacity 0.35s ease, transform 0.35s ease;
    }
    body.bg-view-mode .draggable-timer {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }
    .app-nav, .panel-bg, .app-header .actions > *, .app-header > .row {
        transition: opacity 0.35s ease, transform 0.35s ease, background 0.35s ease, border-color 0.35s ease, box-shadow 0.35s ease;
    }
    body.bg-view-mode .app-nav,
    body.bg-view-mode .view.active > .panel-bg {
        opacity: 0;
        pointer-events: none;
        transform: scale(0.98);
    }
    body.bg-view-mode .app-header {
        background: transparent !important;
        border-color: transparent !important;
        box-shadow: none !important;
    }
    body.bg-view-mode .app-header .actions > *:not(#btnToggleBg),
    body.bg-view-mode .app-header > .row {
        opacity: 0;
        pointer-events: none;
    }
    body.bg-view-mode #btnToggleBg {
        opacity: 1;
        pointer-events: auto;
    }
    .sound-permission-bar {
      position: fixed; left: 50%; transform: translateX(-50%);
      bottom: 48px; z-index: 9999;
      border-radius: 12px; padding: 10px 14px;
      display: none; align-items: center; gap: 10px;
      box-shadow: var(--shadow);
    }
    .sound-permission-bar.show { display: flex; }
    .sound-permission-bar .msg { font-size: 14px; color: var(--text); }
    .draggable-timer { text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9); }

    /* Reduce/remove text shadow on light themes to avoid blur/glare */
    body[data-theme='light'],
    body[data-theme='pastel'] { text-shadow: none; }
    body[data-theme='light'] .draggable-timer,
    body[data-theme='pastel'] .draggable-timer { text-shadow: none; }

    /* ============================================= */
/* ========================================================= */
/* START: THI?T L?P PANEL KI?U M?  ?C (FROSTED GLASS)        */
/* ========================================================= */

/* --- 1.  p d?ng hi?u ?ng n?n m? chung cho t?t c? c c panel --- */
.app-nav,
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    background: rgba(var(--panel-rgb), var(--panel-opacity));
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
}

/* --- 2.  ?nh nghia vi?n cho t?ng lo?i panel --- */
.app-nav {
    border-right: 1px solid rgba(255, 255, 255, 0.1);
}
.panel-bg,
.modal-card,
.actions-menu,
.nav-btn .tooltip,
.draggable-timer, 
.sound-permission-bar,
.toast,
.topic-item,
.stat-card,
.hist-item,
.method-item {
    border: 1px solid rgba(255, 255, 255, 0.1);
}

/* --- 3. Tinh ch?nh vi?n cho c c theme S NG (Light/Pastel) --- */
[data-theme='light'] .app-nav,
[data-theme='light'] .panel-bg,
[data-theme='light'] .modal-card,
[data-theme='light'] .actions-menu,
[data-theme='light'] .nav-btn .tooltip,
[data-theme='light'] .draggable-timer,
[data-theme='light'] .sound-permission-bar,
[data-theme='light'] .toast,
[data-theme='light'] .topic-item,
[data-theme='light'] .stat-card,
[data-theme='light'] .hist-item,
[data-theme='light'] .method-item,
[data-theme='pastel'] .app-nav,
[data-theme='pastel'] .panel-bg,
[data-theme='pastel'] .modal-card,
[data-theme='pastel'] .actions-menu,
[data-theme='pastel'] .nav-btn .tooltip,
[data-theme='pastel'] .draggable-timer,
[data-theme='pastel'] .sound-permission-bar,
[data-theme='pastel'] .toast,
[data-theme='pastel'] .topic-item,
[data-theme='pastel'] .stat-card,
[data-theme='pastel'] .hist-item,
[data-theme='pastel'] .method-item {
    border-color: rgba(0, 0, 0, 0.1);
}

/* --- 4. S?a l?i hi?u ?ng fade-out c?a ghi ch  cho ph  h?p --- */
.note-content:not(.expanded)::after {
    background: linear-gradient(to top, rgba(var(--panel-rgb), 1) 20%, transparent);
}

/* --- C c quy t?c c n l?i gi? nguy n t? file g?c --- */
[data-theme='light'] .tab-nav,
[data-theme='pastel'] .tab-nav {
    border-bottom-color: rgba(0, 0, 0, 0.1);
}
.subtopic-btn {
    background-color: transparent;
}
.subtopic-btn:hover {
    background-color: transparent; /* Hover transparent to avoid blue background */
}
.method-item[open] summary {
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}
    [data-theme='light'] .method-item[open] summary,
    [data-theme='pastel'] .method-item[open] summary {
        border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    /* Editor container (single pane, Rich Text) */
    .editor-container { height: 350px; }
    .editable-content { height: 100%; border: 1px solid var(--muted); border-radius: 10px; padding: 10px; overflow-y: auto; background: var(--bg); }
    .editable-content:focus-within { border-color: var(--acc); outline: none; }
    .editable-content h4 { color: var(--acc-2); font-size: 1.1em; margin-top: 1.5em; margin-bottom: 0.5em; }
    .editable-content strong, .editable-content b { color: var(--acc); font-weight: 600; }
    .editable-content ol, .editable-content ul { padding-left: 20px; }

    /* Editor toolbar for Methods modal */
    .editor-toolbar { display: flex; gap: 6px; margin-bottom: 6px; padding: 4px; background: var(--muted); border-radius: 8px; }
    .editor-toolbar button { font-weight: bold; width: 32px; height: 32px; padding: 0; }
    .editor-toolbar .btn.ghost:hover { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.15); }
    .editor-toolbar .btn.ghost.active { background-color: rgba(var(--acc-rgb, 108, 140, 255), 0.25); }
    .color-picker-wrapper { position: relative; }
    .color-palette { position: absolute; bottom: 110%; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; padding: 6px; border-radius: 8px; border: 1px solid var(--muted); background: var(--panel); box-shadow: var(--shadow); z-index: 10; }
    .color-swatch { width: 24px; height: 24px; border-radius: 50%; border: 2px solid rgba(255, 255, 255, 0.5); cursor: pointer; transition: transform 0.15s ease; }
    .color-swatch:hover { transform: scale(1.15); }

    /* Method actions inline with summary and show on hover */
    .method-item summary { display: flex; align-items: center; justify-content: space-between; }
    .method-item summary > span { flex: 1; }
    .method-item summary .topic-actions { margin-left: 8px; }
    .method-title { cursor: pointer; }
    .method-item:hover .topic-actions, .method-item:focus-within .topic-actions { opacity: 1; visibility: visible; }

    </style>
</head>
<body data-theme="default"> <div class="app" id="app">
    <nav class="app-nav">
        <button class="nav-btn active" id="navBtnTimer" data-view="timer" aria-label="Timer">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
            <span class="tooltip">Timer</span>
        </button>
        <button class="nav-btn" id="navBtnTopics" data-view="topics" aria-label="Topics">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg>
            <span class="tooltip">Topics</span>
        </button>
        <button class="nav-btn" id="navBtnStats" data-view="stats" aria-label="Stats">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"></path><path d="m19 9-5 5-4-4-3 3"></path></svg>
            <span class="tooltip">Stats</span>
        </button>
        <button class="nav-btn" id="navBtnMethods" data-view="methods" aria-label="Knowledge Base">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.042 21.672L13.684 16.6s.408-1.947 1.25-3.25c.842-1.303 2.002-2.5 3.5-3.5s3.25-1.25 3.25-1.25l5.072 1.358c.27.072.358.42.128.628l-3.35 3.35a.499.499 0 0 1-.594.052l-2.07-1.486c-.44-.314-.82-.53-1.11-.665-.29-.135-.55-.22-.78-.245s-.45.045-.63.155c-.18.11-.3.29-.36.5-.06.21.02.48.18.78.16.3.385.68.665 1.11l1.486 2.07a.499.499 0 0 1-.052.594l-3.35 3.35c-.208.23-.556.142-.628-.128z"/><path d="M12 15l-3-3 3-3 3 3-3 3z"/><path d="M9.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/><path d="M5.01 11.99l-3.005 3.004a.997.997 0 0 1-1.41-1.41l3.004-3.005-3.004-3.005a.997.997 0 0 1 1.41-1.41l3.005 3.004z"/></svg>
            <span class="tooltip">Knowledge Base</span>
        </button>
        <button class="nav-btn" id="btnSettings" style="margin-top: auto;" aria-label="Settings">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <span class="tooltip">Settings</span>
        </button>
        <button class="nav-btn" id="navBtnGuide" data-view="guide" aria-label="Guide">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            <span class="tooltip">Guide</span>
        </button>
    </nav>

    <main class="app-content">
      <header class="app-header panel-bg">
        <div class="row" style="gap:12px; align-items:center; flex:0 1 auto">
          <strong>📚 Pomodoro Study App</strong>
          <span class="badge" id="selectedContext">No Subtopic Selected</span>
        </div>
        <div class="actions">
          <button class="btn ghost small" id="btnDashboard" title="Dashboard">📊 Dashboard </button>
          <a href="https://forms.gle/61hYjvwAkR328EaC9" target="_blank" rel="noopener noreferrer" class="btn ghost small" title="Send your feedback">💬 Feedback</a>
          <button class="btn ghost small" id="btnExport" title="Export JSON">⬇️ Export File</button>
          <label class="btn ghost small" for="importFile" title="Import JSON">⬆️ Import File</label>
          <input type="file" id="importFile" accept="application/json" style="display:none" />
          <button class="btn small" id="btnToggleBg" title="Show/Hide Interface">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
          </button>
          <button class="btn small" id="btnFullscreen" title="Fullscreen">↗️</button>
        </div>
      </header>
      

      <div id="view-timer" class="view active">
        <section class="panel panel-bg">
          <div class="timer-header">
            <div id="welcomePanel" class="hidden panel-bg" style="text-align:center; padding: 20px; border-radius: var(--radius); width: 100%;">
                <h3>Welcome to the Pomodoro Study App!</h3>
                <p>Get started by selecting a <strong>Subtopic</strong> or creating a new Topic/Subtopic.</p>
                <button class="btn acc" id="btnHelpCreateTopic">＋ Create New Topic</button>
            </div>
            <div class="presets" role="group" aria-label="Choose preset mode">
                <button id="btnPresetA" class="btn small ghost" data-preset="A"></button>
                <button id="btnPresetB" class="btn small ghost" data-preset="B"></button>
                <button id="btnPresetC" class="btn small ghost" data-preset="C">🌊 Flow</button>
            </div>
          </div>
          <hr />
          <div class="timer" aria-live="polite">
            <div class="badge" id="stateBadge">STATUS</div>
            
            <div class="timer-circle-container">
              <svg class="timer-svg" viewBox="0 0 100 100">
                  <circle class="timer-circle-bg" cx="50" cy="50" r="45"></circle>
                  <circle class="timer-circle-progress" cx="50" cy="50" r="45"></circle>
              </svg>
              <div id="timeDisplay" class="big-time">00:00</div>
            </div>

            <div class="tiny" id="cycleInfo"></div>

            <div class="tiny" id="breakSuggestionDisplay" style="min-height: 1.5em; font-style: italic; opacity: 0.8; transition: opacity 0.3s ease;"></div>

            <div id="windDownChecklist" class="hidden" style="text-align: left; max-width: 300px; margin: 0 auto; padding: 0 10px;">
              <h4 style="margin: 8px 0 4px; color: var(--acc); text-align: center;">Wind-down Checklist</h4>
              <ul style="list-style: '✓ '; margin: 0; padding-left: 20px; color: var(--sub);">
                <li>Save your current work (Save/Commit).</li>
                <li>Jot down the "Next step".</li>
                <li>Tidy up your workspace.</li>
              </ul>
            </div>
            
            <div class="controls">
              <button class="btn acc" id="btnStart" aria-label="Start (Space)">▶️ Start</button>
              <button class="btn warn hidden" id="btnFinishFlow" aria-label="End focus session">🧘 Start Break</button>
              <button class="btn" id="btnPause" aria-label="Pause (Space)">⏸️ Pause</button>
              <button class="btn" id="btnResume" aria-label="Resume (Space)">⏵ Resume</button>
              <button class="btn warn" id="btnSkip" aria-label="Skip (N)">⏭️ Skip</button>
              <button class="btn danger" id="btnReset">↺ Reset</button>
              <button class="btn acc small hidden" id="btnBreakEarly">🧘 Break Early</button>
            </div>
            <div class="tiny">Shortcuts: <strong>Space</strong> = Start/Pause/Resume, <strong>N</strong> = Next/Skip</div>
          </div>
        </section>

        <section class="panel panel-bg aux-panel">
            <nav class="tab-nav">
                <button class="tab-btn active" data-tab="tasks">Tasks</button>
                <button class="tab-btn" data-tab="notes">Notes</button>
                <button class="tab-btn" data-tab="ai">Gemini AI</button>
            </nav>
            <div id="tasks" class="tab-content active">
                <h4 style="margin: 0 0 8px; color: var(--sub);">To-dos for this subtopic:</h4>
                <ul id="subtopicTasksList" class="subtopic-todo-list"></ul>
                <div class="row" style="gap:8px; margin-top: 8px;">
                    <input type="text" id="newSubtopicTaskInput" placeholder="Add a new task..." />
                    <button id="btnAddSubtopicTask" class="btn small" style="flex: 0 1 auto;">Add</button>
                </div>
            </div>
            <div id="notes" class="tab-content">
                <div id="generalNotesList" class="notes-list"></div>
                <div class="add-note-area" style="margin-top: 12px;">
                    <textarea id="newGeneralNoteText" placeholder="Add a new note..."></textarea>
                    <div style="text-align: right; margin-top: 8px;">
                        <button class="btn acc small" id="btnAddGeneralNote">＋ Add Note</button>
                    </div>
                </div>
            </div>
            <div id="ai" class="tab-content">
                <div class="panel-header" style="margin-bottom: 8px; padding: 0;">
                    <h4 style="margin:0;">Gemini for: <span id="currentSubtopicNameChat">(none selected)</span></h4>
                    <div class="actions">
                        <button id="btnClearChat" class="btn small danger" title="Clear History">🗑️</button>
                    </div>
                </div>
                <div id="chatMessages" class="chat-messages"></div>
                <div id="aiPromptSuggestions" style="display: flex; gap: 6px; margin: 8px 0; flex-wrap: wrap;">
                  <button class="btn small ghost" data-prompt="Explain the key concepts of this topic">Explain Concept</button>
                  <button class="btn small ghost" data-prompt="Create a detailed outline for this topic">Create Outline</button>
                  <button class="btn small ghost" data-prompt="List 5 important review questions for this topic">Create Review Questions</button>
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Ask Gemini something..." />
                  <button id="btnSendMessage" class="btn acc">Send</button>
                </div>
            </div>
        </section>
      </div>

      <div id="view-topics" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin: 0;">Topic Management</h3>
                <button class="btn small acc" id="btnAddTopic" style="margin-left: auto;">＋ Add Topic</button>
            </div>
            <div id="topicsList"></div>
            <div class="footer-note">Click the arrow to expand/collapse the subtopic list.</div>
        </div>
      </div>
      
      <div id="view-stats" class="view">
        <section class="panel panel-bg">
            <h3 style="margin:0 0 12px 0;">Statistics & History — <span id="currentSubtopicName">(none selected)</span></h3>
            <div class="stats-grid">
              <div class="stat-card"><h4>Total Time</h4><div class="stat-value" id="statTotal">0 min</div></div>
              <div class="stat-card"><h4>Sessions</h4><div class="stat-value" id="statSessions">0</div></div>
              <div class="stat-card"><h4>Tasks Completed</h4><div class="stat-value" id="statTasks">0</div></div>
            </div>
            <div style="margin-top:12px">
              <h4 style="margin:4px 0 8px; color:var(--sub)">History (FOCUS)</h4>
              <div class="history" id="historyList"></div>
            </div>
        </section>
      </div>
      
      <div id="view-methods" class="view">
        <div class="panel panel-bg">
            <div class="row" style="gap:8px; align-items: center; margin-bottom: 12px;">
                <h3 style="margin:0;">💡 Personalized Knowledge Base</h3>
                <button class="btn small acc" id="btnAddMethod" style="margin-left: auto;">＋ Add Knowledge</button>
            </div>
            <p class="tiny" style="margin-top: -8px; margin-bottom: 20px;">Click on an item to see details.</p>
            <div class="methods-container"></div>
        </div>
      </div>

      <div id="view-guide" class="view">
          <div class="panel panel-bg">
              <h3 style="margin-top: 0;">📖 Discover the Pomodoro Study App</h3>
              <p>
                  Welcome to a study space designed for focus and efficiency. Explore the features that support your learning journey.
              </p>

              <h4>🚀 Quick Start in 4 Steps</h4>
              <p>To keep your journey organized, the app uses a <strong>Main Topic → Subtopic</strong> structure.</p>
              <ol>
                  <li>Open <strong>📚 Topics</strong> from the side navigation.</li>
                  <li>Click <strong>＋ Add Topic</strong> to create a main area (e.g., "Conversational English").</li>
                  <li>Next to the topic, click <strong>＋ Add</strong> to create a more specific subtopic (e.g., "Lesson 1: Practice IPA").</li>
                  <li>Select that subtopic. You’re now ready to start your first focus session!</li>
              </ol>

              <hr />
              <h4>✨ Notable Features</h4>

              <h4>Flexible Timer Modes ⏱️</h4>
              <p>The app offers more than Pomodoro. Pick what fits your work:</p>
              <ul>
                  <li><strong>Classic Pomodoro (Style A/B):</strong> Focus in fixed sessions (e.g., 25 min work, 5 min break) to build discipline and cadence.</li>
                  <li><strong>Flowtime Mode (Style 🌊 Flow):</strong> Ideal for deep work. The timer counts up; end when it feels right. Break time is suggested based on your focus time.</li>
                  <li><strong>Wind-down Buffer:</strong> A customizable buffer between focus and break to wrap up, jot the next step, and switch smoothly—without abrupt cutoffs.</li>
              </ul>

              <h4>Personalized Knowledge Base 💡</h4>
              <p>You can <strong>Add, Edit, Delete</strong> learning methods and important notes. The rich editor lets you format headings, bold key points, create lists, and pick text colors for emphasis.</p>

              <h4>Visual Topic Management</h4>
              <p>Easily organize your study goals. Use <strong>drag and drop</strong> to reorder Topics or move Subtopics across topics intuitively.</p>

              <h4>Integrated Tasks & Notes 📝</h4>
              <p>Right within the timer view, create to-dos for each subtopic and jot quick notes without breaking your flow.</p>

              <h4>Zen Mode 🧘</h4>
              <p>When you need absolute focus, click the eye icon (👁️). The interface hides, leaving only the background and timer. You can <strong>drag the timer</strong> anywhere for a clean workspace.</p>

              <h4>Statistics & Milestones 🏆</h4>
              <p>Track your journey through meaningful numbers. The app records and celebrates important focus-time milestones—turning effort into achievements.</p>

              <hr />
              <h4>⌨️ Smart Shortcuts</h4>
              <ul>
                  <li><kbd>Space</kbd>: Start / Pause / Resume the session.</li>
                  <li><kbd>N</kbd>: Skip the current focus or break session.</li>
                  <li><kbd>Esc</kbd>: Close open dialogs (e.g., Settings).</li>
              </ul>

              <hr />
              <h4>🛠️ Advanced Settings & Integrations</h4>

              <h4>Gemini AI Assistant 🧠</h4>
              <p>Turn the app into a smart study companion. Beyond Q&A, you can:</p>
              <ul>
                  <li><strong>Smart Auto-formatting:</strong> While writing under "Methods", let AI analyze and format your raw text—detect headings, bold key ideas, and lists.</li>
                  <li><strong>Setup:</strong> Visit Google AI Studio to create a free API Key and paste it into "Gemini API Key" in Settings.</li>
              </ul>

              <h4>Customize Interface & Sound 🎨</h4>
              <p>Make the workspace yours:</p>
              <ul>
                  <li><strong>Multiple Themes & Backgrounds:</strong> Choose from built-in themes (Light, Dark, Pastel...) or <strong>upload your own background</strong> for inspiration.</li>
                  <li><strong>Custom Alerts:</strong> <strong>Upload your own audio files (.mp3, .wav...)</strong> as alert sounds for focus and breaks.</li>
              </ul>

              <h4>YouTube Background Music 🎶</h4>
              <p>Create the perfect study ambiance by playing a YouTube video or playlist as background music. Paste the URL into the "YouTube Background Music" field in Settings.</p>

              <h4>Data Safety: Backup & Restore 🛡️</h4>
              <p>The app automatically backs up your progress daily. Customize how many days to keep and restore data from a previous day if needed. ⚠️ <strong>Warning:</strong> Restore will overwrite your current data.</p>
          </div>
      </div>
    </main>
  </div>

  <div class="modal" id="modalMilestone" role="dialog" aria-modal="true" aria-labelledby="milestoneTitle">
    <div class="modal-card" style="width: min(600px, 94vw);">
        <h3 id="milestoneTitle">🎉 Congratulations!</h3>
        <p id="milestoneMessage" style="white-space: pre-wrap; line-height: 1.6;"></p>
        <div class="row" style="justify-content:flex-end; margin-top:12px">
            <button class="btn acc" id="btnMilestoneClose">Continue the journey!</button>
        </div>
    </div>
  </div>
  <div class="modal" id="modalSettings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="modal-card">
          <h3 id="settingsTitle">⚙️ Settings</h3>
          <nav class="tab-nav">
              <button class="tab-btn active" data-tab="settings-timer">Timer</button>
              <button class="tab-btn" data-tab="settings-ui">Interface & Sound</button>
              <button class="tab-btn" data-tab="settings-integrations">Integrations</button>
          </nav>
          <div class="settings-content">
              <div id="settings-timer" class="tab-content active" style="flex-direction:column; gap:20px;">
                  <div class="row" id="timerPresetSelector" style="margin-bottom:16px;">
                      <button class="btn acc" data-preset-target="A"> Style A </button>
                      <button class="btn ghost" data-preset-target="B"> Style B </button>
                      <button class="btn ghost" data-preset-target="C"> Style C (Flow) </button>
                  </div>
                  <div id="settings-pomodoro">
                      <h4>Pomodoro Durations</h4>
                      <div class="row">
                          <label>FOCUS (minutes)<input type="number" id="set_work" min="1" /></label>
                          <label>WIND-DOWN (minutes)<input type="number" id="set_winddown" min="0" /></label>
                          <label>SHORT BREAK (minutes)<input type="number" id="set_short" min="1" /></label>
                          <label>LONG BREAK (minutes)<input type="number" id="set_long" min="1" /></label>
                      </div>
                      <div class="row">
                          <label>Pomodoro Cycles<input type="number" id="set_cycles" min="1" /></label>
                          <label>Long Break Interval<input type="number" id="set_interval" min="2" /></label>
                      </div>
                  </div>
                  <div id="settings-flowtime" class="hidden">
                      <h4>Flowtime</h4>
                      <div class="row">
                          <label>Break Ratio (Work / X)
                              <input type="number" id="set_flowRatio" min="1" max="20" />
                          </label>
                      </div>
                      <p class="tiny" style="margin-top: 4px;">Tip: Break time = total focus time / X. Default is 5.</p>
                  </div>
                  <div class="settings-row-toggle">
                          <label for="set_autoStartNext">Automatically start next session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_autoStartNext">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableWinddown">Enable Wind-down after focus session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableWinddown">
                              <span class="slider"></span>
                          </label>
                      </div>
                  <div class="settings-row-toggle">
                          <label for="set_enableSessionNotes">Prompt for note after each session</label>
                          <label class="toggle-switch">
                              <input type="checkbox" id="set_enableSessionNotes">
                              <span class="slider"></span>
                          </label>
                      </div>
              </div>
              <div id="settings-ui" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>Interface</h4>
                      <div class="row">
                          <label>UI Theme
                                <select id="set_theme_color">
                                    <option value="default">Default (Dark Blue)</option>
                                    <option value="light">Light - Milk Tea</option>
                                    <option value="pastel">Pastel - Soft</option>
                                    <option value="lofi">Lofi Study Room</option>
                                    <option value="space">Space Station</option>
                                </select>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 12px;">
                          <label>Background Display Mode
                              <select id="set_backgroundMode">
                                  <option value="cover">Cover (Default)</option>
                                  <option value="contain">Contain (Sharp)</option>
                                  <option value="auto">Original Size (Repeat)</option>
                              </select>
                          </label>
                      </div>
                      <div class="row">
                          <label>Background Image
                              <label class="btn small ghost" for="uploadBg">Upload New Image</label>
                              <input type="file" id="uploadBg" accept="image/*" class="hidden" />
                          </label>
                          <button class="btn small danger" id="btnClearBg">Clear Background</button>
                      </div>
                      <div class="row">
                          <label style="flex: 1;">Panel Opacity</label>
                          <input type="range" id="set_panelOpacity" min="0.1" max="1" step="0.05" style="flex: 2;">
                      </div>
                      
                      
                   </div>
                  
                   <div>
                      <h4>Sound</h4>
                      <div class="row">
                          <label>Volume (0–1)<input type="number" id="set_volume" step="0.05" min="0" max="1"/></label>
                          <label>Alert Style
                              <select id="set_theme">
                                  <option value="beep">Beep</option>
                                  <option value="chime">Chime</option>
                              </select>
                          </label>
                           <button class="btn" id="btnTestSound" style="flex: 0 1 auto; align-self: center;">Test</button>
                      </div>
                      <div style="text-align: right; margin-top: 12px;">
                          <button class="btn ghost small" id="btnToggleCustomSounds">Customize Alerts</button>
                      </div>

                      <div id="customSoundsContainer" class="hidden" style="margin-top: 8px;">
                      <div class="row" style="display: flex; gap: 8px; justify-content: flex-end;">
                          <div>
                              <small>Alert at end of FOCUS</small>
                              <label title="Alert at end of FOCUS" class="btn small ghost" for="uploadSoundWork">FOCUS</label>
                              <input type="file" id="uploadSoundWork" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of SHORT BREAK</small>
                              <label title="Alert at end of SHORT BREAK" class="btn small ghost" for="uploadSoundBreak">SHORT BREAK</label>
                              <input type="file" id="uploadSoundBreak" accept="audio/*" class="hidden" />
                          </div>
                          <div>
                              <small>Alert at end of LONG BREAK</small>
                              <label title="Alert at end of LONG BREAK" class="btn small ghost" for="uploadSoundLong">LONG BREAK</label>
                              <input type="file" id="uploadSoundLong" accept="audio/*" class="hidden" />
                          </div>
                      </div>
                      </div>
                      
                  </div>
              </div>
              <div id="settings-integrations" class="tab-content" style="flex-direction: column; gap: 20px;">
                  <div>
                      <h4>AI Integration</h4>
                      <label>Gemini API Key
                          <input type="password" id="set_apiKey" placeholder="Paste your API Key here..." />
                      </label>
                      <div class="tiny">Required to use AI features. Get a free key at <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">Google AI Studio</a>.</div>
                  </div>
                  <div>
                      <h4>🎵 YouTube Background Music</h4>
                      <div class="row" style="gap:8px; align-items:center;">
                          <input type="text" id="set_youtubeUrl" placeholder="Paste YouTube link here..." style="flex:1;">
                          </div>
                      <div id="ytUrlFeedback" class="tiny" style="min-height: 1.2em; padding: 4px 0;"></div>
                      <div class="row" style="margin-top: 4px;">
                          <label style="flex: 0 1 auto; display: flex; align-items: center; gap: 8px; font-size: 14px;">
                              <input type="checkbox" id="set_ytThumbAsBg">
                              <span>Use video thumbnail as background</span>
                          </label>
                      </div>
                      <div class="row" style="margin-top: 8px;">
                          <button id="btnToggleYtSound" class="btn small" style="flex:0 1 auto;" title="Stopping will not auto-play again until you press ▶️">▶️</button>
                          <input type="range" id="ytSoundVolume" min="0" max="100" step="1" value="80" style="flex:1;">
                      </div>
                      <div class="tiny" style="text-align:center; margin-top:4px;">Volume</div>
                  </div>
                  <div>
                      <h4>🛡️ Backup Settings</h4>
                      <div class="row">
                          <label>Number of backup days to keep
                               <input type="number" id="set_backupDays" min="1" max="30" />
                          </label>
                      </div>
                  </div>
                  <div>
                      <h4>🛡️ Restore Data</h4>
                      <p class="tiny">Restore from an automatic daily backup. This action will overwrite your current data.</p>
                      <div class="row">
                          <select id="backupList" style="flex: 3;"></select>
                          <button id="btnRestoreBackup" class="btn warn small" style="flex: 1;">Restore</button>
                      </div>
                  </div>
              </div>
          </div>
          <div class="row" style="margin-top:16px; justify-content:flex-end">
              <button class="btn ghost" id="btnDefaults">Defaults</button>
              <button class="btn acc" id="btnSaveSettings">Save</button>
              <button class="btn" id="btnCloseSettings">Close</button>
          </div>
      </div>
  </div>

  <div class="modal" id="modalNote" role="dialog" aria-modal="true" aria-labelledby="noteTitle">
    <div class="modal-card">
      <h3 id="noteTitle">📝 Note for the completed session</h3>
      <div class="row"><textarea id="noteText" placeholder="What did you learn? Any difficulties? Next steps?"></textarea></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px; gap: 12px;">
        <button class="btn" id="btnSummarizeNote">✨ Summarize & Suggest</button>
        <button class="btn" id="btnSkipNote">Skip</button>
        <button class="btn acc" id="btnSaveNote">Save Note</button>
      </div>
    </div>
  </div>

  <div class="modal" id="modalGeneric" role="dialog" aria-modal="true" aria-labelledby="genericTitle">
      <div class="modal-card" style="width: min(450px, 94vw);">
          <h3 id="genericTitle">Title</h3>
          <p id="genericMessage" class="hidden"></p>
          <input type="text" id="genericInput" class="hidden" />
          <div class="row" style="justify-content:flex-end; margin-top:12px">
              <button class="btn" id="btnGenericCancel">Cancel</button>
              <button class="btn acc" id="btnGenericOk">OK</button>
          </div>
      </div>
  </div>
  
  <div class="modal" id="modalDashboard" role="dialog" aria-modal="true" aria-labelledby="dashboardTitle">
    <div class="modal-card" style="width: min(800px, 95vw);">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3 id="dashboardTitle">📊 Dashboard</h3>
            <button class="btn ghost small" id="btnCloseDashboard">Close</button>
        </div>
        <p class="tiny">Summary of time and sessions completed across all topics.</p>
        <div id="dashboardContent" style="max-height: 60vh; overflow-y: auto;"></div>
    </div>
  </div>

  <div class="modal" id="modalMethodEditor" role="dialog" aria-modal="true">
    <div class="modal-card" style="width: min(800px, 95vw);">
      <h3 id="methodEditorTitle">Edit Method</h3>
      
      <div style="display: flex; flex-direction: column; gap: 12px; margin-top: 12px;">
        <input type="hidden" id="methodEditorId">
        <label>Title<input type="text" id="methodEditorTitleInput"></label>
        
        <label>Content</label>
        <div class="editor-toolbar">
          <button id="toolH4" class="btn small ghost" title="Small heading">H</button>
          <button id="toolBold" class="btn small ghost" title="Bold">B</button>
          <button id="toolItalic" class="btn small ghost" title="Italic">I</button>
          <button id="toolList" class="btn small ghost" title="Numbered list">1.</button>
          <button id="toolBullet" class="btn small ghost" title="Bulleted list">•</button>

          <div class="color-picker-wrapper">
            <button id="toolColor" class="btn small ghost" title="Text color">A</button>
            <div class="color-palette hidden">
              <button class="color-swatch" style="background-color: var(--text);" data-color="var(--text)" title="Default text color"></button>
              <button class="color-swatch" style="background-color: var(--acc);" data-color="var(--acc)" title="Accent color"></button>
              <button class="color-swatch" style="background-color: var(--acc-2);" data-color="var(--acc-2)" title="Positive color"></button>
              <button class="color-swatch" style="background-color: var(--warn);" data-color="var(--warn)" title="Warning color"></button>
              <button class="color-swatch" style="background-color: var(--danger);" data-color="var(--danger)" title="Danger color"></button>
              <button class="color-swatch" style="background-color: var(--purple);" data-color="var(--purple)" title="Purple"></button>
            </div>
          </div>
        </div>

        <div class="editor-container">
            <div id="methodEditorContentInput" class="editable-content" contenteditable="true"></div>
        </div>

      </div>

      <div class="row" style="justify-content:space-between; margin-top:16px">
        <button id="btnAutoFormat" class="btn small" disabled title="This feature requires a Gemini API Key">✨ Auto-format</button>
        <div>
          <button class="btn" id="btnCancelMethodEditor">Cancel</button>
          <button class="btn acc" id="btnSaveMethod">Save</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>
  <audio id="audioWorkEnd"></audio>
  <audio id="audioBreakEnd"></audio>
  <audio id="audioLongEnd"></audio>
  <div id="youtube-player-container"></div>

  <div id="draggableTimer" class="draggable-timer">00:00</div>

  <div id="soundPermissionBar" class="sound-permission-bar" role="alert" aria-live="polite">
    <span class="msg">Press "Enable Sound" to allow background audio.</span>
    <button id="btnEnableSound" class="btn small acc">Enable Sound</button>
  </div>
<!-- YouTube Iframe API is loaded dynamically when needed -->
<!-- === START: Inline Minimal Sortable (Offline-Safe) === -->
<script>
// Minimal Sortable shim for offline single-file usage.
// Supports: draggable selector, cross-list via same group, onEnd callback.
(function(){
  if (window.Sortable) return; // Respect existing if loaded
  const DND = { src: null, from: null, selector: null, group: null };
  function makeDraggable(container, selector){
    Array.from(container.querySelectorAll(selector)).forEach(el => {
      try { el.setAttribute('draggable','true'); } catch(_) {}
    });
  }
  function closestItem(e, selector){
    const t = e.target && e.target.closest ? e.target.closest(selector) : null;
    return t || null;
  }
  function Sortable(container, opts){
    this.el = container;
    this.options = opts || {};
    const selector = this.options.draggable || '*';
    const group = this.options.group || null;
    makeDraggable(container, selector);
    const handleDragStart = (e) => {
      const item = closestItem(e, selector);
      if (!item) return;
      DND.src = item; DND.from = container; DND.selector = selector; DND.group = group;
      e.dataTransfer.effectAllowed = 'move';
      try { e.dataTransfer.setData('text/plain', ''); } catch(_) {}
    };
    const handleDragOver = (e) => {
      if (!DND.src) return;
      // Only allow drop if same selector and group matches (or no group)
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
    };
    const handleDrop = (e) => {
      if (!DND.src) return;
      const sameGroup = (!group && !DND.group) || (group && DND.group && group === DND.group);
      if (!sameGroup) return;
      const target = closestItem(e, selector);
      if (!target) return;
      e.preventDefault();
      const from = DND.from;
      const to = container;
      const children = Array.from(from.querySelectorAll(DND.selector));
      const oldIndex = children.indexOf(DND.src);
      if (target && DND.src && target !== DND.src) {
        to.insertBefore(DND.src, target);
      }
      const newChildren = Array.from(to.querySelectorAll(DND.selector));
      const newIndex = newChildren.indexOf(DND.src);
      if (typeof this.options.onEnd === 'function') {
        try { this.options.onEnd({ oldIndex, newIndex, from, to, item: DND.src }); } catch(_) {}
      }
      DND.src = null; DND.from = null; DND.selector = null; DND.group = null;
    };
    this._listeners = { handleDragStart, handleDragOver, handleDrop };
    container.addEventListener('dragstart', handleDragStart);
    container.addEventListener('dragover', handleDragOver);
    container.addEventListener('drop', handleDrop);
    this.destroy = () => {
      container.removeEventListener('dragstart', handleDragStart);
      container.removeEventListener('dragover', handleDragOver);
      container.removeEventListener('drop', handleDrop);
    };
  }
  window.Sortable = Sortable;
})();
</script>
<!-- === END: Inline Minimal Sortable === -->
  <script>
    function _0x4a2d(_0x444011,_0x5bf389){const _0x14e790=_0x14e7();return _0x4a2d=function(_0x4a2d9f,_0x2cca53){_0x4a2d9f=_0x4a2d9f-0x1a3;let _0x4da55a=_0x14e790[_0x4a2d9f];return _0x4da55a;},_0x4a2d(_0x444011,_0x5bf389);}const _0x3be7fc=_0x4a2d;(function(_0x5a2213,_0x457c40){const _0x3ae521=_0x4a2d,_0x402c4a=_0x5a2213();while(!![]){try{const _0x3fd9f8=parseInt(_0x3ae521(0x2c3))/0x1*(parseInt(_0x3ae521(0x49e))/0x2)+parseInt(_0x3ae521(0x4a0))/0x3*(-parseInt(_0x3ae521(0x444))/0x4)+-parseInt(_0x3ae521(0x3a4))/0x5*(-parseInt(_0x3ae521(0x3c5))/0x6)+-parseInt(_0x3ae521(0x450))/0x7*(parseInt(_0x3ae521(0x272))/0x8)+-parseInt(_0x3ae521(0x2a2))/0x9*(parseInt(_0x3ae521(0x39f))/0xa)+parseInt(_0x3ae521(0x3b1))/0xb*(parseInt(_0x3ae521(0x348))/0xc)+parseInt(_0x3ae521(0x30e))/0xd;if(_0x3fd9f8===_0x457c40)break;else _0x402c4a['push'](_0x402c4a['shift']());}catch(_0x57b55e){_0x402c4a['push'](_0x402c4a['shift']());}}}(_0x14e7,0x8778a),window['addEventListener'](_0x3be7fc(0x42c),()=>{try{updateFullscreenButton();}catch(_0x3374d4){}}));const IS_FILE_PROTOCOL=window[_0x3be7fc(0x223)][_0x3be7fc(0x219)]===_0x3be7fc(0x447);function startYtApiWatchdog(){const _0x557de9=_0x3be7fc,_0x5c045c=document[_0x557de9(0x1dc)]('ytUrlFeedback');if(!_0x5c045c)return;const _0x37ddc4=setTimeout(()=>{const _0x39386d=_0x557de9;try{(!window['YT']||!window['YT'][_0x39386d(0x21e)])&&(_0x5c045c[_0x39386d(0x342)]=_0x39386d(0x1da),_0x5c045c['style'][_0x39386d(0x32a)]='var(--sub)');}catch(_0x718b8d){}},0x5dc),_0x11c979=setTimeout(()=>{const _0xec9ebf=_0x557de9;try{(!window['YT']||!window['YT']['Player'])&&(_0x5c045c[_0xec9ebf(0x342)]=_0xec9ebf(0x46e),_0x5c045c[_0xec9ebf(0x43e)][_0xec9ebf(0x32a)]=_0xec9ebf(0x39d));}catch(_0x330a40){}},0x1b58);window[_0x557de9(0x3ae)]={'cancel'(){clearTimeout(_0x37ddc4),clearTimeout(_0x11c979);}};}(function(){const _0x4311cc=_0x3be7fc,_0x4a950d={'timer.cycleInfo':({current:current=0x0,target:target=0x0}={})=>_0x4311cc(0x471)+current+'/'+target,'timer.selectSubtopicPrompt':_0x4311cc(0x36a)};window['t']=function _0x1abad3(_0x37a0c5,_0x16edb2){const _0x550c98=_0x4311cc;try{const _0x11329e=_0x4a950d[_0x37a0c5];if(typeof _0x11329e==='function')return _0x11329e(_0x16edb2||{});if(typeof _0x11329e===_0x550c98(0x22c))return _0x11329e;}catch(_0x1ffb85){}return _0x37a0c5;},window['loadLanguage']=function _0x1352be(_0x44776b){const _0x56adb4=_0x4311cc;try{localStorage[_0x56adb4(0x287)](_0x56adb4(0x37f),_0x44776b||'en');}catch(_0x5ad0bd){}return Promise['resolve']();};}());function ensureYouTubeAPI(){const _0x2321f9=_0x3be7fc;if(IS_FILE_PROTOCOL)return Promise[_0x2321f9(0x437)](![]);try{if(window['YT']&&window['YT'][_0x2321f9(0x21e)])return Promise[_0x2321f9(0x437)](!![]);}catch(_0x3c114f){}if(window[_0x2321f9(0x2e1)])return window[_0x2321f9(0x2e1)];return startYtApiWatchdog(),window['__ytApiPromise']=new Promise((_0x3280dd,_0x4bebfa)=>{const _0x12aa0b=_0x2321f9;try{const _0x3ce6b5=document[_0x12aa0b(0x1ce)](_0x12aa0b(0x1ea));_0x3ce6b5['src']='https://www.youtube.com/iframe_api',_0x3ce6b5['async']=!![],_0x3ce6b5[_0x12aa0b(0x1d7)]=!![],_0x3ce6b5[_0x12aa0b(0x296)]=()=>_0x3280dd(!![]),_0x3ce6b5[_0x12aa0b(0x1f5)]=()=>_0x4bebfa(new Error(_0x12aa0b(0x306))),document['head'][_0x12aa0b(0x253)](_0x3ce6b5);}catch(_0x457fa6){_0x4bebfa(_0x457fa6);}}),window[_0x2321f9(0x2e1)];}const storageManager={'DB_NAME':_0x3be7fc(0x417),'DB_VERSION':0x1,'db':null,async 'initDB'(){return new Promise((_0x1da40e,_0x20e540)=>{const _0x4b3d4b=_0x4a2d;if(this['db'])return _0x1da40e(this['db']);const _0x1a39f3=indexedDB[_0x4b3d4b(0x32c)](this['DB_NAME'],this[_0x4b3d4b(0x264)]);_0x1a39f3['onupgradeneeded']=_0xf60f48=>{const _0x490626=_0x4b3d4b,_0x58dd45=_0xf60f48[_0x490626(0x35a)][_0x490626(0x2e3)];!_0x58dd45[_0x490626(0x4ac)][_0x490626(0x203)](_0x490626(0x48d))&&_0x58dd45['createObjectStore'](_0x490626(0x48d));!_0x58dd45[_0x490626(0x4ac)][_0x490626(0x203)]('topics')&&_0x58dd45[_0x490626(0x23a)]('topics',{'keyPath':'id'});if(!_0x58dd45[_0x490626(0x4ac)][_0x490626(0x203)](_0x490626(0x372))){const _0x3ce276=_0x58dd45['createObjectStore'](_0x490626(0x372),{'keyPath':'id'});_0x3ce276[_0x490626(0x291)](_0x490626(0x2b7),'topicId');}!_0x58dd45['objectStoreNames']['contains'](_0x490626(0x259))&&_0x58dd45[_0x490626(0x23a)](_0x490626(0x259),{'keyPath':_0x490626(0x214)});},_0x1a39f3[_0x4b3d4b(0x2ef)]=_0x5180ea=>{const _0x46faad=_0x4b3d4b;this['db']=_0x5180ea['target'][_0x46faad(0x2e3)],console[_0x46faad(0x2c8)](_0x46faad(0x44b)),_0x1da40e(this['db']);},_0x1a39f3[_0x4b3d4b(0x1f5)]=_0x5afd48=>{const _0x8aca4d=_0x4b3d4b;console[_0x8aca4d(0x292)](_0x8aca4d(0x1c1),_0x5afd48['target'][_0x8aca4d(0x21b)]),_0x20e540(_0x5afd48['target'][_0x8aca4d(0x292)]);};});},async '_getStore'(_0x207043,_0x43708e=_0x3be7fc(0x360)){const _0x1be353=_0x3be7fc;await this[_0x1be353(0x3d9)]();const _0x485b9a=this['db']['transaction']([_0x207043],_0x43708e);return _0x485b9a[_0x1be353(0x2d7)](_0x207043);},async 'getSettings'(){const _0x13f50c=_0x3be7fc,_0x3d1bb6=await this[_0x13f50c(0x3ad)](_0x13f50c(0x48d));return new Promise((_0x2e145e,_0x267f44)=>{const _0x427aaa=_0x13f50c,_0x596215=_0x3d1bb6[_0x427aaa(0x3da)](_0x427aaa(0x3ee));_0x596215[_0x427aaa(0x2ef)]=()=>_0x2e145e(_0x596215[_0x427aaa(0x2e3)]),_0x596215[_0x427aaa(0x1f5)]=()=>_0x267f44(_0x596215[_0x427aaa(0x292)]);});},async 'updateSettings'(_0x52f479){const _0x144f60=_0x3be7fc,_0x2b5911=await this['_getStore'](_0x144f60(0x48d),_0x144f60(0x382));return new Promise((_0x36781f,_0x4c55dd)=>{const _0x20eb8c=_0x144f60,_0x5747c4=_0x2b5911[_0x20eb8c(0x406)](_0x52f479,_0x20eb8c(0x3ee));_0x5747c4[_0x20eb8c(0x2ef)]=()=>_0x36781f(_0x5747c4[_0x20eb8c(0x2e3)]),_0x5747c4[_0x20eb8c(0x1f5)]=()=>_0x4c55dd(_0x5747c4['error']);});},async 'getAll'(_0x3b18dc){const _0x218a69=_0x3be7fc,_0x36ad43=await this[_0x218a69(0x3ad)](_0x3b18dc);return new Promise((_0x992750,_0x4b3412)=>{const _0x33cc35=_0x218a69,_0x51f03f=_0x36ad43[_0x33cc35(0x34c)]();_0x51f03f['onsuccess']=()=>_0x992750(_0x51f03f[_0x33cc35(0x2e3)]),_0x51f03f[_0x33cc35(0x1f5)]=()=>_0x4b3412(_0x51f03f['error']);});},async 'update'(_0x1030c1,_0x2a8f5f){const _0x12f0fd=await this['_getStore'](_0x1030c1,'readwrite');return new Promise((_0x470fd3,_0x4c8fe9)=>{const _0x4886fe=_0x4a2d,_0x13dc9a=_0x12f0fd[_0x4886fe(0x406)](_0x2a8f5f);_0x13dc9a['onsuccess']=()=>_0x470fd3(_0x13dc9a[_0x4886fe(0x2e3)]),_0x13dc9a[_0x4886fe(0x1f5)]=()=>_0x4c8fe9(_0x13dc9a[_0x4886fe(0x292)]);});},async 'add'(_0x21603d,_0xcd243){const _0x4c9114=_0x3be7fc,_0x5c499f=await this[_0x4c9114(0x3ad)](_0x21603d,_0x4c9114(0x382));return new Promise((_0x5c7be7,_0x511d79)=>{const _0x3515df=_0x4c9114,_0x420d21=_0x5c499f[_0x3515df(0x27e)](_0xcd243);_0x420d21[_0x3515df(0x2ef)]=()=>_0x5c7be7(_0x420d21[_0x3515df(0x2e3)]),_0x420d21['onerror']=()=>_0x511d79(_0x420d21[_0x3515df(0x292)]);});},async 'delete'(_0x183902,_0x1dbafd){const _0x585a98=await this['_getStore'](_0x183902,'readwrite');return new Promise((_0x3d428a,_0x1cd459)=>{const _0x4e97c9=_0x4a2d,_0x2d8963=_0x585a98[_0x4e97c9(0x404)](_0x1dbafd);_0x2d8963[_0x4e97c9(0x2ef)]=()=>_0x3d428a(_0x2d8963[_0x4e97c9(0x2e3)]),_0x2d8963[_0x4e97c9(0x1f5)]=()=>_0x1cd459(_0x2d8963[_0x4e97c9(0x292)]);});},async 'save'(_0x32fe22){const _0x5d0307=_0x3be7fc;return await this[_0x5d0307(0x3d9)](),new Promise((_0x35bc37,_0x58b420)=>{const _0x4b6b82=_0x5d0307,_0x263454=this['db'][_0x4b6b82(0x27d)]([_0x4b6b82(0x48d),_0x4b6b82(0x247),_0x4b6b82(0x372)],_0x4b6b82(0x382)),_0x2b8eae=_0x263454[_0x4b6b82(0x2d7)]('settings'),_0x5d46f5=_0x263454[_0x4b6b82(0x2d7)]('topics'),_0x11ade7=_0x263454['objectStore'](_0x4b6b82(0x372));_0x2b8eae[_0x4b6b82(0x406)](_0x32fe22[_0x4b6b82(0x48d)],_0x4b6b82(0x3ee)),_0x5d46f5[_0x4b6b82(0x2f6)](),_0x11ade7[_0x4b6b82(0x2f6)](),_0x32fe22[_0x4b6b82(0x247)][_0x4b6b82(0x2d6)](_0x4a141c=>{const _0x5231cc=_0x4b6b82,{subtopics:_0xc57478,..._0x443cc6}=_0x4a141c;_0x5d46f5[_0x5231cc(0x406)](_0x443cc6),(_0xc57478||[])['forEach'](_0x34fcbd=>_0x11ade7[_0x5231cc(0x406)](_0x34fcbd));}),_0x263454[_0x4b6b82(0x3b9)]=()=>_0x35bc37(),_0x263454[_0x4b6b82(0x1f5)]=_0x4c3f1a=>_0x58b420(_0x4c3f1a['target']['error']);});},async 'autoBackup'(_0x3be2de){const _0x47b1a6=_0x3be7fc;await this[_0x47b1a6(0x3d9)]();const _0xb7efcb=new Date()[_0x47b1a6(0x1e9)]()[_0x47b1a6(0x2f9)](0x0,0xa),_0x220f54=localStorage[_0x47b1a6(0x3b8)](_0x47b1a6(0x468));if(_0xb7efcb!==_0x220f54){console['log']('Creating\x20backup\x20for\x20'+_0xb7efcb+'...');const _0x45597a={'date':_0xb7efcb,'data':JSON[_0x47b1a6(0x327)](JSON[_0x47b1a6(0x225)](_0x3be2de))},_0x436100=this['db']['transaction'](['backups'],_0x47b1a6(0x382)),_0x1818e1=_0x436100['objectStore'](_0x47b1a6(0x259)),_0x45bcf6=_0x1818e1[_0x47b1a6(0x406)](_0x45597a);_0x45bcf6[_0x47b1a6(0x2ef)]=()=>{const _0x268ae9=_0x47b1a6;localStorage[_0x268ae9(0x287)](_0x268ae9(0x468),_0xb7efcb),console[_0x268ae9(0x2c8)]('Daily\x20backup\x20successful.'),this[_0x268ae9(0x35b)](_0x3be2de?.[_0x268ae9(0x48d)]?.[_0x268ae9(0x1e6)]||0x7);},_0x45bcf6[_0x47b1a6(0x1f5)]=_0x43e91f=>{const _0x260696=_0x47b1a6;console[_0x260696(0x292)](_0x260696(0x469),_0x43e91f['target'][_0x260696(0x292)]);};}},async 'cleanupOldBackups'(_0x3dbeb9){const _0x178ee1=_0x3be7fc;await this[_0x178ee1(0x3d9)]();const _0x262f8f=this['db'][_0x178ee1(0x27d)]([_0x178ee1(0x259)],_0x178ee1(0x382)),_0x2567f9=_0x262f8f['objectStore'](_0x178ee1(0x259)),_0x579672=_0x2567f9[_0x178ee1(0x26f)]();_0x579672[_0x178ee1(0x2ef)]=()=>{const _0x5ffb5d=_0x178ee1,_0x3075a0=_0x579672[_0x5ffb5d(0x2e3)][_0x5ffb5d(0x227)]()['reverse']();if(_0x3075a0[_0x5ffb5d(0x49f)]>_0x3dbeb9){const _0x326706=_0x3075a0[_0x5ffb5d(0x2f9)](_0x3dbeb9);_0x326706[_0x5ffb5d(0x2d6)](_0x3a0613=>{const _0x3db574=_0x5ffb5d;_0x2567f9['delete'](_0x3a0613),console[_0x3db574(0x2c8)](_0x3db574(0x414)+_0x3a0613);});}};},async 'getBackupList'(){const _0x1e816a=_0x3be7fc;return await this[_0x1e816a(0x3d9)](),new Promise((_0x3a5785,_0x331f6d)=>{const _0x1fb0bf=_0x1e816a,_0x3ee708=this['db'][_0x1fb0bf(0x27d)](['backups'],_0x1fb0bf(0x360)),_0x4b143d=_0x3ee708[_0x1fb0bf(0x2d7)](_0x1fb0bf(0x259)),_0x10bc83=_0x4b143d['getAll']();_0x10bc83[_0x1fb0bf(0x2ef)]=()=>_0x3a5785(_0x10bc83[_0x1fb0bf(0x2e3)][_0x1fb0bf(0x227)]((_0x5be8bb,_0x2cb96e)=>_0x2cb96e[_0x1fb0bf(0x214)][_0x1fb0bf(0x1ed)](_0x5be8bb[_0x1fb0bf(0x214)]))),_0x10bc83[_0x1fb0bf(0x1f5)]=_0x1aa197=>_0x331f6d(_0x1aa197['target']['error']);});},async 'restoreBackup'(_0x5f0ad3){return await this['initDB'](),new Promise((_0x506ff2,_0x5d592c)=>{const _0x5b0f85=_0x4a2d,_0x2dd15c=this['db'][_0x5b0f85(0x27d)]([_0x5b0f85(0x259)],_0x5b0f85(0x360)),_0x46d447=_0x2dd15c[_0x5b0f85(0x2d7)](_0x5b0f85(0x259)),_0x58bf2d=_0x46d447[_0x5b0f85(0x3da)](_0x5f0ad3);_0x58bf2d['onsuccess']=()=>{const _0x800e7=_0x5b0f85;_0x58bf2d['result']&&_0x58bf2d[_0x800e7(0x2e3)][_0x800e7(0x4b6)]?(localStorage[_0x800e7(0x287)]('pomodoroData_v11',JSON[_0x800e7(0x225)](_0x58bf2d['result'][_0x800e7(0x4b6)])),_0x506ff2(_0x58bf2d[_0x800e7(0x2e3)][_0x800e7(0x4b6)])):_0x5d592c(new Error(_0x800e7(0x4ae)));},_0x58bf2d['onerror']=_0x228833=>_0x5d592c(_0x228833[_0x5b0f85(0x35a)]['error']);});},'exportData'(_0xdfb63e){const _0x992fad=_0x3be7fc;let _0x39f091={};try{_0x39f091=JSON[_0x992fad(0x327)](JSON['stringify'](_0xdfb63e||{}));}catch(_0x31c339){_0x39f091=_0xdfb63e;}try{if(_0x39f091&&_0x39f091[_0x992fad(0x48d)])_0x39f091[_0x992fad(0x48d)][_0x992fad(0x3fa)]='';}catch(_0x14cd83){}const _0x433203=new Blob([JSON[_0x992fad(0x225)](_0x39f091,null,0x2)],{'type':_0x992fad(0x2df)}),_0x3ca210=document[_0x992fad(0x1ce)]('a'),_0x45ac31=new Date(),_0x25fa53=_0x4ebc4d=>(''+_0x4ebc4d)[_0x992fad(0x1fc)](0x2,'0');_0x3ca210[_0x992fad(0x464)]=URL[_0x992fad(0x31a)](_0x433203),_0x3ca210[_0x992fad(0x266)]=_0x992fad(0x251)+_0x45ac31[_0x992fad(0x2ce)]()+_0x25fa53(_0x45ac31['getMonth']()+0x1)+_0x25fa53(_0x45ac31[_0x992fad(0x233)]())+'.json',_0x3ca210['click'](),URL[_0x992fad(0x33c)](_0x3ca210[_0x992fad(0x464)]);},async 'importData'(_0x101761){const _0x5410fe=_0x3be7fc,_0x506962=await _0x101761[_0x5410fe(0x430)](),_0x242499=JSON[_0x5410fe(0x327)](_0x506962);if(!_0x242499['version']||!_0x242499['settings']||!Array[_0x5410fe(0x265)](_0x242499[_0x5410fe(0x247)]))throw new Error(_0x5410fe(0x3f4));try{const _0x590695=window['data']&&window[_0x5410fe(0x4b6)]['settings']&&window[_0x5410fe(0x4b6)][_0x5410fe(0x48d)][_0x5410fe(0x3fa)]||'';(!(_0x5410fe(0x3fa)in _0x242499[_0x5410fe(0x48d)])||_0x242499[_0x5410fe(0x48d)][_0x5410fe(0x3fa)]==='')&&(_0x242499[_0x5410fe(0x48d)][_0x5410fe(0x3fa)]=_0x590695);}catch(_0x100c04){}return localStorage[_0x5410fe(0x287)](_0x5410fe(0x213),JSON[_0x5410fe(0x225)](_0x242499)),_0x242499;}},$=(_0x42fe02,_0x3c8a4f=document)=>_0x3c8a4f[_0x3be7fc(0x3ed)](_0x42fe02),breakSuggestions=[_0x3be7fc(0x2b5),'Drink\x20a\x20glass\x20of\x20water\x20to\x20stay\x20hydrated.','Gaze\x20out\x20the\x20window\x20for\x2020\x20seconds.',_0x3be7fc(0x3fe),_0x3be7fc(0x354),_0x3be7fc(0x36f),_0x3be7fc(0x3d1),_0x3be7fc(0x286),_0x3be7fc(0x2b6),'Relax\x20your\x20body\x20and\x20notice\x20your\x20breath.',_0x3be7fc(0x37e),_0x3be7fc(0x3ec),_0x3be7fc(0x3d5),'Look\x20at\x20something\x20cute\x20or\x20uplifting.','Count\x20down\x20slowly\x20from\x2020\x20to\x200.',_0x3be7fc(0x316),_0x3be7fc(0x23f),_0x3be7fc(0x355),_0x3be7fc(0x304),_0x3be7fc(0x3e7),_0x3be7fc(0x470),_0x3be7fc(0x3fd),_0x3be7fc(0x1b1),'Have\x20a\x20sip\x20of\x20water.','Stand\x20up\x20and\x20take\x20a\x20few\x20steps.',_0x3be7fc(0x1dd),_0x3be7fc(0x1c9),_0x3be7fc(0x35c),_0x3be7fc(0x21c),_0x3be7fc(0x2fa),_0x3be7fc(0x33d),_0x3be7fc(0x43b)],$$=(_0x2aa588,_0x28a20c=document)=>Array[_0x3be7fc(0x421)](_0x28a20c['querySelectorAll'](_0x2aa588));function on(_0x27bf1e,_0x18042d,_0x23dceb){const _0x152a78=_0x3be7fc;if(!_0x27bf1e){console[_0x152a78(0x26e)](_0x152a78(0x1fd),_0x18042d);return;}_0x27bf1e['addEventListener'](_0x18042d,_0x23dceb);}const formatMMSS=_0x5ec259=>{const _0x3f60f0=_0x3be7fc,_0x32a2eb=Math[_0x3f60f0(0x1a9)](_0x5ec259/0x3c)[_0x3f60f0(0x3c3)]()[_0x3f60f0(0x1fc)](0x2,'0'),_0x2e1274=Math[_0x3f60f0(0x1a9)](_0x5ec259%0x3c)[_0x3f60f0(0x3c3)]()[_0x3f60f0(0x1fc)](0x2,'0');return _0x32a2eb+':'+_0x2e1274;},uid=(_0x3dc47e='id')=>_0x3dc47e+'_'+Date[_0x3be7fc(0x3e5)]()+'_'+Math[_0x3be7fc(0x243)]()['toString'](0x24)[_0x3be7fc(0x2f9)](0x2,0x9);let __releaseFocusTrap=null;function trapFocus(_0x2f9f26){const _0x280b30=_0x3be7fc;try{const _0x1f62e6=_0x2f9f26[_0x280b30(0x2bc)]('button,\x20[href],\x20input,\x20select,\x20textarea,\x20[tabindex]:not([tabindex=\x22-1\x22])');if(!_0x1f62e6[_0x280b30(0x49f)])return;const _0x55e092=_0x1f62e6[0x0],_0x1afde1=_0x1f62e6[_0x1f62e6[_0x280b30(0x49f)]-0x1],_0x380348=_0x2be80f=>{const _0x45cf98=_0x280b30;if(_0x2be80f['key']==='Tab'){if(_0x2be80f['shiftKey']&&document[_0x45cf98(0x4b4)]===_0x55e092)_0x2be80f[_0x45cf98(0x358)](),_0x1afde1[_0x45cf98(0x3d2)]();else!_0x2be80f['shiftKey']&&document[_0x45cf98(0x4b4)]===_0x1afde1&&(_0x2be80f[_0x45cf98(0x358)](),_0x55e092[_0x45cf98(0x3d2)]());}};_0x2f9f26[_0x280b30(0x2bd)](_0x280b30(0x49b),_0x380348),_0x55e092['focus'](),__releaseFocusTrap=()=>{const _0x2c84a3=_0x280b30;try{_0x2f9f26[_0x2c84a3(0x20e)](_0x2c84a3(0x49b),_0x380348);}catch(_0x15c1bf){}};}catch(_0x5b3048){}}function releaseFocus(){if(__releaseFocusTrap){try{__releaseFocusTrap();}catch(_0x5326b8){}__releaseFocusTrap=null;}}const todayISO=()=>new Date()[_0x3be7fc(0x1e9)]();function toast(_0x230a49,_0x20f551=0xa28){const _0x397601=_0x3be7fc,_0xee0b9a=$(_0x397601(0x23c)),_0x44514b=document[_0x397601(0x1ce)](_0x397601(0x422));_0x44514b['className']=_0x397601(0x1bd),_0x44514b['textContent']=_0x230a49,_0xee0b9a[_0x397601(0x253)](_0x44514b),setTimeout(()=>{const _0x36ca1c=_0x397601;_0x44514b[_0x36ca1c(0x43e)][_0x36ca1c(0x488)]='0';},_0x20f551-0x12c),setTimeout(()=>_0xee0b9a[_0x397601(0x22b)](_0x44514b),_0x20f551);}function escapeHTML(_0x4f7c1f){const _0x15c42c=_0x3be7fc;return _0x4f7c1f[_0x15c42c(0x3bb)](/[&<>"']/g,_0x305642=>({'&':'&amp;','<':_0x15c42c(0x375),'>':_0x15c42c(0x1f0),'\x22':_0x15c42c(0x1d0),'\x27':'&#39;'}[_0x305642]));}function formatDaysHoursMinutes(_0x28c797){const _0x1c67b9=_0x3be7fc;if(!_0x28c797||_0x28c797<0x1)return _0x1c67b9(0x222);const _0x1449c9=Math[_0x1c67b9(0x1a9)](_0x28c797/0x3c),_0x194daf=_0x28c797%0x3c,_0x17d757=_0x194daf[_0x1c67b9(0x3c3)]()['padStart'](0x2,'0');return _0x1449c9+_0x1c67b9(0x256)+_0x17d757+_0x1c67b9(0x405);}function formatGeminiResponse(_0x20f61d){return _0x20f61d['replace'](/(\*\*|__|\*|_|#+\s*)/g,'');}function parseSimpleMarkdown(_0xc1dbb2){const _0x327d88=_0x3be7fc,_0x287630=(_0xc1dbb2||'')[_0x327d88(0x204)]('\x0a');let _0x46673d='',_0x372d77=null;const _0x2e6ab3=()=>{const _0x53e0de=_0x327d88;_0x372d77&&(_0x46673d+=_0x372d77==='ol'?_0x53e0de(0x351):_0x53e0de(0x1fb),_0x372d77=null);};for(let _0x2f1750 of _0x287630){let _0x18b1ef=(_0x2f1750||'')[_0x327d88(0x3d6)]();if(!_0x18b1ef){_0x2e6ab3();continue;}if(_0x18b1ef[_0x327d88(0x34a)](_0x327d88(0x1f7)))_0x2e6ab3(),_0x46673d+=_0x327d88(0x4b3)+escapeHTML(_0x18b1ef[_0x327d88(0x2cd)](0x5))+_0x327d88(0x246);else{if(/^\d+\.\s/[_0x327d88(0x45e)](_0x18b1ef)){_0x372d77!=='ol'&&(_0x2e6ab3(),_0x46673d+='<ol>',_0x372d77='ol');const _0x1c7a58=_0x18b1ef[_0x327d88(0x2cd)](_0x18b1ef[_0x327d88(0x310)]('\x20')+0x1);_0x46673d+='<li>'+escapeHTML(_0x1c7a58)+_0x327d88(0x2a4);}else _0x18b1ef[_0x327d88(0x34a)]('-\x20')?(_0x372d77!=='ul'&&(_0x2e6ab3(),_0x46673d+=_0x327d88(0x3cd),_0x372d77='ul'),_0x46673d+=_0x327d88(0x435)+escapeHTML(_0x18b1ef['substring'](0x2))+'</li>'):(_0x2e6ab3(),_0x18b1ef=escapeHTML(_0x18b1ef)[_0x327d88(0x3bb)](/\*\*(.*?)\*\*/g,_0x327d88(0x325))[_0x327d88(0x3bb)](/_(.*?)_/g,'<i>$1</i>'),_0x46673d+=_0x327d88(0x390)+_0x18b1ef+'</p>');}}return _0x2e6ab3(),_0x46673d;}function wrapTextInMarkdown(_0x2d3f32,_0x3df110,_0x23010f=''){const _0x2c9470=_0x3be7fc;if(!_0x2d3f32)return;const _0x39ecb0=_0x2d3f32[_0x2c9470(0x4b7)]||0x0,_0x4cb9a0=_0x2d3f32[_0x2c9470(0x41f)]||0x0,_0x50eda8=_0x2d3f32['value'][_0x2c9470(0x2cd)](_0x39ecb0,_0x4cb9a0),_0x3b3731=_0x3df110+_0x50eda8+(_0x23010f||_0x3df110);_0x2d3f32[_0x2c9470(0x25e)](_0x3b3731,_0x39ecb0,_0x4cb9a0,'end'),_0x2d3f32[_0x2c9470(0x3d2)]();}function updateEditorPreview(){const _0x12c519=_0x3be7fc,_0x48bac3=$('#methodEditorContentInput'),_0x170373=$('#editorPreview');if(!_0x48bac3||!_0x170373)return;const _0x2284d9=_0x48bac3['value']||'';_0x170373[_0x12c519(0x28b)]=parseSimpleMarkdown(_0x2284d9);}function normalizeDataStructure(_0x282db9){const _0x3ded91=_0x3be7fc;if(!_0x282db9||typeof _0x282db9!==_0x3ded91(0x1df))return;const _0x27705b=_0x282db9[_0x3ded91(0x48d)]||{},_0x2d0f92={...defaults[_0x3ded91(0x48d)],..._0x27705b,'durations':{...defaults[_0x3ded91(0x48d)]['durations'],..._0x27705b[_0x3ded91(0x1a4)]||{}}};if(!Array[_0x3ded91(0x265)](_0x2d0f92[_0x3ded91(0x231)]))_0x2d0f92['achievedMilestones']=[];_0x282db9['settings']=_0x2d0f92,_0x282db9[_0x3ded91(0x247)]=Array[_0x3ded91(0x265)](_0x282db9['topics'])?_0x282db9['topics']:[],_0x282db9[_0x3ded91(0x247)][_0x3ded91(0x2d6)](_0x71eea8=>{const _0x19cf4a=_0x3ded91;_0x71eea8[_0x19cf4a(0x372)]=Array['isArray'](_0x71eea8[_0x19cf4a(0x372)])?_0x71eea8['subtopics']:[],_0x71eea8[_0x19cf4a(0x372)][_0x19cf4a(0x2d6)](_0x5bf122=>{const _0x528675=_0x19cf4a;_0x5bf122[_0x528675(0x302)]=_0x5bf122['tasks']||[],_0x5bf122[_0x528675(0x201)]=_0x5bf122[_0x528675(0x201)]||[],_0x5bf122[_0x528675(0x1e3)]=_0x5bf122['summaries']||[],_0x5bf122['chatHistory']=_0x5bf122[_0x528675(0x412)]||[],_0x5bf122[_0x528675(0x3dd)]=_0x5bf122[_0x528675(0x3dd)]||{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},_0x5bf122[_0x528675(0x1e7)]=_0x5bf122[_0x528675(0x1e7)]||[],_0x5bf122[_0x528675(0x278)]=_0x5bf122[_0x528675(0x278)]||{'state':_0x528675(0x323),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0};});});}function extractYouTubeID(_0x272eec){const _0x18a42a=_0x3be7fc;if(!_0x272eec)return null;const _0x31b9b4=/^.*(?:youtu.be\/|shorts\/|live\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([A-Za-z0-9_-]{11}).*/,_0x160813=_0x272eec[_0x18a42a(0x499)](_0x31b9b4);return _0x160813?_0x160813[0x1]:null;}let sessionYoutubeUrl='';function getActiveYoutubeUrl(){const _0x1f05d0=_0x3be7fc;try{if(sessionYoutubeUrl)return sessionYoutubeUrl;const _0x238f94=document[_0x1f05d0(0x1dc)](_0x1f05d0(0x285)),_0x5a6aa4=(_0x238f94&&_0x238f94['value']?_0x238f94[_0x1f05d0(0x451)]:'')[_0x1f05d0(0x3d6)]();return _0x5a6aa4;}catch(_0x382bfc){return'';}}function getActiveVideoId(){return extractYouTubeID(getActiveYoutubeUrl());}function handleYoutubeUrlInput(){const _0x59ceb3=_0x3be7fc,_0x13c4dc=$(_0x59ceb3(0x200)),_0x1ce102=$(_0x59ceb3(0x275)),_0x22b80a=$(_0x59ceb3(0x4ad)),_0x510d1f=_0x13c4dc[_0x59ceb3(0x451)][_0x59ceb3(0x3d6)](),_0x53c77c=extractYouTubeID(_0x510d1f);if(_0x53c77c){_0x1ce102[_0x59ceb3(0x342)]=_0x59ceb3(0x38c),_0x1ce102[_0x59ceb3(0x43e)][_0x59ceb3(0x32a)]=_0x59ceb3(0x277),_0x22b80a[_0x59ceb3(0x2dc)]=![],sessionYoutubeUrl=_0x510d1f;try{ytUserPaused=![];}catch(_0x449797){}try{const _0xfd8fce='https://img.youtube.com/vi/'+_0x53c77c+_0x59ceb3(0x2b8),_0x50b63e=new Image();_0x50b63e['onload']=async()=>{const _0x4bed98=_0x59ceb3;data[_0x4bed98(0x48d)]['customBg']=_0xfd8fce;try{await saveData();}catch(_0x47c90f){}applyCustomBg();},_0x50b63e['onerror']=async()=>{const _0x4a1cf0=_0x59ceb3,_0x450f7f=_0x4a1cf0(0x1d2)+_0x53c77c+_0x4a1cf0(0x1f1);data[_0x4a1cf0(0x48d)][_0x4a1cf0(0x1db)]=_0x450f7f;try{await saveData();}catch(_0xa6c793){}applyCustomBg();},_0x50b63e[_0x59ceb3(0x42f)]=_0xfd8fce;}catch(_0x183680){}try{if(IS_FILE_PROTOCOL){const _0x32d408=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x53c77c,{'autoplay':0x1,'mute':_0x32d408});try{setTimeout(()=>{const _0x3b811e=_0x59ceb3;try{fallbackPostMessage(_0x3b811e(0x38b));}catch(_0x2ad492){}},0xfa);}catch(_0x133e85){}!_ytUnlocked&&showSoundPermission();try{setTimeout(()=>{const _0x3ad4a4=_0x59ceb3,_0x2fe909=document[_0x3ad4a4(0x1dc)]('ytUrlFeedback');if(_0x2fe909)_0x2fe909[_0x3ad4a4(0x342)]=_0x3ad4a4(0x267);},0x1f4);}catch(_0xc1264b){}}else ensureYouTubeAPI()[_0x59ceb3(0x409)](()=>{const _0x46ca33=_0x59ceb3;updateYouTubePlayer();try{if(_ytUnlocked)ytFadeInPlay();else ytPlayer&&ytPlayer[_0x46ca33(0x21f)]&&ytPlayer['playVideo']&&(ytPlayer[_0x46ca33(0x21f)](),ytPlayer[_0x46ca33(0x38b)](),_ytPrimed=!![],showSoundPermission());}catch(_0x50e55f){}})['catch'](()=>{});}catch(_0x523394){}}else{if(_0x510d1f===''){_0x1ce102[_0x59ceb3(0x342)]='',_0x22b80a[_0x59ceb3(0x2dc)]=!![];if(IS_FILE_PROTOCOL)try{fallbackStop();}catch(_0x19a7d0){}else ytPlayer&&ytPlayer[_0x59ceb3(0x35d)]&&ytPlayer[_0x59ceb3(0x35d)]();}else _0x1ce102[_0x59ceb3(0x342)]=_0x59ceb3(0x28c),_0x1ce102[_0x59ceb3(0x43e)][_0x59ceb3(0x32a)]=_0x59ceb3(0x39d),_0x22b80a[_0x59ceb3(0x2dc)]=!![];}}function applyTheme(_0x2e75cb){const _0x2be445=_0x3be7fc,_0x182ba2=_0x2e75cb||data[_0x2be445(0x48d)][_0x2be445(0x330)]||_0x2be445(0x242);document[_0x2be445(0x298)][_0x2be445(0x485)]['theme']=_0x182ba2;const _0x323a3e=[_0x2be445(0x40f),_0x2be445(0x35e)][_0x2be445(0x2ac)](_0x182ba2),_0x37614b=_0x182ba2===_0x2be445(0x30b)||_0x182ba2===_0x2be445(0x206),_0xf3a6bc=data[_0x2be445(0x48d)][_0x2be445(0x1db)],_0x24c419=()=>{const _0x4a4ed3=_0x2be445;try{document['body'][_0x4a4ed3(0x43e)][_0x4a4ed3(0x2d9)]='';}catch(_0x3a5bd0){}};if(_0xf3a6bc&&!data[_0x2be445(0x48d)][_0x2be445(0x4a6)])document[_0x2be445(0x298)]['style']['setProperty'](_0x2be445(0x411),_0x2be445(0x41a)+_0xf3a6bc+')'),_0x24c419();else{if(_0xf3a6bc&&data[_0x2be445(0x48d)][_0x2be445(0x4a6)])document[_0x2be445(0x298)][_0x2be445(0x43e)][_0x2be445(0x457)]('--bg-image',_0x2be445(0x41a)+_0xf3a6bc+')'),_0x24c419();else{if(_0x323a3e)document['body'][_0x2be445(0x43e)]['removeProperty'](_0x2be445(0x411)),_0x24c419();else _0x37614b?(document['body'][_0x2be445(0x43e)][_0x2be445(0x457)](_0x2be445(0x411),'none'),_0x24c419()):(document[_0x2be445(0x298)][_0x2be445(0x43e)]['setProperty'](_0x2be445(0x411),''),document[_0x2be445(0x298)]['style']['backgroundImage']=_0x2be445(0x34d));}}}const defaults={'version':0x1,'settings':{'apiKey':'','currentView':_0x3be7fc(0x379),'preset':'A','autoStartNext':!![],'soundOn':!![],'volume':0.8,'soundTheme':'beep','theme':_0x3be7fc(0x242),'cyclesA':0x4,'longBreakIntervalA':0x4,'cyclesB':0x4,'longBreakIntervalB':0x4,'flowtimeBreakRatio':0x5,'enableSessionNotes':!![],'enableWinddown':!![],'durations':{'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},'selectedTopicId':'','selectedSubtopicId':'','collapsedTopics':{},'customBg':'','customSounds':{'work_end':'','break_end':'','long_end':''},'youtubeUrl':'','youtubeVolume':0x50,'useYtThumbnailAsBg':!![],'panelOpacity':0.85,'panelBlur':0xa,'backgroundMode':_0x3be7fc(0x4a7),'backupDaysToKeep':0x7,'achievedMilestones':[],'methods':[{'id':uid('m'),'title':_0x3be7fc(0x29c),'content':'<p>The\x20core\x20idea:\x20\x22If\x20you\x20can’t\x20explain\x20a\x20topic\x20simply,\x20you\x20don’t\x20truly\x20understand\x20it.\x22\x20The\x20goal\x20is\x20to\x20turn\x20complex\x20knowledge\x20into\x20explanations\x20simple\x20enough\x20that\x20a\x20child\x20could\x20understand.</p><h4>Streamlined\x204-Step\x20Process</h4><ol><li><strong>Learn:</strong>\x20Pick\x20a\x20topic\x20and\x20write\x20down\x20everything\x20you\x20know\x20about\x20it.</li><li><strong>Teach:</strong>\x20Pretend\x20to\x20teach\x20it\x20using\x20the\x20simplest\x20language\x20possible.\x20Write\x20or\x20speak\x20it\x20out\x20loud.</li><li><strong>Find\x20&\x20Fix\x20Gaps:</strong>\x20Whenever\x20you\x20get\x20\x22stuck\x22,\x20rely\x20on\x20jargon,\x20or\x20can’t\x20explain\x20smoothly,\x20you’ve\x20found\x20a\x20knowledge\x20gap.\x20Go\x20back\x20to\x20the\x20source\x20and\x20learn\x20until\x20the\x20gap\x20is\x20filled.</li><li><strong>Simplify:</strong>\x20Reorganize\x20your\x20final\x20explanation,\x20using\x20simple\x20examples\x20or\x20analogies\x20so\x20it’s\x20clear\x20and\x20easy\x20to\x20grasp.</li></ol><h4>Essence</h4><p>The\x20Feynman\x20Technique\x20forces\x20you\x20to\x20move\x20from\x20passive\x20intake\x20(reading,\x20listening)\x20to\x20actively\x20processing\x20information.\x20The\x20moment\x20you\x20\x22get\x20stuck\x22\x20is\x20a\x20powerful\x20diagnostic\x20tool—pinpointing\x20exactly\x20where\x20you’re\x20weak.</p><p><i>The\x20quickest\x20way\x20to\x20check\x20and\x20strengthen\x20understanding\x20is\x20to\x20try\x20teaching\x20it\x20simply\x20to\x20someone\x20else.</i></p>'},{'id':uid('m'),'title':_0x3be7fc(0x2d5),'content':'<p>Benjamin\x20Franklin\x20trained\x20himself\x20from\x20a\x20poor\x20writer\x20into\x20a\x20master\x20by\x20practicing\x20actively—rather\x20than\x20reading\x20passively.\x20The\x20core\x20is\x20to\x20deconstruct,\x20recreate,\x20and\x20compare\x20with\x20a\x20high-quality\x20piece.</p><p>This\x20is\x20a\x20classic\x20example\x20of\x20<i>Deliberate\x20Practice</i>:\x20target\x20weaknesses,\x20set\x20clear\x20goals,\x20and\x20get\x20immediate\x20feedback.</p><h4>Core\x203-Step\x20Process</h4><ol><li><strong>Deconstruct:</strong>\x20Read\x20an\x20excellent\x20sample.\x20Then\x20jot\x20down\x20only\x20the\x20key\x20points\x20of\x20each\x20paragraph\x20or\x20sentence\x20on\x20a\x20separate\x20sheet.</li><li><strong>Recreate:</strong>\x20A\x20few\x20days\x20later—once\x20you’ve\x20forgotten\x20the\x20original\x20style—use\x20those\x20key-point\x20notes\x20to\x20rewrite\x20the\x20piece\x20entirely\x20in\x20your\x20own\x20words.</li><li><strong>Compare\x20&\x20Correct:</strong>\x20Compare\x20your\x20version\x20with\x20the\x20original.\x20This\x20crucial\x20step\x20reveals\x20errors\x20in\x20vocabulary,\x20sentence\x20structure,\x20and\x20idea\x20organization\x20so\x20you\x20can\x20fix\x20them.</li></ol><p>Franklin\x20also\x20practiced\x20advanced\x20variations:\x20shuffling\x20the\x20order\x20of\x20ideas\x20to\x20train\x20logic,\x20or\x20turning\x20prose\x20into\x20poetry\x20to\x20enrich\x20vocabulary.</p><h4>The\x20Golden\x20Rule</h4><p>Success\x20here\x20doesn’t\x20come\x20from\x20mindless\x20repetition,\x20but\x20from\x20direct\x20feedback\x20loops.\x20Comparing\x20to\x20the\x20original\x20forces\x20you\x20to\x20confront\x20and\x20correct\x20specific\x20weaknesses—turning\x20vague\x20learning\x20into\x20measurable\x20practice.</p><p><i>To\x20write\x20better,\x20don’t\x20just\x20read.\x20Choose\x20a\x20great\x20piece,\x20analyze\x20it,\x20try\x20to\x20recreate\x20it,\x20then\x20compare\x20and\x20correct.</i></p>'},{'id':uid('m'),'title':_0x3be7fc(0x2e7),'content':_0x3be7fc(0x443)},{'id':uid('m'),'title':_0x3be7fc(0x300),'content':'<p>Active\x20Recall\x20is\x20the\x20effortful\x20retrieval\x20of\x20information\x20from\x20memory\x20without\x20looking\x20at\x20materials.\x20It\x20outperforms\x20passive\x20methods\x20like\x20rereading,\x20highlighting,\x20or\x20summarizing.</p><h4>The\x2020/80\x20Principle</h4><p><strong>The\x20vital\x2020%:</strong>\x20Forcing\x20yourself\x20to\x20recall\x20strengthens\x20neural\x20connections\x20and\x20consolidates\x20long-term\x20memory.\x20The\x20difficulty\x20you\x20feel\x20while\x20recalling\x20is\x20the\x20sign\x20of\x20effective\x20learning.</p><p><strong>The\x2080%\x20result:</strong>\x20You\x20retain\x20knowledge\x20longer\x20and\x20know\x20exactly\x20where\x20you’re\x20weak.</p><h4>Most\x20Effective\x20Techniques</h4><ul><li><strong>Self-testing:</strong>\x20Hide\x20your\x20notes\x20and\x20quiz\x20yourself.\x20For\x20example,\x20use\x20flashcards\x20and\x20always\x20answer\x20before\x20flipping\x20them\x20over.</li><li><strong>Blurting:</strong>\x20After\x20studying\x20a\x20topic,\x20close\x20the\x20book\x20and\x20write\x20everything\x20you\x20can\x20remember.\x20Then\x20compare\x20with\x20the\x20source\x20to\x20fill\x20gaps.</li><li><strong>Teach\x20someone\x20else:</strong>\x20Explaining\x20a\x20concept\x20forces\x20retrieval,\x20simplification,\x20and\x20coherent\x20structuring.</li></ul><p><i>Bottom\x20line:\x20Don’t\x20just\x20reread.\x20Pause,\x20cover\x20your\x20materials,\x20and\x20ask:\x20\x22What\x20do\x20I\x20actually\x20remember?\x22</i></p>'},{'id':uid('m'),'title':_0x3be7fc(0x344),'content':_0x3be7fc(0x1b3)}]},'topics':[]};let data,editingPreset='A',AUDIO_CTX=null;function ensureAudio(){const _0x164667=_0x3be7fc;if(!AUDIO_CTX)AUDIO_CTX=new(window[(_0x164667(0x3a9))]||window['webkitAudioContext'])();}function tone(_0xfdc78b=0x370,_0x12eb86=0xc8,_0x16d392=0.2,_0x58357c=_0x3be7fc(0x2ed),_0x1971c7=0x0){const _0x5080dc=_0x3be7fc;ensureAudio();const _0x3ad33a=AUDIO_CTX,_0x495871=_0x3ad33a['createOscillator'](),_0x453300=_0x3ad33a['createGain']();_0x495871[_0x5080dc(0x23d)]=_0x58357c,_0x495871[_0x5080dc(0x46c)][_0x5080dc(0x451)]=_0xfdc78b,_0x495871[_0x5080dc(0x2cc)](_0x453300),_0x453300['connect'](_0x3ad33a['destination']);const _0x20cb27=_0x3ad33a[_0x5080dc(0x2ca)]+_0x1971c7;_0x453300[_0x5080dc(0x26a)][_0x5080dc(0x209)](0x0,_0x20cb27),_0x453300[_0x5080dc(0x26a)][_0x5080dc(0x1b6)](_0x16d392,_0x20cb27+0.01),_0x453300['gain'][_0x5080dc(0x24e)](0.0001,_0x20cb27+_0x12eb86/0x3e8),_0x495871['start'](_0x20cb27),_0x495871[_0x5080dc(0x2c7)](_0x20cb27+_0x12eb86/0x3e8+0.05);}function playSound(_0x1dfde7){const _0x2ac168=_0x3be7fc;if(!data[_0x2ac168(0x48d)]['soundOn'])return;const _0x5e96c7=Math['max'](0x0,Math[_0x2ac168(0x40b)](0x1,data[_0x2ac168(0x48d)][_0x2ac168(0x46d)]??0.8)),_0x45188c=data[_0x2ac168(0x48d)][_0x2ac168(0x1bb)]?.[_0x1dfde7];let _0x37b26e;if(_0x1dfde7===_0x2ac168(0x386))_0x37b26e=$(_0x2ac168(0x3df));else{if(_0x1dfde7==='break_end')_0x37b26e=$(_0x2ac168(0x2a8));else{if(_0x1dfde7==='long_end')_0x37b26e=$('#audioLongEnd');}}if(_0x45188c&&_0x37b26e){_0x45188c['startsWith'](_0x2ac168(0x2de))||_0x45188c[_0x2ac168(0x34a)](_0x2ac168(0x441))||_0x45188c[_0x2ac168(0x34a)](_0x2ac168(0x290))?(_0x37b26e['src']=_0x45188c,_0x37b26e[_0x2ac168(0x46d)]=_0x5e96c7,_0x37b26e[_0x2ac168(0x2e6)]()['catch'](_0x50625c=>console['error'](_0x2ac168(0x2f8),_0x50625c))):getStoredFileUrl(_0x45188c)[_0x2ac168(0x409)](_0x1aadfb=>{const _0x5828a3=_0x2ac168;_0x1aadfb&&(_0x37b26e[_0x5828a3(0x42f)]=_0x1aadfb,_0x37b26e['volume']=_0x5e96c7,_0x37b26e[_0x5828a3(0x2e6)]()[_0x5828a3(0x350)](_0x3a6848=>console[_0x5828a3(0x292)](_0x5828a3(0x2f8),_0x3a6848)));});return;}const _0x4d2cb6=data[_0x2ac168(0x48d)]['soundTheme']||_0x2ac168(0x3e8);if(_0x4d2cb6===_0x2ac168(0x3e8)){if(_0x1dfde7===_0x2ac168(0x386))tone(0x370,0xfa,_0x5e96c7),tone(0x294,0xb4,_0x5e96c7*0.8,_0x2ac168(0x2ed),0.22);else{if(_0x1dfde7===_0x2ac168(0x3ba))tone(0x294,0xdc,_0x5e96c7*0.9);else _0x1dfde7===_0x2ac168(0x1c6)&&(tone(0x208,0xc8,_0x5e96c7),tone(0x30c,0xc8,_0x5e96c7,_0x2ac168(0x2ed),0.22),tone(0x410,0xdc,_0x5e96c7,'sine',0.44));}}else{if(_0x1dfde7===_0x2ac168(0x386))tone(0x4b0,0xa0,_0x5e96c7*0.9,_0x2ac168(0x46f)),tone(0x384,0xdc,_0x5e96c7*0.8,_0x2ac168(0x46f),0.18);else{if(_0x1dfde7===_0x2ac168(0x3ba))tone(0x370,0xf0,_0x5e96c7*0.8,_0x2ac168(0x46f));else _0x1dfde7===_0x2ac168(0x1c6)&&(tone(0x258,0xdc,_0x5e96c7*0.9,'triangle'),tone(0x3b6,0xf0,_0x5e96c7*0.9,_0x2ac168(0x46f),0.22),tone(0x4b0,0xf0,_0x5e96c7,_0x2ac168(0x46f),0.44));}}}async function saveData(){const _0x2719b3=_0x3be7fc;try{await storageManager[_0x2719b3(0x497)](data);}catch(_0x148569){console[_0x2719b3(0x292)](_0x2719b3(0x3b2),_0x148569),toast(_0x2719b3(0x1d1)+_0x148569[_0x2719b3(0x3b7)]);}}async function ensureValidSelection(){const _0x45ed05=_0x3be7fc,_0x5a38df=data[_0x45ed05(0x48d)];if(!data[_0x45ed05(0x247)]||data[_0x45ed05(0x247)][_0x45ed05(0x49f)]===0x0){_0x5a38df[_0x45ed05(0x1a7)]='',_0x5a38df['selectedSubtopicId']='',await saveData();return;}const _0x2f9083=data[_0x45ed05(0x247)]['find'](_0x4622c7=>_0x4622c7['id']===_0x5a38df[_0x45ed05(0x1a7)]),_0x2044dc=_0x2f9083?.[_0x45ed05(0x372)][_0x45ed05(0x489)](_0x277f75=>_0x277f75['id']===_0x5a38df[_0x45ed05(0x33b)]);if(!_0x2f9083||!_0x2044dc){const _0x132f13=data[_0x45ed05(0x247)][0x0],_0x1882e7=_0x132f13?.[_0x45ed05(0x372)]?.[0x0];_0x5a38df['selectedTopicId']=_0x132f13?.['id']||'',_0x5a38df[_0x45ed05(0x33b)]=_0x1882e7?.['id']||'',await saveData();}}function showInputModal(_0x1311f1,_0x420ef5,_0x209a77=''){const _0x4724ee=_0x3be7fc;$(_0x4724ee(0x1c7))['textContent']=_0x1311f1,$('#genericMessage')[_0x4724ee(0x39e)][_0x4724ee(0x27e)]('hidden');const _0x4a05f3=$('#genericInput');_0x4a05f3[_0x4724ee(0x451)]=_0x209a77,_0x4a05f3['classList'][_0x4724ee(0x1ef)]('hidden'),$(_0x4724ee(0x486))['classList'][_0x4724ee(0x27e)]('show');try{trapFocus($(_0x4724ee(0x486)));}catch(_0x2d3f52){}_0x4a05f3[_0x4724ee(0x3d2)](),_0x4a05f3['select']();const _0x11802a=()=>{const _0x322959=_0x4724ee;_0x420ef5(_0x4a05f3[_0x322959(0x451)]),_0xdc6b47();},_0x353764=()=>_0xdc6b47(),_0xa4e11d=_0x354959=>{const _0xfa1d77=_0x4724ee;if(_0x354959[_0xfa1d77(0x320)]==='Enter')_0x11802a();if(_0x354959[_0xfa1d77(0x320)]==='Escape')_0x353764();};$(_0x4724ee(0x387))[_0x4724ee(0x276)]=_0x11802a,$('#btnGenericCancel')[_0x4724ee(0x276)]=_0x353764,_0x4a05f3[_0x4724ee(0x48a)]=_0xa4e11d;function _0xdc6b47(){const _0x4fd1b8=_0x4724ee;$(_0x4fd1b8(0x486))[_0x4fd1b8(0x39e)][_0x4fd1b8(0x1ef)](_0x4fd1b8(0x369)),$(_0x4fd1b8(0x387))['onclick']=null,$(_0x4fd1b8(0x446))['onclick']=null,_0x4a05f3[_0x4fd1b8(0x48a)]=null;try{releaseFocus();}catch(_0x2e2221){}}}function showConfirmModal(_0x3764f5,_0x253ddb,_0x2ec89a){const _0x18f7df=_0x3be7fc;$(_0x18f7df(0x1c7))[_0x18f7df(0x342)]=_0x3764f5;const _0x2d5a62=$('#genericMessage');_0x2d5a62[_0x18f7df(0x342)]=_0x253ddb,_0x2d5a62[_0x18f7df(0x39e)][_0x18f7df(0x1ef)]('hidden'),$(_0x18f7df(0x1e4))['classList'][_0x18f7df(0x27e)](_0x18f7df(0x2ee)),$(_0x18f7df(0x486))[_0x18f7df(0x39e)]['add'](_0x18f7df(0x369));try{trapFocus($(_0x18f7df(0x486)));}catch(_0x3d1d3b){}const _0x50be69=()=>{_0x2ec89a(!![]),_0x2ead81();},_0x491159=()=>{_0x2ec89a(![]),_0x2ead81();};$(_0x18f7df(0x387))[_0x18f7df(0x276)]=_0x50be69,$(_0x18f7df(0x446))['onclick']=_0x491159;function _0x2ead81(){const _0x4e0f79=_0x18f7df;$('#modalGeneric')[_0x4e0f79(0x39e)][_0x4e0f79(0x1ef)](_0x4e0f79(0x369)),$('#btnGenericOk')['onclick']=null,$('#btnGenericCancel')[_0x4e0f79(0x276)]=null;try{releaseFocus();}catch(_0x5d8922){}}}let pendingNoteSessionId=null;function openNoteModal(_0xaeab65){const _0x4b8a2c=_0x3be7fc;pendingNoteSessionId=_0xaeab65||null;const _0x7a0691=$('#modalNote');if(!_0x7a0691)return;const _0x29e84a=$(_0x4b8a2c(0x48f));if(_0x29e84a)try{_0x29e84a[_0x4b8a2c(0x451)]='';}catch(_0x519ccb){}_0x7a0691['classList'][_0x4b8a2c(0x27e)](_0x4b8a2c(0x369));try{trapFocus(_0x7a0691);}catch(_0x384f29){}}function closeNoteModal(){const _0xb1f95d=_0x3be7fc,_0x4c933c=$('#modalNote');if(!_0x4c933c)return;_0x4c933c[_0xb1f95d(0x39e)][_0xb1f95d(0x1ef)](_0xb1f95d(0x369)),pendingNoteSessionId=null;try{releaseFocus();}catch(_0x27c36b){}}async function switchView(_0x34a168){const _0x1eb3ad=_0x3be7fc;$$('.view')[_0x1eb3ad(0x2d6)](_0x1c45f0=>_0x1c45f0[_0x1eb3ad(0x39e)][_0x1eb3ad(0x1ef)](_0x1eb3ad(0x279))),$(_0x1eb3ad(0x284)+_0x34a168)[_0x1eb3ad(0x39e)]['add'](_0x1eb3ad(0x279)),$$('.nav-btn')[_0x1eb3ad(0x2d6)](_0x361bc9=>_0x361bc9[_0x1eb3ad(0x39e)][_0x1eb3ad(0x1ef)](_0x1eb3ad(0x279)));const _0x1b130f=$(_0x1eb3ad(0x345)+_0x34a168+'\x22]');if(_0x1b130f)_0x1b130f[_0x1eb3ad(0x39e)][_0x1eb3ad(0x27e)](_0x1eb3ad(0x279));data[_0x1eb3ad(0x48d)][_0x1eb3ad(0x1b9)]=_0x34a168,await saveData(),_0x34a168===_0x1eb3ad(0x3dd)&&renderDashboard();}function closeAllMenus(){const _0x28b97d=_0x3be7fc;$$(_0x28b97d(0x477))[_0x28b97d(0x2d6)](_0x5ceff2=>_0x5ceff2['classList'][_0x28b97d(0x1ef)](_0x28b97d(0x369))),$$(_0x28b97d(0x340))['forEach'](_0x316294=>_0x316294[_0x28b97d(0x39e)][_0x28b97d(0x1ef)](_0x28b97d(0x1d9)));}function renderTopics(){const _0x486bb1=_0x3be7fc,_0x27a687=$('#topicsList');if(!_0x27a687)return;_0x27a687[_0x486bb1(0x28b)]='';const _0x30e0f7=data['settings'][_0x486bb1(0x2b0)]||{};data[_0x486bb1(0x247)]['forEach'](_0x3c55ba=>{const _0x5cc9e8=_0x486bb1,_0x4e1a06=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x422));_0x4e1a06[_0x5cc9e8(0x25b)]=_0x5cc9e8(0x3ce),_0x4e1a06[_0x5cc9e8(0x485)][_0x5cc9e8(0x3b6)]=_0x3c55ba['id'];const _0xf2ba61=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x422));_0xf2ba61[_0x5cc9e8(0x25b)]=_0x5cc9e8(0x228);const _0x5943ed=!!_0x30e0f7[_0x3c55ba['id']],_0x16bd41=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x2ad));_0x16bd41[_0x5cc9e8(0x25b)]=_0x5cc9e8(0x394),_0x16bd41[_0x5cc9e8(0x30c)](_0x5cc9e8(0x3c1),String(!_0x5943ed)),_0x16bd41['innerHTML']='<span\x20class=\x22ico\x22>▾</span>';const _0xa525d1=document[_0x5cc9e8(0x1ce)]('div');_0xa525d1[_0x5cc9e8(0x25b)]=_0x5cc9e8(0x37b),_0xa525d1[_0x5cc9e8(0x342)]=_0x3c55ba[_0x5cc9e8(0x313)];const _0x583aa0=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x422));_0x583aa0['className']=_0x5cc9e8(0x262);const _0x81657f=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x2ad));_0x81657f['className']=_0x5cc9e8(0x257),_0x81657f[_0x5cc9e8(0x28b)]=_0x5cc9e8(0x1c3),_0x81657f[_0x5cc9e8(0x3f7)]=_0x5cc9e8(0x1de);const _0x4ce015=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x422));_0x4ce015[_0x5cc9e8(0x43e)][_0x5cc9e8(0x258)]='relative';const _0x8095cb=document['createElement']('button');_0x8095cb[_0x5cc9e8(0x25b)]=_0x5cc9e8(0x1fa),_0x8095cb[_0x5cc9e8(0x28b)]=_0x5cc9e8(0x374),_0x8095cb[_0x5cc9e8(0x3f7)]='More\x20options';const _0x134575=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x422));_0x134575['className']=_0x5cc9e8(0x463);const _0x27dea6=document['createElement'](_0x5cc9e8(0x2ad));_0x27dea6[_0x5cc9e8(0x25b)]=_0x5cc9e8(0x428),_0x27dea6[_0x5cc9e8(0x28b)]='Rename\x20Topic';const _0x3af5fd=document[_0x5cc9e8(0x1ce)]('button');_0x3af5fd[_0x5cc9e8(0x25b)]=_0x5cc9e8(0x423),_0x3af5fd[_0x5cc9e8(0x28b)]=_0x5cc9e8(0x34e),_0x134575[_0x5cc9e8(0x38f)](_0x27dea6,_0x3af5fd),_0x4ce015[_0x5cc9e8(0x38f)](_0x8095cb,_0x134575),_0x583aa0[_0x5cc9e8(0x38f)](_0x81657f,_0x4ce015),_0xf2ba61['append'](_0x16bd41,_0xa525d1,_0x583aa0),_0x16bd41['addEventListener'](_0x5cc9e8(0x363),async _0x3a66bf=>{const _0x1f24a0=_0x5cc9e8;_0x3a66bf[_0x1f24a0(0x22f)]();const _0x363552=!!_0x30e0f7[_0x3c55ba['id']];_0x363552?delete _0x30e0f7[_0x3c55ba['id']]:_0x30e0f7[_0x3c55ba['id']]=!![],data[_0x1f24a0(0x48d)][_0x1f24a0(0x2b0)]=_0x30e0f7,await storageManager[_0x1f24a0(0x322)](data[_0x1f24a0(0x48d)]),renderTopics();});const _0x642e43=async()=>{const _0x30d248=_0x5cc9e8,_0x52059b=!!_0x30e0f7[_0x3c55ba['id']];_0x52059b?delete _0x30e0f7[_0x3c55ba['id']]:_0x30e0f7[_0x3c55ba['id']]=!![],data[_0x30d248(0x48d)][_0x30d248(0x2b0)]=_0x30e0f7,await storageManager[_0x30d248(0x322)](data[_0x30d248(0x48d)]),renderTopics();};_0xf2ba61[_0x5cc9e8(0x2bd)](_0x5cc9e8(0x363),async _0x5334dd=>{const _0x1693cc=_0x5cc9e8,_0x3d5d3a=_0x5334dd['target'];if(_0x3d5d3a&&_0x3d5d3a[_0x1693cc(0x239)]){if(_0x3d5d3a['closest'](_0x1693cc(0x32d))||_0x3d5d3a['closest'](_0x1693cc(0x263))||_0x3d5d3a[_0x1693cc(0x239)](_0x1693cc(0x2ad))||_0x3d5d3a[_0x1693cc(0x239)](_0x1693cc(0x307)))return;}_0x5334dd[_0x1693cc(0x22f)](),await _0x642e43();}),_0xa525d1[_0x5cc9e8(0x2bd)](_0x5cc9e8(0x363),async _0x2a1633=>{const _0x1d72cb=_0x5cc9e8;_0x2a1633[_0x1d72cb(0x22f)](),await _0x642e43();}),_0x4e1a06[_0x5cc9e8(0x2bd)](_0x5cc9e8(0x363),async _0x15a33f=>{const _0x3513ca=_0x5cc9e8,_0x30f26c=_0x15a33f[_0x3513ca(0x35a)];if(_0x30f26c&&_0x30f26c[_0x3513ca(0x239)]){if(_0x30f26c['closest'](_0x3513ca(0x384)))return;if(_0x30f26c[_0x3513ca(0x239)](_0x3513ca(0x32d))||_0x30f26c[_0x3513ca(0x239)](_0x3513ca(0x263))||_0x30f26c[_0x3513ca(0x239)](_0x3513ca(0x2ad))||_0x30f26c[_0x3513ca(0x239)]('input,select,textarea'))return;}await _0x642e43();});const _0x462f56=document[_0x5cc9e8(0x1ce)](_0x5cc9e8(0x422));_0x462f56[_0x5cc9e8(0x25b)]='subtopics'+(_0x5943ed?'\x20hidden':''),_0x462f56['dataset'][_0x5cc9e8(0x3b6)]=_0x3c55ba['id'],_0x3c55ba[_0x5cc9e8(0x372)][_0x5cc9e8(0x2d6)](_0x719455=>{const _0x2e5f2c=_0x5cc9e8,_0x595cda=document[_0x2e5f2c(0x1ce)](_0x2e5f2c(0x422));_0x595cda[_0x2e5f2c(0x25b)]=_0x2e5f2c(0x29e),_0x595cda[_0x2e5f2c(0x485)]['sid']=_0x719455['id'];const _0x4e63e0=document[_0x2e5f2c(0x1ce)]('button');_0x4e63e0[_0x2e5f2c(0x25b)]=_0x2e5f2c(0x303),_0x4e63e0['textContent']='•\x20'+_0x719455['name'],_0x4e63e0[_0x2e5f2c(0x485)][_0x2e5f2c(0x362)]=_0x719455['id'],_0x4e63e0['dataset'][_0x2e5f2c(0x3b6)]=_0x3c55ba['id'];if(data[_0x2e5f2c(0x48d)][_0x2e5f2c(0x33b)]===_0x719455['id'])_0x4e63e0[_0x2e5f2c(0x39e)][_0x2e5f2c(0x27e)](_0x2e5f2c(0x279));const _0x1bdcd1=document[_0x2e5f2c(0x1ce)](_0x2e5f2c(0x422));_0x1bdcd1[_0x2e5f2c(0x25b)]=_0x2e5f2c(0x1b8);const _0x2481e9=document['createElement'](_0x2e5f2c(0x422));_0x2481e9[_0x2e5f2c(0x43e)]['position']='relative';const _0xf8dd40=document[_0x2e5f2c(0x1ce)](_0x2e5f2c(0x2ad));_0xf8dd40[_0x2e5f2c(0x25b)]='btn\x20small\x20ghost\x20actions-menu-btn',_0xf8dd40[_0x2e5f2c(0x28b)]=_0x2e5f2c(0x374),_0xf8dd40[_0x2e5f2c(0x3f7)]=_0x2e5f2c(0x426);const _0x306444=document[_0x2e5f2c(0x1ce)](_0x2e5f2c(0x422));_0x306444[_0x2e5f2c(0x25b)]='actions-menu';const _0xdbc4ed=document[_0x2e5f2c(0x1ce)](_0x2e5f2c(0x2ad));_0xdbc4ed[_0x2e5f2c(0x25b)]=_0x2e5f2c(0x428),_0xdbc4ed[_0x2e5f2c(0x28b)]=_0x2e5f2c(0x3c9);const _0x88b09=document[_0x2e5f2c(0x1ce)]('button');_0x88b09[_0x2e5f2c(0x25b)]=_0x2e5f2c(0x423),_0x88b09['innerHTML']=_0x2e5f2c(0x230),_0x306444[_0x2e5f2c(0x38f)](_0xdbc4ed,_0x88b09),_0x2481e9[_0x2e5f2c(0x38f)](_0xf8dd40,_0x306444),_0x1bdcd1['append'](_0x2481e9),_0x595cda[_0x2e5f2c(0x38f)](_0x4e63e0,_0x1bdcd1),_0x462f56[_0x2e5f2c(0x253)](_0x595cda),_0x4e63e0[_0x2e5f2c(0x2bd)]('click',()=>selectSubtopic(_0x3c55ba['id'],_0x719455['id'])),_0xf8dd40[_0x2e5f2c(0x2bd)]('click',_0x4cc17d=>{const _0x2912b4=_0x2e5f2c;_0x4cc17d['stopPropagation']();const _0x2ce89f=_0x306444[_0x2912b4(0x39e)][_0x2912b4(0x203)](_0x2912b4(0x369));closeAllMenus(),_0x2ce89f?_0x4e1a06['classList']['remove'](_0x2912b4(0x1d9)):(_0x306444['classList']['add'](_0x2912b4(0x369)),_0x4e1a06[_0x2912b4(0x39e)][_0x2912b4(0x27e)]('menu-active'));}),_0xdbc4ed[_0x2e5f2c(0x2bd)](_0x2e5f2c(0x363),()=>showInputModal(_0x2e5f2c(0x3c9),async _0x5ca6a4=>{const _0x509cce=_0x2e5f2c;if(!_0x5ca6a4)return;_0x719455[_0x509cce(0x313)]=_0x5ca6a4,await storageManager[_0x509cce(0x436)]('subtopics',_0x719455),renderAll();},_0x719455[_0x2e5f2c(0x313)])),_0x88b09[_0x2e5f2c(0x2bd)](_0x2e5f2c(0x363),()=>showConfirmModal(_0x2e5f2c(0x429),'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20subtopic\x20\x22'+_0x719455[_0x2e5f2c(0x313)]+_0x2e5f2c(0x2a6),async _0x2749fb=>{const _0x1efc94=_0x2e5f2c;if(!_0x2749fb)return;_0x3c55ba[_0x1efc94(0x372)]=_0x3c55ba[_0x1efc94(0x372)][_0x1efc94(0x2b3)](_0x341c6e=>_0x341c6e['id']!==_0x719455['id']);const _0x2fdfd1=data[_0x1efc94(0x48d)];_0x2fdfd1[_0x1efc94(0x33b)]===_0x719455['id']&&(_0x2fdfd1[_0x1efc94(0x33b)]='',_0x2fdfd1['selectedTopicId']='',ensureValidSelection()),await storageManager[_0x1efc94(0x404)]('subtopics',_0x719455['id']),renderAll();}));}),_0x8095cb[_0x5cc9e8(0x2bd)]('click',_0x1e836d=>{const _0x39eda0=_0x5cc9e8;_0x1e836d[_0x39eda0(0x22f)]();const _0x508b44=_0x134575['classList']['contains'](_0x39eda0(0x369));closeAllMenus(),_0x508b44?_0x4e1a06[_0x39eda0(0x39e)][_0x39eda0(0x1ef)]('menu-active'):(_0x134575['classList']['add'](_0x39eda0(0x369)),_0x4e1a06[_0x39eda0(0x39e)][_0x39eda0(0x27e)]('menu-active'));}),_0x81657f[_0x5cc9e8(0x2bd)]('click',()=>showInputModal('New\x20Subtopic\x20name?',async _0x5b00ed=>{const _0x454f8e=_0x5cc9e8;if(!_0x5b00ed)return;const _0x311931={'id':uid('s'),'topicId':_0x3c55ba['id'],'name':_0x5b00ed,'tasks':[],'generalNotes':[],'summaries':[],'chatHistory':[],'stats':{'totalMinutes':0x0,'sessionsCompleted':0x0,'tasksCompleted':0x0},'sessions':[],'timerState':{'state':_0x454f8e(0x323),'prevState':null,'remaining':0x0,'segmentTotal':0x0,'cycleIndex':0x0}};_0x3c55ba[_0x454f8e(0x372)][_0x454f8e(0x2d0)](_0x311931),await storageManager[_0x454f8e(0x27e)]('subtopics',_0x311931),renderTopics();})),_0x27dea6[_0x5cc9e8(0x2bd)](_0x5cc9e8(0x363),()=>showInputModal('Rename\x20Topic',async _0x22776f=>{const _0x301d94=_0x5cc9e8;if(!_0x22776f)return;_0x3c55ba[_0x301d94(0x313)]=_0x22776f,await storageManager[_0x301d94(0x436)](_0x301d94(0x247),_0x3c55ba),renderTopics();},_0x3c55ba[_0x5cc9e8(0x313)])),_0x3af5fd[_0x5cc9e8(0x2bd)](_0x5cc9e8(0x363),()=>showConfirmModal(_0x5cc9e8(0x429),_0x5cc9e8(0x4a1)+_0x3c55ba[_0x5cc9e8(0x313)]+'\x22?\x20All\x20subtopics\x20and\x20related\x20data\x20will\x20be\x20lost.',async _0xd1e649=>{const _0x5947d0=_0x5cc9e8;if(!_0xd1e649)return;data[_0x5947d0(0x247)]=data[_0x5947d0(0x247)][_0x5947d0(0x2b3)](_0x18d09a=>_0x18d09a['id']!==_0x3c55ba['id']),delete _0x30e0f7[_0x3c55ba['id']];data['settings'][_0x5947d0(0x1a7)]===_0x3c55ba['id']&&(data[_0x5947d0(0x48d)][_0x5947d0(0x1a7)]='',data[_0x5947d0(0x48d)][_0x5947d0(0x33b)]='',ensureValidSelection());await storageManager[_0x5947d0(0x404)]('topics',_0x3c55ba['id']);for(const _0x1be9b2 of _0x3c55ba['subtopics']){await storageManager[_0x5947d0(0x404)](_0x5947d0(0x372),_0x1be9b2['id']);}renderAll();})),_0x81657f['addEventListener'](_0x5cc9e8(0x363),_0x4256df=>_0x4256df[_0x5cc9e8(0x22f)]()),_0x27dea6[_0x5cc9e8(0x2bd)](_0x5cc9e8(0x363),_0x3b0cf0=>_0x3b0cf0['stopPropagation']()),_0x3af5fd[_0x5cc9e8(0x2bd)]('click',_0x3df115=>_0x3df115['stopPropagation']()),_0x4e1a06[_0x5cc9e8(0x38f)](_0xf2ba61,_0x462f56),_0x27a687[_0x5cc9e8(0x253)](_0x4e1a06);});if(window['Sortable']){const _0xb2f753=document['getElementById'](_0x486bb1(0x288));if(_0xb2f753){if(_0xb2f753[_0x486bb1(0x2c4)])try{_0xb2f753[_0x486bb1(0x2c4)][_0x486bb1(0x36c)]();}catch(_0x712c2f){}_0xb2f753[_0x486bb1(0x2c4)]=new Sortable(_0xb2f753,{'animation':0x96,'draggable':_0x486bb1(0x367),'onEnd':async function(_0x3e0793){const _0x5f1253=_0x486bb1;if(_0x3e0793[_0x5f1253(0x1ee)]===_0x3e0793[_0x5f1253(0x4b0)])return;const _0x152315=data['topics'][_0x5f1253(0x3af)](_0x3e0793[_0x5f1253(0x1ee)],0x1)[0x0];data[_0x5f1253(0x247)]['splice'](_0x3e0793['newIndex'],0x0,_0x152315),await saveData(),renderTopics();}}),_0xb2f753[_0x486bb1(0x2bc)](_0x486bb1(0x384))[_0x486bb1(0x2d6)](_0x49d596=>{const _0x2e3eea=_0x486bb1;new Sortable(_0x49d596,{'group':_0x2e3eea(0x392),'animation':0x96,'draggable':_0x2e3eea(0x2f4),'onEnd':async function(_0x47c015){const _0x574608=_0x2e3eea,_0x3c6ce0=_0x47c015[_0x574608(0x421)]?.['dataset']?.[_0x574608(0x3b6)]||_0x47c015[_0x574608(0x421)]?.[_0x574608(0x239)](_0x574608(0x367))?.[_0x574608(0x485)]?.[_0x574608(0x3b6)],_0x2a8eac=_0x47c015['to']?.[_0x574608(0x485)]?.[_0x574608(0x3b6)]||_0x47c015['to']?.[_0x574608(0x239)]('.topic-item')?.[_0x574608(0x485)]?.[_0x574608(0x3b6)],_0x5dbb46=data[_0x574608(0x247)][_0x574608(0x489)](_0xebb438=>_0xebb438['id']===_0x3c6ce0),_0x38d13b=data[_0x574608(0x247)]['find'](_0x4805c1=>_0x4805c1['id']===_0x2a8eac);if(!_0x5dbb46||!_0x38d13b)return;let _0x5e92b8=null;const _0x3910d1=_0x47c015[_0x574608(0x1af)]?.[_0x574608(0x485)]?.[_0x574608(0x362)]||_0x47c015[_0x574608(0x1af)]?.[_0x574608(0x3ed)]('.subtopic-btn')?.[_0x574608(0x485)]?.['sid'];if(_0x3910d1){const _0x59f99c=_0x5dbb46['subtopics'][_0x574608(0x2f2)](_0x330759=>_0x330759['id']===_0x3910d1);if(_0x59f99c>=0x0)_0x5e92b8=_0x5dbb46['subtopics']['splice'](_0x59f99c,0x1)[0x0];}!_0x5e92b8&&(_0x5e92b8=_0x5dbb46[_0x574608(0x372)][_0x574608(0x3af)](_0x47c015[_0x574608(0x1ee)],0x1)[0x0]);if(!_0x5e92b8)return;_0x5e92b8[_0x574608(0x49a)]=_0x38d13b['id'],_0x38d13b[_0x574608(0x372)][_0x574608(0x3af)](_0x47c015[_0x574608(0x4b0)],0x0,_0x5e92b8),data['settings'][_0x574608(0x33b)]===_0x5e92b8['id']&&(data[_0x574608(0x48d)][_0x574608(0x1a7)]=_0x38d13b['id']),await saveData(),renderTopics();}});});}}}function selectSubtopic(_0x9feb1,_0x4492ea){const _0x5bf89e=_0x3be7fc,_0x3953d9=$(_0x5bf89e(0x295)),_0x20ad2d=getCurrentSubtopic();_0x20ad2d&&timer[_0x5bf89e(0x1f9)]!==_0x5bf89e(0x323)&&(_0x20ad2d[_0x5bf89e(0x278)]={'state':timer[_0x5bf89e(0x1f9)],'prevState':timer['prevState'],'remaining':timer[_0x5bf89e(0x359)],'segmentTotal':timer[_0x5bf89e(0x2ff)],'cycleIndex':timer[_0x5bf89e(0x1a6)]}),_0x3953d9[_0x5bf89e(0x39e)][_0x5bf89e(0x27e)](_0x5bf89e(0x35f)),setTimeout(async()=>{const _0x533c19=_0x5bf89e;data['settings'][_0x533c19(0x1a7)]=_0x9feb1,data[_0x533c19(0x48d)][_0x533c19(0x33b)]=_0x4492ea;const _0x325f20=getCurrentSubtopic();_0x325f20[_0x533c19(0x278)]?(timer[_0x533c19(0x1f9)]=_0x325f20[_0x533c19(0x278)][_0x533c19(0x1f9)],timer['prevState']=_0x325f20[_0x533c19(0x278)][_0x533c19(0x490)]||null,timer[_0x533c19(0x359)]=_0x325f20[_0x533c19(0x278)][_0x533c19(0x359)],timer[_0x533c19(0x2ff)]=_0x325f20[_0x533c19(0x278)]['segmentTotal'],timer[_0x533c19(0x1a6)]=_0x325f20[_0x533c19(0x278)][_0x533c19(0x1a6)]):timer[_0x533c19(0x494)](),await saveData(),timer[_0x533c19(0x398)](),renderAll(),switchView('timer'),_0x3953d9[_0x533c19(0x39e)]['remove'](_0x533c19(0x35f));},0xc8);}function getCurrentSubtopic(){const _0x45c9d8=_0x3be7fc,_0x5f5878=data[_0x45c9d8(0x48d)][_0x45c9d8(0x1a7)],_0x2f4ea8=data[_0x45c9d8(0x48d)]['selectedSubtopicId'];if(!_0x5f5878||!_0x2f4ea8)return null;const _0x44ac1b=data[_0x45c9d8(0x247)][_0x45c9d8(0x489)](_0x18b482=>_0x18b482['id']===_0x5f5878);if(!_0x44ac1b)return null;return _0x44ac1b['subtopics'][_0x45c9d8(0x489)](_0x2e26f4=>_0x2e26f4['id']===_0x2f4ea8)||null;}function renderContextBadge(){const _0x3c79ec=_0x3be7fc,_0x507127=getCurrentSubtopic(),_0x3155ba=_0x507127?_0x507127[_0x3c79ec(0x313)]:_0x3c79ec(0x347),_0x231cc6=$('#selectedContext'),_0x306b62=$(_0x3c79ec(0x3f0)),_0x25cc8a=$(_0x3c79ec(0x273));if(_0x231cc6)_0x231cc6['textContent']=_0x507127?_0x3c79ec(0x32f)+_0x507127[_0x3c79ec(0x313)]:_0x3c79ec(0x314);if(_0x306b62)_0x306b62[_0x3c79ec(0x342)]=_0x3155ba;if(_0x25cc8a)_0x25cc8a['textContent']=_0x3155ba;}function renderSubtopicTasks(){const _0x1a8c8f=_0x3be7fc,_0xf3e364=getCurrentSubtopic(),_0x2ce143=$(_0x1a8c8f(0x1ad)),_0x996190=$(_0x1a8c8f(0x41b));if(!_0x2ce143||!_0x996190)return;const _0x336bf2=_0x996190[_0x1a8c8f(0x3c4)];if(!_0xf3e364){_0x2ce143[_0x1a8c8f(0x28b)]='<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Select\x20a\x20subtopic\x20to\x20view\x20the\x20to-do\x20list.</li>',_0x336bf2['classList'][_0x1a8c8f(0x27e)](_0x1a8c8f(0x2ee));return;}_0x336bf2['classList']['remove'](_0x1a8c8f(0x2ee)),_0x2ce143[_0x1a8c8f(0x28b)]='';const _0x1cf12c=_0xf3e364['tasks']?_0xf3e364[_0x1a8c8f(0x302)][_0x1a8c8f(0x2b3)](_0x1475f2=>!_0x1475f2['isCompleted']):[];_0x1cf12c[_0x1a8c8f(0x49f)]===0x0&&(_0x2ce143[_0x1a8c8f(0x28b)]=_0x1a8c8f(0x2a1)),_0x1cf12c['forEach'](_0x521e6e=>{const _0x7c9f76=_0x1a8c8f,_0x3f864f=document[_0x7c9f76(0x1ce)]('li');_0x3f864f[_0x7c9f76(0x28b)]=_0x7c9f76(0x40e)+_0x521e6e['id']+_0x7c9f76(0x473)+_0x521e6e['id']+'\x22>'+escapeHTML(_0x521e6e[_0x7c9f76(0x430)])+_0x7c9f76(0x419),_0x3f864f[_0x7c9f76(0x3ed)](_0x7c9f76(0x21a))[_0x7c9f76(0x2bd)](_0x7c9f76(0x3f9),_0x304120=>toggleSubtopicTask(_0x304120['target']['id'],_0x3f864f)),_0x2ce143[_0x7c9f76(0x253)](_0x3f864f);});}async function addSubtopicTask(){const _0x55058c=_0x3be7fc,_0x143edc=getCurrentSubtopic();if(!_0x143edc){toast(t('timer.selectSubtopicPrompt'));return;}const _0x247b47=$(_0x55058c(0x41b)),_0x233579=_0x247b47[_0x55058c(0x451)][_0x55058c(0x3d6)]();if(_0x233579){if(!_0x143edc[_0x55058c(0x302)])_0x143edc[_0x55058c(0x302)]=[];_0x143edc[_0x55058c(0x302)][_0x55058c(0x2d0)]({'id':uid(_0x55058c(0x334)),'text':_0x233579,'isCompleted':![],'createdAt':todayISO()}),await saveData(),renderSubtopicTasks(),_0x247b47[_0x55058c(0x451)]='';}_0x247b47[_0x55058c(0x3d2)]();}async function toggleSubtopicTask(_0x4cdda4,_0x5330b3){const _0x1f3755=_0x3be7fc,_0x3c005f=getCurrentSubtopic();if(!_0x3c005f||!_0x3c005f[_0x1f3755(0x302)])return;const _0x4fb9b1=_0x3c005f[_0x1f3755(0x302)][_0x1f3755(0x489)](_0x5caab0=>_0x5caab0['id']===_0x4cdda4);_0x4fb9b1&&(_0x4fb9b1['isCompleted']=!![],_0x3c005f[_0x1f3755(0x3dd)][_0x1f3755(0x482)]=(_0x3c005f['stats'][_0x1f3755(0x482)]||0x0)+0x1,await saveData(),_0x5330b3[_0x1f3755(0x39e)]['add'](_0x1f3755(0x2ab)),setTimeout(()=>{renderSubtopicTasks(),renderStatsHistory();},0xc8));}const timer={'state':_0x3be7fc(0x323),'prevState':null,'tickHandle':null,'endAt':null,'remaining':0x0,'segmentTotal':0x0,'cyclesTarget':0x4,'cycleIndex':0x0,'mode':'A','persistInterval':0x3c*0x3e8,'lastPersist':0x0,async 'setPreset'(_0x2ae79d,{silent:silent=![]}={}){const _0xe115d8=_0x3be7fc,_0x296922=data[_0xe115d8(0x48d)];this[_0xe115d8(0x211)]=_0x2ae79d,this[_0xe115d8(0x368)]=_0x2ae79d==='A'?_0x296922[_0xe115d8(0x29f)]:_0x2ae79d==='B'?_0x296922[_0xe115d8(0x42e)]:0x0,_0x296922[_0xe115d8(0x352)]=_0x2ae79d,await saveData(),this[_0xe115d8(0x1f9)]===_0xe115d8(0x323)&&this['reset']();},'currentDurations'(){const _0x3d97df=_0x3be7fc,_0x306e68=data['settings'][_0x3d97df(0x1a4)];if(this[_0x3d97df(0x211)]==='A')return{'work':_0x306e68[_0x3d97df(0x2f3)],'short':_0x306e68['A_short'],'long':_0x306e68[_0x3d97df(0x432)],'winddown':_0x306e68[_0x3d97df(0x37c)]??0x0};if(this['mode']==='B')return{'work':_0x306e68[_0x3d97df(0x487)],'short':_0x306e68[_0x3d97df(0x2d4)],'long':_0x306e68[_0x3d97df(0x380)],'winddown':_0x306e68[_0x3d97df(0x4b8)]??0x0};return{'work':0x0,'short':0x0,'long':0x0,'winddown':0x0};},'currentConfig'(){const _0x5429f7=_0x3be7fc,_0x2a1baa=data[_0x5429f7(0x48d)];if(this[_0x5429f7(0x211)]==='A')return{'cycles':_0x2a1baa[_0x5429f7(0x29f)],'interval':_0x2a1baa['longBreakIntervalA']};if(this[_0x5429f7(0x211)]==='B')return{'cycles':_0x2a1baa[_0x5429f7(0x42e)],'interval':_0x2a1baa[_0x5429f7(0x452)]};return{'cycles':0x0,'interval':0x0};},'updateUI'(){const _0x12e610=_0x3be7fc,_0x32145c=$(_0x12e610(0x3de)),_0x388439=$(_0x12e610(0x3a8)),_0x39740c=$(_0x12e610(0x3a7));if(!_0x32145c||!_0x388439||!_0x39740c)return;const _0x12c8d5=this[_0x12e610(0x211)]==='C';$(_0x12e610(0x3f3))[_0x12e610(0x39e)]['toggle'](_0x12e610(0x2ee),this[_0x12e610(0x1f9)]!=='idle'||_0x12c8d5&&this[_0x12e610(0x1f9)]===_0x12e610(0x3e6)),$(_0x12e610(0x2a3))['classList'][_0x12e610(0x402)]('hidden',!(_0x12c8d5&&this[_0x12e610(0x1f9)]===_0x12e610(0x3e6))),$(_0x12e610(0x385))[_0x12e610(0x39e)]['toggle'](_0x12e610(0x2ee),![_0x12e610(0x3e6),'break',_0x12e610(0x2c9)][_0x12e610(0x2ac)](this['state'])),$(_0x12e610(0x1c5))['classList'][_0x12e610(0x402)](_0x12e610(0x2ee),this[_0x12e610(0x1f9)]!==_0x12e610(0x2d8));let _0x33ab08=_0x12e610(0x3a6);if(this[_0x12e610(0x1f9)]===_0x12e610(0x3e6))_0x32145c[_0x12e610(0x342)]=_0x12c8d5?_0x12e610(0x341):_0x12e610(0x1c4),_0x32145c[_0x12e610(0x25b)]=_0x12e610(0x20f),_0x33ab08='var(--acc)';else{if(this[_0x12e610(0x1f9)]===_0x12e610(0x339))_0x32145c['textContent']='SHORT\x20BREAK',_0x32145c[_0x12e610(0x25b)]=_0x12e610(0x366),_0x33ab08=_0x12e610(0x45a);else{if(this[_0x12e610(0x1f9)]===_0x12e610(0x2c9))_0x32145c['textContent']=_0x12e610(0x32e),_0x32145c[_0x12e610(0x25b)]='badge\x20state\x20long',_0x33ab08=_0x12e610(0x39d);else{if(this[_0x12e610(0x1f9)]==='wind_down'){_0x32145c[_0x12e610(0x342)]='WIND-DOWN',_0x32145c[_0x12e610(0x25b)]='badge\x20state\x20work',_0x33ab08=_0x12e610(0x277);try{$(_0x12e610(0x208))[_0x12e610(0x39e)][_0x12e610(0x1ef)]('hidden'),$('#btnBreakEarly')[_0x12e610(0x39e)][_0x12e610(0x1ef)](_0x12e610(0x2ee));}catch(_0x2be88d){}}else this['state']==='paused'?(_0x32145c[_0x12e610(0x342)]='PAUSED',_0x32145c[_0x12e610(0x25b)]=_0x12e610(0x3e3)):(_0x32145c[_0x12e610(0x342)]='READY',_0x32145c[_0x12e610(0x25b)]=_0x12e610(0x3e3));}}}[_0x12e610(0x3e6),_0x12e610(0x339),_0x12e610(0x2c9),'wind_down'][_0x12e610(0x2ac)](this[_0x12e610(0x1f9)])?_0x39740c[_0x12e610(0x39e)]['add'](_0x12e610(0x31d)):_0x39740c[_0x12e610(0x39e)]['remove'](_0x12e610(0x31d));_0x388439['style'][_0x12e610(0x442)]=_0x33ab08,_0x39740c['classList'][_0x12e610(0x1ef)](_0x12e610(0x309));const _0x389a53=$(_0x12e610(0x434));if(_0x389a53)_0x389a53[_0x12e610(0x342)]=formatMMSS(this[_0x12e610(0x359)]);const _0x41f49f=_0x388439['r'][_0x12e610(0x2fc)][_0x12e610(0x451)],_0x57d39d=0x2*Math['PI']*_0x41f49f,_0x899f80=this['segmentTotal']>0x0?_0x57d39d-this[_0x12e610(0x359)]/this[_0x12e610(0x2ff)]*_0x57d39d:_0x57d39d;_0x388439[_0x12e610(0x43e)][_0x12e610(0x220)]=_0x57d39d,_0x388439['style']['strokeDashoffset']=isNaN(_0x899f80)?_0x57d39d:_0x899f80;const _0x3ee1a4=$(_0x12e610(0x2ae));if(_0x3ee1a4){const _0x321e6e=this[_0x12e610(0x23b)]();_0x3ee1a4[_0x12e610(0x342)]=t('timer.cycleInfo',{'current':this['cycleIndex'],'target':_0x321e6e[_0x12e610(0x3b4)]}),_0x3ee1a4[_0x12e610(0x39e)][_0x12e610(0x402)](_0x12e610(0x2ee),_0x12c8d5);}const _0x2e619e=$(_0x12e610(0x249));_0x2e619e&&_0x2e619e['classList']['toggle'](_0x12e610(0x2ee),_0x12c8d5&&this[_0x12e610(0x1f9)]===_0x12e610(0x3e6));const _0x3ebcd0=$(_0x12e610(0x41e));if(_0x3ebcd0)_0x3ebcd0[_0x12e610(0x342)]=formatMMSS(this['remaining']);if(this[_0x12e610(0x1f9)]!==_0x12e610(0x378))try{$(_0x12e610(0x208))['classList'][_0x12e610(0x27e)](_0x12e610(0x2ee)),$(_0x12e610(0x3d4))[_0x12e610(0x39e)][_0x12e610(0x27e)](_0x12e610(0x2ee));}catch(_0x1c2026){}},'persistTimerState'(_0x228b90=![]){const _0x1dbe3e=_0x3be7fc;try{const _0x5b1f49=getCurrentSubtopic();if(!_0x5b1f49)return;const _0x2a85cd={'state':this[_0x1dbe3e(0x1f9)],'prevState':this[_0x1dbe3e(0x490)],'remaining':this[_0x1dbe3e(0x359)],'segmentTotal':this[_0x1dbe3e(0x2ff)],'cycleIndex':this[_0x1dbe3e(0x1a6)]};_0x5b1f49[_0x1dbe3e(0x278)]=_0x2a85cd;try{localStorage['setItem'](_0x1dbe3e(0x311)+_0x5b1f49['id'],JSON[_0x1dbe3e(0x225)](_0x2a85cd));}catch(_0x27cfcc){}this['lastPersist']=Date[_0x1dbe3e(0x3e5)]();}catch(_0x511a00){}},'_startTick'(){const _0x3e3f03=_0x3be7fc;if(this['tickHandle'])clearInterval(this['tickHandle']);if(this['mode']==='C'&&this[_0x3e3f03(0x1f9)]===_0x3e3f03(0x3e6)){this[_0x3e3f03(0x3d8)]=setInterval(()=>{const _0x13a3bc=_0x3e3f03;this[_0x13a3bc(0x359)]+=0x1,this['updateUI'](),this[_0x13a3bc(0x1d8)]();},0x3e8);return;}this[_0x3e3f03(0x3d8)]=setInterval(()=>{const _0x365bf5=_0x3e3f03;this[_0x365bf5(0x359)]>0x0&&(this[_0x365bf5(0x359)]-=0x1,this['updateUI'](),this[_0x365bf5(0x1d8)]()),this[_0x365bf5(0x359)]<=0x0&&(clearInterval(this[_0x365bf5(0x3d8)]),this['tickHandle']=null,this['_onFinishSegment']());},0x3e8);},'_onFinishSegment'(){const _0x2f33ee=_0x3be7fc;if(this['state']===_0x2f33ee(0x3e6)){const _0x2ca866=getCurrentSubtopic();if(_0x2ca866){const _0x36a54c=this[_0x2f33ee(0x370)]()['work'];_0x2ca866[_0x2f33ee(0x3dd)][_0x2f33ee(0x244)]=(_0x2ca866[_0x2f33ee(0x3dd)][_0x2f33ee(0x244)]||0x0)+_0x36a54c,_0x2ca866[_0x2f33ee(0x3dd)][_0x2f33ee(0x1b4)]=(_0x2ca866['stats'][_0x2f33ee(0x1b4)]||0x0)+0x1;const _0xd21eaf={'id':uid(_0x2f33ee(0x440)),'dateISO':todayISO(),'durationMinutes':_0x36a54c,'mode':this['mode'],'note':''};if(!_0x2ca866[_0x2f33ee(0x1e7)])_0x2ca866['sessions']=[];_0x2ca866[_0x2f33ee(0x1e7)][_0x2f33ee(0x484)](_0xd21eaf);if(data?.[_0x2f33ee(0x48d)]?.[_0x2f33ee(0x29a)])try{openNoteModal(_0xd21eaf['id']);}catch(_0x3d4bea){}saveData(),renderStatsHistory(),checkAndShowMilestones();}this[_0x2f33ee(0x1a6)]++;}if(typeof data!=='undefined'&&data&&data[_0x2f33ee(0x48d)]&&data[_0x2f33ee(0x48d)][_0x2f33ee(0x1ac)]===![]&&this[_0x2f33ee(0x1f9)]===_0x2f33ee(0x3e6))playSound(_0x2f33ee(0x386));else(this[_0x2f33ee(0x1f9)]===_0x2f33ee(0x378)||this[_0x2f33ee(0x1f9)]===_0x2f33ee(0x339)||this[_0x2f33ee(0x1f9)]==='long_break')&&playSound(_0x2f33ee(0x3ba));const _0x237f44=$(_0x2f33ee(0x3a7));if(_0x237f44)_0x237f44[_0x2f33ee(0x39e)][_0x2f33ee(0x27e)](_0x2f33ee(0x309));if(data[_0x2f33ee(0x48d)]['autoStartNext']){if(this[_0x2f33ee(0x1f9)]==='work')data[_0x2f33ee(0x48d)][_0x2f33ee(0x1ac)]===![]?this['beginBreak']():this[_0x2f33ee(0x427)]();else this[_0x2f33ee(0x1f9)]==='wind_down'?this['beginBreak']():this[_0x2f33ee(0x2c1)]();}else this[_0x2f33ee(0x3d8)]&&(clearInterval(this[_0x2f33ee(0x3d8)]),this[_0x2f33ee(0x3d8)]=null),this[_0x2f33ee(0x1f9)]=_0x2f33ee(0x323),this[_0x2f33ee(0x490)]=null,this[_0x2f33ee(0x398)](),toast(_0x2f33ee(0x460));},'beginWindDown'(){const _0x30e261=_0x3be7fc;if(data?.[_0x30e261(0x48d)]?.[_0x30e261(0x1ac)]===![]){this['beginBreak']();return;}this[_0x30e261(0x490)]=this['state'],this[_0x30e261(0x1f9)]=_0x30e261(0x378);const _0x477511=(this['currentDurations']()[_0x30e261(0x321)]||0x0)*0x3c;if(_0x477511<=0x0){this['beginBreak']();return;}this[_0x30e261(0x2ff)]=_0x477511,this['remaining']=_0x477511;try{playSound('break_end');}catch(_0x25407a){}try{toast('Time\x20to\x20wind\x20down.\x20Please\x20wrap\x20up\x20and\x20prepare\x20to\x20rest.');}catch(_0x51942a){}this[_0x30e261(0x44e)](),this['updateUI']();},'beginWork'(){const _0x3a0ca6=_0x3be7fc;this[_0x3a0ca6(0x490)]=this[_0x3a0ca6(0x1f9)],this['state']=_0x3a0ca6(0x3e6);if(this[_0x3a0ca6(0x211)]==='C'){this[_0x3a0ca6(0x2ff)]=0x0;if(this[_0x3a0ca6(0x490)]!==_0x3a0ca6(0x2d8))this[_0x3a0ca6(0x359)]=0x0;}else{const _0x1e17db=this['currentDurations']()[_0x3a0ca6(0x3e6)]*0x3c;this[_0x3a0ca6(0x2ff)]=_0x1e17db;if(this['prevState']!==_0x3a0ca6(0x2d8))this[_0x3a0ca6(0x359)]=_0x1e17db;}const _0x1811c6=$(_0x3a0ca6(0x249));_0x1811c6&&(_0x1811c6[_0x3a0ca6(0x342)]=''),this[_0x3a0ca6(0x44e)](),this['updateUI']();},'finishFlowSession'(){const _0x51afa6=_0x3be7fc;if(this[_0x51afa6(0x211)]!=='C'||this[_0x51afa6(0x1f9)]!=='work')return;this[_0x51afa6(0x3d8)]&&(clearInterval(this['tickHandle']),this['tickHandle']=null);const _0x4e5cf1=Math['max'](0x1,parseInt(data['settings'][_0x51afa6(0x48b)]??0x5,0xa)),_0x4c55bd=Math['max'](0x0,this[_0x51afa6(0x359)]|0x0),_0x2c599e=Math[_0x51afa6(0x36e)](0x3c,Math['floor'](_0x4c55bd/_0x4e5cf1));try{const _0x26d444=getCurrentSubtopic();if(_0x26d444){const _0x3ed431=Math[_0x51afa6(0x36e)](0x1,Math[_0x51afa6(0x28d)](_0x4c55bd/0x3c));_0x26d444[_0x51afa6(0x3dd)][_0x51afa6(0x244)]=(_0x26d444[_0x51afa6(0x3dd)][_0x51afa6(0x244)]||0x0)+_0x3ed431,_0x26d444[_0x51afa6(0x3dd)]['sessionsCompleted']=(_0x26d444[_0x51afa6(0x3dd)][_0x51afa6(0x1b4)]||0x0)+0x1;const _0x2df593={'id':uid(_0x51afa6(0x440)),'dateISO':todayISO(),'durationMinutes':_0x3ed431,'mode':this['mode'],'note':''};if(!_0x26d444[_0x51afa6(0x1e7)])_0x26d444['sessions']=[];_0x26d444['sessions']['unshift'](_0x2df593),saveData(),renderStatsHistory(),data?.[_0x51afa6(0x48d)]?.['enableSessionNotes']&&openNoteModal(_0x2df593['id']);}}catch(_0xff2540){}this[_0x51afa6(0x1f9)]=_0x51afa6(0x339),this[_0x51afa6(0x2ff)]=_0x2c599e,this['remaining']=_0x2c599e,this[_0x51afa6(0x44e)](),this[_0x51afa6(0x398)](),this[_0x51afa6(0x1d8)](!![]);try{toast('Break\x20'+Math[_0x51afa6(0x28d)](_0x2c599e/0x3c)+_0x51afa6(0x270)+_0x4e5cf1+').');}catch(_0x3c1dc3){}},'beginBreak'(){const _0x5f2f5c=_0x3be7fc;this[_0x5f2f5c(0x490)]=this['state'];const _0x3a4c42=this[_0x5f2f5c(0x23b)](),_0x157afb=this['currentDurations']();if(this[_0x5f2f5c(0x1a6)]>0x0&&this[_0x5f2f5c(0x1a6)]%_0x3a4c42[_0x5f2f5c(0x27b)]===0x0){this[_0x5f2f5c(0x1f9)]=_0x5f2f5c(0x2c9);const _0x506a91=_0x157afb[_0x5f2f5c(0x377)]*0x3c;this[_0x5f2f5c(0x2ff)]=_0x506a91;if(this[_0x5f2f5c(0x490)]!==_0x5f2f5c(0x2d8))this[_0x5f2f5c(0x359)]=_0x506a91;toast(_0x5f2f5c(0x31f));}else{this[_0x5f2f5c(0x1f9)]=_0x5f2f5c(0x339);const _0x1da007=_0x157afb[_0x5f2f5c(0x439)]*0x3c;this[_0x5f2f5c(0x2ff)]=_0x1da007;if(this['prevState']!=='paused')this[_0x5f2f5c(0x359)]=_0x1da007;}const _0x118a24=$(_0x5f2f5c(0x249));if(_0x118a24){const _0x1ee4d9=Math[_0x5f2f5c(0x1a9)](Math['random']()*breakSuggestions[_0x5f2f5c(0x49f)]);_0x118a24[_0x5f2f5c(0x342)]=_0x5f2f5c(0x448)+breakSuggestions[_0x1ee4d9];}this[_0x5f2f5c(0x44e)](),this[_0x5f2f5c(0x398)]();},async 'start'(){const _0x53aedf=_0x3be7fc;if(!getCurrentSubtopic()){toast(_0x53aedf(0x420));return;}ensureAudio();if(this[_0x53aedf(0x211)]==='C'&&this[_0x53aedf(0x1f9)]===_0x53aedf(0x323))this[_0x53aedf(0x1f9)]=_0x53aedf(0x3e6),this[_0x53aedf(0x359)]=0x0,this[_0x53aedf(0x2ff)]=0x0,this[_0x53aedf(0x1a6)]=0x0,this[_0x53aedf(0x44e)](),this[_0x53aedf(0x398)]();else{if(this['state']==='idle')this[_0x53aedf(0x1a6)]=this['cycleIndex']||0x0,this['beginWork']();else this[_0x53aedf(0x1f9)]===_0x53aedf(0x2d8)&&this[_0x53aedf(0x480)]();}await this[_0x53aedf(0x1d8)](!![]);},async 'pause'(){const _0x2cab16=_0x3be7fc;this['tickHandle']&&(clearInterval(this[_0x2cab16(0x3d8)]),this[_0x2cab16(0x3d8)]=null),this[_0x2cab16(0x490)]=this[_0x2cab16(0x1f9)],this[_0x2cab16(0x1f9)]='paused',this['updateUI'](),await this[_0x2cab16(0x1d8)](!![]);},async 'resume'(){const _0x1c8337=_0x3be7fc;if(this[_0x1c8337(0x1f9)]!==_0x1c8337(0x2d8))return;this[_0x1c8337(0x1f9)]=this[_0x1c8337(0x490)]||'work',this[_0x1c8337(0x44e)](),this[_0x1c8337(0x398)](),await this[_0x1c8337(0x1d8)](!![]);},async 'skip'(){const _0x42192d=_0x3be7fc;if(this['mode']==='C'&&this[_0x42192d(0x1f9)]===_0x42192d(0x3e6)){this['finishFlowSession'](),await this[_0x42192d(0x1d8)](!![]);return;}this[_0x42192d(0x1f9)]==='work'?(this[_0x42192d(0x3d8)]&&(clearInterval(this[_0x42192d(0x3d8)]),this[_0x42192d(0x3d8)]=null),this[_0x42192d(0x359)]=0x0,this[_0x42192d(0x3b0)]()):(this[_0x42192d(0x359)]=0x0,this['tickHandle']&&(clearInterval(this['tickHandle']),this[_0x42192d(0x3d8)]=null),this[_0x42192d(0x3b0)]()),await this[_0x42192d(0x1d8)](!![]);},async 'reset'(){const _0x160949=_0x3be7fc;this[_0x160949(0x3d8)]&&(clearInterval(this[_0x160949(0x3d8)]),this[_0x160949(0x3d8)]=null);this['state']='idle',this[_0x160949(0x490)]=null,this['remaining']=0x0,this[_0x160949(0x2ff)]=0x0,this['cycleIndex']=0x0;const _0x1b4d3e=$('#breakSuggestionDisplay');_0x1b4d3e&&(_0x1b4d3e[_0x160949(0x342)]=''),this['updateUI'](),await this[_0x160949(0x1d8)](!![]);}};async function deleteSummary(_0x1bb03b){const _0x2ab96c=_0x3be7fc;showConfirmModal('Confirm\x20Deletion',_0x2ab96c(0x410),async _0x5f2490=>{const _0x3084de=_0x2ab96c;if(!_0x5f2490)return;const _0x505e29=getCurrentSubtopic();if(!_0x505e29||!_0x505e29[_0x3084de(0x1e3)])return;const _0x22fd85=[..._0x505e29[_0x3084de(0x1e3)]];_0x505e29[_0x3084de(0x1e3)]=_0x505e29['summaries'][_0x3084de(0x2b3)](_0x239a6b=>_0x239a6b['id']!==_0x1bb03b);try{await storageManager[_0x3084de(0x436)](_0x3084de(0x372),_0x505e29),renderSummaries(),toast('Summary\x20deleted.');}catch(_0x392acf){console[_0x3084de(0x292)](_0x3084de(0x467),_0x392acf),_0x505e29[_0x3084de(0x1e3)]=_0x22fd85,toast(_0x3084de(0x3a0));}});}function exportSummary(_0x2d701c){const _0x1a6bf5=_0x3be7fc,_0xf44a31=new Blob([_0x2d701c[_0x1a6bf5(0x41d)]],{'type':_0x1a6bf5(0x2cb)}),_0x4ed53e=document['createElement']('a'),_0x551c53=new Date(_0x2d701c['createdAt']),_0x1a5b50=_0x4d13c1=>(''+_0x4d13c1)[_0x1a6bf5(0x1fc)](0x2,'0');_0x4ed53e[_0x1a6bf5(0x464)]=URL['createObjectURL'](_0xf44a31),_0x4ed53e[_0x1a6bf5(0x266)]='summary_'+_0x551c53[_0x1a6bf5(0x2ce)]()+_0x1a5b50(_0x551c53[_0x1a6bf5(0x424)]()+0x1)+_0x1a5b50(_0x551c53[_0x1a6bf5(0x233)]())+_0x1a6bf5(0x1eb),_0x4ed53e[_0x1a6bf5(0x363)](),URL[_0x1a6bf5(0x33c)](_0x4ed53e[_0x1a6bf5(0x464)]);}function renderStatsHistory(){const _0x2d3391=_0x3be7fc,_0x1d7139=getCurrentSubtopic(),_0x1ace2c=$(_0x2d3391(0x1f8)),_0x28bfdd=$('#statSessions'),_0x30bdeb=$(_0x2d3391(0x2fd)),_0x14da94=$('#historyList');if(!_0x1ace2c||!_0x28bfdd||!_0x30bdeb||!_0x14da94)return;if(!_0x1d7139){_0x1ace2c[_0x2d3391(0x342)]=_0x2d3391(0x222),_0x28bfdd['textContent']='0',_0x30bdeb[_0x2d3391(0x342)]='0',_0x14da94[_0x2d3391(0x28b)]='<div\x20class=\x22tiny\x22>No\x20data\x20yet</div>';return;}const _0x2f89bb=_0x1d7139[_0x2d3391(0x3dd)]&&_0x1d7139[_0x2d3391(0x3dd)][_0x2d3391(0x244)]?_0x1d7139['stats']['totalMinutes']:0x0,_0x288c1a=_0x1d7139[_0x2d3391(0x3dd)]&&_0x1d7139[_0x2d3391(0x3dd)][_0x2d3391(0x1b4)]?_0x1d7139[_0x2d3391(0x3dd)][_0x2d3391(0x1b4)]:0x0,_0x2db721=_0x1d7139['tasks']?_0x1d7139[_0x2d3391(0x302)][_0x2d3391(0x2b3)](_0x32b50b=>_0x32b50b[_0x2d3391(0x44a)])[_0x2d3391(0x49f)]:0x0;_0x1ace2c[_0x2d3391(0x342)]=formatDaysHoursMinutes(_0x2f89bb),_0x28bfdd['textContent']=String(_0x288c1a),_0x30bdeb[_0x2d3391(0x342)]=String(_0x2db721),_0x14da94['innerHTML']='';const _0x332e80=Array[_0x2d3391(0x265)](_0x1d7139[_0x2d3391(0x1e7)])?_0x1d7139[_0x2d3391(0x1e7)]:[];if(_0x332e80[_0x2d3391(0x49f)]===0x0){_0x14da94[_0x2d3391(0x28b)]=_0x2d3391(0x1e2);return;}_0x332e80[_0x2d3391(0x2d6)](_0x43dea9=>{const _0x2c4658=_0x2d3391,_0x24b57f=document[_0x2c4658(0x1ce)](_0x2c4658(0x422));_0x24b57f[_0x2c4658(0x25b)]=_0x2c4658(0x32b);const _0x8e1b88=document[_0x2c4658(0x1ce)](_0x2c4658(0x422)),_0xdb5c37=_0x43dea9['dateISO']?new Date(_0x43dea9[_0x2c4658(0x235)]):new Date(),_0x25ad4f=_0x43dea9[_0x2c4658(0x271)]!=null?_0x43dea9[_0x2c4658(0x271)]:_0x43dea9[_0x2c4658(0x326)]||0x0,_0x2be387='<div\x20class=\x22hist-meta\x22>'+_0xdb5c37['toLocaleString']()+'\x20·\x20'+_0x25ad4f+_0x2c4658(0x401)+(_0x43dea9[_0x2c4658(0x211)]||'')+_0x2c4658(0x218);let _0x43c193='';if(_0x43dea9[_0x2c4658(0x45f)])_0x43c193='<div>'+escapeHTML(_0x43dea9['note'])+'</div>';else data?.[_0x2c4658(0x48d)]?.[_0x2c4658(0x29a)]&&(_0x43c193=_0x2c4658(0x281));_0x8e1b88[_0x2c4658(0x28b)]=_0x2be387+_0x43c193,_0x24b57f[_0x2c4658(0x253)](_0x8e1b88),_0x14da94[_0x2c4658(0x253)](_0x24b57f);});}function renderGeneralNotes(){const _0x395192=_0x3be7fc,_0x298c5a=$(_0x395192(0x45d));if(!_0x298c5a)return;const _0x2c3b1d=getCurrentSubtopic();if(!_0x2c3b1d){_0x298c5a[_0x395192(0x28b)]=_0x395192(0x25f);return;}_0x2c3b1d[_0x395192(0x201)]=_0x2c3b1d[_0x395192(0x201)]||[];if(_0x2c3b1d[_0x395192(0x201)][_0x395192(0x49f)]===0x0){_0x298c5a['innerHTML']=_0x395192(0x365);return;}_0x298c5a[_0x395192(0x28b)]='',_0x2c3b1d['generalNotes'][_0x395192(0x2d6)](_0x5172c3=>{const _0x131995=_0x395192,_0x22fad9=document['createElement'](_0x131995(0x422));_0x22fad9[_0x131995(0x25b)]='note-item';const _0x96ebca=document['createElement']('div');_0x96ebca[_0x131995(0x25b)]='note-content',_0x96ebca[_0x131995(0x342)]=typeof _0x5172c3===_0x131995(0x22c)?_0x5172c3:_0x5172c3[_0x131995(0x430)]||'';const _0x1cc0ed=document[_0x131995(0x1ce)](_0x131995(0x422));_0x1cc0ed[_0x131995(0x25b)]=_0x131995(0x388),_0x1cc0ed['textContent']=_0x5172c3[_0x131995(0x1ff)]?new Date(_0x5172c3[_0x131995(0x1ff)])[_0x131995(0x3cf)]():'';const _0x4b7a12=document[_0x131995(0x1ce)](_0x131995(0x422)),_0x1defee=document['createElement'](_0x131995(0x2ad));_0x1defee['className']=_0x131995(0x24a),_0x1defee[_0x131995(0x342)]=_0x131995(0x261),_0x1defee['onclick']=async _0x1f142c=>{const _0x2423de=_0x131995;_0x1f142c['stopPropagation']();const _0x4ad7d2=getCurrentSubtopic();if(!_0x4ad7d2)return;_0x4ad7d2[_0x2423de(0x201)]=(_0x4ad7d2[_0x2423de(0x201)]||[])[_0x2423de(0x2b3)](_0x619764=>(_0x619764['id']||_0x619764)!==(_0x5172c3['id']||_0x5172c3)),await saveData(),renderGeneralNotes();},_0x4b7a12[_0x131995(0x253)](_0x1defee);const _0x3fb8a7=document[_0x131995(0x1ce)](_0x131995(0x422));_0x3fb8a7['className']=_0x131995(0x408),_0x3fb8a7['append'](_0x96ebca,_0x1cc0ed),_0x22fad9['append'](_0x3fb8a7,_0x4b7a12),_0x298c5a[_0x131995(0x253)](_0x22fad9);});}function renderMethods(){const _0x965355=_0x3be7fc,_0x2d311e=document[_0x965355(0x3ed)]('#view-methods\x20.methods-container');if(!_0x2d311e)return;_0x2d311e[_0x965355(0x28b)]='';const _0x3eea06=data?.[_0x965355(0x48d)]?.[_0x965355(0x462)]||[];if(_0x3eea06[_0x965355(0x49f)]===0x0){_0x2d311e['innerHTML']=_0x965355(0x21d);return;}_0x3eea06['forEach'](_0x41a7a1=>{const _0x41de87=_0x965355,_0x94444e=document[_0x41de87(0x1ce)](_0x41de87(0x2e2));_0x94444e[_0x41de87(0x25b)]=_0x41de87(0x4a8),_0x94444e['dataset']['methodId']=_0x41a7a1['id'];const _0x3e02a7=document['createElement'](_0x41de87(0x226)),_0x40cdec=document['createElement']('span');_0x40cdec[_0x41de87(0x25b)]=_0x41de87(0x24d),_0x40cdec['textContent']=_0x41a7a1[_0x41de87(0x3f7)]||'Untitled',_0x40cdec['addEventListener'](_0x41de87(0x363),_0x2c6772=>{const _0x654fae=_0x41de87;_0x2c6772['preventDefault'](),_0x2c6772['stopPropagation'](),_0x94444e[_0x654fae(0x32c)]=!_0x94444e[_0x654fae(0x32c)];});const _0x4175e2=document[_0x41de87(0x1ce)](_0x41de87(0x422));_0x4175e2[_0x41de87(0x25b)]=_0x41de87(0x262);const _0x3d9422=document['createElement'](_0x41de87(0x2ad));_0x3d9422[_0x41de87(0x25b)]='btn\x20small\x20ghost\x20method-edit',_0x3d9422[_0x41de87(0x342)]=_0x41de87(0x1e1),_0x3d9422['dataset']['id']=_0x41a7a1['id'];const _0x2070a6=document[_0x41de87(0x1ce)](_0x41de87(0x2ad));_0x2070a6[_0x41de87(0x25b)]=_0x41de87(0x1f4),_0x2070a6[_0x41de87(0x342)]='Delete',_0x2070a6[_0x41de87(0x485)]['id']=_0x41a7a1['id'],_0x4175e2[_0x41de87(0x38f)](_0x3d9422,_0x2070a6),_0x3e02a7['append'](_0x40cdec,_0x4175e2);const _0x1e536c=document[_0x41de87(0x1ce)](_0x41de87(0x422));_0x1e536c[_0x41de87(0x25b)]=_0x41de87(0x1d6),_0x1e536c[_0x41de87(0x28b)]=_0x41a7a1['content']||'',_0x94444e[_0x41de87(0x38f)](_0x3e02a7,_0x1e536c),_0x2d311e['appendChild'](_0x94444e),_0x94444e['addEventListener'](_0x41de87(0x363),_0x396324=>{const _0x119616=_0x41de87,_0x1e1578=_0x396324[_0x119616(0x35a)];if(!_0x1e1578)return;if(_0x1e1578[_0x119616(0x239)](_0x119616(0x2ad))||_0x1e1578[_0x119616(0x239)]('a')||_0x1e1578[_0x119616(0x239)]('.color-picker-wrapper')||_0x1e1578[_0x119616(0x239)](_0x119616(0x3dc)))return;if(!_0x94444e[_0x119616(0x32c)])_0x94444e['open']=!![];});});const _0x30de50=_0x2d311e[_0x965355(0x2bc)](_0x965355(0x1b7));_0x30de50['forEach'](_0x1b5533=>{const _0x41c54d=_0x965355;_0x1b5533[_0x41c54d(0x2bd)](_0x41c54d(0x402),()=>{const _0x2d5219=_0x41c54d;_0x1b5533[_0x2d5219(0x32c)]&&_0x30de50['forEach'](_0x339f05=>{const _0x3a4ea4=_0x2d5219;if(_0x339f05!==_0x1b5533)_0x339f05[_0x3a4ea4(0x32c)]=![];});});});}function addGeneralNote(){const _0x4b7c08=_0x3be7fc;showInputModal(_0x4b7c08(0x47e),async _0x3ca376=>{const _0x1c57d3=_0x4b7c08;if(!_0x3ca376)return;const _0x115144=getCurrentSubtopic();if(!_0x115144){toast(_0x1c57d3(0x24b));return;}_0x115144[_0x1c57d3(0x201)]=_0x115144[_0x1c57d3(0x201)]||[],_0x115144[_0x1c57d3(0x201)][_0x1c57d3(0x484)]({'id':uid('gn'),'text':_0x3ca376,'createdAt':todayISO()}),await saveData(),renderGeneralNotes();},'');}async function summarizeNotes(){const _0x4816db=_0x3be7fc,_0x2415ef=getCurrentSubtopic();if(!_0x2415ef){toast('Please\x20select\x20a\x20subtopic\x20first.');return;}const _0x32da15=(_0x2415ef[_0x4816db(0x201)]||[])[_0x4816db(0x2eb)](_0x5cb701=>typeof _0x5cb701==='string'?_0x5cb701:_0x5cb701[_0x4816db(0x430)]||'')[_0x4816db(0x2b3)](Boolean);if(_0x32da15[_0x4816db(0x49f)]===0x0){toast('No\x20notes\x20to\x20summarize.');return;}const _0x44e6e2=$(_0x4816db(0x1cd));_0x44e6e2&&(_0x44e6e2[_0x4816db(0x2dc)]=!![],_0x44e6e2[_0x4816db(0x28b)]=_0x4816db(0x415));try{const _0x228d67='Summarize\x20the\x20following\x20notes\x20as\x20concise,\x20clear\x20bullet\x20points:\x0a\x0a'+_0x32da15['join'](_0x4816db(0x4a9)),_0x215ff8=await callGeminiAPI(_0x228d67);if(!_0x2415ef[_0x4816db(0x1e3)])_0x2415ef[_0x4816db(0x1e3)]=[];_0x2415ef[_0x4816db(0x1e3)]['unshift']({'id':uid(_0x4816db(0x4a2)),'content':_0x215ff8||_0x4816db(0x3ac),'createdAt':todayISO()}),await saveData(),renderSummaries();}catch(_0x504639){console[_0x4816db(0x292)](_0x504639),toast(_0x4816db(0x289));}finally{_0x44e6e2&&(_0x44e6e2[_0x4816db(0x2dc)]=![],_0x44e6e2['textContent']=_0x4816db(0x400));}}function renderSummaries(){const _0x437593=_0x3be7fc,_0x143437=$('#summariesList');if(!_0x143437)return;const _0x3de024=getCurrentSubtopic();if(!_0x3de024){_0x143437[_0x437593(0x28b)]=_0x437593(0x1bf);return;}_0x143437[_0x437593(0x28b)]='';if(!_0x3de024[_0x437593(0x1e3)]||_0x3de024['summaries'][_0x437593(0x49f)]===0x0){_0x143437[_0x437593(0x28b)]=_0x437593(0x33a);return;}_0x3de024['summaries'][_0x437593(0x2d6)](_0x4269c6=>{const _0x45757f=_0x437593,_0x28d379=document[_0x45757f(0x1ce)](_0x45757f(0x422));_0x28d379[_0x45757f(0x25b)]='note-item';const _0x723a51=document[_0x45757f(0x1ce)]('div');_0x723a51[_0x45757f(0x25b)]=_0x45757f(0x408);const _0x5c1498=document['createElement'](_0x45757f(0x422));_0x5c1498[_0x45757f(0x25b)]='note-content',_0x5c1498[_0x45757f(0x342)]=_0x4269c6[_0x45757f(0x41d)];const _0x3e50ef=document[_0x45757f(0x1ce)](_0x45757f(0x422));_0x3e50ef[_0x45757f(0x25b)]='note-meta',_0x3e50ef['textContent']=new Date(_0x4269c6['createdAt'])[_0x45757f(0x3cf)](),_0x723a51[_0x45757f(0x38f)](_0x5c1498,_0x3e50ef);const _0x569da6=document[_0x45757f(0x1ce)](_0x45757f(0x422)),_0x36235a=document[_0x45757f(0x1ce)](_0x45757f(0x2ad));_0x36235a[_0x45757f(0x25b)]=_0x45757f(0x257),_0x36235a[_0x45757f(0x342)]=_0x45757f(0x3be),_0x36235a[_0x45757f(0x276)]=_0x1b3910=>{const _0x24c19a=_0x45757f;_0x1b3910[_0x24c19a(0x22f)](),exportSummary(_0x4269c6);};const _0x30303c=document[_0x45757f(0x1ce)](_0x45757f(0x2ad));_0x30303c[_0x45757f(0x25b)]=_0x45757f(0x24a),_0x30303c[_0x45757f(0x342)]='Delete',_0x30303c[_0x45757f(0x276)]=_0x17b200=>{_0x17b200['stopPropagation'](),deleteSummary(_0x4269c6['id']);},_0x569da6['append'](_0x36235a,_0x30303c),_0x28d379['append'](_0x723a51,_0x569da6),_0x28d379['addEventListener']('click',()=>_0x5c1498[_0x45757f(0x39e)][_0x45757f(0x402)](_0x45757f(0x2c5))),_0x143437['appendChild'](_0x28d379);});}function loadEditingPresetFields(){const _0x2bb7a2=_0x3be7fc,_0x5b622d=data['settings'],_0x1a3bc5=_0x5b622d[_0x2bb7a2(0x1a4)],_0x446fba=$(_0x2bb7a2(0x2f1)),_0x371b93=$(_0x2bb7a2(0x2aa));if(_0x446fba&&_0x371b93){const _0x25bc0e=editingPreset==='C';_0x446fba[_0x2bb7a2(0x39e)][_0x2bb7a2(0x402)](_0x2bb7a2(0x2ee),_0x25bc0e),_0x371b93[_0x2bb7a2(0x39e)][_0x2bb7a2(0x402)]('hidden',!_0x25bc0e);}if(editingPreset==='A'){$(_0x2bb7a2(0x269))[_0x2bb7a2(0x451)]=_0x1a3bc5[_0x2bb7a2(0x2f3)];if($(_0x2bb7a2(0x2ba)))$(_0x2bb7a2(0x2ba))[_0x2bb7a2(0x451)]=_0x1a3bc5[_0x2bb7a2(0x37c)]??0x0;$(_0x2bb7a2(0x22e))[_0x2bb7a2(0x451)]=_0x1a3bc5['A_short'],$(_0x2bb7a2(0x479))['value']=_0x1a3bc5[_0x2bb7a2(0x432)],$(_0x2bb7a2(0x25d))['value']=_0x5b622d[_0x2bb7a2(0x29f)],$('#set_interval')[_0x2bb7a2(0x451)]=_0x5b622d[_0x2bb7a2(0x2d1)];}else{if(editingPreset==='B'){$('#set_work')['value']=_0x1a3bc5[_0x2bb7a2(0x487)];if($(_0x2bb7a2(0x2ba)))$('#set_winddown')[_0x2bb7a2(0x451)]=_0x1a3bc5[_0x2bb7a2(0x4b8)]??0x0;$('#set_short')[_0x2bb7a2(0x451)]=_0x1a3bc5[_0x2bb7a2(0x2d4)],$('#set_long')[_0x2bb7a2(0x451)]=_0x1a3bc5[_0x2bb7a2(0x380)],$(_0x2bb7a2(0x25d))[_0x2bb7a2(0x451)]=_0x5b622d[_0x2bb7a2(0x42e)],$('#set_interval')[_0x2bb7a2(0x451)]=_0x5b622d['longBreakIntervalB'];}else{if(editingPreset==='C'){const _0x3dffbd=$(_0x2bb7a2(0x280));if(_0x3dffbd)_0x3dffbd[_0x2bb7a2(0x451)]=_0x5b622d['flowtimeBreakRatio']??0x5;}}}}function highlightPresetSelector(){const _0x2eafdb=_0x3be7fc;$$(_0x2eafdb(0x3b5))[_0x2eafdb(0x2d6)](_0x48245b=>{const _0x3aa909=_0x2eafdb,_0x200d16=_0x48245b['dataset']['presetTarget']===editingPreset;_0x48245b['classList']['toggle']('acc',_0x200d16),_0x48245b[_0x3aa909(0x39e)][_0x3aa909(0x402)](_0x3aa909(0x20c),!_0x200d16);});}function openSettings(){const _0x26914d=_0x3be7fc,_0x5d028e=data['settings'];editingPreset=_0x5d028e[_0x26914d(0x352)],$('#set_apiKey')[_0x26914d(0x451)]=_0x5d028e['apiKey']||'',loadEditingPresetFields(),highlightPresetSelector(),$(_0x26914d(0x250))[_0x26914d(0x451)]=_0x5d028e[_0x26914d(0x46d)]??0.8,$('#set_theme')[_0x26914d(0x451)]=_0x5d028e[_0x26914d(0x317)]||'beep',$(_0x26914d(0x40c))['value']=_0x5d028e[_0x26914d(0x330)]||_0x26914d(0x242);const _0x262ce2=getActiveYoutubeUrl();$('#set_youtubeUrl')[_0x26914d(0x451)]=_0x262ce2||'';const _0xdc50e7=extractYouTubeID(_0x262ce2);$(_0x26914d(0x4ad))[_0x26914d(0x2dc)]=!_0xdc50e7;$(_0x26914d(0x275))&&($(_0x26914d(0x275))[_0x26914d(0x342)]='');$(_0x26914d(0x3f1))[_0x26914d(0x451)]=_0x5d028e['youtubeVolume']||0x50,$(_0x26914d(0x20d))[_0x26914d(0x425)]=!!_0x5d028e[_0x26914d(0x4a6)],$('#set_panelOpacity')[_0x26914d(0x451)]=_0x5d028e['panelOpacity']||0.85;$('#set_backgroundMode')&&($(_0x26914d(0x1ba))[_0x26914d(0x451)]=_0x5d028e['backgroundMode']||'cover');$(_0x26914d(0x1ca))&&($('#set_autoStartNext')[_0x26914d(0x425)]=!!_0x5d028e[_0x26914d(0x371)]);$(_0x26914d(0x49c))&&($(_0x26914d(0x49c))[_0x26914d(0x425)]=_0x5d028e['enableWinddown']!==![]);$(_0x26914d(0x315))&&($(_0x26914d(0x315))['checked']=!!_0x5d028e[_0x26914d(0x29a)]);$(_0x26914d(0x26c))&&($(_0x26914d(0x26c))['value']=_0x5d028e[_0x26914d(0x1e6)]||0x7);const _0x24fbe7=$(_0x26914d(0x1a3));_0x24fbe7&&storageManager['getBackupList']()['then'](_0x491831=>{const _0x5f28d2=_0x26914d;_0x24fbe7[_0x5f28d2(0x28b)]='<option\x20value=\x22\x22>--\x20Select\x20a\x20date\x20to\x20restore\x20--</option>',_0x491831&&_0x491831['length']>0x0?_0x491831[_0x5f28d2(0x2d6)](_0x79eb2f=>{const _0x38fe7e=_0x5f28d2,_0x21f5a9=document[_0x38fe7e(0x1ce)]('option');_0x21f5a9['value']=_0x79eb2f[_0x38fe7e(0x214)],_0x21f5a9[_0x38fe7e(0x342)]='Backup\x20from:\x20'+new Date(_0x79eb2f[_0x38fe7e(0x214)])['toLocaleDateString'](_0x38fe7e(0x312)),_0x24fbe7[_0x38fe7e(0x253)](_0x21f5a9);}):_0x24fbe7[_0x5f28d2(0x28b)]=_0x5f28d2(0x324);});$('#modalSettings')[_0x26914d(0x39e)][_0x26914d(0x27e)](_0x26914d(0x369));try{trapFocus($(_0x26914d(0x33f)));}catch(_0xc63b28){}}function closeSettings(){const _0x569a8f=_0x3be7fc;$(_0x569a8f(0x33f))[_0x569a8f(0x39e)][_0x569a8f(0x1ef)](_0x569a8f(0x369));try{releaseFocus();}catch(_0x42b55d){}}async function setDefaults(){const _0x3133fb=_0x3be7fc;data[_0x3133fb(0x48d)][_0x3133fb(0x1a4)]={'A_work':0x19,'A_short':0x5,'A_long':0xf,'A_winddown':0x2,'B_work':0x32,'B_short':0xa,'B_long':0x1e,'B_winddown':0x5},data[_0x3133fb(0x48d)]['cyclesA']=0x4,data['settings'][_0x3133fb(0x2d1)]=0x4,data[_0x3133fb(0x48d)][_0x3133fb(0x42e)]=0x4,data[_0x3133fb(0x48d)]['longBreakIntervalB']=0x4,data[_0x3133fb(0x48d)][_0x3133fb(0x48b)]=0x5,data[_0x3133fb(0x48d)][_0x3133fb(0x352)]='A',data[_0x3133fb(0x48d)][_0x3133fb(0x46d)]=0.8,data['settings']['soundTheme']=_0x3133fb(0x3e8),await saveData(),openSettings(),toast(_0x3133fb(0x1be));}async function saveSettings(){const _0x4c9e81=_0x3be7fc,_0x4e5152=data[_0x4c9e81(0x48d)];_0x4e5152[_0x4c9e81(0x3fa)]=$(_0x4c9e81(0x30d))[_0x4c9e81(0x451)][_0x4c9e81(0x3d6)]();const _0x107fd9=_0x4e5152[_0x4c9e81(0x1a4)];if(editingPreset==='A')_0x107fd9[_0x4c9e81(0x2f3)]=clampInt($(_0x4c9e81(0x269))[_0x4c9e81(0x451)],0x1,0x3e7),_0x107fd9[_0x4c9e81(0x37c)]=clampInt($(_0x4c9e81(0x2ba))[_0x4c9e81(0x451)],0x0,0x3e7),_0x107fd9[_0x4c9e81(0x39c)]=clampInt($(_0x4c9e81(0x22e))['value'],0x1,0x3e7),_0x107fd9['A_long']=clampInt($(_0x4c9e81(0x479))[_0x4c9e81(0x451)],0x1,0x3e7),_0x4e5152[_0x4c9e81(0x29f)]=clampInt($('#set_cycles')['value'],0x1,0xc),_0x4e5152['longBreakIntervalA']=clampInt($(_0x4c9e81(0x498))[_0x4c9e81(0x451)],0x2,0xc);else{if(editingPreset==='B')_0x107fd9[_0x4c9e81(0x487)]=clampInt($(_0x4c9e81(0x269))['value'],0x1,0x3e7),_0x107fd9['B_winddown']=clampInt($('#set_winddown')['value'],0x0,0x3e7),_0x107fd9[_0x4c9e81(0x2d4)]=clampInt($(_0x4c9e81(0x22e))['value'],0x1,0x3e7),_0x107fd9[_0x4c9e81(0x380)]=clampInt($('#set_long')[_0x4c9e81(0x451)],0x1,0x3e7),_0x4e5152[_0x4c9e81(0x42e)]=clampInt($(_0x4c9e81(0x25d))[_0x4c9e81(0x451)],0x1,0xc),_0x4e5152[_0x4c9e81(0x452)]=clampInt($(_0x4c9e81(0x498))[_0x4c9e81(0x451)],0x2,0xc);else{if(editingPreset==='C'){const _0x1cb967=$(_0x4c9e81(0x280));if(_0x1cb967)_0x4e5152['flowtimeBreakRatio']=clampInt(_0x1cb967[_0x4c9e81(0x451)],0x1,0x14);}}}_0x4e5152[_0x4c9e81(0x46d)]=clampFloat($('#set_volume')['value'],0x0,0x1,0.8),_0x4e5152[_0x4c9e81(0x317)]=$(_0x4c9e81(0x3ab))['value']===_0x4c9e81(0x453)?_0x4c9e81(0x453):_0x4c9e81(0x3e8),_0x4e5152[_0x4c9e81(0x330)]=$(_0x4c9e81(0x40c))['value'],_0x4e5152[_0x4c9e81(0x343)]=parseFloat($(_0x4c9e81(0x3e2))[_0x4c9e81(0x451)])||0.85;$(_0x4c9e81(0x1ba))&&(_0x4e5152[_0x4c9e81(0x38e)]=$(_0x4c9e81(0x1ba))[_0x4c9e81(0x451)]);_0x4e5152[_0x4c9e81(0x371)]=!!($(_0x4c9e81(0x1ca))&&$(_0x4c9e81(0x1ca))['checked']),_0x4e5152['enableWinddown']=!!($(_0x4c9e81(0x49c))&&$('#set_enableWinddown')[_0x4c9e81(0x425)]),_0x4e5152[_0x4c9e81(0x29a)]=!!($(_0x4c9e81(0x315))&&$(_0x4c9e81(0x315))[_0x4c9e81(0x425)]);$(_0x4c9e81(0x26c))&&(_0x4e5152[_0x4c9e81(0x1e6)]=clampInt($(_0x4c9e81(0x26c))[_0x4c9e81(0x451)],0x1,0x1e));_0x4e5152[_0x4c9e81(0x330)]==='light'||_0x4e5152[_0x4c9e81(0x330)]===_0x4c9e81(0x206)?(_0x4e5152[_0x4c9e81(0x4a6)]=![],typeof _0x4e5152[_0x4c9e81(0x1db)]===_0x4c9e81(0x22c)&&_0x4e5152[_0x4c9e81(0x1db)][_0x4c9e81(0x2ac)](_0x4c9e81(0x28e))&&(_0x4e5152[_0x4c9e81(0x1db)]='')):_0x4e5152[_0x4c9e81(0x4a6)]=!![];const _0x26f54f=$(_0x4c9e81(0x200))[_0x4c9e81(0x451)][_0x4c9e81(0x3d6)]();_0x4e5152['useYtThumbnailAsBg']=$(_0x4c9e81(0x20d))[_0x4c9e81(0x425)],_0x4e5152[_0x4c9e81(0x3c6)]=parseInt($('#ytSoundVolume')[_0x4c9e81(0x451)],0xa),sessionYoutubeUrl=_0x26f54f;try{if(!IS_FILE_PROTOCOL){if(ytPlayer&&ytPlayer['setVolume'])ytPlayer[_0x4c9e81(0x237)](_0x4e5152['youtubeVolume']);}else try{fallbackPostMessage(_0x4c9e81(0x237),[_0x4e5152[_0x4c9e81(0x3c6)]]);}catch(_0x36b744){}}catch(_0x9b6d64){}await saveData(),applyTheme(),applyCustomBg(),applyPanelOpacity(),updatePresetButtonsText(),timer[_0x4c9e81(0x36b)](_0x4e5152[_0x4c9e81(0x352)],{'silent':!![]}),closeSettings(),toast(_0x4c9e81(0x403));}function clampInt(_0x4486a7,_0x43bd22,_0x2767b5){const _0x34366e=_0x3be7fc;_0x4486a7=parseInt(_0x4486a7||0x0,0xa);if(isNaN(_0x4486a7))_0x4486a7=_0x43bd22;return Math[_0x34366e(0x36e)](_0x43bd22,Math[_0x34366e(0x40b)](_0x2767b5,_0x4486a7));}function clampFloat(_0x4ad56e,_0x519534,_0x2f0f60,_0x7d3b67){const _0xbae3ad=_0x3be7fc;_0x4ad56e=parseFloat(_0x4ad56e);if(Number[_0xbae3ad(0x1c0)](_0x4ad56e))_0x4ad56e=_0x7d3b67;return Math['max'](_0x519534,Math[_0xbae3ad(0x40b)](_0x2f0f60,_0x4ad56e));}const dbPromise=new Promise((_0x4fe392,_0x1f04f4)=>{const _0x102066=_0x3be7fc,_0x3da14c=indexedDB[_0x102066(0x32c)]('pomodoro_files',0x1);_0x3da14c['onupgradeneeded']=_0x2e5d00=>_0x2e5d00['target']['result']['createObjectStore'](_0x102066(0x3e9)),_0x3da14c[_0x102066(0x2ef)]=_0x30b4e6=>_0x4fe392(_0x30b4e6[_0x102066(0x35a)][_0x102066(0x2e3)]),_0x3da14c[_0x102066(0x1f5)]=_0x2e6b6a=>_0x1f04f4(_0x2e6b6a);}),fileCache={};function handleFileUpload(_0x4ff0fe,_0x215280){const _0x46619a=_0x3be7fc;if(!_0x4ff0fe)return;dbPromise[_0x46619a(0x409)](_0x15a787=>{const _0x5c81a7=_0x46619a,_0x2a7805=uid('file'),_0x26a865=_0x15a787[_0x5c81a7(0x27d)](_0x5c81a7(0x3e9),'readwrite');_0x26a865['objectStore'](_0x5c81a7(0x3e9))[_0x5c81a7(0x406)](_0x4ff0fe,_0x2a7805),_0x26a865['oncomplete']=()=>_0x215280(_0x2a7805),_0x26a865[_0x5c81a7(0x1f5)]=()=>toast(_0x5c81a7(0x205));});}function getStoredFileUrl(_0xb7a5ff){const _0x10e646=_0x3be7fc;if(!_0xb7a5ff)return Promise[_0x10e646(0x437)]('');if(fileCache[_0xb7a5ff])return Promise[_0x10e646(0x437)](fileCache[_0xb7a5ff]);return dbPromise[_0x10e646(0x409)](_0x205d6a=>new Promise(_0x3332f2=>{const _0x59b39a=_0x10e646,_0x294bf9=_0x205d6a[_0x59b39a(0x27d)](_0x59b39a(0x3e9),_0x59b39a(0x360)),_0x2eeeae=_0x294bf9[_0x59b39a(0x2d7)](_0x59b39a(0x3e9))['get'](_0xb7a5ff);_0x2eeeae[_0x59b39a(0x2ef)]=_0x1bb32c=>{const _0x4ed3e9=_0x59b39a,_0x2c2a2e=_0x1bb32c['target'][_0x4ed3e9(0x2e3)];if(_0x2c2a2e){const _0x1a3b94=URL['createObjectURL'](_0x2c2a2e);fileCache[_0xb7a5ff]=_0x1a3b94,_0x3332f2(_0x1a3b94);}else _0x3332f2('');},_0x2eeeae[_0x59b39a(0x1f5)]=()=>_0x3332f2('');}));}function applyCustomBg(){const _0x536e4b=_0x3be7fc,_0x543a11=data[_0x536e4b(0x48d)],_0x2cdf38=_0x543a11[_0x536e4b(0x1db)],_0x460c02=_0x543a11['theme'],_0x448176=[_0x536e4b(0x40f),'space']['includes'](_0x460c02),_0xb86fd2=_0x460c02===_0x536e4b(0x30b)||_0x460c02==='pastel',_0x252f7b=_0x543a11[_0x536e4b(0x38e)]||_0x536e4b(0x4a7);document[_0x536e4b(0x298)][_0x536e4b(0x43e)][_0x536e4b(0x1b5)]=_0x252f7b,document[_0x536e4b(0x298)][_0x536e4b(0x43e)][_0x536e4b(0x438)]=_0x252f7b===_0x536e4b(0x28f)?_0x536e4b(0x23e):_0x536e4b(0x1e8);const _0x2e9ff0=()=>{const _0x3d6b6f=_0x536e4b;try{document[_0x3d6b6f(0x298)][_0x3d6b6f(0x43e)][_0x3d6b6f(0x2d9)]='';}catch(_0x4cec81){}};if(_0x2cdf38){const _0x3bddfe=_0x2cdf38['startsWith'](_0x536e4b(0x2de))||_0x2cdf38[_0x536e4b(0x34a)](_0x536e4b(0x441))||_0x2cdf38['startsWith']('blob:')?Promise[_0x536e4b(0x437)](_0x2cdf38):getStoredFileUrl(_0x2cdf38);_0x3bddfe[_0x536e4b(0x409)](_0x15618b=>{const _0x4b2d33=_0x536e4b;_0x15618b?document[_0x4b2d33(0x298)]['style']['setProperty'](_0x4b2d33(0x411),_0x4b2d33(0x41a)+_0x15618b+')'):document[_0x4b2d33(0x298)][_0x4b2d33(0x43e)][_0x4b2d33(0x457)](_0x4b2d33(0x411),_0xb86fd2?_0x4b2d33(0x3fc):''),_0x2e9ff0();});}else!_0x448176?_0xb86fd2?(document['body'][_0x536e4b(0x43e)][_0x536e4b(0x457)](_0x536e4b(0x411),_0x536e4b(0x3fc)),_0x2e9ff0()):document[_0x536e4b(0x298)][_0x536e4b(0x43e)][_0x536e4b(0x457)](_0x536e4b(0x411),'radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)'):(document[_0x536e4b(0x298)][_0x536e4b(0x43e)]['removeProperty'](_0x536e4b(0x411)),_0x2e9ff0());}function applyPanelOpacity(){const _0x2a6be1=_0x3be7fc;document[_0x2a6be1(0x474)]['style'][_0x2a6be1(0x457)]('--panel-opacity',data['settings'][_0x2a6be1(0x343)]);}function renderDashboard(){const _0x232ac9=_0x3be7fc,_0x2bd851=data[_0x232ac9(0x247)]['flatMap'](_0x14001f=>_0x14001f[_0x232ac9(0x372)][_0x232ac9(0x2eb)](_0x4687ab=>({'topic':_0x14001f[_0x232ac9(0x313)],'subtopic':_0x4687ab['name'],'m':_0x4687ab[_0x232ac9(0x3dd)]['totalMinutes']||0x0,'c':_0x4687ab[_0x232ac9(0x3dd)][_0x232ac9(0x1b4)]||0x0,'t':_0x4687ab[_0x232ac9(0x3dd)]['tasksCompleted']||0x0}))),_0x56bb43=_0x2bd851['reduce']((_0x5265ee,_0x1a66c5)=>_0x5265ee+_0x1a66c5['m'],0x0),_0x14b068=_0x2bd851[_0x232ac9(0x338)]((_0x5e910f,_0x386186)=>_0x5e910f+_0x386186['c'],0x0),_0x400cf2=_0x2bd851[_0x232ac9(0x338)]((_0x1fb7eb,_0x35593a)=>_0x1fb7eb+_0x35593a['t'],0x0);let _0x5cf132=_0x232ac9(0x2ec)+formatDaysHoursMinutes(_0x56bb43)+_0x232ac9(0x207)+_0x14b068+'\x20|\x20<strong>Total\x20tasks:</strong>\x20'+_0x400cf2+_0x232ac9(0x455);_0x2bd851[_0x232ac9(0x2d6)](_0x1e211e=>{const _0x25ef66=_0x232ac9;_0x5cf132+=_0x25ef66(0x383)+escapeHTML(_0x1e211e[_0x25ef66(0x449)])+_0x25ef66(0x472)+escapeHTML(_0x1e211e[_0x25ef66(0x1c8)])+_0x25ef66(0x472)+formatDaysHoursMinutes(_0x1e211e['m'])+_0x25ef66(0x472)+_0x1e211e['c']+_0x25ef66(0x472)+_0x1e211e['t']+_0x25ef66(0x496);}),_0x5cf132+=_0x232ac9(0x3eb);const _0x5840bd=$('#dashboardContent');if(_0x5840bd)_0x5840bd[_0x232ac9(0x28b)]=_0x5cf132;}function getMilestones(){const _0xddcb6=_0x3be7fc;return[{'hours':0x5,'title':_0xddcb6(0x397),'message':_0xddcb6(0x4b9)},{'hours':0x14,'title':_0xddcb6(0x40d),'message':_0xddcb6(0x221)},{'hours':0x32,'title':_0xddcb6(0x1b0),'message':_0xddcb6(0x20a)},{'hours':0x64,'title':_0xddcb6(0x20b),'message':_0xddcb6(0x2f0)},{'hours':0xfa,'title':_0xddcb6(0x34b),'message':_0xddcb6(0x3a2)},{'hours':0x1f4,'title':_0xddcb6(0x2a9),'message':_0xddcb6(0x1e5)},{'hours':0x3e8,'title':_0xddcb6(0x31c),'message':_0xddcb6(0x3ca)},{'hours':0x1388,'title':_0xddcb6(0x24f),'message':'5,000\x20hours\x20of\x20deliberate\x20focus.\x20Few\x20ever\x20reach\x20this.\x0a\x0aAt\x20this\x20milestone,\x20the\x20question\x20shifts\x20from\x20‘How\x20do\x20I\x20focus?’\x20to\x20‘What\x20value\x20will\x20this\x20focus\x20create?’.\x20You’re\x20not\x20just\x20working—you’re\x20building\x20a\x20legacy.'}][_0xddcb6(0x227)]((_0x5d4a08,_0xcfb821)=>_0xcfb821[_0xddcb6(0x2d3)]-_0x5d4a08[_0xddcb6(0x2d3)]);}async function checkAndShowMilestones(){const _0x40b611=_0x3be7fc;if(!data||!data['settings'])return;if(!Array[_0x40b611(0x265)](data[_0x40b611(0x48d)][_0x40b611(0x231)]))data[_0x40b611(0x48d)]['achievedMilestones']=[];const _0x557f2c=data[_0x40b611(0x247)]['reduce']((_0x4f2453,_0x3d3a84)=>{const _0x466fef=_0x40b611;return _0x4f2453+_0x3d3a84[_0x466fef(0x372)][_0x466fef(0x338)]((_0x3163a3,_0x33e4bd)=>{const _0x227084=_0x466fef;return _0x3163a3+(_0x33e4bd[_0x227084(0x3dd)][_0x227084(0x244)]||0x0);},0x0);},0x0),_0x46f19b=_0x557f2c/0x3c,_0x19656e=getMilestones(),_0x1e59e6=Array[_0x40b611(0x265)](data[_0x40b611(0x48d)][_0x40b611(0x231)])?data['settings'][_0x40b611(0x231)]:[],_0x32c8e9=_0x19656e[_0x40b611(0x2b3)](_0x3269de=>_0x46f19b>=_0x3269de[_0x40b611(0x2d3)]&&!_0x1e59e6[_0x40b611(0x2ac)](_0x3269de[_0x40b611(0x2d3)]));if(_0x32c8e9[_0x40b611(0x49f)]===0x0)return![];const _0x1ed4cf=_0x32c8e9[_0x40b611(0x338)]((_0x144313,_0x490225)=>_0x144313&&_0x144313[_0x40b611(0x2d3)]>_0x490225[_0x40b611(0x2d3)]?_0x144313:_0x490225,null);if(!_0x1ed4cf)return![];$(_0x40b611(0x27f))[_0x40b611(0x342)]=_0x1ed4cf[_0x40b611(0x3f7)],$(_0x40b611(0x238))[_0x40b611(0x342)]=_0x1ed4cf[_0x40b611(0x3b7)],$(_0x40b611(0x454))[_0x40b611(0x39e)][_0x40b611(0x27e)](_0x40b611(0x369));try{trapFocus($(_0x40b611(0x454)));}catch(_0x2993f5){}return data['settings'][_0x40b611(0x231)]['push'](_0x1ed4cf['hours']),await saveData(),!![];}async function seedAchievedMilestones(){const _0x567b1f=_0x3be7fc;if(!data||!data[_0x567b1f(0x48d)])return;!Array['isArray'](data['settings'][_0x567b1f(0x231)])&&(data[_0x567b1f(0x48d)][_0x567b1f(0x231)]=[],await saveData());}async function handleSendMessage(){const _0x56b227=_0x3be7fc,_0x288cee=$(_0x56b227(0x3ef)),_0x1de888=$(_0x56b227(0x3bc)),_0x422f7e=_0x1de888['value']['trim'](),_0xf37be8=getCurrentSubtopic();if(!_0x422f7e)return;if(!_0xf37be8){toast(t('timer.selectSubtopicPrompt'));return;}_0x1de888[_0x56b227(0x451)]='',_0x288cee[_0x56b227(0x2dc)]=!![],_0x288cee['innerHTML']=_0x56b227(0x415),_0xf37be8['chatHistory'][_0x56b227(0x2d0)]({'role':_0x56b227(0x4b1),'text':_0x422f7e}),renderChat();const _0x53a0cf=await callGeminiAPI(_0x422f7e);_0x53a0cf&&(_0xf37be8[_0x56b227(0x412)]['push']({'role':_0x56b227(0x3d0),'text':_0x53a0cf}),await saveData(),renderChat()),_0x288cee[_0x56b227(0x2dc)]=![],_0x288cee[_0x56b227(0x28b)]=_0x56b227(0x44c);}function renderChat(){const _0xf89e22=_0x3be7fc,_0x2eea12=getCurrentSubtopic(),_0x9856ea=$('#chatMessages'),_0x474f37=$(_0xf89e22(0x3bc)),_0x234383=$(_0xf89e22(0x3ef));if(!_0x9856ea||!_0x474f37||!_0x234383)return;if(!_0x2eea12){_0x9856ea[_0xf89e22(0x28b)]='<div\x20class=\x22tiny\x22>Select\x20a\x20subtopic\x20to\x20start\x20chatting.</div>',_0x474f37[_0xf89e22(0x2dc)]=!![],_0x234383[_0xf89e22(0x2dc)]=!![];return;}_0x474f37[_0xf89e22(0x2dc)]=![],_0x234383[_0xf89e22(0x2dc)]=![],_0x9856ea[_0xf89e22(0x28b)]='';if(!_0x2eea12['chatHistory']||_0x2eea12[_0xf89e22(0x412)][_0xf89e22(0x49f)]===0x0){_0x9856ea[_0xf89e22(0x28b)]=_0xf89e22(0x283);return;}_0x2eea12[_0xf89e22(0x412)][_0xf89e22(0x2d6)](_0x2dab62=>{const _0x17e57d=_0xf89e22,_0x133a50=document[_0x17e57d(0x1ce)](_0x17e57d(0x422));_0x133a50[_0x17e57d(0x25b)]=_0x17e57d(0x2fb)+_0x2dab62[_0x17e57d(0x389)],_0x133a50[_0x17e57d(0x342)]=_0x2dab62[_0x17e57d(0x430)],_0x9856ea[_0x17e57d(0x253)](_0x133a50);}),_0x9856ea[_0xf89e22(0x478)]=_0x9856ea[_0xf89e22(0x25a)];}async function handleSummarizeNote(){const _0x958df3=_0x3be7fc,_0x53b767=$(_0x958df3(0x2e9)),_0x3bd9fe=$(_0x958df3(0x48f)),_0x528495=_0x3bd9fe[_0x958df3(0x451)]['trim'](),_0x59d0ad=getCurrentSubtopic();if(!_0x528495){toast(_0x958df3(0x45c));return;}const _0x4cbffa=_0x53b767[_0x958df3(0x28b)];_0x53b767['innerHTML']=_0x958df3(0x415),_0x53b767['disabled']=!![];const _0x4bb856=_0x958df3(0x3ea)+(_0x59d0ad?.[_0x958df3(0x313)]||_0x958df3(0x43a))+_0x958df3(0x319)+_0x528495+'\x22\x0a\x0aProduce\x20a\x20concise\x20summary\x20of\x20what\x20was\x20done\x20and\x20propose\x20a\x20reasonable\x20next\x20step.\x20Format\x20the\x20answer\x20like\x20this:\x0a\x0a---\x0a**✨\x20AI\x20Summary:**\x0a[Summary\x20here]\x0a\x0a**🚀\x20Next\x20Suggestion:**\x0a[Suggestion\x20here]',_0xbd6d38=await callGeminiAPI(_0x4bb856);_0xbd6d38&&(_0x3bd9fe['value']+='\x0a\x0a'+_0xbd6d38),_0x53b767[_0x958df3(0x28b)]=_0x4cbffa,_0x53b767['disabled']=![];}function clearChat(){const _0xc25648=_0x3be7fc,_0x2cf4e6=getCurrentSubtopic();if(!_0x2cf4e6){toast(t(_0xc25648(0x3e1)));return;}showConfirmModal(_0xc25648(0x429),'Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20all\x20chat\x20history\x20for\x20this\x20subtopic?',async _0x3cb3b5=>{const _0x7c1e39=_0xc25648;_0x3cb3b5&&(_0x2cf4e6[_0x7c1e39(0x412)]=[],await saveData(),renderChat(),toast(_0x7c1e39(0x357)));});}let ytPlayer,ytUserPaused=![],ytFallbackFrame=null,ytFallbackIsPlaying=![];function buildFallbackSrc(_0x2b88ad,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x599611=_0x3be7fc,_0xd8c697=new URLSearchParams({'autoplay':String(autoplay),'mute':String(mute),'controls':'0','playsinline':'1','loop':'1','playlist':_0x2b88ad,'enablejsapi':'1','origin':_0x599611(0x39b)})['toString']();return _0x599611(0x3f6)+_0x2b88ad+'?'+_0xd8c697;}function ensureFallbackFrame(){const _0x5bdc04=_0x3be7fc,_0x449e41=document[_0x5bdc04(0x1dc)]('youtube-player-container');if(!_0x449e41)return null;if(ytFallbackFrame&&ytFallbackFrame['isConnected'])return ytFallbackFrame;const _0x4c28fb=document[_0x5bdc04(0x1ce)](_0x5bdc04(0x2fe));return _0x4c28fb['id']=_0x5bdc04(0x4a5),_0x4c28fb[_0x5bdc04(0x1b2)]='1',_0x4c28fb[_0x5bdc04(0x252)]='1',_0x4c28fb[_0x5bdc04(0x43e)][_0x5bdc04(0x258)]='absolute',_0x4c28fb[_0x5bdc04(0x43e)][_0x5bdc04(0x3cb)]=_0x5bdc04(0x399),_0x4c28fb['style']['left']=_0x5bdc04(0x399),_0x4c28fb[_0x5bdc04(0x2a7)]=_0x5bdc04(0x29d),_0x449e41[_0x5bdc04(0x28b)]='',_0x449e41['appendChild'](_0x4c28fb),ytFallbackFrame=_0x4c28fb,_0x4c28fb;}function fallbackLoadVideo(_0x1e741a,{autoplay:autoplay=0x1,mute:mute=0x1}={}){const _0x2a1182=_0x3be7fc,_0x47c667=document[_0x2a1182(0x1dc)](_0x2a1182(0x234));if(!_0x47c667)return;_0x47c667[_0x2a1182(0x28b)]='';const _0x48ed8f=document[_0x2a1182(0x1ce)]('iframe');_0x48ed8f['id']=_0x2a1182(0x4a5),_0x48ed8f[_0x2a1182(0x1b2)]='1',_0x48ed8f['height']='1',_0x48ed8f[_0x2a1182(0x43e)]['position']=_0x2a1182(0x4a3),_0x48ed8f['style'][_0x2a1182(0x3cb)]=_0x2a1182(0x399),_0x48ed8f[_0x2a1182(0x43e)][_0x2a1182(0x491)]='-9999px',_0x48ed8f[_0x2a1182(0x2a7)]=_0x2a1182(0x29d),_0x48ed8f[_0x2a1182(0x42f)]=buildFallbackSrc(_0x1e741a,{'autoplay':autoplay,'mute':mute}),_0x47c667['appendChild'](_0x48ed8f),ytFallbackFrame=_0x48ed8f,ytFallbackIsPlaying=!!autoplay;try{const _0x61ca11=document['getElementById']('btnToggleYtSound');if(_0x61ca11)_0x61ca11['textContent']=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x2b8796){}}function fallbackPostMessage(_0x2cf963,_0x12b64a=[]){const _0x443b8=_0x3be7fc;try{if(!ytFallbackFrame||!ytFallbackFrame[_0x443b8(0x2c0)])return;ytFallbackFrame[_0x443b8(0x2c0)][_0x443b8(0x46b)](JSON[_0x443b8(0x225)]({'event':_0x443b8(0x30f),'func':_0x2cf963,'args':_0x12b64a}),_0x443b8(0x39b));}catch(_0x28a193){}}function fallbackPlay(){const _0x117ac5=_0x3be7fc;fallbackPostMessage(_0x117ac5(0x38b));}function fallbackStop(){const _0x28acdc=_0x3be7fc;try{ytFallbackFrame&&(ytFallbackFrame[_0x28acdc(0x42f)]=_0x28acdc(0x42a),ytFallbackIsPlaying=![]);}catch(_0x17c0e2){}}function _0x14e7(){const _0x3838eb=['topic-title','A_winddown','start','Place\x20a\x20hand\x20on\x20your\x20chest\x20and\x20feel\x20your\x20heartbeat.','lang','B_long','Initialization\x20error:\x20','readwrite','<tr><td>','.subtopics','#btnPause','work_end','#btnGenericOk','note-meta','role','API\x20response\x20structure\x20is\x20unexpected:','playVideo','OK.\x20Valid\x20link.\x20Preparing\x20to\x20play...','Sound\x20has\x20been\x20enabled!','backgroundMode','append','<p>','Content\x20required\x20for\x20AI\x20formatting.','subtopics-group','mousemove','chev\x20btn\x20small\x20ghost','json','fullscreenchange','To\x20You,\x20The\x20First\x205\x20Hours\x20(Warm-up)','updateUI','-9999px','Switch\x20to\x20Style\x20','https://www.youtube.com','A_short','var(--danger)','classList','92480aGkIlg','Unable\x20to\x20save\x20changes.','tab','250\x20hours\x20is\x20proof\x20of\x20incredible\x20perseverance.\x20You’ve\x20met\x20hard\x20days\x20and\x20distractions—and\x20you\x20kept\x20returning.\x20Real\x20strength\x20lies\x20in\x20this\x20consistency.','🌊\x20Flow','5nAGKfZ','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M2\x2012s3-7\x2010-7\x2010\x207\x2010\x207-3\x207-10\x207-10-7-10-7Z\x22/><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x223\x22/></svg>','var(--muted)','.timer-circle-container','.timer-circle-progress','AudioContext','modalMethodEditor','#set_theme','(Could\x20not\x20generate\x20summary)','_getStore','__ytApiWatchdog','splice','_onFinishSegment','143yrQVBg','Failed\x20to\x20save\x20data:','parts','cycles','#timerPresetSelector\x20button','tid','message','getItem','oncomplete','break_end','replace','#chatInput','ArrowDown','Export','innerHeight','Background\x20updated.','aria-expanded','Note\x20saved','toString','parentElement','6207018vlKfEZ','youtubeVolume','#toolBullet','statusText','Rename\x20Subtopic','Welcome\x20to\x20the\x201,000-Hour\x20Club.\x0a\x0aThis\x20number\x20is\x20not\x20just\x20time—it\x20represents\x20transformation.\x20Focus\x20has\x20become\x20part\x20of\x20you,\x20a\x20‘superpower’\x20you\x20can\x20summon.\x20Your\x20journey\x20is\x20inspiring.','top','#methodEditorId','<ul>','topic-item','toLocaleString','model','Play\x20a\x20favorite\x20song\x20briefly.','focus','italic','#btnBreakEarly','Gently\x20massage\x20your\x20temples.','trim','PLAYING','tickHandle','initDB','get','Gemini\x20API\x20Error:','.color-palette','stats','#stateBadge','#audioWorkEnd','.method-edit','timer.selectSubtopicPrompt','#set_panelOpacity','badge','fixed','now','work','Notice\x20the\x20room’s\x20temperature\x20and\x20lighting.','beep','files','Based\x20on\x20the\x20following:\x0a-\x20Topic/Subtopic:\x20\x22','</tbody></table>','Open\x20a\x20window\x20for\x20some\x20fresh\x20air.','querySelector','main_settings','#btnSendMessage','#currentSubtopicName','#ytSoundVolume','toLowerCase','#btnStart','Invalid\x20file\x20format','#btnToggleBg','https://www.youtube.com/embed/','title','origin','change','apiKey','?\x20This\x20will\x20stop\x20and\x20reset\x20the\x20current\x20session.','none','Take\x20one\x20deep\x20sigh\x20and\x20relax\x20your\x20shoulders.','Take\x20a\x20short\x20walk\x20around\x20the\x20room.','promptFeedback','Summarize','\x27\x20·\x20Mode\x20','toggle','Settings\x20saved','delete','\x20min','put','#customSoundsContainer','note-content-wrapper','then','ENDED','min','#set_theme_color','To\x20You,\x2020\x20Hours\x20(Foundation)','<input\x20type=\x22checkbox\x22\x20id=\x22','lofi','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20summary?','--bg-image','chatHistory','#btnCancelMethodEditor','Deleted\x20old\x20backup:\x20','<div\x20class=\x22spinner\x22></div>','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=','PomodoroAppDB','getIframe','</label>','url(','#newSubtopicTaskInput','Space','content','#draggableTimer','selectionEnd','Please\x20select\x20a\x20Subtopic\x20first','from','div','menu-item\x20danger','getMonth','checked','More\x20options','beginWindDown','menu-item','Confirm\x20Deletion','about:blank','offsetHeight','load','clientY','cyclesB','src','text','#btnReset','A_long','#btnDefaults','#timeDisplay','<li>','update','resolve','backgroundRepeat','short','unknown','Remind\x20yourself:\x20Resting\x20well\x20helps\x20you\x20work\x20better!','reload','Import\x20failed:\x20','style','Switched\x20to\x20Style\x20','sess','http','stroke','<p>To\x20avoid\x20overwhelm\x20in\x20a\x20new\x20domain,\x20focus\x20on\x20the\x20vital\x2020%\x20that\x20delivers\x2080%\x20of\x20the\x20results\x20(Minimum\x20Effective\x20Dose).</p><h4>The\x20Core\x2020%:\x20Use\x20this\x205-Step\x20Analysis\x20Framework\x20to\x20identify\x20the\x20critical\x2020%:</h4><ol><li><strong>Define\x20Outcomes:</strong>\x20What\x20is\x20your\x20end\x20goal?\x20(e.g.,\x20ship\x20a\x20basic\x20website).</li><li><strong>Analyze\x20Fundamentals:</strong>\x20Identify\x203–5\x20invariant\x20principles\x20of\x20the\x20field.</li><li><strong>Spot\x20Common\x20Pitfalls:</strong>\x20Learn\x20the\x20mistakes\x20beginners\x20make\x20and\x20avoid\x20them.</li><li><strong>Find\x20the\x20“Force\x20Multiplier”:</strong>\x20Which\x20meta-skill\x20makes\x20learning\x20everything\x20else\x20easier?\x20(e.g.,\x20music\x20theory\x20in\x20music).</li><li><strong>Map\x20Practical\x20Application:</strong>\x20Focus\x20on\x20the\x2020%\x20of\x20tasks\x20that\x20consume\x2080%\x20of\x20real-world\x20time.</li></ol>','3188JtDmcF','pointerdown','#btnGenericCancel','file:','💡\x20Suggestion:\x20','topic','isCompleted','IndexedDB\x20initialized\x20successfully.','Send','No\x20valid\x20link.\x20Paste\x20a\x20link\x20then\x20press\x20▶.','_startTick','isConnected','440440TDvbOL','value','longBreakIntervalB','chime','#modalMilestone','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22dashboard-table\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead><tr><th>Topic</th><th>Subtopic</th><th>Time</th><th>Sessions</th><th>Tasks</th></tr></thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>','pause','setProperty','restoreBackup','Did\x20not\x20receive\x20valid\x20content\x20from\x20AI.','var(--warn)','\x20(A)','Please\x20enter\x20a\x20note\x20before\x20summarizing.','#generalNotesList','test','note','Session\x20completed!\x20Press\x20Start\x20to\x20begin\x20the\x20next\x20session.','Data\x20restored\x20successfully!\x20Reloading...','methods','actions-menu','href','finishFlowSession','candidates','Failed\x20to\x20delete\x20summary:','lastBackupDate','Backup\x20failed:','Error:\x20','postMessage','frequency','volume','Failed\x20to\x20load\x20the\x20YouTube\x20API.\x20Check\x20your\x20network\x20or\x20reload\x20the\x20page.','triangle','Count\x20your\x20breaths\x20slowly\x20up\x20to\x20ten.','Cycle\x20','</td><td>','\x22\x20title=\x22Complete\x20task\x22>\x20<label\x20for=\x22','documentElement','status','#welcomePanel\x20p','.actions-menu.show','scrollTop','#set_long','.color-picker-wrapper','formatBlock','#btnRestoreBackup','tagName','Add\x20note','fullscreenElement','resume','PlayerState','tasksCompleted','?\x20Current\x20data\x20will\x20be\x20overwritten.','unshift','dataset','#modalGeneric','B_work','opacity','find','onkeydown','flowtimeBreakRatio','#view-timer','settings','right','#noteText','prevState','left','getPropertyValue','#btnDashboard','reset','#uploadSoundLong','</td></tr>','save','#set_interval','match','topicId','keydown','#set_enableWinddown','#view-methods','14scrsYx','length','3219FyZxdB','Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20topic\x20\x22','sum','absolute','view','yt-fallback','useYtThumbnailAsBg','cover','method-item','\x0a-\x20','#importFile','#btnAddSubtopicTask','objectStoreNames','#btnToggleYtSound','Backup\x20not\x20found.','#btnSkipNote','newIndex','user','#btnSaveMethod','<h4>','activeElement','sound_unlocked','data','selectionStart','B_winddown','Five\x20focused\x20hours!\x20You’ve\x20overcome\x20the\x20biggest\x20barrier:\x20procrastination.\x20Every\x20minute\x20invested\x20is\x20a\x20statement\x20of\x20your\x20intent.\x20Keep\x20the\x20fire\x20burning!','#backupList','durations','toLocaleDateString','cycleIndex','selectedTopicId','#modalDashboard','floor','presetTarget','getPlayerState','enableWinddown','#subtopicTasksList','insertOrderedList','item','To\x20You,\x2050\x20Hours\x20(Momentum)','Listen\x20closely\x20to\x20your\x20in-breath\x20and\x20out-breath.','width','<p>If\x20Active\x20Recall\x20is\x20about\x20<i>how</i>\x20you\x20learn,\x20Spaced\x20Repetition\x20is\x20about\x20<i>when</i>.\x20It\x20schedules\x20reviews\x20to\x20move\x20knowledge\x20into\x20long-term\x20memory\x20most\x20efficiently.</p><h4>Core\x20Principle:\x20Resist\x20Forgetting\x20🧠</h4><p>Based\x20on\x20the\x20“Forgetting\x20Curve,”\x20we\x20forget\x20fastest\x20right\x20after\x20learning.\x20Spaced\x20Repetition\x20prompts\x20review\x20right\x20before\x20you’re\x20about\x20to\x20forget.</p><p>Each\x20successful\x20review\x20lengthens\x20retention\x20intervals.\x20You\x20might\x20forget\x20after\x201\x20day\x20initially,\x20but\x20after\x20review,\x20you’ll\x20remember\x20for\x203\x20days,\x20then\x20a\x20week,\x20a\x20month,\x20and\x20so\x20on.</p><h4>Most\x20Effective\x20Tool:\x20SRS\x20Apps\x20📱</h4><p>Instead\x20of\x20manual\x20schedules,\x20use\x20Spaced\x20Repetition\x20Software\x20(SRS).\x20Anki\x20is\x20the\x20gold\x20standard:\x20it\x20automates\x20scheduling\x20for\x20thousands\x20of\x20cards\x20based\x20on\x20your\x20self-rated\x20difficulty,\x20ensuring\x20optimal\x20review\x20timing.</p><h4>Biggest\x20Pitfall\x20to\x20Avoid\x20❌</h4><p>The\x20#1\x20cause\x20of\x20failure\x20is\x20<i>Review\x20Overload</i>—creating\x20too\x20many\x20new\x20cards\x20daily\x20or\x20skipping\x20days,\x20leading\x20to\x20a\x20discouraging\x20backlog.</p><p><strong>Solution\x20(20%\x20effort,\x2080%\x20results):</strong>\x20Be\x20consistent.\x20Set\x20realistic\x20new-card\x20limits\x20(e.g.,\x2010–20/day)\x20and\x20review\x20daily.\x20Better\x20to\x20study\x20a\x20little\x20every\x20day\x20than\x20to\x20cram.</p><h4>Essential\x20Combo:\x20AR\x20+\x20SR</h4><p>Spaced\x20Repetition\x20(SR)\x20and\x20Active\x20Recall\x20(AR)\x20are\x20two\x20sides\x20of\x20the\x20same\x20coin.\x20SR\x20tells\x20you\x20<i>when</i>\x20to\x20review;\x20AR\x20is\x20what\x20you\x20do\x20<i>during</i>\x20the\x20review.\x20Together\x20they\x20ensure\x20your\x20recall\x20efforts\x20hit\x20memory’s\x20“sweet\x20spot.”\x20Anki\x20is\x20the\x20most\x20effective\x20way\x20to\x20implement\x20this\x20combo.</p>','sessionsCompleted','backgroundSize','linearRampToValueAtTime','.method-item','actions','currentView','#set_backgroundMode','customSounds','#btnPresetB','toast','Defaults\x20restored','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic\x20to\x20view\x20summaries.</div>','isNaN','IndexedDB\x20error:','bottom','＋\x20Add','FOCUS','#btnResume','long_end','#genericTitle','subtopic','Splash\x20water\x20on\x20your\x20face\x20or\x20pat\x20it\x20gently.','#set_autoStartNext','Confirm\x20Restore','#toolBold','#btnSummarize','createElement','bold','&quot;','Error\x20saving\x20data:\x20','https://img.youtube.com/vi/','importData','mousedown','#btnFullscreen','method-content','defer','persistTimerState','menu-active','Loading\x20YouTube\x20API...','customBg','getElementById','Blink\x20ten\x20times\x20to\x20prevent\x20dry\x20eyes.','Add\x20subtopic','object','ArrowUp','Edit','<div\x20class=\x22tiny\x22>No\x20sessions\x20yet</div>','summaries','#genericInput','Half\x20a\x20thousand\x20hours\x20of\x20focus.\x20You’ve\x20devoted\x20meaningful\x20time\x20to\x20what\x20matters.\x20This\x20level\x20of\x20dedication\x20creates\x20deep,\x20distinctive\x20results.\x20Admirable.','backupDaysToKeep','sessions','no-repeat','toISOString','script','.txt','.presets\x20button','localeCompare','oldIndex','remove','&gt;','/hqdefault.jpg','.modal','https:','btn\x20small\x20danger\x20method-delete','onerror','scroll','####\x20','#statTotal','state','btn\x20small\x20ghost\x20actions-menu-btn','</ul>','padStart','Missing\x20element','Saved\x20alert\x20for\x20SHORT\x20BREAK.','createdAt','#set_youtubeUrl','generalNotes','#toolList','contains','split','File\x20save\x20error.','pastel','\x20|\x20<strong>Total\x20sessions:</strong>\x20','#windDownChecklist','setValueAtTime','50\x20focused\x20hours!\x20Your\x20habits\x20are\x20creating\x20momentum.\x20Small\x20daily\x20consistencies\x20compound\x20into\x20big\x20steps\x20forward.\x20You’re\x20on\x20the\x20right\x20path—keep\x20going.','To\x20You,\x20100\x20Hours\x20of\x20Dedication\x20(Commitment)','ghost','#set_ytThumbAsBg','removeEventListener','badge\x20state\x20work','#btnTestSound','mode','#methodEditorContentInput','pomodoroData_v11','date','skip','all','#btnExport','</div>','protocol','input','errorCode','Refuel\x20with\x20a\x20healthy\x20snack.','<p\x20class=\x22tiny\x22\x20style=\x22opacity:0.7;\x22>No\x20knowledge\x20items\x20added\x20yet.</p>','Player','mute','strokeDasharray','Congrats\x20on\x20doing\x20the\x20hardest\x20part:\x20starting\x20and\x20staying\x20consistent.\x0a\x0aThese\x2020\x20hours\x20aren’t\x20just\x20time—they’re\x2020\x20hours\x20of\x20winning\x20against\x20distraction.\x20You’re\x20building\x20a\x20strong\x20foundation\x20of\x20discipline.\x20Be\x20proud\x20of\x20this\x20start.','0\x20min','location','Delete\x20knowledge\x20\x22','stringify','summary','sort','topic-header','#btnClearChat','Error:\x20Rate\x20limit\x20exceeded\x20for\x20Gemini.\x20Please\x20try\x20again\x20in\x20a\x20few\x20minutes.','removeChild','string','#methodEditorTitleInput','#set_short','stopPropagation','Delete\x20Subtopic','achievedMilestones','POST','getDate','youtube-player-container','dateISO','Show\x20interface','setVolume','#milestoneMessage','closest','createObjectStore','currentConfig','#toasts','type','repeat','Check\x20and\x20correct\x20your\x20sitting\x20posture.','Use\x20AI\x20to\x20auto-format\x20text','ArrowRight','default','random','totalMinutes','#btnEnableSound','</h4>','topics','New\x20Topic\x20name?','#breakSuggestionDisplay','btn\x20small\x20danger','Please\x20select\x20a\x20subtopic\x20first.','code','method-title','exponentialRampToValueAtTime','To\x20You,\x205,000+\x20Hours\x20(Legacy)','#set_volume','pomodoro_backup_','height','appendChild','Error:\x20Invalid\x20or\x20changed\x20Gemini\x20API\x20Key.\x20Please\x20verify\x20in\x20Settings.','#btnMilestoneClose','\x20hours\x20','btn\x20small','position','backups','scrollHeight','className','#methodEditorTitle','#set_cycles','setRangeText','<div\x20class=\x22tiny\x22>Please\x20select\x20a\x20subtopic.</div>','#view-methods\x20.method-item','Delete','topic-actions','.actions-menu-btn','DB_VERSION','isArray','download','Playing','prompt','#set_work','gain','#btnAddMethod','#set_backupDays','exitFullscreen','warn','getAllKeys','\x20min\x20via\x20Flowtime\x20(','durationMinutes','104cwXVBo','#currentSubtopicNameChat','clientX','#ytUrlFeedback','onclick','var(--acc-2)','timerState','active','mouseup','interval','Exit\x20fullscreen','transaction','add','#milestoneTitle','#set_flowRatio','<div><span\x20class=\x22tiny\x22>(no\x20note\x20yet)</span></div>','getVolume','<div\x20class=\x22tiny\x22>No\x20messages\x20yet.</div>','#view-','set_youtubeUrl','Close\x20your\x20eyes\x20and\x20relax\x20for\x20one\x20minute.','setItem','topicsList','Summary\x20failed.','Background\x20music\x20stopped.','innerHTML','❌\x20Invalid\x20or\x20unsupported\x20link.','round','img.youtube.com/vi/','auto','blob:','createIndex','error','#btnSkip','textarea','.app-content','onload','#btnToggleCustomSounds','body','aria-pressed','enableSessionNotes','unMute','The\x20Feynman\x20Technique:\x20Understand\x20Deeply\x20by\x20Explaining\x20Simply','autoplay;\x20encrypted-media;\x20picture-in-picture','sub-row','cyclesA','#uploadBg','<li\x20class=\x22tiny\x22\x20style=\x22opacity:\x200.7;\x22>Great!\x20No\x20tasks\x20left.</li>','45KUvTwp','#btnFinishFlow','</li>','.nav-btn[data-view]','\x22?\x20All\x20related\x20data\x20will\x20be\x20lost.','allow','#audioBreakEnd','To\x20You,\x20500\x20Hours\x20(Focus\x20Mastery)','#settings-flowtime','removing','includes','button','#cycleInfo','transition','collapsedTopics','\x20(B)','Please\x20enter\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings.','filter','Analyze\x20and\x20reformat\x20the\x20following\x20plain\x20text\x20into\x20clean\x20HTML.\x20Use\x20these\x20tags:\x0a-\x20Use\x20<h4>\x20for\x20main\x20section\x20headings.\x0a-\x20Use\x20<strong>\x20to\x20emphasize\x20important\x20terms\x20or\x20ideas.\x0a-\x20Use\x20<i>\x20for\x20notes\x20or\x20quotes.\x0a-\x20Use\x20<ol>\x20and\x20<li>\x20for\x20ordered\x20lists.\x0a-\x20Use\x20<ul>\x20and\x20<li>\x20for\x20unordered\x20lists.\x0a-\x20Wrap\x20normal\x20paragraphs\x20with\x20<p>.\x0aText\x20to\x20format:\x0a\x0a\x22','Stand\x20up\x20and\x20stretch.','Loosen\x20wrists\x20and\x20shoulders\x20for\x2030\x20seconds.','by_topic','/maxresdefault.jpg','Error:\x20Unable\x20to\x20enter\x20fullscreen:\x20','#set_winddown','flex','querySelectorAll','addEventListener','ArrowLeft','#btnCloseDashboard','contentWindow','beginWork','getSettings','19572koioHU','_sortable','expanded','btnToggleYtSound','stop','log','long_break','currentTime','text/plain','connect','substring','getFullYear','Error\x20calling\x20Gemini\x20API:','push','longBreakIntervalA','Hide\x20interface','hours','B_short','Benjamin\x20Franklin’s\x20Writing\x20Method:\x20Learn\x20by\x20Recreating','forEach','objectStore','paused','backgroundImage','#btnSaveSettings','innerWidth','disabled','Data\x20imported\x20successfully!','data:','application/json','select','__ytApiPromise','details','result','#btnCloseSettings','Content\x20blocked\x20for:\x20','play','The\x2080/20\x20Principle\x20for\x20Mastering\x20a\x20New\x20Field','<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M9.88\x209.88a3\x203\x200\x201\x200\x204.24\x204.24\x22/><path\x20d=\x22M10.73\x205.08A10.43\x2010.43\x200\x200\x201\x2012\x205c7\x200\x2010\x207\x2010\x207a13.16\x2013.16\x200\x200\x201-1.67\x202.68\x22/><path\x20d=\x22M6.61\x206.61A13.526\x2013.526\x200\x200\x200\x202\x2012s3\x207\x2010\x207a9.74\x209.74\x200\x200\x200\x205.39-1.61\x22/><line\x20x1=\x222\x22\x20y1=\x222\x22\x20x2=\x2222\x22\x20y2=\x2222\x22/></svg>','#btnSummarizeNote','offsetWidth','map','<p\x20class=\x22tiny\x22><strong>Total\x20time:</strong>\x20','sine','hidden','onsuccess','100\x20hours!\x20This\x20is\x20no\x20longer\x20an\x20experiment—it’s\x20a\x20serious\x20investment\x20in\x20your\x20goals.\x0a\x0aTake\x20a\x20moment\x20to\x20reflect:\x20how\x20far\x20have\x20these\x20100\x20focused\x20hours\x20taken\x20you?\x20Your\x20energy\x20is\x20shaping\x20real\x20outcomes.','#settings-pomodoro','findIndex','A_work','.sub-row','#btnAutoFormat','clear','Disabled\x20YouTube\x20background\x20to\x20suit\x20the\x20light\x20theme.','Audio\x20playback\x20error:','slice','Step\x20onto\x20a\x20balcony\x20and\x20enjoy\x20natural\x20light.','chat-msg\x20','baseVal','#statTasks','iframe','segmentTotal','Active\x20Recall:\x20The\x20Core\x20Principle\x20for\x20Deep\x20Learning','#btnHelpCreateTopic','tasks','btn\x20subtopic-btn','Relax\x20your\x20legs\x20and\x20rotate\x20your\x20ankles\x20under\x20the\x20desk.','beginBreak','Failed\x20to\x20load\x20YouTube\x20API','input,select,textarea','#uploadSoundBreak','finished','.tab-btn','light','setAttribute','#set_apiKey','10926695fZdkhY','command','indexOf','timerState_','en-US','name','No\x20Subtopic\x20Selected','#set_enableSessionNotes','Ask\x20yourself:\x20‘How\x20do\x20I\x20feel\x20right\x20now?’','soundTheme','#modalMethodEditor','\x22\x0a-\x20User\x27s\x20note\x20after\x20a\x20focus\x20session:\x20\x22','createObjectURL','pauseVideo','To\x20You,\x201,000\x20Hours\x20(Transformation)','breathing','cancel','Great!\x20Time\x20for\x20a\x20long\x20break.','key','winddown','updateSettings','idle','<option\x20value=\x22\x22>No\x20backups\x20available</option>','<strong>$1</strong>','workMinutes','parse','Saved\x20alert\x20for\x20FOCUS.','#btnPresetC','color','hist-item','open','.actions-menu','LONG\x20BREAK','Subtopic:\x20','theme','.tab-content','soundPermissionBar','.aux-panel,\x20.modal-card','task','Confirm\x20Switch','getBoundingClientRect','Add\x20New\x20Knowledge','reduce','break','<div\x20class=\x22tiny\x22>No\x20summaries\x20yet.</div>','selectedSubtopicId','revokeObjectURL','Check\x20your\x20breathing—if\x20rushed,\x20slow\x20it\x20down.','Gemini\x20error:\x20','#modalSettings','.topic-item.menu-active','FOCUS\x20(FLOW)','textContent','panelOpacity','Spaced\x20Repetition:\x20Learning\x20at\x20the\x20Right\x20Time','.nav-btn[data-view=\x22','Custom\x20background\x20removed.','(none\x20selected)','242076tnIEyD','#welcomePanel','startsWith','To\x20You,\x20250\x20Hours\x20(Perseverance)','getAll','radial-gradient(1200px\x20800px\x20at\x2010%\x20-10%,\x20#20285b\x200%,\x20#0f1222\x2050%,\x20#0b0e1a\x20100%)','Delete\x20Topic','function','catch','</ol>','preset','display','Do\x20a\x20few\x20deep-breathing\x20cycles.','Gently\x20close\x20your\x20eyes\x20and\x20smile\x20to\x20yourself.','#btnAddTopic','Chat\x20history\x20cleared.','preventDefault','remaining','target','cleanupOldBackups','Loosen\x20your\x20finger\x20joints\x20after\x20typing.','stopVideo','space','reloading','readonly','.\x20Please\x20try\x20again\x20with\x20different\x20content.','sid','click','http:','<div\x20class=\x22tiny\x22>No\x20notes\x20yet.</div>','badge\x20state\x20break','.topic-item','cyclesTarget','show','Please\x20select\x20a\x20Subtopic\x20before\x20proceeding.','setPreset','destroy','Network\x20error\x20connecting\x20to\x20Gemini.\x20Please\x20check\x20your\x20internet\x20connection.','max','Tidy\x20or\x20rearrange\x20your\x20workspace.','currentDurations','autoStartNext','subtopics','foreColor','...','&lt;','Fullscreen','long','wind_down','timer','Playing\x20background\x20music...'];_0x14e7=function(){return _0x3838eb;};return _0x14e7();}function fallbackPause(){fallbackStop();}function fallbackUnMute(){const _0x503c79=_0x3be7fc;fallbackPostMessage(_0x503c79(0x29b));}function fallbackMute(){fallbackPostMessage('mute');}window['onYouTubeIframeAPIReady']=function(){const _0x276742=_0x3be7fc;if(IS_FILE_PROTOCOL){try{window['__ytApiWatchdog']&&window[_0x276742(0x3ae)][_0x276742(0x31e)]();}catch(_0x2822f1){}return;}const _0x3624d5={'height':'1','width':'1','playerVars':{'autoplay':0x0,'controls':0x0,'playsinline':0x1},'events':{'onReady':onPlayerReady,'onStateChange':onPlayerStateChange},'host':_0x276742(0x39b)};(window[_0x276742(0x223)]['protocol']===_0x276742(0x364)||window[_0x276742(0x223)][_0x276742(0x219)]===_0x276742(0x1f3))&&(_0x3624d5[_0x276742(0x3f8)]=window[_0x276742(0x223)][_0x276742(0x3f8)]);ytPlayer=new YT[(_0x276742(0x21e))](_0x276742(0x234),_0x3624d5);try{window[_0x276742(0x3ae)]&&window[_0x276742(0x3ae)][_0x276742(0x31e)]();const _0x4f0e68=document[_0x276742(0x1dc)]('ytUrlFeedback');_0x4f0e68&&(_0x4f0e68['textContent']='');}catch(_0x5a8a1b){}};let _ytPrimed=![],_ytUnlocked=![];try{_ytUnlocked=localStorage[_0x3be7fc(0x3b8)](_0x3be7fc(0x4b5))==='1';}catch(_0x36fde8){}function showSoundPermission(){const _0x5b1409=_0x3be7fc,_0x25f645=document[_0x5b1409(0x1dc)](_0x5b1409(0x332));if(!_0x25f645)return;if(_ytUnlocked){_0x25f645[_0x5b1409(0x39e)][_0x5b1409(0x1ef)](_0x5b1409(0x369));return;}_0x25f645[_0x5b1409(0x39e)][_0x5b1409(0x27e)](_0x5b1409(0x369));}function hideSoundPermission(){const _0x26c1f8=_0x3be7fc,_0x2d3e11=document[_0x26c1f8(0x1dc)](_0x26c1f8(0x332));if(!_0x2d3e11)return;_0x2d3e11[_0x26c1f8(0x39e)][_0x26c1f8(0x1ef)]('show');}function unlockAudioChain(){const _0x202a6d=_0x3be7fc;try{if(AUDIO_CTX&&typeof AUDIO_CTX[_0x202a6d(0x480)]===_0x202a6d(0x34f))AUDIO_CTX[_0x202a6d(0x480)]();}catch(_0x55d237){}try{if(IS_FILE_PROTOCOL)fallbackUnMute(),fallbackPlay();else ytPlayer&&ytPlayer[_0x202a6d(0x29b)]&&(ytPlayer[_0x202a6d(0x29b)](),ytPlayer['playVideo']());}catch(_0x5ad162){}_ytUnlocked=!![];try{localStorage[_0x202a6d(0x287)]('sound_unlocked','1');}catch(_0x3b49be){}hideSoundPermission(),toast(_0x202a6d(0x38d));}function onPlayerReady(_0x216880){const _0x3db860=_0x3be7fc;try{const _0x5a3930=ytPlayer&&ytPlayer[_0x3db860(0x418)]?ytPlayer[_0x3db860(0x418)]():null;_0x5a3930&&_0x5a3930[_0x3db860(0x30c)](_0x3db860(0x2a7),_0x3db860(0x29d));}catch(_0x48e2bd){}try{if(ytPlayer&&ytPlayer[_0x3db860(0x237)])ytPlayer['setVolume'](data&&data['settings']&&data[_0x3db860(0x48d)]['youtubeVolume']||0x50);}catch(_0x16d490){}try{const _0x47a201=getActiveVideoId&&getActiveVideoId();if(_0x47a201&&ytPlayer&&ytPlayer[_0x3db860(0x21f)]&&ytPlayer[_0x3db860(0x38b)]){ytPlayer[_0x3db860(0x21f)](),ytPlayer['playVideo'](),_ytPrimed=!![];const _0x28ff1f=()=>{const _0x1c008b=_0x3db860;if(_ytUnlocked)return;try{unlockAudioChain();}catch(_0x4c1fc1){}window['removeEventListener'](_0x1c008b(0x445),_0x28ff1f,!![]),window[_0x1c008b(0x20e)](_0x1c008b(0x49b),_0x28ff1f,!![]);};window['addEventListener'](_0x3db860(0x445),_0x28ff1f,!![]),window['addEventListener'](_0x3db860(0x49b),_0x28ff1f,!![]),showSoundPermission();}}catch(_0x2d7aba){}updateYouTubePlayer();}function onPlayerStateChange(_0xe8fb65){const _0xda5d91=_0x3be7fc,_0x3fab62=$(_0xda5d91(0x4ad));_0xe8fb65['data']==YT[_0xda5d91(0x481)][_0xda5d91(0x3d7)]?(_0x3fab62['textContent']='⏸️',hideSoundPermission()):_0x3fab62[_0xda5d91(0x342)]='▶';if(_0xe8fb65[_0xda5d91(0x4b6)]===YT['PlayerState'][_0xda5d91(0x40a)]){if(!ytUserPaused)ytPlayer[_0xda5d91(0x38b)]();}}async function ytFadeTo(_0xc1019a,_0x4b7a79=0xfa){const _0x3f4171=_0x3be7fc;try{if(!ytPlayer||!ytPlayer[_0x3f4171(0x282)]||!ytPlayer['setVolume'])return;ytPlayer[_0x3f4171(0x29b)]();const _0x185a8c=ytPlayer[_0x3f4171(0x282)](),_0x50666c=_0xc1019a-_0x185a8c;if(Math['abs'](_0x50666c)<0x1||_0x4b7a79<=0x0){ytPlayer[_0x3f4171(0x237)](_0xc1019a);return;}const _0x384b04=performance['now']();await new Promise(_0x47e669=>{const _0x593168=_0x4b0609=>{const _0x18ace7=_0x4a2d,_0x542d8d=Math[_0x18ace7(0x40b)](0x1,(_0x4b0609-_0x384b04)/_0x4b7a79),_0x150cbe=Math[_0x18ace7(0x28d)](_0x185a8c+_0x50666c*_0x542d8d);ytPlayer[_0x18ace7(0x237)](_0x150cbe);if(_0x542d8d<0x1)requestAnimationFrame(_0x593168);else _0x47e669();};requestAnimationFrame(_0x593168);});}catch(_0x29e1cb){}}async function ytFadeInPlay(_0x3419b0=0xdc){const _0x318e91=_0x3be7fc;try{const _0x1bccea=Math[_0x318e91(0x36e)](0x0,Math[_0x318e91(0x40b)](0x64,data&&data[_0x318e91(0x48d)]&&data[_0x318e91(0x48d)][_0x318e91(0x3c6)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;ytPlayer['unMute'](),ytPlayer[_0x318e91(0x38b)]();try{ytPlayer[_0x318e91(0x237)](0x0);}catch(_0x36ad36){}await ytFadeTo(_0x1bccea,_0x3419b0);}else{const _0x5a0d93=getActiveVideoId();_0x5a0d93&&fallbackLoadVideo(_0x5a0d93,{'autoplay':0x1,'mute':0x0});}}catch(_0x2cd19b){}}async function ytFadeOutPause(_0xddd321=0xb4){const _0x27e974=_0x3be7fc;try{const _0x4b1ddb=Math['max'](0x0,Math[_0x27e974(0x40b)](0x64,data&&data[_0x27e974(0x48d)]&&data[_0x27e974(0x48d)][_0x27e974(0x3c6)]||0x50));if(!IS_FILE_PROTOCOL){if(!ytPlayer)return;await ytFadeTo(0x0,_0xddd321);try{ytPlayer[_0x27e974(0x31b)](),ytPlayer['setVolume'](_0x4b1ddb);}catch(_0x10fe2f){}}else try{fallbackPause();}catch(_0x4df1e4){}}catch(_0x55572e){}}async function updateYouTubePlayer(){const _0x212e5d=_0x3be7fc,_0x367e9c=getActiveVideoId();if(data['settings'][_0x212e5d(0x4a6)]&&_0x367e9c){const _0x295f66=_0x212e5d(0x1d2)+_0x367e9c+'/maxresdefault.jpg',_0x4a34be=new Image();_0x4a34be['onload']=async()=>{const _0x16fe20=_0x212e5d;data[_0x16fe20(0x48d)][_0x16fe20(0x1db)]=_0x295f66,await saveData(),applyCustomBg();},_0x4a34be[_0x212e5d(0x1f5)]=async()=>{const _0x21e988=_0x212e5d,_0xf2d1d8=_0x21e988(0x1d2)+_0x367e9c+_0x21e988(0x1f1);data['settings']['customBg']=_0xf2d1d8,await saveData(),applyCustomBg();},_0x4a34be[_0x212e5d(0x42f)]=_0x295f66;}else!_0x367e9c&&(data['settings']['customBg']='',await saveData(),applyCustomBg());if(IS_FILE_PROTOCOL){if(!_0x367e9c){fallbackStop(),hideSoundPermission();return;}const _0x4a0026=_ytUnlocked?0x0:0x1;fallbackLoadVideo(_0x367e9c,{'autoplay':0x1,'mute':_0x4a0026});!_ytUnlocked&&showSoundPermission();return;}if(!ytPlayer||!ytPlayer['cueVideoById']){try{ensureYouTubeAPI();}catch(_0x3f5e27){}return;}if(!_0x367e9c){if(ytPlayer[_0x212e5d(0x35d)])ytPlayer[_0x212e5d(0x35d)]();hideSoundPermission();return;}ytPlayer['cueVideoById'](_0x367e9c),ytPlayer[_0x212e5d(0x237)](data[_0x212e5d(0x48d)][_0x212e5d(0x3c6)]);}function toggleYtSound(){const _0x188456=_0x3be7fc;if(!_ytUnlocked){try{ensureAudio();}catch(_0x550179){}try{unlockAudioChain();}catch(_0x26fa7e){}return;}if(IS_FILE_PROTOCOL){const _0x236273=getActiveVideoId();if(!ytFallbackFrame||!ytFallbackFrame[_0x188456(0x44f)]){if(!_0x236273){toast(_0x188456(0x44d));return;}fallbackLoadVideo(_0x236273,{'autoplay':0x1,'mute':0x0}),ytFallbackIsPlaying=!![];try{const _0x1fbc30=document[_0x188456(0x1dc)](_0x188456(0x2c6));if(_0x1fbc30)_0x1fbc30[_0x188456(0x342)]='⏸️';}catch(_0x45f729){}toast(_0x188456(0x37a));return;}if(ytFallbackIsPlaying)fallbackPostMessage(_0x188456(0x31b)),ytFallbackIsPlaying=![],toast(_0x188456(0x28a));else{if(!_0x236273){toast(_0x188456(0x44d));return;}fallbackPostMessage('playVideo'),ytFallbackIsPlaying=!![],toast(_0x188456(0x37a));}try{const _0x5891b3=document['getElementById'](_0x188456(0x2c6));if(_0x5891b3)_0x5891b3[_0x188456(0x342)]=ytFallbackIsPlaying?'⏸️':'▶';}catch(_0x5b0b2a){}return;}if(!ytPlayer||typeof ytPlayer[_0x188456(0x1ab)]!==_0x188456(0x34f)){try{ensureYouTubeAPI();}catch(_0xbcd930){}return;}const _0x467efe=ytPlayer['getPlayerState']();_0x467efe===YT['PlayerState'][_0x188456(0x3d7)]||_0x467efe===YT[_0x188456(0x481)]['BUFFERING']?(ytFadeOutPause(),ytUserPaused=!![],toast(_0x188456(0x28a))):(ytFadeInPlay(),ytUserPaused=![],toast('Playing\x20background\x20music...'));}function bindEvents(){const _0x3a0f64=_0x3be7fc;try{const _0x47eee7=document['querySelector'](_0x3a0f64(0x476));_0x47eee7&&(_0x47eee7[_0x3a0f64(0x28b)]='Get\x20started\x20by\x20selecting\x20a\x20<strong>Subtopic</strong>\x20or\x20creating\x20a\x20Topic.');}catch(_0x38d558){}on($(_0x3a0f64(0x3f5)),_0x3a0f64(0x363),toggleBackgroundView),on($(_0x3a0f64(0x255)),_0x3a0f64(0x363),()=>{const _0x349a93=_0x3a0f64;$('#modalMilestone')['classList'][_0x349a93(0x1ef)](_0x349a93(0x369));try{releaseFocus();}catch(_0x1ef9b9){}}),on($(_0x3a0f64(0x356)),_0x3a0f64(0x363),()=>showInputModal(_0x3a0f64(0x248),async _0xb20af8=>{const _0x37bfd1=_0x3a0f64;if(!_0xb20af8)return;data[_0x37bfd1(0x247)][_0x37bfd1(0x2d0)]({'id':uid('t'),'name':_0xb20af8,'subtopics':[]}),await saveData(),renderTopics();})),on($(_0x3a0f64(0x217)),'click',()=>storageManager['exportData'](data)),on($(_0x3a0f64(0x4aa)),_0x3a0f64(0x3f9),_0x1d16da=>{const _0x5dc1b2=_0x3a0f64,_0x456dcd=_0x1d16da[_0x5dc1b2(0x35a)][_0x5dc1b2(0x3e9)][0x0];if(!_0x456dcd)return;storageManager[_0x5dc1b2(0x1d3)](_0x456dcd)[_0x5dc1b2(0x409)](async _0x174ee8=>{const _0x436f3a=_0x5dc1b2;data=_0x174ee8,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),toast(_0x436f3a(0x2dd)),renderAll();})[_0x5dc1b2(0x350)](_0x3e056a=>toast(_0x5dc1b2(0x43d)+_0x3e056a['message'])),_0x1d16da['target'][_0x5dc1b2(0x451)]=null;}),on($(_0x3a0f64(0x47c)),_0x3a0f64(0x363),()=>{const _0x56371b=_0x3a0f64,_0x2e4788=$(_0x56371b(0x1a3)),_0x59e16a=_0x2e4788?_0x2e4788[_0x56371b(0x451)]:'';if(!_0x59e16a){toast('Please\x20select\x20a\x20backup.');return;}showConfirmModal(_0x56371b(0x1cb),'Are\x20you\x20sure\x20you\x20want\x20to\x20restore\x20data\x20from\x20'+new Date(_0x59e16a)[_0x56371b(0x1a5)]()+_0x56371b(0x483),_0x3f8560=>{const _0x598ae9=_0x56371b;_0x3f8560&&storageManager[_0x598ae9(0x458)](_0x59e16a)[_0x598ae9(0x409)](_0x1d0f9b=>{const _0x5874bc=_0x598ae9;data=_0x1d0f9b,toast(_0x5874bc(0x461)),setTimeout(()=>window[_0x5874bc(0x223)][_0x5874bc(0x43c)](),0x5dc);})[_0x598ae9(0x350)](_0x2bb643=>{const _0x13f350=_0x598ae9;toast(_0x13f350(0x46a)+_0x2bb643['message']);});});}),on($(_0x3a0f64(0x40c)),_0x3a0f64(0x21a),_0x2a0ab6=>{const _0x1af58c=_0x3a0f64,_0x2fe385=_0x2a0ab6[_0x1af58c(0x35a)][_0x1af58c(0x451)];applyTheme(_0x2fe385);if(_0x2fe385===_0x1af58c(0x30b)||_0x2fe385===_0x1af58c(0x206)){const _0x1bac54=$(_0x1af58c(0x20d));_0x1bac54&&(_0x1bac54[_0x1af58c(0x425)]=![],toast(_0x1af58c(0x2f7),0x7d0));try{document['body'][_0x1af58c(0x43e)][_0x1af58c(0x457)](_0x1af58c(0x411),_0x1af58c(0x3fc));}catch(_0x1ea4d4){}}else{const _0x454440=$(_0x1af58c(0x20d));_0x454440&&(_0x454440[_0x1af58c(0x425)]=!![]);try{updateYouTubePlayer();}catch(_0x4613bd){}}}),on($('#btnSettings'),_0x3a0f64(0x363),openSettings),on($(_0x3a0f64(0x301)),_0x3a0f64(0x363),()=>{const _0x2ba960=_0x3a0f64;switchView(_0x2ba960(0x247)),$(_0x2ba960(0x356))[_0x2ba960(0x363)]();}),on($(_0x3a0f64(0x493)),'click',()=>{const _0x1b168b=_0x3a0f64;renderDashboard(),$(_0x1b168b(0x1a8))['classList'][_0x1b168b(0x27e)]('show');}),on($(_0x3a0f64(0x2bf)),'click',()=>{const _0x596b1e=_0x3a0f64;$('#modalDashboard')[_0x596b1e(0x39e)]['remove'](_0x596b1e(0x369));}),on($(_0x3a0f64(0x2e4)),_0x3a0f64(0x363),closeSettings),on($(_0x3a0f64(0x2da)),_0x3a0f64(0x363),saveSettings),on($(_0x3a0f64(0x433)),_0x3a0f64(0x363),setDefaults),on($(_0x3a0f64(0x210)),'click',()=>{const _0x26fa14=_0x3a0f64;ensureAudio(),playSound(_0x26fa14(0x386));}),on($(_0x3a0f64(0x297)),_0x3a0f64(0x363),_0x32dd20=>{const _0x26e945=_0x3a0f64;_0x32dd20[_0x26e945(0x358)]();const _0x520054=$(_0x26e945(0x407));if(_0x520054)_0x520054['classList']['toggle']('hidden');}),on($('#btnSaveNote'),_0x3a0f64(0x363),async()=>{const _0x596b2c=_0x3a0f64,_0x5b8a19=getCurrentSubtopic();if(!_0x5b8a19)return;const _0x46b101=pendingNoteSessionId,_0x2f0852=_0x5b8a19[_0x596b2c(0x1e7)][_0x596b2c(0x489)](_0x11fcfb=>_0x11fcfb['id']===_0x46b101);_0x2f0852&&(_0x2f0852['note']=$(_0x596b2c(0x48f))['value'][_0x596b2c(0x3d6)](),await saveData(),renderStatsHistory(),toast(_0x596b2c(0x3c2))),closeNoteModal();}),on($(_0x3a0f64(0x4af)),_0x3a0f64(0x363),()=>closeNoteModal()),on($('#btnAddGeneralNote'),'click',addGeneralNote),on($(_0x3a0f64(0x2e9)),_0x3a0f64(0x363),handleSummarizeNote),on($(_0x3a0f64(0x3ef)),_0x3a0f64(0x363),handleSendMessage),on($(_0x3a0f64(0x3bc)),_0x3a0f64(0x49b),_0x56b501=>{const _0x46db60=_0x3a0f64;if(_0x56b501[_0x46db60(0x320)]==='Enter')handleSendMessage();}),$$('#aiPromptSuggestions\x20button')[_0x3a0f64(0x2d6)](_0x14ad5e=>{const _0x491abe=_0x3a0f64;on(_0x14ad5e,_0x491abe(0x363),()=>{const _0x3c7334=_0x491abe,_0x3e8a15=_0x14ad5e['dataset'][_0x3c7334(0x268)];$('#chatInput')[_0x3c7334(0x451)]=_0x3e8a15,$('#chatInput')[_0x3c7334(0x3d2)]();});}),on($(_0x3a0f64(0x229)),_0x3a0f64(0x363),clearChat),on($(_0x3a0f64(0x4ab)),_0x3a0f64(0x363),addSubtopicTask),on($(_0x3a0f64(0x41b)),_0x3a0f64(0x49b),_0x2b4552=>{if(_0x2b4552['key']==='Enter')addSubtopicTask();}),on($(_0x3a0f64(0x4ad)),_0x3a0f64(0x363),toggleYtSound),on($(_0x3a0f64(0x245)),_0x3a0f64(0x363),()=>{ensureAudio(),unlockAudioChain();}),on($('#ytSoundVolume'),_0x3a0f64(0x21a),_0x3079df=>{const _0x4f21e2=_0x3a0f64,_0x53b13e=parseInt(_0x3079df['target'][_0x4f21e2(0x451)],0xa);ytPlayer&&ytPlayer['setVolume']&&ytPlayer[_0x4f21e2(0x237)](_0x53b13e);}),on($(_0x3a0f64(0x200)),'input',handleYoutubeUrlInput),$$(_0x3a0f64(0x2a5))[_0x3a0f64(0x2d6)](_0xe7362=>{const _0x373765=_0x3a0f64;_0xe7362['addEventListener'](_0x373765(0x363),()=>{const _0x30c07b=_0x373765,_0x324e27=_0xe7362['dataset'][_0x30c07b(0x4a4)],_0x23cc65=data?.[_0x30c07b(0x48d)]?.[_0x30c07b(0x1b9)]||_0x30c07b(0x379);if(_0x23cc65===_0x324e27&&_0x324e27!=='timer')switchView(_0x30c07b(0x379));else switchView(_0x324e27);});}),$$(_0x3a0f64(0x30a))['forEach'](_0x1d95a1=>{const _0x388f76=_0x3a0f64;_0x1d95a1[_0x388f76(0x2bd)](_0x388f76(0x363),()=>{const _0x2584dd=_0x388f76,_0x5b0d02=_0x1d95a1[_0x2584dd(0x485)][_0x2584dd(0x3a1)],_0x4ddc14=_0x1d95a1[_0x2584dd(0x239)](_0x2584dd(0x333));if(!_0x4ddc14)return;_0x4ddc14[_0x2584dd(0x2bc)](_0x2584dd(0x30a))[_0x2584dd(0x2d6)](_0x4c30d3=>_0x4c30d3[_0x2584dd(0x39e)]['remove']('active')),_0x1d95a1['classList'][_0x2584dd(0x27e)](_0x2584dd(0x279)),_0x4ddc14[_0x2584dd(0x2bc)](_0x2584dd(0x331))['forEach'](_0x2e0edc=>{const _0x317f93=_0x2584dd;_0x2e0edc[_0x317f93(0x39e)][_0x317f93(0x1ef)](_0x317f93(0x279)),_0x2e0edc[_0x317f93(0x43e)][_0x317f93(0x353)]='none';});const _0x13a731=_0x4ddc14[_0x2584dd(0x3ed)]('#'+_0x5b0d02);_0x13a731&&(_0x13a731['classList'][_0x2584dd(0x27e)](_0x2584dd(0x279)),_0x13a731[_0x2584dd(0x43e)][_0x2584dd(0x353)]='block',_0x4ddc14[_0x2584dd(0x239)](_0x2584dd(0x33f))&&(_0x13a731['style'][_0x2584dd(0x353)]=_0x2584dd(0x2bb)));});});const _0x100c8d=$(_0x3a0f64(0x212));function _0x2a1dfd(_0xe60cc8,_0x33715f=null){const _0x507799=_0x3a0f64;try{document['execCommand']('styleWithCSS',![],!![]);}catch(_0x38db1d){}try{document['execCommand'](_0xe60cc8,![],_0x33715f);}catch(_0x5d11f2){}if(_0x100c8d)_0x100c8d[_0x507799(0x3d2)]();}on($(_0x3a0f64(0x1cc)),_0x3a0f64(0x363),()=>_0x2a1dfd(_0x3a0f64(0x1cf))),on($('#toolItalic'),_0x3a0f64(0x363),()=>_0x2a1dfd(_0x3a0f64(0x3d3))),on($('#toolH4'),_0x3a0f64(0x363),()=>_0x2a1dfd(_0x3a0f64(0x47b),'<h4>')),on($(_0x3a0f64(0x202)),_0x3a0f64(0x363),()=>_0x2a1dfd(_0x3a0f64(0x1ae))),on($(_0x3a0f64(0x3c7)),_0x3a0f64(0x363),()=>_0x2a1dfd('insertUnorderedList'));const _0x1506e4=$(_0x3a0f64(0x47a)),_0xa6cc72=$(_0x3a0f64(0x3dc));on($('#toolColor'),_0x3a0f64(0x363),_0x1c9b8c=>{const _0xeaf128=_0x3a0f64;if(!_0xa6cc72)return;_0x1c9b8c[_0xeaf128(0x22f)](),_0xa6cc72[_0xeaf128(0x39e)][_0xeaf128(0x402)](_0xeaf128(0x2ee));}),$$('.color-swatch')[_0x3a0f64(0x2d6)](_0x260a62=>{const _0x43746f=_0x3a0f64;on(_0x260a62,_0x43746f(0x363),_0x462b20=>{const _0x35b14b=_0x43746f;_0x462b20[_0x35b14b(0x358)]();const _0x31b24c=_0x260a62[_0x35b14b(0x485)][_0x35b14b(0x32a)]||'';let _0x425bf9=_0x31b24c;try{const _0x12486e=_0x31b24c[_0x35b14b(0x499)](/--[a-zA-Z0-9_-]+/);if(_0x12486e)_0x425bf9=getComputedStyle(document[_0x35b14b(0x298)])[_0x35b14b(0x492)](_0x12486e[0x0])[_0x35b14b(0x3d6)]();}catch(_0x46dbcb){}_0x2a1dfd(_0x35b14b(0x373),_0x425bf9);if(_0xa6cc72)_0xa6cc72[_0x35b14b(0x39e)][_0x35b14b(0x27e)]('hidden');});}),on(document,_0x3a0f64(0x363),_0x39bd91=>{const _0x56c944=_0x3a0f64;if(!_0x1506e4||!_0xa6cc72)return;!_0x1506e4[_0x56c944(0x203)](_0x39bd91[_0x56c944(0x35a)])&&!_0xa6cc72[_0x56c944(0x39e)][_0x56c944(0x203)](_0x56c944(0x2ee))&&_0xa6cc72[_0x56c944(0x39e)][_0x56c944(0x27e)](_0x56c944(0x2ee));});function _0x7f1aa6(_0xf4b6d0){const _0x399976=_0x3a0f64,_0x4f5154=data?.[_0x399976(0x48d)]?.[_0x399976(0x462)]||[],_0x15caf5=_0xf4b6d0?_0x4f5154[_0x399976(0x489)](_0x216b21=>_0x216b21['id']===_0xf4b6d0):null;$(_0x399976(0x3cc))['value']=_0x15caf5&&_0x15caf5['id']||'',$(_0x399976(0x25c))[_0x399976(0x342)]=_0x15caf5?'Edit\x20Knowledge':_0x399976(0x337),$(_0x399976(0x22d))['value']=_0x15caf5&&_0x15caf5[_0x399976(0x3f7)]||'';const _0x342f0b=$('#methodEditorContentInput');if(_0x342f0b)_0x342f0b[_0x399976(0x28b)]=_0x15caf5&&_0x15caf5[_0x399976(0x41d)]||'';$(_0x399976(0x318))['classList'][_0x399976(0x27e)](_0x399976(0x369));try{trapFocus($(_0x399976(0x318)));}catch(_0x54d50e){}try{const _0x1ba589=$(_0x399976(0x2f5));if(_0x1ba589){const _0xbe2c9f=!!(data?.[_0x399976(0x48d)]?.[_0x399976(0x3fa)]&&data[_0x399976(0x48d)][_0x399976(0x3fa)]['trim']());_0x1ba589[_0x399976(0x2dc)]=!_0xbe2c9f,_0x1ba589[_0x399976(0x3f7)]=_0xbe2c9f?_0x399976(0x240):'Please\x20add\x20a\x20Gemini\x20API\x20Key\x20in\x20Settings\x20to\x20use\x20this\x20feature.';}}catch(_0x3549c1){}}on($(_0x3a0f64(0x413)),_0x3a0f64(0x363),()=>{const _0x3b7d04=_0x3a0f64;$('#modalMethodEditor')['classList'][_0x3b7d04(0x1ef)]('show');try{releaseFocus();}catch(_0x1a7f26){}}),on($(_0x3a0f64(0x4b2)),_0x3a0f64(0x363),async()=>{const _0x542b3d=_0x3a0f64,_0x26f483=$(_0x542b3d(0x3cc))[_0x542b3d(0x451)]||uid('m'),_0x3ba7a0=($(_0x542b3d(0x22d))[_0x542b3d(0x451)]||'')[_0x542b3d(0x3d6)](),_0x5b78b0=$(_0x542b3d(0x212)),_0x1e5869=_0x5b78b0?_0x5b78b0[_0x542b3d(0x28b)]||'':'';if(!Array['isArray'](data['settings'][_0x542b3d(0x462)]))data[_0x542b3d(0x48d)]['methods']=[];const _0x24bad0=data['settings'][_0x542b3d(0x462)][_0x542b3d(0x2f2)](_0x9fe05d=>_0x9fe05d['id']===_0x26f483),_0x8d3d23={'id':_0x26f483,'title':_0x3ba7a0,'content':_0x1e5869};if(_0x24bad0>=0x0)data[_0x542b3d(0x48d)][_0x542b3d(0x462)][_0x24bad0]=_0x8d3d23;else data['settings']['methods'][_0x542b3d(0x484)](_0x8d3d23);await storageManager[_0x542b3d(0x322)](data[_0x542b3d(0x48d)]),renderMethods(),$('#modalMethodEditor')['classList'][_0x542b3d(0x1ef)]('show');try{releaseFocus();}catch(_0x245e2c){}}),on($(_0x3a0f64(0x2f5)),_0x3a0f64(0x363),async()=>{const _0x111dda=_0x3a0f64,_0x4e64bd=$(_0x111dda(0x212));if(!_0x4e64bd)return;const _0x585327=(_0x4e64bd[_0x111dda(0x342)]||'')['trim']();if(!_0x585327||_0x585327[_0x111dda(0x49f)]<0x14){toast(_0x111dda(0x391));return;}const _0x54a85b=$('#btnAutoFormat');_0x54a85b&&(_0x54a85b[_0x111dda(0x2dc)]=!![],_0x54a85b[_0x111dda(0x28b)]=_0x111dda(0x415));const _0x482424=_0x111dda(0x2b4)+_0x585327+'\x22',_0x55e568=await callGeminiAPI(_0x482424);_0x55e568?(_0x4e64bd[_0x111dda(0x28b)]=_0x55e568,toast('AI\x20finished\x20formatting!')):toast('AI\x20cannot\x20format\x20at\x20the\x20moment.'),_0x54a85b&&(_0x54a85b['disabled']=![],_0x54a85b[_0x111dda(0x28b)]='✨\x20Auto-format');}),on($(_0x3a0f64(0x26b)),_0x3a0f64(0x363),()=>_0x7f1aa6());const _0x14146b=document[_0x3a0f64(0x3ed)](_0x3a0f64(0x49d));_0x14146b&&_0x14146b[_0x3a0f64(0x2bd)](_0x3a0f64(0x363),_0x2d6395=>{const _0x4ad2aa=_0x3a0f64,_0x28ea5f=_0x2d6395[_0x4ad2aa(0x35a)][_0x4ad2aa(0x239)]&&_0x2d6395[_0x4ad2aa(0x35a)]['closest'](_0x4ad2aa(0x3e0)),_0x4a29a5=!_0x28ea5f&&_0x2d6395[_0x4ad2aa(0x35a)][_0x4ad2aa(0x239)]&&_0x2d6395['target'][_0x4ad2aa(0x239)]('.method-delete');if(_0x28ea5f){_0x2d6395['preventDefault'](),_0x2d6395['stopPropagation']();const _0x3efc3d=_0x28ea5f['dataset']['id'];if(_0x3efc3d)_0x7f1aa6(_0x3efc3d);return;}if(_0x4a29a5){_0x2d6395[_0x4ad2aa(0x358)](),_0x2d6395[_0x4ad2aa(0x22f)]();const _0x1c4f81=_0x4a29a5[_0x4ad2aa(0x485)]['id'];if(!_0x1c4f81)return;const _0x89e7a2=data?.[_0x4ad2aa(0x48d)]?.['methods']||[],_0x679560=_0x89e7a2[_0x4ad2aa(0x489)](_0x585b43=>_0x585b43['id']===_0x1c4f81);if(!_0x679560)return;showConfirmModal(_0x4ad2aa(0x429),_0x4ad2aa(0x224)+(_0x679560[_0x4ad2aa(0x3f7)]||'')+'\x22?',async _0x4fcff1=>{const _0x48d4c3=_0x4ad2aa;if(!_0x4fcff1)return;data['settings'][_0x48d4c3(0x462)]=_0x89e7a2[_0x48d4c3(0x2b3)](_0x4cd91e=>_0x4cd91e['id']!==_0x1c4f81),await storageManager[_0x48d4c3(0x322)](data['settings']),renderMethods();});}});$$(_0x3a0f64(0x3b5))[_0x3a0f64(0x2d6)](_0x5e146f=>{const _0x3b537f=_0x3a0f64;_0x5e146f[_0x3b537f(0x2bd)](_0x3b537f(0x363),()=>{const _0xdaf87d=_0x3b537f;editingPreset=_0x5e146f['dataset'][_0xdaf87d(0x1aa)],highlightPresetSelector(),loadEditingPresetFields();});}),$$('.presets\x20button')[_0x3a0f64(0x2d6)](_0x4c8079=>{const _0x3e8900=_0x3a0f64;_0x4c8079[_0x3e8900(0x2bd)](_0x3e8900(0x363),_0x44d917=>{const _0x1b7a45=_0x3e8900,_0x450cc=_0x44d917[_0x1b7a45(0x35a)][_0x1b7a45(0x485)][_0x1b7a45(0x352)],_0x5c154a=data[_0x1b7a45(0x48d)][_0x1b7a45(0x352)];if(_0x450cc===_0x5c154a)return;timer[_0x1b7a45(0x1f9)]!=='idle'?showConfirmModal(_0x1b7a45(0x335),_0x1b7a45(0x39a)+_0x450cc+_0x1b7a45(0x3fb),_0x4a9388=>{const _0x98e856=_0x1b7a45;_0x4a9388&&(timer['reset'](),timer['setPreset'](_0x450cc),renderAll(),toast(_0x98e856(0x43f)+_0x450cc+'.'));}):(timer[_0x1b7a45(0x36b)](_0x450cc),renderAll(),toast(_0x1b7a45(0x43f)+_0x450cc+'.'));});}),on($(_0x3a0f64(0x3f3)),_0x3a0f64(0x363),()=>timer['start']()),on($(_0x3a0f64(0x2a3)),'click',()=>timer[_0x3a0f64(0x465)]()),on($(_0x3a0f64(0x385)),_0x3a0f64(0x363),()=>timer[_0x3a0f64(0x456)]()),on($(_0x3a0f64(0x1c5)),_0x3a0f64(0x363),()=>timer['resume']()),on($(_0x3a0f64(0x293)),_0x3a0f64(0x363),()=>timer[_0x3a0f64(0x215)]()),on($(_0x3a0f64(0x431)),_0x3a0f64(0x363),()=>timer[_0x3a0f64(0x494)]()),on($(_0x3a0f64(0x3d4)),_0x3a0f64(0x363),()=>timer[_0x3a0f64(0x305)]()),on($(_0x3a0f64(0x2a0)),_0x3a0f64(0x3f9),_0x332a97=>{const _0x3bd67e=_0x3a0f64;handleFileUpload(_0x332a97[_0x3bd67e(0x35a)][_0x3bd67e(0x3e9)][0x0],async _0x593e7f=>{const _0xd50052=_0x3bd67e;data['settings']['customBg']=_0x593e7f,await saveData(),applyCustomBg(),toast(_0xd50052(0x3c0));}),_0x332a97[_0x3bd67e(0x35a)][_0x3bd67e(0x451)]=null;}),on($('#btnClearBg'),'click',async()=>{const _0x2bf9bf=_0x3a0f64;data[_0x2bf9bf(0x48d)][_0x2bf9bf(0x1db)]='',data[_0x2bf9bf(0x48d)][_0x2bf9bf(0x4a6)]=![],await saveData(),applyCustomBg(),toast(_0x2bf9bf(0x346)),$(_0x2bf9bf(0x33f))[_0x2bf9bf(0x39e)][_0x2bf9bf(0x203)]('show')&&openSettings();}),on($('#uploadSoundWork'),'change',_0x5b30a8=>{const _0x3676f1=_0x3a0f64;handleFileUpload(_0x5b30a8[_0x3676f1(0x35a)][_0x3676f1(0x3e9)][0x0],async _0x1ed381=>{const _0x42d31c=_0x3676f1;data[_0x42d31c(0x48d)][_0x42d31c(0x1bb)][_0x42d31c(0x386)]=_0x1ed381,await saveData(),toast(_0x42d31c(0x328));}),_0x5b30a8[_0x3676f1(0x35a)][_0x3676f1(0x451)]=null;}),on($(_0x3a0f64(0x308)),_0x3a0f64(0x3f9),_0xbd9db5=>{const _0x3e2d97=_0x3a0f64;handleFileUpload(_0xbd9db5['target'][_0x3e2d97(0x3e9)][0x0],async _0x5cb8e0=>{const _0x52495e=_0x3e2d97;data[_0x52495e(0x48d)]['customSounds'][_0x52495e(0x3ba)]=_0x5cb8e0,await saveData(),toast(_0x52495e(0x1fe));}),_0xbd9db5[_0x3e2d97(0x35a)][_0x3e2d97(0x451)]=null;}),on($(_0x3a0f64(0x495)),_0x3a0f64(0x3f9),_0xa267a3=>{const _0x5390ce=_0x3a0f64;handleFileUpload(_0xa267a3['target'][_0x5390ce(0x3e9)][0x0],async _0x2a0e31=>{data['settings']['customSounds']['long_end']=_0x2a0e31,await saveData(),toast('Saved\x20alert\x20for\x20LONG\x20BREAK.');}),_0xa267a3['target']['value']=null;}),on($(_0x3a0f64(0x1d5)),_0x3a0f64(0x363),toggleFullScreen),document['addEventListener'](_0x3a0f64(0x396),updateFullscreenButton),window[_0x3a0f64(0x2bd)](_0x3a0f64(0x49b),_0x2f0dcb=>{const _0x577792=_0x3a0f64,_0x5e687f=(_0x2f0dcb[_0x577792(0x35a)][_0x577792(0x47d)]||'')[_0x577792(0x3f2)](),_0x3e7584=[_0x577792(0x21a),_0x577792(0x294),_0x577792(0x2e0)][_0x577792(0x2ac)](_0x5e687f);if(_0x2f0dcb[_0x577792(0x24c)]===_0x577792(0x41c)&&!_0x3e7584){_0x2f0dcb[_0x577792(0x358)]();if(timer[_0x577792(0x1f9)]===_0x577792(0x323)||timer[_0x577792(0x1f9)]===_0x577792(0x2d8))timer[_0x577792(0x37d)]();else timer[_0x577792(0x456)]();}(_0x2f0dcb['key']==='n'||_0x2f0dcb[_0x577792(0x320)]==='N')&&(!_0x3e7584&&(_0x2f0dcb[_0x577792(0x358)](),timer['skip']()));if(_0x2f0dcb[_0x577792(0x320)]==='Escape'){$$('.modal')[_0x577792(0x2d6)](_0x3ef504=>_0x3ef504[_0x577792(0x39e)][_0x577792(0x1ef)](_0x577792(0x369)));try{releaseFocus();}catch(_0x39d660){}}if(_0x2f0dcb['altKey']&&!_0x3e7584){if(_0x2f0dcb[_0x577792(0x320)]===_0x577792(0x1e0))_0x2f0dcb[_0x577792(0x358)](),_0x5b702d(0x0,-0xa);else{if(_0x2f0dcb[_0x577792(0x320)]===_0x577792(0x3bd))_0x2f0dcb['preventDefault'](),_0x5b702d(0x0,0xa);else{if(_0x2f0dcb[_0x577792(0x320)]===_0x577792(0x2be))_0x2f0dcb[_0x577792(0x358)](),_0x5b702d(-0xa,0x0);else _0x2f0dcb[_0x577792(0x320)]===_0x577792(0x241)&&(_0x2f0dcb[_0x577792(0x358)](),_0x5b702d(0xa,0x0));}}}}),$$(_0x3a0f64(0x1f2))[_0x3a0f64(0x2d6)](_0x3236b8=>_0x3236b8[_0x3a0f64(0x2bd)](_0x3a0f64(0x363),_0x45d745=>{const _0x17cb14=_0x3a0f64;if(_0x45d745&&_0x45d745['target']&&_0x45d745['target']['id']===_0x17cb14(0x3aa))return;if(_0x45d745['target']===_0x3236b8){_0x3236b8[_0x17cb14(0x39e)][_0x17cb14(0x1ef)](_0x17cb14(0x369));try{releaseFocus();}catch(_0x2f399b){}}})),window[_0x3a0f64(0x2bd)]('click',_0x112a49=>{const _0x559a6b=_0x3a0f64;!_0x112a49['target'][_0x559a6b(0x239)]('.actions-menu-btn')&&!_0x112a49[_0x559a6b(0x35a)]['closest'](_0x559a6b(0x32d))&&closeAllMenus();});try{const _0x460084=document[_0x3a0f64(0x3ed)](_0x3a0f64(0x295));if(_0x460084)_0x460084[_0x3a0f64(0x2bd)](_0x3a0f64(0x1f6),closeAllMenus);}catch(_0x4b3cd8){}try{window[_0x3a0f64(0x2bd)]('scroll',closeAllMenus,!![]);}catch(_0x305275){}window[_0x3a0f64(0x2bd)]('beforeunload',()=>timer['persistTimerState'](!![]));try{const _0x1543e1=Array['from'](document['querySelectorAll'](_0x3a0f64(0x260)));_0x1543e1['length']&&_0x1543e1[_0x3a0f64(0x2d6)](_0x1e318b=>{const _0x44e597=_0x3a0f64;_0x1e318b[_0x44e597(0x2bd)](_0x44e597(0x402),()=>{const _0x21380a=_0x44e597;_0x1e318b['open']&&_0x1543e1[_0x21380a(0x2d6)](_0x4970bf=>{const _0x38bc30=_0x21380a;if(_0x4970bf!==_0x1e318b)_0x4970bf[_0x38bc30(0x32c)]=![];});});});}catch(_0x22f5d3){}const _0x2b50b1=$(_0x3a0f64(0x41e));let _0x375d7c=![],_0xdf95a0,_0x58985d;_0x2b50b1&&(_0x2b50b1[_0x3a0f64(0x2bd)](_0x3a0f64(0x1d4),_0xdf6df3=>{const _0x2e7b4a=_0x3a0f64;_0x375d7c=!![];const _0x1e3062=_0x2b50b1[_0x2e7b4a(0x336)]();_0xdf95a0=_0xdf6df3[_0x2e7b4a(0x274)]-_0x1e3062[_0x2e7b4a(0x491)],_0x58985d=_0xdf6df3[_0x2e7b4a(0x42d)]-_0x1e3062[_0x2e7b4a(0x3cb)],_0x2b50b1[_0x2e7b4a(0x43e)]['transition']=_0x2e7b4a(0x3fc);}),document[_0x3a0f64(0x2bd)](_0x3a0f64(0x393),_0x59cb49=>{const _0x3b8079=_0x3a0f64;if(!_0x375d7c)return;let _0xc22f15=_0x59cb49[_0x3b8079(0x274)]-_0xdf95a0,_0x316bc5=_0x59cb49[_0x3b8079(0x42d)]-_0x58985d;const _0x37fbca=window[_0x3b8079(0x2db)]-_0x2b50b1[_0x3b8079(0x2ea)],_0xc73bce=window[_0x3b8079(0x3bf)]-_0x2b50b1[_0x3b8079(0x42b)];_0xc22f15=Math[_0x3b8079(0x36e)](0x0,Math['min'](_0xc22f15,_0x37fbca)),_0x316bc5=Math[_0x3b8079(0x36e)](0x0,Math[_0x3b8079(0x40b)](_0x316bc5,_0xc73bce)),_0x2b50b1[_0x3b8079(0x43e)][_0x3b8079(0x491)]=_0xc22f15+'px',_0x2b50b1[_0x3b8079(0x43e)][_0x3b8079(0x3cb)]=_0x316bc5+'px',_0x2b50b1[_0x3b8079(0x43e)][_0x3b8079(0x1c2)]=_0x3b8079(0x28f),_0x2b50b1[_0x3b8079(0x43e)][_0x3b8079(0x48e)]=_0x3b8079(0x28f);}),document[_0x3a0f64(0x2bd)](_0x3a0f64(0x27a),()=>{const _0x1d3b53=_0x3a0f64;if(!_0x375d7c)return;_0x375d7c=![],_0x2b50b1[_0x1d3b53(0x43e)][_0x1d3b53(0x2af)]='';}));function _0x3205c7(_0x483337){const _0x5c11c0=_0x3a0f64,_0x195c47=$('#draggableTimer');if(!_0x195c47)return;_0x195c47[_0x5c11c0(0x43e)][_0x5c11c0(0x258)]=_0x5c11c0(0x3e4),_0x195c47[_0x5c11c0(0x43e)][_0x5c11c0(0x2af)]='',_0x195c47[_0x5c11c0(0x43e)]['left']=_0x5c11c0(0x28f),_0x195c47[_0x5c11c0(0x43e)]['top']=_0x5c11c0(0x28f),_0x195c47[_0x5c11c0(0x43e)]['right']='auto',_0x195c47[_0x5c11c0(0x43e)][_0x5c11c0(0x1c2)]=_0x5c11c0(0x28f);const _0x38c3b8=0x10;_0x483337==='tl'&&(_0x195c47['style'][_0x5c11c0(0x491)]=_0x38c3b8+'px',_0x195c47['style']['top']=_0x38c3b8+'px'),_0x483337==='tr'&&(_0x195c47[_0x5c11c0(0x43e)][_0x5c11c0(0x48e)]=_0x38c3b8+'px',_0x195c47[_0x5c11c0(0x43e)]['top']=_0x38c3b8+'px'),_0x483337==='bl'&&(_0x195c47[_0x5c11c0(0x43e)][_0x5c11c0(0x491)]=_0x38c3b8+'px',_0x195c47[_0x5c11c0(0x43e)]['bottom']=_0x38c3b8+'px'),_0x483337==='br'&&(_0x195c47['style'][_0x5c11c0(0x48e)]=_0x38c3b8+'px',_0x195c47[_0x5c11c0(0x43e)][_0x5c11c0(0x1c2)]=_0x38c3b8+'px');}function _0x5b702d(_0x552514,_0x2f2961){const _0x300d27=_0x3a0f64,_0x4b9dbc=$(_0x300d27(0x41e));if(!_0x4b9dbc)return;const _0x102196=_0x4b9dbc[_0x300d27(0x336)](),_0x59a7b5=Math[_0x300d27(0x36e)](0x0,Math[_0x300d27(0x40b)](_0x102196['left']+_0x552514,window[_0x300d27(0x2db)]-_0x4b9dbc[_0x300d27(0x2ea)])),_0x251214=Math['max'](0x0,Math['min'](_0x102196[_0x300d27(0x3cb)]+_0x2f2961,window[_0x300d27(0x3bf)]-_0x4b9dbc[_0x300d27(0x42b)]));_0x4b9dbc['style']['left']=_0x59a7b5+'px',_0x4b9dbc['style'][_0x300d27(0x3cb)]=_0x251214+'px',_0x4b9dbc[_0x300d27(0x43e)][_0x300d27(0x48e)]=_0x300d27(0x28f),_0x4b9dbc[_0x300d27(0x43e)][_0x300d27(0x1c2)]=_0x300d27(0x28f);}}function toggleBackgroundView(){const _0x34276d=_0x3be7fc,_0x540d8b=document[_0x34276d(0x298)];_0x540d8b[_0x34276d(0x39e)]['toggle']('bg-view-mode');const _0x5cb984=_0x540d8b['classList'][_0x34276d(0x203)]('bg-view-mode'),_0x17f14f=$(_0x34276d(0x3f5));if(!_0x17f14f)return;_0x5cb984?(_0x17f14f['title']=_0x34276d(0x236),_0x17f14f['innerHTML']=_0x34276d(0x2e8)):(_0x17f14f[_0x34276d(0x3f7)]=_0x34276d(0x2d2),_0x17f14f['innerHTML']=_0x34276d(0x3a5));}function updateMainViewVisibility(){const _0x15955a=_0x3be7fc,_0x3eda18=!!getCurrentSubtopic(),_0x3d5c8b=$(_0x15955a(0x48c)),_0x6af963=$(_0x15955a(0x349));_0x6af963&&_0x6af963[_0x15955a(0x39e)][_0x15955a(0x402)]('hidden',_0x3eda18),_0x3d5c8b&&(_0x3eda18?_0x3d5c8b[_0x15955a(0x39e)][_0x15955a(0x1ef)]('no-subtopic-selected'):_0x3d5c8b[_0x15955a(0x39e)][_0x15955a(0x27e)]('no-subtopic-selected'));}function updatePresetButtonsText(){const _0x1cd66b=_0x3be7fc,_0x57000b=data[_0x1cd66b(0x48d)],_0x455634=_0x57000b['cyclesA'],_0x344bbe=_0x57000b['cyclesB'],_0x78b8cb=_0x57000b['durations']['A_work'],_0x4a19e7=_0x57000b[_0x1cd66b(0x1a4)][_0x1cd66b(0x487)],_0x4154db=$('#btnPresetA'),_0x5dad79=$(_0x1cd66b(0x1bc)),_0x307724=$(_0x1cd66b(0x329));_0x4154db&&(_0x4154db[_0x1cd66b(0x342)]=_0x455634+'×'+_0x78b8cb+_0x1cd66b(0x45b)),_0x5dad79&&(_0x5dad79[_0x1cd66b(0x342)]=_0x344bbe+'×'+_0x4a19e7+_0x1cd66b(0x2b1)),_0x307724&&(_0x307724[_0x1cd66b(0x342)]=_0x1cd66b(0x3a3));}function renderAll(){const _0x30594a=_0x3be7fc;updatePresetButtonsText();const _0x2d2acb=data[_0x30594a(0x48d)][_0x30594a(0x352)];$$(_0x30594a(0x1ec))[_0x30594a(0x2d6)](_0x17f401=>{const _0x5660c9=_0x30594a,_0xe1ff2c=_0x17f401['dataset'][_0x5660c9(0x352)]===_0x2d2acb;_0x17f401[_0x5660c9(0x39e)][_0x5660c9(0x402)]('acc',_0xe1ff2c),_0x17f401[_0x5660c9(0x39e)][_0x5660c9(0x402)](_0x5660c9(0x20c),!_0xe1ff2c),_0x17f401[_0x5660c9(0x30c)](_0x5660c9(0x299),_0xe1ff2c);}),updateMainViewVisibility(),timer[_0x30594a(0x36b)](data[_0x30594a(0x48d)][_0x30594a(0x352)],{'silent':!![]}),renderTopics(),renderContextBadge(),renderStatsHistory(),renderGeneralNotes(),renderMethods(),renderChat(),applyCustomBg(),applyPanelOpacity(),renderSubtopicTasks(),updateFullscreenButton(),switchView(data[_0x30594a(0x48d)][_0x30594a(0x1b9)]);}function toggleFullScreen(){const _0x45c2cd=_0x3be7fc;!document[_0x45c2cd(0x47f)]?document['documentElement']['requestFullscreen']()[_0x45c2cd(0x350)](_0x7315d0=>{const _0x56c521=_0x45c2cd;toast(_0x56c521(0x2b9)+_0x7315d0[_0x56c521(0x3b7)]);}):document[_0x45c2cd(0x26d)]&&document[_0x45c2cd(0x26d)]();}function updateFullscreenButton(){const _0x32940d=_0x3be7fc,_0x1c5e07=$(_0x32940d(0x1d5));document[_0x32940d(0x47f)]?(_0x1c5e07['innerHTML']='↙',_0x1c5e07[_0x32940d(0x3f7)]=_0x32940d(0x27c)):(_0x1c5e07[_0x32940d(0x28b)]='↗',_0x1c5e07[_0x32940d(0x3f7)]=_0x32940d(0x376));}async function initializeApp(){const _0x178dd2=_0x3be7fc;try{await storageManager[_0x178dd2(0x3d9)]();const [_0x24cca6,_0xe84dd,_0x5b8042]=await Promise[_0x178dd2(0x216)]([storageManager[_0x178dd2(0x2c2)](),storageManager[_0x178dd2(0x34c)](_0x178dd2(0x247)),storageManager[_0x178dd2(0x34c)]('subtopics')]);let _0x316248;if(!_0x24cca6){const _0x12ae84=JSON[_0x178dd2(0x327)](JSON[_0x178dd2(0x225)](defaults));await storageManager[_0x178dd2(0x322)](_0x12ae84[_0x178dd2(0x48d)]);for(const _0x5c7df6 of _0x12ae84[_0x178dd2(0x247)]){const {subtopics:_0x566626,..._0x3a7a7b}=_0x5c7df6;await storageManager[_0x178dd2(0x27e)]('topics',_0x3a7a7b);for(const _0x38f81a of _0x566626){await storageManager[_0x178dd2(0x27e)](_0x178dd2(0x372),{..._0x38f81a,'topicId':_0x5c7df6['id']});}}_0x316248=_0x12ae84;}else{const _0x3de076={};for(const _0x3f56fa of _0xe84dd)_0x3de076[_0x3f56fa['id']]={..._0x3f56fa,'subtopics':[]};for(const _0x280835 of _0x5b8042)_0x3de076[_0x280835[_0x178dd2(0x49a)]]?.[_0x178dd2(0x372)][_0x178dd2(0x2d0)](_0x280835);_0x316248={'version':defaults['version'],'settings':_0x24cca6,'topics':Object['values'](_0x3de076)};}data=window[_0x178dd2(0x4b6)]=_0x316248,normalizeDataStructure(data),await ensureValidSelection(),await seedAchievedMilestones(),renderAll();try{storageManager['autoBackup'](data);}catch(_0x219ee1){console[_0x178dd2(0x26e)]('AutoBackup\x20error:',_0x219ee1);}bindEvents(),applyTheme();}catch(_0x56cb26){console['error']('Initialization\x20error:',_0x56cb26),toast(_0x178dd2(0x381)+_0x56cb26[_0x178dd2(0x3b7)]);}}callGeminiAPI=async function(_0x3665ff,_0x3df0e1=0x3,_0x4ca585=0x3e8){const _0x4997b0=_0x3be7fc,_0x298e4f=data?.[_0x4997b0(0x48d)]?.[_0x4997b0(0x3fa)]||'';if(!_0x298e4f)return toast(_0x4997b0(0x2b2)),null;const _0x1d8ec3=_0x4997b0(0x416)+_0x298e4f,_0x24c9e6={'contents':[{'role':'user','parts':[{'text':_0x3665ff}]}]};try{const _0x574e7a=await fetch(_0x1d8ec3,{'method':_0x4997b0(0x232),'headers':{'Content-Type':'application/json'},'body':JSON[_0x4997b0(0x225)](_0x24c9e6)});if(!_0x574e7a['ok']){if(_0x574e7a[_0x4997b0(0x475)]===0x1ad&&_0x3df0e1>0x0)return await new Promise(_0x1b88db=>setTimeout(_0x1b88db,_0x4ca585)),callGeminiAPI(_0x3665ff,_0x3df0e1-0x1,_0x4ca585*0x2);let _0x1b6dab=null;try{_0x1b6dab=await _0x574e7a[_0x4997b0(0x395)]();}catch(_0x2d6522){}let _0x4b48dc='HTTP\x20error:\x20'+_0x574e7a['status'];if(_0x574e7a[_0x4997b0(0x475)]===0x190)_0x4b48dc=_0x4997b0(0x254);else{if(_0x574e7a['status']===0x1ad)_0x4b48dc=_0x4997b0(0x22a);else _0x1b6dab?.[_0x4997b0(0x292)]?.[_0x4997b0(0x3b7)]&&(_0x4b48dc=_0x4997b0(0x33e)+_0x1b6dab['error']['message']);}return toast(_0x4b48dc,0xfa0),console[_0x4997b0(0x292)](_0x4997b0(0x3db),_0x1b6dab||_0x574e7a[_0x4997b0(0x3c8)]),null;}const _0xfe7f3d=await _0x574e7a[_0x4997b0(0x395)]();if(_0xfe7f3d[_0x4997b0(0x466)]&&_0xfe7f3d['candidates'][0x0]?.[_0x4997b0(0x41d)]?.[_0x4997b0(0x3b3)]?.[0x0]?.[_0x4997b0(0x430)])return formatGeminiResponse(_0xfe7f3d[_0x4997b0(0x466)][0x0][_0x4997b0(0x41d)][_0x4997b0(0x3b3)][0x0][_0x4997b0(0x430)]);else{console[_0x4997b0(0x292)](_0x4997b0(0x38a),_0xfe7f3d);if(_0xfe7f3d['promptFeedback']?.['blockReason'])return _0x4997b0(0x2e5)+_0xfe7f3d[_0x4997b0(0x3ff)]['blockReason']+_0x4997b0(0x361);return _0x4997b0(0x459);}}catch(_0x3c14de){return console[_0x4997b0(0x292)](_0x4997b0(0x2cf),_0x3c14de),toast(_0x4997b0(0x36d),0xfa0),null;}},loadLanguage(localStorage[_0x3be7fc(0x3b8)](_0x3be7fc(0x37f))||'en')[_0x3be7fc(0x409)](initializeApp);
    </script>
</body>
</html>
